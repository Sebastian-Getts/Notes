{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/keep/source/css/font-awesome.min.css","path":"css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/keep/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/images/avatar.svg","path":"images/avatar.svg","modified":1,"renderable":1},{"_id":"themes/keep/source/images/avatar.png","path":"images/avatar.png","modified":1,"renderable":1},{"_id":"themes/keep/source/images/bg.svg","path":"images/bg.svg","modified":1,"renderable":1},{"_id":"themes/keep/source/images/loading.svg","path":"images/loading.svg","modified":1,"renderable":1},{"_id":"themes/keep/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/keep/source/images/upyun.png","path":"images/upyun.png","modified":1,"renderable":1},{"_id":"themes/keep/source/js/back2top.js","path":"js/back2top.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/code-copy.js","path":"js/code-copy.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/dark-light-toggle.js","path":"js/dark-light-toggle.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/header-shrink.js","path":"js/header-shrink.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/lazyload.js","path":"js/lazyload.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/left-side-toggle.js","path":"js/left-side-toggle.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/local-search.js","path":"js/local-search.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/main.js","path":"js/main.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/toc.js","path":"js/toc.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-brands-400.eot","path":"webfonts/fa-brands-400.eot","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-brands-400.svg","path":"webfonts/fa-brands-400.svg","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-brands-400.ttf","path":"webfonts/fa-brands-400.ttf","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-brands-400.woff","path":"webfonts/fa-brands-400.woff","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-brands-400.woff2","path":"webfonts/fa-brands-400.woff2","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-regular-400.eot","path":"webfonts/fa-regular-400.eot","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-regular-400.svg","path":"webfonts/fa-regular-400.svg","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-regular-400.ttf","path":"webfonts/fa-regular-400.ttf","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-regular-400.woff","path":"webfonts/fa-regular-400.woff","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-regular-400.woff2","path":"webfonts/fa-regular-400.woff2","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-solid-900.eot","path":"webfonts/fa-solid-900.eot","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-solid-900.svg","path":"webfonts/fa-solid-900.svg","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-solid-900.ttf","path":"webfonts/fa-solid-900.ttf","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-solid-900.woff","path":"webfonts/fa-solid-900.woff","modified":1,"renderable":1},{"_id":"themes/keep/source/webfonts/fa-solid-900.woff2","path":"webfonts/fa-solid-900.woff2","modified":1,"renderable":1},{"_id":"themes/keep/source/css/common/animated.styl","path":"css/common/animated.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/common/basic.styl","path":"css/common/basic.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/common/keep-theme.styl","path":"css/common/keep-theme.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/common/markdown.styl","path":"css/common/markdown.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/common/variables.styl","path":"css/common/variables.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/layout/article-content.styl","path":"css/layout/article-content.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/layout/archive-content.styl","path":"css/layout/archive-content.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/layout/home-content.styl","path":"css/layout/home-content.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/layout/category-list.styl","path":"css/layout/category-list.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/layout/page.styl","path":"css/layout/page.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/layout/category-content.styl","path":"css/layout/category-content.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/layout/tag-content.styl","path":"css/layout/tag-content.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/js/libs/pjax.min.js","path":"js/libs/pjax.min.js","modified":1,"renderable":1},{"_id":"themes/keep/source/js/libs/anime.min.js","path":"js/libs/anime.min.js","modified":1,"renderable":1},{"_id":"themes/keep/source/css/common/codeblock/code-theme.styl","path":"css/common/codeblock/code-theme.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/common/codeblock/copy-code.styl","path":"css/common/codeblock/copy-code.styl","modified":1,"renderable":1},{"_id":"themes/keep/source/css/common/codeblock/highlight.styl","path":"css/common/codeblock/highlight.styl","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"15e4cb98758c097932c391beb9634959e3de46e2","modified":1662086791877},{"_id":"source/about/index.md","hash":"d89d7a36d87c7959261591eba7773a08a8b1e5ca","modified":1670901414295},{"_id":"source/_posts/Apollo-01.md","hash":"6959f483600f3cbc4cbf24cd526a8358e31de113","modified":1669290947016},{"_id":"source/_posts/2021-mid.md","hash":"5b9a1050d64366e39a31ed035d94745e7f3e286d","modified":1636900215926},{"_id":"source/_posts/2022-end.md","hash":"fcc1185455560405f6290597eff14bf58f5cb0eb","modified":1672468503177},{"_id":"source/_posts/2022-mid-summary.md","hash":"dd614550ca8ad501c9f0a0155aac70185f1dd2e0","modified":1670597565141},{"_id":"source/_posts/SpringBoot-environment.md","hash":"b615670233ab9c53cf1e1facaa5cad45bc311fc0","modified":1670597143108},{"_id":"source/_posts/Spring-Security-AutoConfiguration.md","hash":"52062e1d30cd9b6ad58516183ce8e460b0f7a187","modified":1670597165954},{"_id":"source/_posts/2020-end.md","hash":"c6d05199189c9c98aff132a58e9e47089eb0ff0d","modified":1636900215926},{"_id":"source/_posts/ArrangementAndCombination.md","hash":"046cdc4f1babccd0a64d748d14fb4783a77614ac","modified":1670575640992},{"_id":"source/_posts/CountDownLatch.md","hash":"7a2ca9bf4d5e797a86dfd833e81182e5b05e590c","modified":1671088302303},{"_id":"source/_posts/SpringBoot-refresh.md","hash":"76d6b81d049a81a7d0f4cd6f655c6c6a815fb162","modified":1670597128913},{"_id":"source/_posts/arraylist-grow.md","hash":"7c7fd774ba6df1d58cc75dac2a3f93ed9172840a","modified":1669290896284},{"_id":"source/_posts/decorating.md","hash":"06cdf2ac3a2ffa6519c14c44c3cc3ff9f2d46191","modified":1670578850910},{"_id":"source/_posts/bitwise.md","hash":"b1742e7e52544b4a2645f2d5de3da6889ca9c90f","modified":1669290830152},{"_id":"source/_posts/SpringBoot-startup.md","hash":"3c46268399d205dd6a25895daa9b7ae2ff777dcc","modified":1670596780437},{"_id":"source/_posts/bst.md","hash":"2adb5276503438bb8d3bd4f3c8f65372dc3d6b2e","modified":1670597514123},{"_id":"source/_posts/gateway.md","hash":"e96d11c9f5a9d6589a8e820b234a4705815f199e","modified":1669619047402},{"_id":"source/_posts/graph.md","hash":"cdc850aa5766f434b0b0be3314352743e2170cae","modified":1670143885465},{"_id":"source/_posts/java-collection-framework.md","hash":"f36f637b738efcfaca634b03e980ab8505e77926","modified":1670597387922},{"_id":"source/_posts/acm-standard-inputoutput.md","hash":"e061b423f15b74e10ff3f343c6015aeb05fbb97b","modified":1670597545640},{"_id":"source/_posts/hashmap.md","hash":"d2ba65a152db76c552c33fdbfa5818c5d8529f5a","modified":1670578958257},{"_id":"source/_posts/heap.md","hash":"9620bd87cf47b734d34aa23eaeb0f5f21e2b0eca","modified":1669290248041},{"_id":"source/_posts/jump-games.md","hash":"171d60f5a9f7031aac79ec05caf4fb49b741e561","modified":1670597378535},{"_id":"source/_posts/https.md","hash":"11df1f5838e85e060851ea62ed65b3a26a4a6a86","modified":1669290230857},{"_id":"source/_posts/jvm-GC.md","hash":"3a0154a3b7929fdba7d9890fd7678929255c4d29","modified":1670578545083},{"_id":"source/_posts/jvm-classloader.md","hash":"ae84797a9c1c8a339e56e7ee5cfa344bee833389","modified":1670597364283},{"_id":"source/_posts/jvm.md","hash":"6a55e7da61f921e5f604b0ae5e38417e31c5e4d1","modified":1669290158022},{"_id":"source/_posts/linux-command-line.md","hash":"cce120b463e4f44e692197be763d424a0d382f76","modified":1669290149026},{"_id":"source/_posts/lock.md","hash":"fd5917130529054601c6ff6d0e16d8bb9732c58e","modified":1670578611465},{"_id":"source/_posts/junit5.md","hash":"5f67c0e18e270ebc1082ea6202a00ad8ef644eb8","modified":1671535710234},{"_id":"source/_posts/leetcode-contest-55-247.md","hash":"b5042493ddfca2374f8053c53f237ef84540357e","modified":1670597331801},{"_id":"source/_posts/mybatis-autoconfiguration.md","hash":"17ef420ec0c627a0a866e9928426367d21228e13","modified":1670576114118},{"_id":"source/_posts/jvm-memory-manage.md","hash":"3e355d02ab50fcc18127164ce7be78d15b7085de","modified":1669290161913},{"_id":"source/_posts/mq.md","hash":"083b25de3ee15dd3316f92dd6ad666ffe73595a7","modified":1669290119048},{"_id":"source/_posts/mybatis-sql-resolution.md","hash":"1a54e2e65d2b4a6417d84e2d12dbba4d18545b90","modified":1669290091525},{"_id":"source/_posts/nginx.md","hash":"60336588c1f77cb8df81e9c4ccbe3b821d4462b3","modified":1669290082079},{"_id":"source/_posts/predict-the-winner.md","hash":"2d79925afc031aab5d6e7543d66a3c04befe7faf","modified":1670576154158},{"_id":"source/_posts/mybatis_preview.md","hash":"f6e6a8031d06675fc28e4a96f6a71424259df20b","modified":1669290112014},{"_id":"source/_posts/primeNumber.md","hash":"cac2bcdc1b8f2763e5d565a466ff0000b8392b12","modified":1671355946777},{"_id":"source/_posts/spring-transactional.md","hash":"4884b988d24e249250b030579bc3b565a8a0c251","modified":1670597151520},{"_id":"source/_posts/redis.md","hash":"574202ca9f04f70819e36714b0642196bc257cd4","modified":1669290029821},{"_id":"source/_posts/observer.md","hash":"c6ae69e8c4a1fa7d15566ec45388d506f90a961c","modified":1670576145236},{"_id":"source/_posts/search-suggestions-system.md","hash":"8dcafe00184a0dae665a4b1cdee6c576746c887a","modified":1670576411095},{"_id":"source/_posts/overlapping-interval.md","hash":"bbb735c0b81c658a3e47104f3f7f61d89db41a5b","modified":1673842314958},{"_id":"source/_posts/springboot-servlet.md","hash":"ba00522fa9e3620564fe2dc4c09536f3cbf7e71a","modified":1670597122412},{"_id":"source/_posts/springmvc-dispatch.md","hash":"fcbc14bda172d5d70905477f1b670fe80e2322ba","modified":1670596654243},{"_id":"source/_posts/springmvc-argument.md","hash":"baf38c46ccde116955b0028e834f6bb3a5f7132d","modified":1670596751349},{"_id":"source/_posts/springmvc-dispatcherservlet.md","hash":"42355a78950501fc231f3443aca1af4efc9032d2","modified":1670596404218},{"_id":"source/_posts/uml.md","hash":"e31c0039e3eedb981ac736f2780395ae8524fef2","modified":1669290985610},{"_id":"source/all-categories/index.md","hash":"5ba8c7b70cc60dc7bf0cefeb22b4d9b86d1aa2e0","modified":1636900215932},{"_id":"source/categories/index.md","hash":"5ed5ee833af50b986e1a543ace747994814a7cb0","modified":1636900215932},{"_id":"source/_posts/volatile.md","hash":"38c7e2c597c57d41ed61dc14136b3f62623dbe5d","modified":1670596326893},{"_id":"source/all-archives/index.md","hash":"fa34028baad36af6c9feb24ef61cc0f3b3c51746","modified":1636900215932},{"_id":"source/tags/index.md","hash":"9c3e184d51c00399c9ab869d6345d6231025afa5","modified":1636900215932},{"_id":"source/all-tags/index.md","hash":"9328f34da1aa2d20dadfdf895d6356720a484353","modified":1636900215932},{"_id":"source/_posts/subarray.md","hash":"cb8fb1cf2f5b8dd41ab90d617fe9058954439792","modified":1670596360853},{"_id":"source/top/index.md","hash":"9f7492a48015822ab20b5c3ca8356d15760667bb","modified":1636900215932},{"_id":"themes/keep/.gitignore","hash":"b49daa26b8121cc0c7074d61b377c8e7e0880d03","modified":1637383091149},{"_id":"themes/keep/README_zh-TW.md","hash":"106577079fbd01a52ddb7d65fe25bf4c7f9942cd","modified":1637383091149},{"_id":"themes/keep/README_zh-CN.md","hash":"77e024325df8ab87114408cc31c8624edb0f5022","modified":1637383091149},{"_id":"themes/keep/package.json","hash":"24c346a8637543d59c78479d3adf88c0a7b729c1","modified":1637383091153},{"_id":"themes/keep/.editorconfig","hash":"a1c91f0a086bf92fddb02ccf23578ec2b51c099c","modified":1637383091149},{"_id":"themes/keep/README.md","hash":"d98baf3223795c0c2faea57c471fc2af9336cef1","modified":1637383091149},{"_id":"themes/keep/languages/en.yml","hash":"e4f42cfda0ed6ea1715d28fd4b1bba6f89b8cdb0","modified":1637383091149},{"_id":"themes/keep/_config.yml","hash":"566f742cdefd2c08924a135dc0af9793a97079b3","modified":1652507434102},{"_id":"themes/keep/languages/zh-TW.yml","hash":"c6be2adec90f8c5d0a93a9f8d7bfb5fac0af4786","modified":1637383091149},{"_id":"themes/keep/LICENSE","hash":"98b8bd28e54ab36ee12396687dfdf88807c6cfdd","modified":1637383091149},{"_id":"themes/keep/layout/archive-content.ejs","hash":"cfa8f29b8863534f407136ea3deb18a4b2ff722c","modified":1637383091152},{"_id":"themes/keep/package-lock 2.json","hash":"f41e6a869f76a6bd80856ce4c83c15c8e3b2d465","modified":1637383848000},{"_id":"themes/keep/languages/zh-CN.yml","hash":"de8aec3e9960fa489c0a290cda825dfc1e7528dd","modified":1637383091149},{"_id":"themes/keep/layout/category-content.ejs","hash":"aef0c90a395f909be7d2c358eb41d5558a10406f","modified":1637383091152},{"_id":"themes/keep/layout/article-content.ejs","hash":"ae9fc0712b89af58e80b6c6daf749d01624c4a3c","modified":1637383091152},{"_id":"themes/keep/layout/archive.ejs","hash":"8456f112fc12bbb1c83cd190d0ce83ee474bd297","modified":1637383091152},{"_id":"themes/keep/package-lock.json","hash":"f41e6a869f76a6bd80856ce4c83c15c8e3b2d465","modified":1637385056978},{"_id":"themes/keep/layout/home-content.ejs","hash":"79e16c3baa6569afbc07ac6a5d2e3f37b273016a","modified":1637383091153},{"_id":"themes/keep/layout/index.ejs","hash":"f5fee4e079a9c2c23059ebde4cd89ec723e310c6","modified":1637383091153},{"_id":"themes/keep/layout/category-list.ejs","hash":"a9390b25238332417fd554d32563a4d9999db90f","modified":1637383091152},{"_id":"themes/keep/layout/category.ejs","hash":"8456f112fc12bbb1c83cd190d0ce83ee474bd297","modified":1637383091152},{"_id":"themes/keep/layout/tag.ejs","hash":"8456f112fc12bbb1c83cd190d0ce83ee474bd297","modified":1637383091153},{"_id":"themes/keep/layout/layout.ejs","hash":"da9dbeba541ad19fed35c41fe187f4016e41f0db","modified":1637383091153},{"_id":"themes/keep/layout/page.ejs","hash":"4bf34f19bcf18efb5f6e76fcbe7cd36b25ceee6a","modified":1637383091153},{"_id":"themes/keep/layout/tag-content.ejs","hash":"ce4c8192a4ccd6a626af412a7ba258d1edbc0b95","modified":1637383091153},{"_id":"themes/keep/scripts/use-source-data.js","hash":"21f6a49e47b7e4d792d67503079ea5b509f18311","modified":1637383091154},{"_id":"themes/keep/layout/_partial/article-copyright-info.ejs","hash":"77e13720374efb902ee3d4d04d13b62de033a3ae","modified":1637383091150},{"_id":"themes/keep/layout/tags.ejs","hash":"8456f112fc12bbb1c83cd190d0ce83ee474bd297","modified":1637383091153},{"_id":"themes/keep/layout/_partial/footer.ejs","hash":"9933e83e6e1022f4c27722f94a8b1540414b2570","modified":1637383091151},{"_id":"themes/keep/layout/_partial/archive-list.ejs","hash":"7c33e49286d54824cd8f3483e30de5579951edc6","modified":1637383091150},{"_id":"themes/keep/layout/_partial/first-screen.ejs","hash":"106683de71f01b368c6f0c5417952b54fcdc9611","modified":1637383091150},{"_id":"themes/keep/layout/_partial/article-meta-info.ejs","hash":"54f77621034e39809911a184f15006ce80e0f67b","modified":1637383091150},{"_id":"themes/keep/layout/_partial/header.ejs","hash":"627dfa9519ff614d6a79dac942a7b61fa5bfac8c","modified":1637383091151},{"_id":"themes/keep/layout/_partial/head.ejs","hash":"4c68f6750fc179368ca5556d80fb1781ba984ff8","modified":1637383091151},{"_id":"themes/keep/layout/_partial/home-article-meta-info.ejs","hash":"0aceb1c7c29b65bd5fc2d79a285a564da8c09b63","modified":1637383091151},{"_id":"themes/keep/layout/_partial/friends-link.ejs","hash":"fe35aa6dabeb31bc677270062eed569f37472c2c","modified":1637383091151},{"_id":"themes/keep/layout/_partial/page-template.ejs","hash":"8fd596f871326b03e707d7defcc96f639cdd628e","modified":1637383091151},{"_id":"themes/keep/layout/_partial/local-search.ejs","hash":"6fbcc0a14467da8362a2eaa490d84acb1336d21b","modified":1637383091151},{"_id":"themes/keep/layout/_partial/paginator.ejs","hash":"cfd4d9a30bd20ee0750b79226cb94562439013bf","modified":1637383091151},{"_id":"themes/keep/layout/_partial/post-tools.ejs","hash":"e8a303fa393a1716c5ff1f731923781eb12322ab","modified":1637383091151},{"_id":"themes/keep/layout/_partial/image-viewer.ejs","hash":"beb3dec5e08856a29d585fe0eb94a8a6ddade4dd","modified":1637383091151},{"_id":"themes/keep/layout/_partial/progress-bar.ejs","hash":"44af04816b86546e0260e73c2df61353e7404208","modified":1637383091152},{"_id":"themes/keep/layout/_partial/scripts.ejs","hash":"ad75de7966c4d9d923c9ac8cfbfe26b38fbe7aed","modified":1637383091152},{"_id":"themes/keep/layout/_partial/toc.ejs","hash":"aefc9db612c0fceb4a02fdbed9fa47a6c4e144b5","modified":1637383091152},{"_id":"themes/keep/layout/_partial/side-tools.ejs","hash":"e55d2034d7e2b8b0c1bd5ac7fdc56ffb8bbd4e60","modified":1637383091152},{"_id":"themes/keep/scripts/filters/lazyload-handle.js","hash":"7a8fd4996b9720c8d4cdb3042bfe5a1008f7c5fd","modified":1637383091153},{"_id":"themes/keep/scripts/helpers/export-config.js","hash":"e7c5417a1cd61f0b7c3f97030d4a77419c41b8a5","modified":1637383091153},{"_id":"themes/keep/scripts/filters/link-handle.js","hash":"b39cfa42d156b7ad4d4e8246b6f934cd51d8db55","modified":1637383091153},{"_id":"themes/keep/scripts/helpers/helper.js","hash":"9d657770648def555884eebbcecbf333e405ff8b","modified":1637383091154},{"_id":"themes/keep/layout/_partial/tagcloud.ejs","hash":"5968618b53a029922f2255b0c76bf8a9f11712ff","modified":1637383091152},{"_id":"themes/keep/source/images/avatar.svg","hash":"aba8367cd7550e75279f707671d7146813c2a776","modified":1637383091157},{"_id":"themes/keep/source/images/avatar.png","hash":"fae7a4bc08bad88136de5f66c9abe97954741234","modified":1652506499930},{"_id":"themes/keep/source/css/font-awesome.min.css","hash":"c508528feb9fd540454f838653cd4863b290df2e","modified":1637383091155},{"_id":"themes/keep/source/images/logo.svg","hash":"b618728f9964a5698b1dc2548db35b3d06dd115f","modified":1637383091157},{"_id":"themes/keep/source/css/style.styl","hash":"e0c2fd781ee3de12716d6a54dd0f9f5ffe443334","modified":1637383091157},{"_id":"themes/keep/source/images/bg.svg","hash":"f3106cd334dc2ceef885c19012bf59a48498af42","modified":1637383091157},{"_id":"themes/keep/source/images/loading.svg","hash":"eedfa204e08a60ca5c80c620cfe9a3eaa6201585","modified":1637383091157},{"_id":"themes/keep/source/js/dark-light-toggle.js","hash":"223e6f1d4e6e70956e4661b58c430e1c68def125","modified":1637383091158},{"_id":"themes/keep/source/js/code-copy.js","hash":"3fdabac26f6406a4592336f1f444ec966201b5d9","modified":1637383091158},{"_id":"themes/keep/source/images/upyun.png","hash":"f014175dd78c3ed5249e69c91603e20a3efcd330","modified":1637383091158},{"_id":"themes/keep/source/js/back2top.js","hash":"fc8e85f6704e39ae3a613bbec5dd51d449be8010","modified":1637383091158},{"_id":"themes/keep/source/js/header-shrink.js","hash":"167b9b6a9ed63c6cf4081cb3c201dd16bbbfb9ad","modified":1637383091158},{"_id":"themes/keep/source/js/left-side-toggle.js","hash":"618f7cfc45db4d82b2f1d00d8e9ee936bcf9043b","modified":1637383091158},{"_id":"themes/keep/source/js/lazyload.js","hash":"95aad532f17d7a8119979fc61ade9e626308a2af","modified":1637383091158},{"_id":"themes/keep/source/js/main.js","hash":"ca8ed228cc0bc234be74428d029cfd047eec0ed6","modified":1637383091159},{"_id":"themes/keep/source/js/local-search.js","hash":"9509ec6d2d7d4466fe37ad624cf606f6639fb3fe","modified":1637383091159},{"_id":"themes/keep/source/js/utils.js","hash":"f6202d352b1f3afc0a93c8ff8f85b78526a1c31d","modified":1637383091159},{"_id":"themes/keep/source/js/toc.js","hash":"ae69bf65d2b30d299b6ca9e2361d3b6e0db3a077","modified":1637383091159},{"_id":"themes/keep/source/webfonts/fa-regular-400.eot","hash":"2baa9a8aa68f1d2d4712b3c7205f9105aaf21879","modified":1637383091165},{"_id":"themes/keep/source/webfonts/fa-regular-400.woff2","hash":"fb9648469530a05fa9aac80e47d4d6960472a242","modified":1637383091166},{"_id":"themes/keep/source/webfonts/fa-regular-400.ttf","hash":"d64e58981a419de52bac110c979887d34e366135","modified":1637383091166},{"_id":"themes/keep/source/webfonts/fa-regular-400.woff","hash":"26afc29d39ab9fac6d0b607be7e76db093ff7c3a","modified":1637383091166},{"_id":"themes/keep/layout/_partial/comment/gitalk.ejs","hash":"28a0c8b1da66a9b6863e5444aa0b50c8f6b862f0","modified":1637383091150},{"_id":"themes/keep/layout/_partial/comment/comment.ejs","hash":"4a7294bbe9aa4be22878e8a638668ed7ade25e2c","modified":1637383091150},{"_id":"themes/keep/layout/_partial/pjax/pjax.ejs","hash":"949d3fdd4bd215cd7d0c95152c4be630ce227e16","modified":1637383091151},{"_id":"themes/keep/source/css/common/animated.styl","hash":"ceb35da27937a5824dea00c0a75de57e10e1dc90","modified":1637383091154},{"_id":"themes/keep/layout/_partial/comment/twikoo.ejs","hash":"92d858874543c4ba149acd04374d84e784ba0aaf","modified":1637383091150},{"_id":"themes/keep/source/css/common/basic.styl","hash":"6d6132527247635f7406d6917cfc8e1cb02d8573","modified":1637383091154},{"_id":"themes/keep/source/css/common/markdown.styl","hash":"55c6c0f77b608b8e1d9c52bb4fdcee881f55eff8","modified":1637383091154},{"_id":"themes/keep/source/css/common/keep-theme.styl","hash":"9b6bf080299102571a6667ca99a62f53c9684246","modified":1637383091154},{"_id":"themes/keep/source/css/common/variables.styl","hash":"8b66a8ae90dbb8ec2e412fcf57ff6c8cee18e949","modified":1637383091154},{"_id":"themes/keep/layout/_partial/comment/valine.ejs","hash":"467cafd412837af791b4c353646cf44ac4458a3f","modified":1637383091150},{"_id":"themes/keep/source/css/layout/article-content.styl","hash":"327bb874968feaa981093c3f218b48aa34cd1d44","modified":1637383091157},{"_id":"themes/keep/source/css/layout/archive-content.styl","hash":"515ebe2a251f3b53f0cf130cdc48b8bb1fb85952","modified":1637383091157},{"_id":"themes/keep/source/css/layout/home-content.styl","hash":"2f2ee2f70020cf5e2ffb5612607bd58772e785a4","modified":1637383091157},{"_id":"themes/keep/source/css/layout/page.styl","hash":"ea83a6a5503b63d91d71221699776c4fe2c7a941","modified":1637383091157},{"_id":"themes/keep/source/css/layout/tag-content.styl","hash":"0d1cc0cc0d263f55b9c7245c1dc023abdcfcd69f","modified":1637383091157},{"_id":"themes/keep/source/css/layout/category-content.styl","hash":"638c3b50d8203c76106f3010fbfeed9a29bfde5c","modified":1637383091157},{"_id":"themes/keep/source/js/libs/pjax.min.js","hash":"57ec40cb4898d7ba74a03603d608af378e5431f8","modified":1637383091159},{"_id":"themes/keep/source/css/common/codeblock/code-theme.styl","hash":"fd81f8a76ae4f55bf5da38116bbc4f0e973daad2","modified":1637383091154},{"_id":"themes/keep/source/js/libs/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1637383091158},{"_id":"themes/keep/source/css/layout/category-list.styl","hash":"bea0a03fe3de16ed08e7b3b541a46d2074561841","modified":1637383091157},{"_id":"themes/keep/source/css/common/codeblock/copy-code.styl","hash":"1edcb0ece1bf4b9838c1937e98eaa845de7f4b3b","modified":1637383091154},{"_id":"themes/keep/source/css/layout/_partial/archive-list.styl","hash":"95c41684691a849d102c5a30efb365300d3d5c6d","modified":1637383091155},{"_id":"themes/keep/source/css/common/codeblock/highlight.styl","hash":"64ea39fa5503f6c5a21a9ed7c9d3d5103cccad5a","modified":1637383091154},{"_id":"themes/keep/source/css/layout/_partial/article-meta-info.styl","hash":"91bf4f2f58217c0d0c6d51ad4792e5e0a00c3165","modified":1637383091155},{"_id":"themes/keep/source/css/layout/_partial/footer.styl","hash":"19a8fc0a01bf1efed637e90530c412d57137dfc4","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/first-screen.styl","hash":"d73c088e639d2d4e076552ff92e611682ce2380b","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/header.styl","hash":"80cd9c8abd3542c0e521841137e987a658471e05","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/article-copyright-info.styl","hash":"6eaa067231bd9e9faa5de2260b8974142faae510","modified":1637383091155},{"_id":"themes/keep/source/css/layout/_partial/local-search.styl","hash":"98aa2e22f16b98b2ffdbf36e1ea24363f8e5045b","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/image-viewer.styl","hash":"59525fcc1f88c78abf8c1f0b06e24b16a088698c","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/page-template.styl","hash":"27d1e19691867a09283facd2983afb9a3404e999","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/progress-bar.styl","hash":"a64df5515c60a3a0993c427dc50facee33215f2b","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/post-tools.styl","hash":"f78a13e3b03b19cb72b03db0a5659f8c734e742e","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/side-tools.styl","hash":"a68a1e3f21da63ee2d387035e91f9f60e956e234","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/tagcloud.styl","hash":"61016e73c8e420c74800b3afdbd6c2f890400e51","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/toc.styl","hash":"029ac31a21203a8b86027e67a3ff3a977579325d","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/comment/comment.styl","hash":"f6d9a37520566e38738fc1184ed76817273c3ee5","modified":1637383091155},{"_id":"themes/keep/source/css/layout/_partial/paginator.styl","hash":"da5df38b09138af28cb8b3fe9a05aeda9dae5011","modified":1637383091156},{"_id":"themes/keep/source/css/layout/_partial/comment/gitalk.styl","hash":"b8fccd13e2753c9fe891fb88a6413087048ab830","modified":1637383091155},{"_id":"themes/keep/source/css/layout/_partial/comment/valine.styl","hash":"6b0c7d69fc3f819610576b41e987ec655411ca44","modified":1637383091155},{"_id":"themes/keep/source/css/layout/_partial/comment/twikoo.styl","hash":"5844874c50a93239031e58b23856698ca9af2725","modified":1637383091155},{"_id":"themes/keep/source/webfonts/fa-brands-400.woff","hash":"a42ac4a94f4e0e9333cdb1b2fb6c13c0ae690ff2","modified":1637383091164},{"_id":"themes/keep/source/webfonts/fa-brands-400.woff2","hash":"f726c4275bb494a045fde059175f072de06c01df","modified":1637383091164},{"_id":"themes/keep/source/webfonts/fa-solid-900.woff","hash":"3b86a0ce15d8d534b65e98560e321a933d310688","modified":1637383091171},{"_id":"themes/keep/source/webfonts/fa-solid-900.woff2","hash":"9b592048b9062b00f0b2dd782d70a95b7dc69b83","modified":1637383091171},{"_id":"themes/keep/source/webfonts/fa-brands-400.eot","hash":"c719f4375679ee58e156434f9ba9727be669cf07","modified":1637383091160},{"_id":"themes/keep/source/webfonts/fa-brands-400.ttf","hash":"9b49c6c5b0cbdef158ae31b2a4e4814555408389","modified":1637383091164},{"_id":"themes/keep/source/webfonts/fa-regular-400.svg","hash":"c41a688158d577e3a2738137992d49b05b17ab8f","modified":1637383091165},{"_id":"themes/keep/source/webfonts/fa-solid-900.eot","hash":"c39b89f7fa7b66931ab02a54002db5ffcbff206c","modified":1637383091167},{"_id":"themes/keep/source/webfonts/fa-solid-900.ttf","hash":"d537bf4cc7273ddb3fd754d53f2b241aeafaefe7","modified":1637383091171},{"_id":"themes/keep/source/webfonts/fa-brands-400.svg","hash":"69a0ff79a9d93a451e9fa90bd79ae7008d2a9da5","modified":1637383091163},{"_id":"themes/keep/source/webfonts/fa-solid-900.svg","hash":"36de6a298660ed3feaab37900f7b28c3e981d80e","modified":1637383091170},{"_id":"public/about/index.html","hash":"afc72b1915bc004550c80819df1f4506519527d3","modified":1678522512694},{"_id":"public/all-archives/index.html","hash":"940df5aba100915671b65d9d587faaf5feaed34a","modified":1678522512694},{"_id":"public/all-categories/index.html","hash":"0f3b7c551f213bb659bd95238586338515dd3a19","modified":1678522512694},{"_id":"public/all-tags/index.html","hash":"ffca0ac52175121f39eb98105fdd344d0c556854","modified":1678522512694},{"_id":"public/categories/index.html","hash":"faf37b7ae5b4fc61394631673a78bbca01f6e6c1","modified":1678522512694},{"_id":"public/top/index.html","hash":"82e94ee51c21c1d79edf5b3e2552a8344b187b6f","modified":1678522512694},{"_id":"public/tags/index.html","hash":"e977eb580b5c935b516f202921e44f076b072131","modified":1678522512694},{"_id":"public/2023/01/16/overlapping-interval/index.html","hash":"1dd60ce1f75668d9491ae7af083d9c9ba4c40b57","modified":1678522512694},{"_id":"public/2022/12/31/2022-end/index.html","hash":"205e48938821ed958f5bec6a7b30673a775bff93","modified":1678522512694},{"_id":"public/2022/12/04/graph/index.html","hash":"6600f4dff89847c5873930c44dbbfc661e23cd04","modified":1678522512694},{"_id":"public/2022/11/24/jvm-GC/index.html","hash":"39276a8e06ae03c0d0f41844de0c5077bd7a95b3","modified":1678522512694},{"_id":"public/2022/09/01/Apollo-01/index.html","hash":"573622108c0863e1c113ccd78920bda3a2234c81","modified":1678522512694},{"_id":"public/2022/05/14/2022-mid-summary/index.html","hash":"3327fdca340274eae67d6949d542db646b9a0299","modified":1678522512694},{"_id":"public/2021/06/06/2021-mid/index.html","hash":"c2575140dfe7a935fef6ba4f0f97344fb6d7be76","modified":1678522512694},{"_id":"public/2021/05/31/search-suggestions-system/index.html","hash":"fc36f1aafc6b65a7d0f8d74d6fd0faf19088ed3d","modified":1678522512694},{"_id":"public/2021/04/20/linux-command-line/index.html","hash":"fcdcc41a39b113a8333dec7d9a022302889efd02","modified":1678522512694},{"_id":"public/2021/03/23/jvm-classloader/index.html","hash":"81a85072820945d6e7330515267a472afcc7d1b2","modified":1678522512694},{"_id":"public/2020/08/05/mybatis_preview/index.html","hash":"8fdd1fc415a60653428c0f67b1dfb5ad4c52fa62","modified":1678522512694},{"_id":"public/2020/03/14/https/index.html","hash":"905d7091060706bb9cce586b3e91a9f1bf7e5e88","modified":1678522512694},{"_id":"public/2020/01/12/uml/index.html","hash":"3465f644fda7e4e753ab01f2ee64421e6b7de19a","modified":1678522512694},{"_id":"public/categories/essay/index.html","hash":"ccadaf635ecbccdbf28cacfc0627da8bd53a05b3","modified":1678522512694},{"_id":"public/categories/springcloud/index.html","hash":"59cde9bfa1bedd67a237b2c4aa76f538ab5d173a","modified":1678522512694},{"_id":"public/categories/leetcode/index.html","hash":"d0b9fceba84f0def2e3456d7292060f23f9ee888","modified":1678522512694},{"_id":"public/categories/java/index.html","hash":"d29d07653f7bf556adc81288cbeab2e348f9a59b","modified":1678522512694},{"_id":"public/categories/springsecurity/index.html","hash":"03d98106fa95491a20f4898316ba10669a60b8cb","modified":1678522512694},{"_id":"public/categories/springboot/index.html","hash":"28aaa338b7b2663eab05ff43a8240bed3e738106","modified":1678522512694},{"_id":"public/categories/designpatterns/index.html","hash":"a7676a191be7168ff32e42febdb4c8e0e1e93e12","modified":1678522512694},{"_id":"public/categories/network/index.html","hash":"d0093317de858900cbe033d46e170aba4d2c1499","modified":1678522512694},{"_id":"public/categories/jvm/index.html","hash":"0a1543c58b8ebec5ec17dbbd1b173196dc523db5","modified":1678522512694},{"_id":"public/categories/datastructure/index.html","hash":"89e38e72a6a622b6e1ae8cfbe775a430b887dd6c","modified":1678522512694},{"_id":"public/categories/unit-test/index.html","hash":"3d18cc3d4b54dc6ea256c6f05615582db06b7c86","modified":1678522512694},{"_id":"public/categories/linux/index.html","hash":"97b4f1c8b653c281805726171238c171170f0d18","modified":1678522512694},{"_id":"public/categories/springbot/index.html","hash":"ab14da19e9d0edbf1b2915dd1d4d70462f0b1b7b","modified":1678522512694},{"_id":"public/categories/mybatis/index.html","hash":"7edf62e37f44756cd36bc0098a7143e5163d0873","modified":1678522512694},{"_id":"public/categories/middleware/index.html","hash":"f87ba70952b882b1005829324f4d3845e44d6af7","modified":1678522512694},{"_id":"public/categories/springmvc/index.html","hash":"5a8e35f9a003878c8dadac803de4363da5cb1452","modified":1678522512694},{"_id":"public/categories/Utils/index.html","hash":"02fef56f70c91c1955f2fa05b11b322f7caa7723","modified":1678522512694},{"_id":"public/tags/summary/index.html","hash":"b67e17a7560e66be28782d5a3b034547f27ac2d2","modified":1678522512694},{"_id":"public/tags/service-discovery/index.html","hash":"5fae8d51abf50af6afea3b2a7d37db0b917eaf29","modified":1678522512694},{"_id":"public/tags/combination/index.html","hash":"d33d906ec36bc253fda5d778575944cdcb5ab5c4","modified":1678522512694},{"_id":"public/tags/lock/index.html","hash":"55114aff03afbe5b26ba04cf63d83c351da53155","modified":1678522512694},{"_id":"public/tags/autoconfiguration/index.html","hash":"0f4037ce76b2ce768f2de10ccacf21f28e05e5aa","modified":1678522512694},{"_id":"public/tags/environment/index.html","hash":"9359f38ab88c8b4c4e4f52d2ce6424cc344d339e","modified":1678522512694},{"_id":"public/tags/startup/index.html","hash":"b335c79ac76f62561f6bb1bb74eb61f20840a4d3","modified":1678522512694},{"_id":"public/tags/refresh/index.html","hash":"f6e4fba19d2fe69f04cf9ce9cedc2ca060ca78b6","modified":1678522512694},{"_id":"public/tags/standard/index.html","hash":"742dfc67c839c13ccfb0d860bfe39f39868d11b7","modified":1678522512694},{"_id":"public/tags/arraylist/index.html","hash":"6eea2866d59afa3f7b541b0264b40ce159e41615","modified":1678522512694},{"_id":"public/tags/bitwise/index.html","hash":"f18f2fcff5da80bcfe4362d1a0db80a63267be50","modified":1678522512694},{"_id":"public/tags/binary-search-tree/index.html","hash":"17d0a7abf8444b3b427509b117951eba943c87f6","modified":1678522512694},{"_id":"public/tags/gateway/index.html","hash":"289b85635e7f0a589abbc0c3ea3b9d8a36f8f905","modified":1678522512694},{"_id":"public/tags/decorating/index.html","hash":"abaf0a8a7743670a5cad193ce189441b2ef319b6","modified":1678522512694},{"_id":"public/tags/hashmap/index.html","hash":"42af6b785348947a0b93d779b9ee402e3ec0e87b","modified":1678522512694},{"_id":"public/tags/heap/index.html","hash":"19e8ed461406b0ef39b70be6d44336a555699139","modified":1678522512694},{"_id":"public/tags/http/index.html","hash":"088b2fc47598087982b0269cff251bec7bd22d03","modified":1678522512694},{"_id":"public/tags/https/index.html","hash":"06e3fdde6db6afb286f8082cf62b9490fc763847","modified":1678522512694},{"_id":"public/tags/framework/index.html","hash":"b89044795c94efc35b999bbeebe659f3f3812811","modified":1678522512694},{"_id":"public/tags/greedy/index.html","hash":"404f65d3c4dc949d59741a46f6bd3da0ec421b10","modified":1678522512694},{"_id":"public/tags/dp/index.html","hash":"c9f40dda837a850ca35ac8884cbeea1cb74c9c9f","modified":1678522512694},{"_id":"public/tags/stratey/index.html","hash":"edbe676f27c60eb8bc15ac0aa576ce2835a4a66e","modified":1678522512694},{"_id":"public/tags/GC/index.html","hash":"ade5a4c9e9e5a1d55dd8e2cb3d41594c1b52b582","modified":1678522512694},{"_id":"public/tags/classloader/index.html","hash":"165344ae394c8c1a329c58d1db1c41decb9912f2","modified":1678522512694},{"_id":"public/tags/junit5/index.html","hash":"368644e6197058f575267aa79b25f5de2c9f719c","modified":1678522512694},{"_id":"public/tags/memory/index.html","hash":"ed930edb274407c5964b767726b74420c412fbab","modified":1678522512694},{"_id":"public/tags/utils/index.html","hash":"86ef2fa7c4a6eae6f438bf3888c7de8f2a4eee34","modified":1678522512694},{"_id":"public/tags/mybatis/index.html","hash":"cc1d22806e41a07989da7f7cd8955ccad512ec42","modified":1678522512694},{"_id":"public/tags/activemq/index.html","hash":"96ed7f786988e9c126b152cfa2bc8e51d67aa04b","modified":1678522512694},{"_id":"public/tags/network/index.html","hash":"d1496a08606a1c12959036998e8e6c668eba66fd","modified":1678522512694},{"_id":"public/tags/observer/index.html","hash":"c10cc808c10d48398e9b3047bf9be94cd6d23221","modified":1678522512694},{"_id":"public/tags/redis/index.html","hash":"2cba93bf373f6bc5d95b86e2b12cc90d370e53e5","modified":1678522512694},{"_id":"public/tags/nosql/index.html","hash":"f5fc3ad48c13ae7c064296f8d7d625653ac5fbf4","modified":1678522512694},{"_id":"public/tags/prime/index.html","hash":"3dfe9b2a85da446a577bd92f1b4c402884a60739","modified":1678522512694},{"_id":"public/tags/treeMap/index.html","hash":"254649f422d32b6d771bd92773a96c5c375adea3","modified":1678522512694},{"_id":"public/tags/servlet/index.html","hash":"c00833640e57acd40e3524175ad86076013d614a","modified":1678522512694},{"_id":"public/tags/transaction/index.html","hash":"cbf3af4523a021806b98134c425ee85513c63ce0","modified":1678522512694},{"_id":"public/tags/argument/index.html","hash":"c144158a36c7f77c2350f13fac473af06ac48be5","modified":1678522512694},{"_id":"public/tags/dispatch/index.html","hash":"8a77052c2cec822abe9857472943a402329e09ae","modified":1678522512694},{"_id":"public/tags/double-pointers/index.html","hash":"73c10754321acf3f5d8dc79d56f09404e2d9c12c","modified":1678522512694},{"_id":"public/tags/preSum/index.html","hash":"1a1e05d930c5b05a3b336667c8c10383d150e04b","modified":1678522512694},{"_id":"public/tags/dispatcherservlet/index.html","hash":"9c0dca8ea629bf53f34f9dcab40f8b699188e177","modified":1678522512694},{"_id":"public/2022/12/20/junit5/index.html","hash":"016c2e95cc2295da19336eee4d1503966ac6f808","modified":1678522512694},{"_id":"public/2022/12/18/primeNumber/index.html","hash":"f9a926f7d68408363d3fc3efd24e882412fe5612","modified":1678522512694},{"_id":"public/2022/12/15/CountDownLatch/index.html","hash":"ccbdeb0f019aec238ede6ec399db6b2444e9bd87","modified":1678522512694},{"_id":"public/2022/11/25/gateway/index.html","hash":"1be83960919abd4e77425d4974785123f3946aaa","modified":1678522512694},{"_id":"public/2022/09/30/ArrangementAndCombination/index.html","hash":"7ef3dcf35452149dc9c090c40d182e0f09b41ef1","modified":1678522512694},{"_id":"public/2022/09/01/spring-transactional/index.html","hash":"49ab8b86c705308e0fff4c20fe8341fe4e67581e","modified":1678522512694},{"_id":"public/2021/06/27/leetcode-contest-55-247/index.html","hash":"6126dddebf3007804859ff0bf3fa78fc39fd15e4","modified":1678522512694},{"_id":"public/2021/05/24/jump-games/index.html","hash":"e60e31ea4590ba0d41263f9d39cbbcb7d5c8dd4b","modified":1678522512694},{"_id":"public/2021/05/14/predict-the-winner/index.html","hash":"13598e7f496fcc3a0b9e50116ee6c83b94490a50","modified":1678522512694},{"_id":"public/2021/05/12/arraylist-grow/index.html","hash":"f02b6b46069f60675d1eaf6277b0e89270cf07ad","modified":1678522512694},{"_id":"public/2021/04/19/acm-standard-inputoutput/index.html","hash":"201e778517cf3ea891a251421593e22aeda26651","modified":1678522512694},{"_id":"public/2021/04/07/springmvc-argument/index.html","hash":"c511d5442054a0cded61aee155368157c2e0c7ef","modified":1678522512694},{"_id":"public/2021/04/06/springmvc-dispatch/index.html","hash":"ea2aa2fa174061e392affeee74a674eab8b44b97","modified":1678522512694},{"_id":"public/2021/04/06/springmvc-dispatcherservlet/index.html","hash":"43a2fddfcb5ae490c033c0c3066be39f8e258389","modified":1678522512694},{"_id":"public/2021/03/23/jvm-memory-manage/index.html","hash":"f6ac1d7cdfabee787b2ae59ab28730dd6ba94d43","modified":1678522512694},{"_id":"public/2021/03/22/Spring-Security-AutoConfiguration/index.html","hash":"5db781e73fec4e3819354fb20d62ac4006ad29e0","modified":1678522512694},{"_id":"public/2021/03/09/mybatis-autoconfiguration/index.html","hash":"8faf235ecb99bb510c39c62dcd78b9af8ddb92dd","modified":1678522512694},{"_id":"public/2021/03/06/java-collection-framework/index.html","hash":"5f31074c76b23f39c9679a5b58acccae83652505","modified":1678522512694},{"_id":"public/2021/03/07/mybatis-sql-resolution/index.html","hash":"7c7c4523f4d0c6747065e85ab4ea7cce53b38778","modified":1678522512694},{"_id":"public/2021/02/28/springboot-servlet/index.html","hash":"0833a775bf761f86e04b24e3b7d9109826d34c36","modified":1678522512694},{"_id":"public/2021/02/27/bst/index.html","hash":"17c5f92c77a05ee3ffa5c78227406a0a02388c2a","modified":1678522512694},{"_id":"public/2021/02/15/SpringBoot-refresh/index.html","hash":"db59738bb4cc3826b2021c890668fbba9f2f7fda","modified":1678522512694},{"_id":"public/2021/02/27/subarray/index.html","hash":"5abe708ef2ac76a6120878825d296e005bbfabb2","modified":1678522512694},{"_id":"public/2021/02/15/SpringBoot-environment/index.html","hash":"b545675cf205206718f04c60457d42fcab160cf0","modified":1678522512694},{"_id":"public/2021/02/15/SpringBoot-startup/index.html","hash":"330e055e7c06076128111d1571b576ec80dddeb0","modified":1678522512694},{"_id":"public/2021/01/03/2020-end/index.html","hash":"9cefc9f6eb521718032c55ec167f0026247010f7","modified":1678522512694},{"_id":"public/2020/08/20/hashmap/index.html","hash":"4a51f4c075bc7348d8f45a4cfda14083822f16ea","modified":1678522512694},{"_id":"public/2020/07/20/lock/index.html","hash":"7bcd2a4985303d5a489e39e20a90c5bf859e9079","modified":1678522512694},{"_id":"public/2020/07/20/mq/index.html","hash":"a296afdd285580919ceba51213c3efffdadaff5c","modified":1678522512694},{"_id":"public/2020/07/20/volatile/index.html","hash":"743f5cb0b264f6cf8354256981abbf563eb742f3","modified":1678522512694},{"_id":"public/2020/06/12/observer/index.html","hash":"420f226361e20583e8bdc2587691b3bd49e3fc64","modified":1678522512694},{"_id":"public/2020/06/12/decorating/index.html","hash":"34e311aed5419d4b0f4460a1542fb85f278cd053","modified":1678522512694},{"_id":"public/2020/06/09/redis/index.html","hash":"3429d9d1fa6066fff3257536d14ae6fd4c1b86b4","modified":1678522512694},{"_id":"public/2020/06/06/heap/index.html","hash":"a713c8b3c0646b0f06abcddbd9aa8b6c818c5bf7","modified":1678522512694},{"_id":"public/2020/06/01/bitwise/index.html","hash":"daee74a598760a2f8a02b52b619c25e95e09c227","modified":1678522512694},{"_id":"public/2020/05/24/jvm/index.html","hash":"90080b6519472e6af093e0d80e5d84638b34db55","modified":1678522512694},{"_id":"public/2019/11/02/nginx/index.html","hash":"8e53d7c1fad207569abf9333f3adec781ff2dc11","modified":1678522512694},{"_id":"public/archives/index.html","hash":"630f183e465d7e054ffd07ae2b22c539deb33db8","modified":1678522512694},{"_id":"public/archives/page/3/index.html","hash":"630f183e465d7e054ffd07ae2b22c539deb33db8","modified":1678522512694},{"_id":"public/archives/page/2/index.html","hash":"630f183e465d7e054ffd07ae2b22c539deb33db8","modified":1678522512694},{"_id":"public/archives/page/4/index.html","hash":"630f183e465d7e054ffd07ae2b22c539deb33db8","modified":1678522512694},{"_id":"public/archives/page/5/index.html","hash":"630f183e465d7e054ffd07ae2b22c539deb33db8","modified":1678522512694},{"_id":"public/archives/2019/index.html","hash":"0c0032934735e46256a566cc418d9d0f790e23fe","modified":1678522512694},{"_id":"public/archives/2019/11/index.html","hash":"ddb9c453b76ddfe8b006fe02d5915bfc94e4106e","modified":1678522512694},{"_id":"public/archives/2020/index.html","hash":"5311ac7d610a065698ee6ee2ee860167741ff19c","modified":1678522512694},{"_id":"public/archives/2020/page/2/index.html","hash":"5311ac7d610a065698ee6ee2ee860167741ff19c","modified":1678522512694},{"_id":"public/archives/2020/01/index.html","hash":"c36576ce1daa98a18568deeafb00f540debb6736","modified":1678522512694},{"_id":"public/archives/2020/03/index.html","hash":"ca9885c2e868e083cd7a66e785948ed95096807b","modified":1678522512694},{"_id":"public/archives/2020/05/index.html","hash":"4a9133b7f7e4b85056f5fd9a09b144a1646385fa","modified":1678522512694},{"_id":"public/archives/2020/07/index.html","hash":"c7a00883b4e580ade6272e790e360d3a377cabfa","modified":1678522512694},{"_id":"public/archives/2020/06/index.html","hash":"dbf0024884bf35a1d02524bb10dbf43e71df698e","modified":1678522512694},{"_id":"public/archives/2021/index.html","hash":"ab98ed5f094768e8d171b8d152f82e5c6196bebd","modified":1678522512694},{"_id":"public/archives/2020/08/index.html","hash":"6b5b07b7a7ea1052f18825bd2fb3c29617fc85c8","modified":1678522512694},{"_id":"public/archives/2021/page/2/index.html","hash":"ab98ed5f094768e8d171b8d152f82e5c6196bebd","modified":1678522512694},{"_id":"public/archives/2021/page/3/index.html","hash":"ab98ed5f094768e8d171b8d152f82e5c6196bebd","modified":1678522512694},{"_id":"public/archives/2021/01/index.html","hash":"f398040dfa0c643c734d37d563c5e1b06431f168","modified":1678522512694},{"_id":"public/archives/2021/02/index.html","hash":"1165da3772f982726ece78e9261c3d0c92618324","modified":1678522512694},{"_id":"public/archives/2021/03/index.html","hash":"6e0a6886010cfc6a772eaf8c5622de8c36e07edc","modified":1678522512694},{"_id":"public/archives/2021/04/index.html","hash":"7cf6256de8d8a28628b6a08f845d239312fa433c","modified":1678522512694},{"_id":"public/archives/2021/05/index.html","hash":"70106db3720999f3a08e344249965727e099250f","modified":1678522512694},{"_id":"public/archives/2022/index.html","hash":"b4c2272bb110effe332dd20e938555c6fc9c57a1","modified":1678522512694},{"_id":"public/archives/2022/page/2/index.html","hash":"b4c2272bb110effe332dd20e938555c6fc9c57a1","modified":1678522512694},{"_id":"public/archives/2022/05/index.html","hash":"df800673b2b0f169d90c29df63fb23ecf7bbefed","modified":1678522512694},{"_id":"public/archives/2022/09/index.html","hash":"ff0eaf6d2540b17a664c4c061eaf7017b27962e1","modified":1678522512694},{"_id":"public/archives/2022/11/index.html","hash":"2d939c1ae1346e1189bdf6e3a5fa9fd6ccaecad1","modified":1678522512694},{"_id":"public/archives/2022/12/index.html","hash":"9143402232d9004284ec5f9c8156889e1cad9e40","modified":1678522512694},{"_id":"public/archives/2023/index.html","hash":"95a906b3e37bf41128214172f8069958564703f4","modified":1678522512694},{"_id":"public/archives/2023/01/index.html","hash":"11cf324040cec750b8b68b4f368a1651c99b6379","modified":1678522512694},{"_id":"public/archives/2021/06/index.html","hash":"1bd6216e747f244d4a2969de9a57522704e2a194","modified":1678522512694},{"_id":"public/index.html","hash":"904c9fc65d7a7c20ddaa589aa5488a1c3380b220","modified":1678522512694},{"_id":"public/page/2/index.html","hash":"61b57f9f4e8e464b911cf13eabf5c91bc08a4ae7","modified":1678522512694},{"_id":"public/page/3/index.html","hash":"1c2ccde6f9341842086437489d3125c20e6c1049","modified":1678522512694},{"_id":"public/page/4/index.html","hash":"9e8c5e68031dbc34afb0d22f85d4aa9c6de9f9fb","modified":1678522512694},{"_id":"public/page/5/index.html","hash":"d8eadcec3c7042ec5903327ae4cb987ad13b4a9e","modified":1678522512694},{"_id":"public/tags/volatile/index.html","hash":"1ab3c591c5f0ff0c8bbea62e3bcdd6c1d9b183cf","modified":1678522512694},{"_id":"public/images/avatar.svg","hash":"aba8367cd7550e75279f707671d7146813c2a776","modified":1678522512694},{"_id":"public/images/avatar.png","hash":"fae7a4bc08bad88136de5f66c9abe97954741234","modified":1678522512694},{"_id":"public/images/bg.svg","hash":"f3106cd334dc2ceef885c19012bf59a48498af42","modified":1678522512694},{"_id":"public/images/logo.svg","hash":"b618728f9964a5698b1dc2548db35b3d06dd115f","modified":1678522512694},{"_id":"public/images/upyun.png","hash":"f014175dd78c3ed5249e69c91603e20a3efcd330","modified":1678522512694},{"_id":"public/images/loading.svg","hash":"eedfa204e08a60ca5c80c620cfe9a3eaa6201585","modified":1678522512694},{"_id":"public/webfonts/fa-regular-400.eot","hash":"2baa9a8aa68f1d2d4712b3c7205f9105aaf21879","modified":1678522512694},{"_id":"public/webfonts/fa-regular-400.woff","hash":"26afc29d39ab9fac6d0b607be7e76db093ff7c3a","modified":1678522512694},{"_id":"public/webfonts/fa-regular-400.ttf","hash":"d64e58981a419de52bac110c979887d34e366135","modified":1678522512694},{"_id":"public/webfonts/fa-regular-400.woff2","hash":"fb9648469530a05fa9aac80e47d4d6960472a242","modified":1678522512694},{"_id":"public/js/back2top.js","hash":"fc8e85f6704e39ae3a613bbec5dd51d449be8010","modified":1678522512694},{"_id":"public/js/header-shrink.js","hash":"167b9b6a9ed63c6cf4081cb3c201dd16bbbfb9ad","modified":1678522512694},{"_id":"public/js/dark-light-toggle.js","hash":"223e6f1d4e6e70956e4661b58c430e1c68def125","modified":1678522512694},{"_id":"public/js/lazyload.js","hash":"95aad532f17d7a8119979fc61ade9e626308a2af","modified":1678522512694},{"_id":"public/js/code-copy.js","hash":"3fdabac26f6406a4592336f1f444ec966201b5d9","modified":1678522512694},{"_id":"public/js/left-side-toggle.js","hash":"618f7cfc45db4d82b2f1d00d8e9ee936bcf9043b","modified":1678522512694},{"_id":"public/js/local-search.js","hash":"9509ec6d2d7d4466fe37ad624cf606f6639fb3fe","modified":1678522512694},{"_id":"public/js/main.js","hash":"ca8ed228cc0bc234be74428d029cfd047eec0ed6","modified":1678522512694},{"_id":"public/js/toc.js","hash":"ae69bf65d2b30d299b6ca9e2361d3b6e0db3a077","modified":1678522512694},{"_id":"public/js/utils.js","hash":"f6202d352b1f3afc0a93c8ff8f85b78526a1c31d","modified":1678522512694},{"_id":"public/css/common/animated.css","hash":"654c7588d80dc8b481a203e3071b3cedd41c7fde","modified":1678522512694},{"_id":"public/css/common/keep-theme.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1678522512694},{"_id":"public/css/common/basic.css","hash":"55f95a3b9398ffbf11b8b39f264509e821df9e2e","modified":1678522512694},{"_id":"public/css/layout/article-content.css","hash":"bb2e9b90086c4a014d0dbeb97cd0beedab27fe9c","modified":1678522512694},{"_id":"public/css/layout/archive-content.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1678522512694},{"_id":"public/css/common/markdown.css","hash":"8c9fb9f7fb403e76a4446a7e533ebe36dd702483","modified":1678522512694},{"_id":"public/css/layout/category-list.css","hash":"672859a61a4e93c0514772112fb557395306e940","modified":1678522512694},{"_id":"public/css/layout/home-content.css","hash":"be1438b849ebf82cea573986fbbd1deed5334a72","modified":1678522512694},{"_id":"public/css/layout/page.css","hash":"c9d5a1244b1a393ebf63412cf9ffef43ca48d64e","modified":1678522512694},{"_id":"public/css/layout/tag-content.css","hash":"90b0cff1ef0228035cdca9ade2adef71c6c8fb5e","modified":1678522512694},{"_id":"public/css/common/variables.css","hash":"157311f7b38a76721f2b6a2a9bd5229fac60df41","modified":1678522512694},{"_id":"public/css/layout/category-content.css","hash":"9687f9cbe029092b633fb804c28ecdcb54860511","modified":1678522512694},{"_id":"public/css/common/codeblock/copy-code.css","hash":"fa5f022395fe92b6daea063418a32f8c19be6168","modified":1678522512694},{"_id":"public/css/common/codeblock/code-theme.css","hash":"0edc6d498dc0abbaadb152b48e9e7bebb6fd15f4","modified":1678522512694},{"_id":"public/css/common/codeblock/highlight.css","hash":"a6584196f859d00cdd962f43c809e44ed89319e4","modified":1678522512694},{"_id":"public/css/style.css","hash":"fb3c2628a6d750f50bb54c1ac8b24f8d4e0bb2b6","modified":1678522512694},{"_id":"public/css/font-awesome.min.css","hash":"c508528feb9fd540454f838653cd4863b290df2e","modified":1678522512694},{"_id":"public/js/libs/pjax.min.js","hash":"57ec40cb4898d7ba74a03603d608af378e5431f8","modified":1678522512694},{"_id":"public/js/libs/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1678522512694},{"_id":"public/webfonts/fa-brands-400.woff2","hash":"f726c4275bb494a045fde059175f072de06c01df","modified":1678522512694},{"_id":"public/webfonts/fa-brands-400.woff","hash":"a42ac4a94f4e0e9333cdb1b2fb6c13c0ae690ff2","modified":1678522512694},{"_id":"public/webfonts/fa-solid-900.woff","hash":"3b86a0ce15d8d534b65e98560e321a933d310688","modified":1678522512694},{"_id":"public/webfonts/fa-solid-900.woff2","hash":"9b592048b9062b00f0b2dd782d70a95b7dc69b83","modified":1678522512694},{"_id":"public/webfonts/fa-brands-400.eot","hash":"c719f4375679ee58e156434f9ba9727be669cf07","modified":1678522512694},{"_id":"public/webfonts/fa-brands-400.ttf","hash":"9b49c6c5b0cbdef158ae31b2a4e4814555408389","modified":1678522512694},{"_id":"public/webfonts/fa-regular-400.svg","hash":"c41a688158d577e3a2738137992d49b05b17ab8f","modified":1678522512694},{"_id":"public/webfonts/fa-solid-900.eot","hash":"c39b89f7fa7b66931ab02a54002db5ffcbff206c","modified":1678522512694},{"_id":"public/webfonts/fa-solid-900.ttf","hash":"d537bf4cc7273ddb3fd754d53f2b241aeafaefe7","modified":1678522512694},{"_id":"public/webfonts/fa-brands-400.svg","hash":"69a0ff79a9d93a451e9fa90bd79ae7008d2a9da5","modified":1678522512694},{"_id":"public/webfonts/fa-solid-900.svg","hash":"36de6a298660ed3feaab37900f7b28c3e981d80e","modified":1678522512694}],"Category":[{"name":"essay","_id":"clf3oyrw700048py09wvqaqj3"},{"name":"springcloud","_id":"clf3oyrwd000r8py0fsah9r27"},{"name":"leetcode","_id":"clf3oyrwe000y8py0fuc81vdt"},{"name":"java","_id":"clf3oyrwf00148py0ex8eca36"},{"name":"springsecurity","_id":"clf3oyrwf001a8py02q29ez7s"},{"name":"springboot","_id":"clf3oyrwg001j8py0eo258jvg"},{"name":"designpatterns","_id":"clf3oyrwj00298py0g3usgop0"},{"name":"datastructure","_id":"clf3oyrwj002h8py0as97c6c5"},{"name":"network","_id":"clf3oyrwk002v8py01uophh2l"},{"name":"jvm","_id":"clf3oyrwl00358py0h45xdody"},{"name":"unit_test","_id":"clf3oyrwm003g8py09owdflp9"},{"name":"linux","_id":"clf3oyrwo00418py0aoyz4vaq"},{"name":"springbot","_id":"clf3oyrwo00478py060ef47wu"},{"name":"mybatis","_id":"clf3oyrwp004e8py0gzjh6gpf"},{"name":"middleware","_id":"clf3oyrwp004j8py0ftbn1yf0"},{"name":"springmvc","_id":"clf3oyrwq004y8py06kn8dihc"},{"name":"Utils","_id":"clf3oyrwq00568py0aax7ewqw"}],"Data":[],"Page":[{"title":"about","date":"2019-11-02T16:17:30.000Z","type":"about","_content":"\nI'm Sebastian and Chinese name is . I've graduated from Hainan University in 2019 and major in Computer Science. Now I'm in Shenzhen working as a software engineer. I do well in Java, as well as related framework. I want to use code to build useful distributed system to help people, to promote social development. In the past three years, I learned Java colleciton framework, wechat mini program, springboot and some middlewares, such as redis, rocketmq and etc. Besides, I know much\nabout Trust industry in finance. Code for fun!\n\n- 2019\n- \n- Java\n","source":"about/index.md","raw":"---\ntitle: about\ndate: 2019-11-03 00:17:30\ntype: about\n---\n\nI'm Sebastian and Chinese name is . I've graduated from Hainan University in 2019 and major in Computer Science. Now I'm in Shenzhen working as a software engineer. I do well in Java, as well as related framework. I want to use code to build useful distributed system to help people, to promote social development. In the past three years, I learned Java colleciton framework, wechat mini program, springboot and some middlewares, such as redis, rocketmq and etc. Besides, I know much\nabout Trust industry in finance. Code for fun!\n\n- 2019\n- \n- Java\n","updated":"2022-12-13T03:16:54.295Z","path":"about/index.html","comments":1,"layout":"page","_id":"clf3oyrw300008py021wq7w6j","content":"<p>Im Sebastian and Chinese name is . Ive graduated from Hainan University in 2019 and major in Computer Science. Now Im in Shenzhen working as a software engineer. I do well in Java, as well as related framework. I want to use code to build useful distributed system to help people, to promote social development. In the past three years, I learned Java colleciton framework, wechat mini program, springboot and some middlewares, such as redis, rocketmq and etc. Besides, I know much<br>about Trust industry in finance. Code for fun!</p>\n<ul>\n<li>2019</li>\n<li></li>\n<li>Java</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>Im Sebastian and Chinese name is . Ive graduated from Hainan University in 2019 and major in Computer Science. Now Im in Shenzhen working as a software engineer. I do well in Java, as well as related framework. I want to use code to build useful distributed system to help people, to promote social development. In the past three years, I learned Java colleciton framework, wechat mini program, springboot and some middlewares, such as redis, rocketmq and etc. Besides, I know much<br>about Trust industry in finance. Code for fun!</p>\n<ul>\n<li>2019</li>\n<li></li>\n<li>Java</li>\n</ul>\n"},{"title":"all-archives","layout":"all-archives","date":"2020-08-16T04:51:57.000Z","_content":"","source":"all-archives/index.md","raw":"---\ntitle: all-archives\nlayout: all-archives\ndate: 2020-08-16 12:51:57\n---\n","updated":"2021-11-14T14:30:15.932Z","path":"all-archives/index.html","comments":1,"_id":"clf3oyrw600028py04vuaf0e0","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"all-categories","layout":"all-categories","date":"2020-08-16T04:51:22.000Z","_content":"","source":"all-categories/index.md","raw":"---\ntitle: all-categories\nlayout: all-categories\ndate: 2020-08-16 12:51:22\n---\n","updated":"2021-11-14T14:30:15.932Z","path":"all-categories/index.html","comments":1,"_id":"clf3oyrw800068py0bmrp1vi7","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"all-tags","layout":"all-tags","date":"2020-08-16T04:51:43.000Z","_content":"","source":"all-tags/index.md","raw":"---\ntitle: all-tags\nlayout: all-tags\ndate: 2020-08-16 12:51:43\n---\n","updated":"2021-11-14T14:30:15.932Z","path":"all-tags/index.html","comments":1,"_id":"clf3oyrw900088py0dfli3pnu","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"categories","date":"2019-11-01T07:35:36.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2019-11-01 15:35:36\ntype: categories\n---\n","updated":"2021-11-14T14:30:15.932Z","path":"categories/index.html","comments":1,"layout":"page","_id":"clf3oyrw9000a8py04ntl10z3","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"top","date":"2019-11-01T13:50:25.000Z","_content":"<div id=\"post-rank\"></div>\n\n<script src=\"//cdn.jsdelivr.net/npm/leancloud-storage@3.10.0/dist/av-min.js\"></script>\n<script>\n  var APP_ID = ******;  //LeanCloudAppID\n  var APP_KEY = ******;  //LeanCloudAppKey\n  AV.init({\n    appId: APP_ID,\n    appKey: APP_KEY\n  });\n\n  var query = new AV.Query('Counter');//\n  query.descending('time'); //\n  query.limit(10);  //10\n  query.find().then( response => {\n    var content = response.reduce( (accum, {attributes}) => {\n      accum += `<p><div class=\"prefix\"> ${attributes.time} </div><div><a href=\"${attributes.url}\">${attributes.title}</a></div></p>`\n      return accum;\n    },\"\")\n    document.querySelector(\"#post-rank\").innerHTML = content;\n  })\n  .catch( error => {\n    console.log(error);\n  });\n</script>\n\n<style type=\"text/css\">\n  #post-rank {\n    text-align: center;\n  }\n  #post-rank .prefix {\n    color: #ff4d4f;\n  }\n</style>","source":"top/index.md","raw":"---\ntitle: top\ndate: 2019-11-01 21:50:25\n---\n<div id=\"post-rank\"></div>\n\n<script src=\"//cdn.jsdelivr.net/npm/leancloud-storage@3.10.0/dist/av-min.js\"></script>\n<script>\n  var APP_ID = ******;  //LeanCloudAppID\n  var APP_KEY = ******;  //LeanCloudAppKey\n  AV.init({\n    appId: APP_ID,\n    appKey: APP_KEY\n  });\n\n  var query = new AV.Query('Counter');//\n  query.descending('time'); //\n  query.limit(10);  //10\n  query.find().then( response => {\n    var content = response.reduce( (accum, {attributes}) => {\n      accum += `<p><div class=\"prefix\"> ${attributes.time} </div><div><a href=\"${attributes.url}\">${attributes.title}</a></div></p>`\n      return accum;\n    },\"\")\n    document.querySelector(\"#post-rank\").innerHTML = content;\n  })\n  .catch( error => {\n    console.log(error);\n  });\n</script>\n\n<style type=\"text/css\">\n  #post-rank {\n    text-align: center;\n  }\n  #post-rank .prefix {\n    color: #ff4d4f;\n  }\n</style>","updated":"2021-11-14T14:30:15.932Z","path":"top/index.html","comments":1,"layout":"page","_id":"clf3oyrwb000f8py0avl08w3b","content":"<div id=\"post-rank\"></div>\n\n<script src=\"//cdn.jsdelivr.net/npm/leancloud-storage@3.10.0/dist/av-min.js\"></script>\n<script>\n  var APP_ID = ******;  //LeanCloudAppID\n  var APP_KEY = ******;  //LeanCloudAppKey\n  AV.init({\n    appId: APP_ID,\n    appKey: APP_KEY\n  });\n\n  var query = new AV.Query('Counter');//\n  query.descending('time'); //\n  query.limit(10);  //10\n  query.find().then( response => {\n    var content = response.reduce( (accum, {attributes}) => {\n      accum += `<p><div class=\"prefix\"> ${attributes.time} </div><div><a href=\"${attributes.url}\">${attributes.title}</a></div></p>`\n      return accum;\n    },\"\")\n    document.querySelector(\"#post-rank\").innerHTML = content;\n  })\n  .catch( error => {\n    console.log(error);\n  });\n</script>\n\n<style type=\"text/css\">\n  #post-rank {\n    text-align: center;\n  }\n  #post-rank .prefix {\n    color: #ff4d4f;\n  }\n</style>","site":{"data":{}},"excerpt":"","more":"<div id=\"post-rank\"></div>\n\n<script src=\"//cdn.jsdelivr.net/npm/leancloud-storage@3.10.0/dist/av-min.js\"></script>\n<script>\n  var APP_ID = ******;  //LeanCloudAppID\n  var APP_KEY = ******;  //LeanCloudAppKey\n  AV.init({\n    appId: APP_ID,\n    appKey: APP_KEY\n  });\n\n  var query = new AV.Query('Counter');//\n  query.descending('time'); //\n  query.limit(10);  //10\n  query.find().then( response => {\n    var content = response.reduce( (accum, {attributes}) => {\n      accum += `<p><div class=\"prefix\"> ${attributes.time} </div><div><a href=\"${attributes.url}\">${attributes.title}</a></div></p>`\n      return accum;\n    },\"\")\n    document.querySelector(\"#post-rank\").innerHTML = content;\n  })\n  .catch( error => {\n    console.log(error);\n  });\n</script>\n\n<style type=\"text/css\">\n  #post-rank {\n    text-align: center;\n  }\n  #post-rank .prefix {\n    color: #ff4d4f;\n  }\n</style>"},{"title":"tags","date":"2019-11-01T07:08:49.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2019-11-01 15:08:49\ntype: tags\n---","updated":"2021-11-14T14:30:15.932Z","path":"tags/index.html","comments":1,"layout":"page","_id":"clf3oyrwb000i8py0b65a8ao6","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"2021_mid","date":"2021-06-06T14:22:06.000Z","_content":"\n202120202021\n\n<!-- more -->\n\n\n\n## \n\n- LeetCode21000.\n- handbook\n- 40850%\n- SpringMybatisSpringMVC\n- \n- id\n\n\n\n## \n\n- \n- vuevuerepogithub\n- PMP\n- \n- vuejs CodeForces\n- 408\n- \n-  \n- JavaJVM\n","source":"_posts/2021-mid.md","raw":"---\ntitle: 2021_mid\ndate: 2021-06-06 22:22:06\ncategories: essay\ntags: summary\n---\n\n202120202021\n\n<!-- more -->\n\n\n\n## \n\n- LeetCode21000.\n- handbook\n- 40850%\n- SpringMybatisSpringMVC\n- \n- id\n\n\n\n## \n\n- \n- vuevuerepogithub\n- PMP\n- \n- vuejs CodeForces\n- 408\n- \n-  \n- JavaJVM\n","slug":"2021-mid","published":1,"updated":"2021-11-14T14:30:15.926Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrw500018py01z0u1fiv","content":"<p>202120202021</p>\n<span id=\"more\"></span>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>LeetCode21000.</li>\n<li>handbook</li>\n<li>40850%</li>\n<li>SpringMybatisSpringMVC</li>\n<li></li>\n<li>id</li>\n</ul>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li>vuevuerepogithub</li>\n<li>PMP</li>\n<li></li>\n<li>vuejs CodeForces</li>\n<li>408</li>\n<li></li>\n<li> </li>\n<li>JavaJVM</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>202120202021</p>","more":"<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>LeetCode21000.</li>\n<li>handbook</li>\n<li>40850%</li>\n<li>SpringMybatisSpringMVC</li>\n<li></li>\n<li>id</li>\n</ul>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li>vuevuerepogithub</li>\n<li>PMP</li>\n<li></li>\n<li>vuejs CodeForces</li>\n<li>408</li>\n<li></li>\n<li> </li>\n<li>JavaJVM</li>\n</ul>"},{"title":"2022-end","date":"2022-12-31T04:54:14.000Z","_content":"\n2022\n\n<!-- more -->\n\nTA202172021 \n\n\n## \n- \n- vuevuerepogithub\n- PMP\n- \n- vuejs CodeForces\n- 408\n- \n-  \n- JavaJVM\n\n7LeetCode\n\n\n## \n2021\n- \n- \n- BEC\n- \n- 408\n- LeetCode1650\n- /NettyRedisRocketMQ","source":"_posts/2022-end.md","raw":"---\ntitle: 2022-end\ndate: 2022-12-31 12:54:14\ncategories: essay\ntags: summary\n---\n\n2022\n\n<!-- more -->\n\nTA202172021 \n\n\n## \n- \n- vuevuerepogithub\n- PMP\n- \n- vuejs CodeForces\n- 408\n- \n-  \n- JavaJVM\n\n7LeetCode\n\n\n## \n2021\n- \n- \n- BEC\n- \n- 408\n- LeetCode1650\n- /NettyRedisRocketMQ","slug":"2022-end","published":1,"updated":"2022-12-31T06:35:03.177Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrw600038py05nmt9ofs","content":"<p>2022</p>\n<span id=\"more\"></span>\n\n<p>TA202172021 </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li>vuevuerepogithub</li>\n<li>PMP</li>\n<li></li>\n<li>vuejs CodeForces</li>\n<li>408</li>\n<li></li>\n<li> </li>\n<li>JavaJVM</li>\n</ul>\n<p>7LeetCode<br></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>2021</p>\n<ul>\n<li></li>\n<li></li>\n<li>BEC</li>\n<li></li>\n<li>408</li>\n<li>LeetCode1650</li>\n<li>/NettyRedisRocketMQ</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>2022</p>","more":"<p>TA202172021 </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li>vuevuerepogithub</li>\n<li>PMP</li>\n<li></li>\n<li>vuejs CodeForces</li>\n<li>408</li>\n<li></li>\n<li> </li>\n<li>JavaJVM</li>\n</ul>\n<p>7LeetCode<br></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>2021</p>\n<ul>\n<li></li>\n<li></li>\n<li>BEC</li>\n<li></li>\n<li>408</li>\n<li>LeetCode1650</li>\n<li>/NettyRedisRocketMQ</li>\n</ul>"},{"title":"2020_end","date":"2021-01-03T13:35:35.000Z","_content":"\n2020\n\n<!-- more -->\n\n\n\n<!--toc-->\n\n## \n\n### 19\n\n201920206202011Java\n\nGithub\n\n- Java\n- SpringBootSpringCloud\n\n\n\n- Java-\n- Java-\n\n### 20\n\nJavalambdaSpringAOP\n\n\n\n- \n  - Javascript, cssflowbox\n- Leetcode\n\nHeadFirst:\n\n- HeadFirst Servlet JSP\n- HeadFirst Java\n- HeadFirst DesignPattern\n\n## \n\nESESSpring Security\n\n\n\n- ElasticSearch\n- Spring Security\n\nJVMJavaSpringBootMyBatisSpringCloud\n\n- Java\n- Java8lambda\n\n\n\n## \n\n- [ ] ****\n- [ ] **pull request** 00.\n- [ ] ****demo\n- [ ] JavaLeetcode**Python****C++**or****\n- [ ] **408**fight\n- [ ] ****\n- [ ] ********demo\n- [ ] Java179","source":"_posts/2020-end.md","raw":"---\ntitle: 2020_end\ndate: 2021-01-03 21:35:35\ncategories: essay\ntags: summary\n---\n\n2020\n\n<!-- more -->\n\n\n\n<!--toc-->\n\n## \n\n### 19\n\n201920206202011Java\n\nGithub\n\n- Java\n- SpringBootSpringCloud\n\n\n\n- Java-\n- Java-\n\n### 20\n\nJavalambdaSpringAOP\n\n\n\n- \n  - Javascript, cssflowbox\n- Leetcode\n\nHeadFirst:\n\n- HeadFirst Servlet JSP\n- HeadFirst Java\n- HeadFirst DesignPattern\n\n## \n\nESESSpring Security\n\n\n\n- ElasticSearch\n- Spring Security\n\nJVMJavaSpringBootMyBatisSpringCloud\n\n- Java\n- Java8lambda\n\n\n\n## \n\n- [ ] ****\n- [ ] **pull request** 00.\n- [ ] ****demo\n- [ ] JavaLeetcode**Python****C++**or****\n- [ ] **408**fight\n- [ ] ****\n- [ ] ********demo\n- [ ] Java179","slug":"2020-end","published":1,"updated":"2021-11-14T14:30:15.926Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrw800078py0fqev9bci","content":"<p>2020</p>\n<span id=\"more\"></span>\n\n<p></p>\n<!--toc-->\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"19\"><a href=\"#19\" class=\"headerlink\" title=\"19\"></a>19</h3><p>201920206202011Java</p>\n<p>Github</p>\n<ul>\n<li>Java</li>\n<li>SpringBootSpringCloud</li>\n</ul>\n<p></p>\n<ul>\n<li>Java-</li>\n<li>Java-</li>\n</ul>\n<h3 id=\"20\"><a href=\"#20\" class=\"headerlink\" title=\"20\"></a>20</h3><p>JavalambdaSpringAOP</p>\n<p></p>\n<ul>\n<li><ul>\n<li>Javascript, cssflowbox</li>\n</ul>\n</li>\n<li>Leetcode</li>\n</ul>\n<p>HeadFirst:</p>\n<ul>\n<li>HeadFirst Servlet JSP</li>\n<li>HeadFirst Java</li>\n<li>HeadFirst DesignPattern</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ESESSpring Security</p>\n<p></p>\n<ul>\n<li>ElasticSearch</li>\n<li>Spring Security</li>\n</ul>\n<p>JVMJavaSpringBootMyBatisSpringCloud</p>\n<ul>\n<li>Java</li>\n<li>Java8lambda</li>\n</ul>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong></li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong>pull request</strong> 00.</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong>demo</li>\n<li><input disabled=\"\" type=\"checkbox\"> JavaLeetcode<strong>Python</strong><strong>C++**or</strong>**</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong>408</strong>fight</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong></li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong><strong></strong>demo</li>\n<li><input disabled=\"\" type=\"checkbox\"> Java179</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>2020</p>","more":"<p></p>\n<!--toc-->\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"19\"><a href=\"#19\" class=\"headerlink\" title=\"19\"></a>19</h3><p>201920206202011Java</p>\n<p>Github</p>\n<ul>\n<li>Java</li>\n<li>SpringBootSpringCloud</li>\n</ul>\n<p></p>\n<ul>\n<li>Java-</li>\n<li>Java-</li>\n</ul>\n<h3 id=\"20\"><a href=\"#20\" class=\"headerlink\" title=\"20\"></a>20</h3><p>JavalambdaSpringAOP</p>\n<p></p>\n<ul>\n<li><ul>\n<li>Javascript, cssflowbox</li>\n</ul>\n</li>\n<li>Leetcode</li>\n</ul>\n<p>HeadFirst:</p>\n<ul>\n<li>HeadFirst Servlet JSP</li>\n<li>HeadFirst Java</li>\n<li>HeadFirst DesignPattern</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ESESSpring Security</p>\n<p></p>\n<ul>\n<li>ElasticSearch</li>\n<li>Spring Security</li>\n</ul>\n<p>JVMJavaSpringBootMyBatisSpringCloud</p>\n<ul>\n<li>Java</li>\n<li>Java8lambda</li>\n</ul>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong></li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong>pull request</strong> 00.</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong>demo</li>\n<li><input disabled=\"\" type=\"checkbox\"> JavaLeetcode<strong>Python</strong><strong>C++**or</strong>**</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong>408</strong>fight</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong></li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong><strong></strong>demo</li>\n<li><input disabled=\"\" type=\"checkbox\"> Java179</li>\n</ul>"},{"title":"2022_mid_summary","date":"2022-05-14T05:53:16.000Z","_content":"\n2021\n\n\n\n\n\n<!-- more -->\n\n## 2021\n\n2021flag\n\n2021\n\n\n\n## 2022 \n\n2021\n\n- \n- vuevuerepogithub\n- PMP\n- \n- vuejs CodeForces\n- 408\n- \n- JavaJVM\n- \n- \n- \n- \n- \n\n## 2022 \n\nPMP\n\n\n\n/\n","source":"_posts/2022-mid-summary.md","raw":"---\ntitle: 2022_mid_summary\ndate: 2022-05-14 13:53:16\ncategories: essay\ntags: summary\n---\n\n2021\n\n\n\n\n\n<!-- more -->\n\n## 2021\n\n2021flag\n\n2021\n\n\n\n## 2022 \n\n2021\n\n- \n- vuevuerepogithub\n- PMP\n- \n- vuejs CodeForces\n- 408\n- \n- JavaJVM\n- \n- \n- \n- \n- \n\n## 2022 \n\nPMP\n\n\n\n/\n","slug":"2022-mid-summary","published":1,"updated":"2022-12-09T14:52:45.141Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrw900098py08t2y1d1o","content":"<p>2021</p>\n<p></p>\n<p></p>\n<span id=\"more\"></span>\n\n<h2 id=\"2021\"><a href=\"#2021\" class=\"headerlink\" title=\"2021\"></a>2021</h2><p>2021flag</p>\n<p>2021</p>\n<p></p>\n<h2 id=\"2022-\"><a href=\"#2022-\" class=\"headerlink\" title=\"2022 \"></a>2022 </h2><p>2021</p>\n<ul>\n<li></li>\n<li>vuevuerepogithub</li>\n<li>PMP</li>\n<li></li>\n<li>vuejs CodeForces</li>\n<li>408</li>\n<li></li>\n<li>JavaJVM</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"2022-\"><a href=\"#2022-\" class=\"headerlink\" title=\"2022 \"></a>2022 </h2><p>PMP</p>\n<p></p>\n<p>/</p>\n","site":{"data":{}},"excerpt":"<p>2021</p>\n<p></p>\n<p></p>","more":"<h2 id=\"2021\"><a href=\"#2021\" class=\"headerlink\" title=\"2021\"></a>2021</h2><p>2021flag</p>\n<p>2021</p>\n<p></p>\n<h2 id=\"2022-\"><a href=\"#2022-\" class=\"headerlink\" title=\"2022 \"></a>2022 </h2><p>2021</p>\n<ul>\n<li></li>\n<li>vuevuerepogithub</li>\n<li>PMP</li>\n<li></li>\n<li>vuejs CodeForces</li>\n<li>408</li>\n<li></li>\n<li>JavaJVM</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"2022-\"><a href=\"#2022-\" class=\"headerlink\" title=\"2022 \"></a>2022 </h2><p>PMP</p>\n<p></p>\n<p>/</p>"},{"title":"Apollo_01","date":"2022-09-01T03:11:35.000Z","_content":"","source":"_posts/Apollo-01.md","raw":"---\ntitle: Apollo_01\ndate: 2022-09-01 11:11:35\ncategories: springcloud\ntags: service-discovery\n---\n","slug":"Apollo-01","published":1,"updated":"2022-11-24T11:55:47.016Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrw9000b8py00c7k54ga","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"ArrangementAndCombination","date":"2022-09-30T08:59:04.000Z","_content":"\nLeetcode`combination sum``subset`\n\n<!-- more -->\n\n## combination\n\n\n\n```java\n    public List<List<Integer>> combinationSum(int[] candidates, int target) {\n        List<List<Integer>> list = new ArrayList<>();\n        helper(list, new ArrayList<>(), candidates, target, 0);\n\n        return list;\n    }\n\n    public void helper(List<List<Integer>> list, List<Integer> tempList, int[] candidates, int target, int start) {\n        if(target <= 0) {\n            // target00\n            if(target == 0) list.add(new ArrayList<>(tempList));\n        } else {\n            // i = startstart\n            for(int i=start; i<candidates.length; i++) {\n                tempList.add(candidates[i]);\n                // start\n                helper(list, tempList, candidates, target - candidates[i], i);\n                tempList.remove(tempList.size() - 1);\n            }\n        }\n    }\n```\n\n```properties\nInput: candidates = [2,3,5], target = 8\nOutput: [[2,2,2,2],[2,3,3],[3,5]]\n```\n\n### combination II\n\n\n\n```java\n    public List<List<Integer>> combinationSum2(int[] candidates, int target) {\n        List<List<Integer>> list = new ArrayList<>();\n        // nusm[i]nums[i-1]\n        Arrays.sort(candidates);\n        helper(list, new ArrayList<>(), candidates, target, 0);\n\n        return list;\n    }\n\n    public void helper(List<List<Integer>> list, List<Integer> templist, int[] nums, int target, int start) {\n        if(target <= 0) {\n            if(target == 0) list.add(new ArrayList<>(templist));\n        } else {\n            for(int i=start; i<nums.length; i++) {\n                // [2,2,3]\n                if(i > start && nums[i] == nums[i-1]) {\n                    continue;\n                }\n                templist.add(nums[i]);\n                helper(list, templist, nums, target - nums[i], i+1);\n                templist.remove(templist.size() - 1);\n            }\n        }\n    }\n```\n\n### combination III\n\n19`k``n`\n\n```java\n    public List<List<Integer>> combinationSum3(int k, int n) {\n        List<List<Integer>> list = new ArrayList<>();\n        int[] nums = {1,2,3,4,5,6,7,8,9};\n        helper(list, new ArrayList<>(), nums, 0, n, k);\n\n        return list;\n    }\n\n    public void helper(List<List<Integer>> list, List<Integer> templist, int[] nums, int start, int target, int k) {\n        // \n        if(target <= 0 && templist.size() == k) {\n            if(target == 0) list.add(new ArrayList<>(templist));\n        } else {\n            for(int i=start; i<nums.length; i++) {\n                templist.add(nums[i]);\n                helper(list, templist, nums, i+1, target - nums[i], k);\n                templist.remove(templist.size() - 1);\n            }\n        }\n    }\n```\n\n## subset\n\n```java\npublic List<List<Integer>> arrangement(int[] nums) {\n    List<List<Integer>> list = new ArrayList<>();\n    helper(list, new ArrayList<>(), nums);\n\n    return list;\n}\n\n\npublic static void helper(List<List<Integer>> list, List<Integer> tempList, int[] nums) {\n    // list\n    if(tempList.size() == nums.length) {\n        list.add(new ArrayList<>(tempList));\n    } else {\n        for(int i=0; i<nums.length; i++) {\n            if(tempList.contains(nums[i])) continue;\n            tempList.add(nums[i]);\n            helper(list, tempList, nums);\n            tempList.remove(tempList.size() - 1);\n        }\n    }\n}\n```\n","source":"_posts/ArrangementAndCombination.md","raw":"---\ntitle: ArrangementAndCombination\ndate: 2022-09-30 16:59:04\ncategories: leetcode\ntags: combination\n---\n\nLeetcode`combination sum``subset`\n\n<!-- more -->\n\n## combination\n\n\n\n```java\n    public List<List<Integer>> combinationSum(int[] candidates, int target) {\n        List<List<Integer>> list = new ArrayList<>();\n        helper(list, new ArrayList<>(), candidates, target, 0);\n\n        return list;\n    }\n\n    public void helper(List<List<Integer>> list, List<Integer> tempList, int[] candidates, int target, int start) {\n        if(target <= 0) {\n            // target00\n            if(target == 0) list.add(new ArrayList<>(tempList));\n        } else {\n            // i = startstart\n            for(int i=start; i<candidates.length; i++) {\n                tempList.add(candidates[i]);\n                // start\n                helper(list, tempList, candidates, target - candidates[i], i);\n                tempList.remove(tempList.size() - 1);\n            }\n        }\n    }\n```\n\n```properties\nInput: candidates = [2,3,5], target = 8\nOutput: [[2,2,2,2],[2,3,3],[3,5]]\n```\n\n### combination II\n\n\n\n```java\n    public List<List<Integer>> combinationSum2(int[] candidates, int target) {\n        List<List<Integer>> list = new ArrayList<>();\n        // nusm[i]nums[i-1]\n        Arrays.sort(candidates);\n        helper(list, new ArrayList<>(), candidates, target, 0);\n\n        return list;\n    }\n\n    public void helper(List<List<Integer>> list, List<Integer> templist, int[] nums, int target, int start) {\n        if(target <= 0) {\n            if(target == 0) list.add(new ArrayList<>(templist));\n        } else {\n            for(int i=start; i<nums.length; i++) {\n                // [2,2,3]\n                if(i > start && nums[i] == nums[i-1]) {\n                    continue;\n                }\n                templist.add(nums[i]);\n                helper(list, templist, nums, target - nums[i], i+1);\n                templist.remove(templist.size() - 1);\n            }\n        }\n    }\n```\n\n### combination III\n\n19`k``n`\n\n```java\n    public List<List<Integer>> combinationSum3(int k, int n) {\n        List<List<Integer>> list = new ArrayList<>();\n        int[] nums = {1,2,3,4,5,6,7,8,9};\n        helper(list, new ArrayList<>(), nums, 0, n, k);\n\n        return list;\n    }\n\n    public void helper(List<List<Integer>> list, List<Integer> templist, int[] nums, int start, int target, int k) {\n        // \n        if(target <= 0 && templist.size() == k) {\n            if(target == 0) list.add(new ArrayList<>(templist));\n        } else {\n            for(int i=start; i<nums.length; i++) {\n                templist.add(nums[i]);\n                helper(list, templist, nums, i+1, target - nums[i], k);\n                templist.remove(templist.size() - 1);\n            }\n        }\n    }\n```\n\n## subset\n\n```java\npublic List<List<Integer>> arrangement(int[] nums) {\n    List<List<Integer>> list = new ArrayList<>();\n    helper(list, new ArrayList<>(), nums);\n\n    return list;\n}\n\n\npublic static void helper(List<List<Integer>> list, List<Integer> tempList, int[] nums) {\n    // list\n    if(tempList.size() == nums.length) {\n        list.add(new ArrayList<>(tempList));\n    } else {\n        for(int i=0; i<nums.length; i++) {\n            if(tempList.contains(nums[i])) continue;\n            tempList.add(nums[i]);\n            helper(list, tempList, nums);\n            tempList.remove(tempList.size() - 1);\n        }\n    }\n}\n```\n","slug":"ArrangementAndCombination","published":1,"updated":"2022-12-09T08:47:20.992Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwb000g8py07hemg24e","content":"<p>Leetcode<code>combination sum</code><code>subset</code></p>\n<span id=\"more\"></span>\n\n<h2 id=\"combination\"><a href=\"#combination\" class=\"headerlink\" title=\"combination\"></a>combination</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum(<span class=\"keyword\">int</span>[] candidates, <span class=\"keyword\">int</span> target) &#123;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    helper(list, <span class=\"keyword\">new</span> ArrayList&lt;&gt;(), candidates, target, <span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; tempList, <span class=\"keyword\">int</span>[] candidates, <span class=\"keyword\">int</span> target, <span class=\"keyword\">int</span> start)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// target00</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) list.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;(tempList));</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// i = startstart</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=start; i&lt;candidates.length; i++) &#123;</span><br><span class=\"line\">            tempList.add(candidates[i]);</span><br><span class=\"line\">            <span class=\"comment\">// start</span></span><br><span class=\"line\">            helper(list, tempList, candidates, target - candidates[i], i);</span><br><span class=\"line\">            tempList.remove(tempList.size() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Input</span>: <span class=\"string\">candidates = [2,3,5], target = 8</span></span><br><span class=\"line\"><span class=\"attr\">Output</span>: <span class=\"string\">[[2,2,2,2],[2,3,3],[3,5]]</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"combination-II\"><a href=\"#combination-II\" class=\"headerlink\" title=\"combination II\"></a>combination II</h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum2(<span class=\"keyword\">int</span>[] candidates, <span class=\"keyword\">int</span> target) &#123;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// nusm[i]nums[i-1]</span></span><br><span class=\"line\">    Arrays.sort(candidates);</span><br><span class=\"line\">    helper(list, <span class=\"keyword\">new</span> ArrayList&lt;&gt;(), candidates, target, <span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; templist, <span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> target, <span class=\"keyword\">int</span> start)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) list.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;(templist));</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=start; i&lt;nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// [2,2,3]</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i &gt; start &amp;&amp; nums[i] == nums[i-<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            templist.add(nums[i]);</span><br><span class=\"line\">            helper(list, templist, nums, target - nums[i], i+<span class=\"number\">1</span>);</span><br><span class=\"line\">            templist.remove(templist.size() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"combination-III\"><a href=\"#combination-III\" class=\"headerlink\" title=\"combination III\"></a>combination III</h3><p>19<code>k</code><code>n</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum3(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> n) &#123;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] nums = &#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>&#125;;</span><br><span class=\"line\">    helper(list, <span class=\"keyword\">new</span> ArrayList&lt;&gt;(), nums, <span class=\"number\">0</span>, n, k);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; templist, <span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> start, <span class=\"keyword\">int</span> target, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target &lt;= <span class=\"number\">0</span> &amp;&amp; templist.size() == k) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) list.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;(templist));</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=start; i&lt;nums.length; i++) &#123;</span><br><span class=\"line\">            templist.add(nums[i]);</span><br><span class=\"line\">            helper(list, templist, nums, i+<span class=\"number\">1</span>, target - nums[i], k);</span><br><span class=\"line\">            templist.remove(templist.size() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"subset\"><a href=\"#subset\" class=\"headerlink\" title=\"subset\"></a>subset</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; arrangement(<span class=\"keyword\">int</span>[] nums) &#123;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    helper(list, <span class=\"keyword\">new</span> ArrayList&lt;&gt;(), nums);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; tempList, <span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// list</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(tempList.size() == nums.length) &#123;</span><br><span class=\"line\">        list.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;(tempList));</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(tempList.contains(nums[i])) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            tempList.add(nums[i]);</span><br><span class=\"line\">            helper(list, tempList, nums);</span><br><span class=\"line\">            tempList.remove(tempList.size() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>Leetcode<code>combination sum</code><code>subset</code></p>","more":"<h2 id=\"combination\"><a href=\"#combination\" class=\"headerlink\" title=\"combination\"></a>combination</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum(<span class=\"keyword\">int</span>[] candidates, <span class=\"keyword\">int</span> target) &#123;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    helper(list, <span class=\"keyword\">new</span> ArrayList&lt;&gt;(), candidates, target, <span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; tempList, <span class=\"keyword\">int</span>[] candidates, <span class=\"keyword\">int</span> target, <span class=\"keyword\">int</span> start)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// target00</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) list.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;(tempList));</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// i = startstart</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=start; i&lt;candidates.length; i++) &#123;</span><br><span class=\"line\">            tempList.add(candidates[i]);</span><br><span class=\"line\">            <span class=\"comment\">// start</span></span><br><span class=\"line\">            helper(list, tempList, candidates, target - candidates[i], i);</span><br><span class=\"line\">            tempList.remove(tempList.size() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Input</span>: <span class=\"string\">candidates = [2,3,5], target = 8</span></span><br><span class=\"line\"><span class=\"attr\">Output</span>: <span class=\"string\">[[2,2,2,2],[2,3,3],[3,5]]</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"combination-II\"><a href=\"#combination-II\" class=\"headerlink\" title=\"combination II\"></a>combination II</h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum2(<span class=\"keyword\">int</span>[] candidates, <span class=\"keyword\">int</span> target) &#123;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// nusm[i]nums[i-1]</span></span><br><span class=\"line\">    Arrays.sort(candidates);</span><br><span class=\"line\">    helper(list, <span class=\"keyword\">new</span> ArrayList&lt;&gt;(), candidates, target, <span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; templist, <span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> target, <span class=\"keyword\">int</span> start)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) list.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;(templist));</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=start; i&lt;nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// [2,2,3]</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i &gt; start &amp;&amp; nums[i] == nums[i-<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            templist.add(nums[i]);</span><br><span class=\"line\">            helper(list, templist, nums, target - nums[i], i+<span class=\"number\">1</span>);</span><br><span class=\"line\">            templist.remove(templist.size() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"combination-III\"><a href=\"#combination-III\" class=\"headerlink\" title=\"combination III\"></a>combination III</h3><p>19<code>k</code><code>n</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum3(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> n) &#123;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] nums = &#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>&#125;;</span><br><span class=\"line\">    helper(list, <span class=\"keyword\">new</span> ArrayList&lt;&gt;(), nums, <span class=\"number\">0</span>, n, k);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; templist, <span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> start, <span class=\"keyword\">int</span> target, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target &lt;= <span class=\"number\">0</span> &amp;&amp; templist.size() == k) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) list.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;(templist));</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=start; i&lt;nums.length; i++) &#123;</span><br><span class=\"line\">            templist.add(nums[i]);</span><br><span class=\"line\">            helper(list, templist, nums, i+<span class=\"number\">1</span>, target - nums[i], k);</span><br><span class=\"line\">            templist.remove(templist.size() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"subset\"><a href=\"#subset\" class=\"headerlink\" title=\"subset\"></a>subset</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; arrangement(<span class=\"keyword\">int</span>[] nums) &#123;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    helper(list, <span class=\"keyword\">new</span> ArrayList&lt;&gt;(), nums);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; tempList, <span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// list</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(tempList.size() == nums.length) &#123;</span><br><span class=\"line\">        list.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;(tempList));</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(tempList.contains(nums[i])) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            tempList.add(nums[i]);</span><br><span class=\"line\">            helper(list, tempList, nums);</span><br><span class=\"line\">            tempList.remove(tempList.size() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"CountDownLatch","date":"2022-12-15T05:59:31.000Z","_content":"synchronizedCountDownLatch\n\n<!-- more -->\n\n## Demo\nCountDownLatch\n```java\npublic static void main(String[] args) throws InterruptedException {\n    CountDownLatch countDownLatch = new CountDownLatch(10);\n    for (int i = 0; i < 10; i++) {\n        new Thread(() -> {\n            System.out.println(Thread.currentThread().getName() + \"\\tleave the room ....\");\n            countDownLatch.countDown();\n        }, String.valueOf(i)).start();\n\n    }\n    countDownLatch.await();\n    System.out.println(\"Ok, lock the door ...\");\n```\n`await()``countDown()`\n\n## Sync\nCountDownLatch`Sync`\n**AQS****AQS**\n\n### \n```java\nSync(int count) {\n    setState(count);\n}\n```\n`count`demo**AQS**`setState`statestate**volatile**\n\n### getCount()\n```java\nint getCount() {\n    return getState();\n}\n```\n**AQS**state\n\n### tryAcquiredShared()\n```java\nprotected int tryAcquireShared(int acquires) {\n    return (getState() == 0) ? 1 : -1;\n}\n```\n\n\n### tryReleaseShared()\n```java\nprotected boolean tryReleaseShared(int releases) {\n    // Decrement count; signal when transition to zero\n    for (;;) {\n        int c = getState();\n        if (c == 0)\n            return false;\n        int nextc = c-1;\n        if (compareAndSetState(c, nextc))\n            return nextc == 0;\n    }\n}\n```\n0false000\n> CountDownLatchAQS\n\n## countDown()\ndemo\n```java\npublic void countDown() {\n    sync.releaseShared(1);\n}\n```\nsync`releaseShared()`**1****AQS**`tryReleaseShared`\n```java\npublic final boolean releaseShared(int arg) {\n    if (tryReleaseShared(arg)) {\n        doReleaseShared();\n        return true;\n    }\n    return false;\n}\n```\n`tryReleaseShared`false0falsetrue\n\n## await()\ndemo\n```java\npublic void await() throws InterruptedException {\n    sync.acquireSharedInterruptibly(1);\n}\n```\n**1****AQS**\n```java\npublic final void acquireSharedInterruptibly(int arg)\n        throws InterruptedException {\n    if (Thread.interrupted())\n        throw new InterruptedException();\n    if (tryAcquireShared(arg) < 0)\n        doAcquireSharedInterruptibly(arg);\n}\n```\n0`(getState() == 0) ? 1 : -1`0100`doAcquireSharedInterruptibly()`volatilestate0\n\n## \n**AQS****AQS**","source":"_posts/CountDownLatch.md","raw":"---\ntitle: CountDownLatch\ndate: 2022-12-15 13:59:31\ncategories: java\ntags: lock\n---\nsynchronizedCountDownLatch\n\n<!-- more -->\n\n## Demo\nCountDownLatch\n```java\npublic static void main(String[] args) throws InterruptedException {\n    CountDownLatch countDownLatch = new CountDownLatch(10);\n    for (int i = 0; i < 10; i++) {\n        new Thread(() -> {\n            System.out.println(Thread.currentThread().getName() + \"\\tleave the room ....\");\n            countDownLatch.countDown();\n        }, String.valueOf(i)).start();\n\n    }\n    countDownLatch.await();\n    System.out.println(\"Ok, lock the door ...\");\n```\n`await()``countDown()`\n\n## Sync\nCountDownLatch`Sync`\n**AQS****AQS**\n\n### \n```java\nSync(int count) {\n    setState(count);\n}\n```\n`count`demo**AQS**`setState`statestate**volatile**\n\n### getCount()\n```java\nint getCount() {\n    return getState();\n}\n```\n**AQS**state\n\n### tryAcquiredShared()\n```java\nprotected int tryAcquireShared(int acquires) {\n    return (getState() == 0) ? 1 : -1;\n}\n```\n\n\n### tryReleaseShared()\n```java\nprotected boolean tryReleaseShared(int releases) {\n    // Decrement count; signal when transition to zero\n    for (;;) {\n        int c = getState();\n        if (c == 0)\n            return false;\n        int nextc = c-1;\n        if (compareAndSetState(c, nextc))\n            return nextc == 0;\n    }\n}\n```\n0false000\n> CountDownLatchAQS\n\n## countDown()\ndemo\n```java\npublic void countDown() {\n    sync.releaseShared(1);\n}\n```\nsync`releaseShared()`**1****AQS**`tryReleaseShared`\n```java\npublic final boolean releaseShared(int arg) {\n    if (tryReleaseShared(arg)) {\n        doReleaseShared();\n        return true;\n    }\n    return false;\n}\n```\n`tryReleaseShared`false0falsetrue\n\n## await()\ndemo\n```java\npublic void await() throws InterruptedException {\n    sync.acquireSharedInterruptibly(1);\n}\n```\n**1****AQS**\n```java\npublic final void acquireSharedInterruptibly(int arg)\n        throws InterruptedException {\n    if (Thread.interrupted())\n        throw new InterruptedException();\n    if (tryAcquireShared(arg) < 0)\n        doAcquireSharedInterruptibly(arg);\n}\n```\n0`(getState() == 0) ? 1 : -1`0100`doAcquireSharedInterruptibly()`volatilestate0\n\n## \n**AQS****AQS**","slug":"CountDownLatch","published":1,"updated":"2022-12-15T07:11:42.303Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwc000j8py0hdyh65fc","content":"<p>synchronizedCountDownLatch</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><p>CountDownLatch</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException </span>&#123;</span><br><span class=\"line\">    CountDownLatch countDownLatch = <span class=\"keyword\">new</span> CountDownLatch(<span class=\"number\">10</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Thread(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;\\tleave the room ....&quot;</span>);</span><br><span class=\"line\">            countDownLatch.countDown();</span><br><span class=\"line\">        &#125;, String.valueOf(i)).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    countDownLatch.await();</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;Ok, lock the door ...&quot;</span>);</span><br></pre></td></tr></table></figure>\n<p><code>await()</code><code>countDown()</code></p>\n<h2 id=\"Sync\"><a href=\"#Sync\" class=\"headerlink\" title=\"Sync\"></a>Sync</h2><p>CountDownLatch<code>Sync</code><br><strong>AQS</strong><strong>AQS</strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Sync(<span class=\"keyword\">int</span> count) &#123;</span><br><span class=\"line\">    setState(count);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>count</code>demo<strong>AQS</strong><code>setState</code>statestate<strong>volatile</strong></p>\n<h3 id=\"getCount\"><a href=\"#getCount\" class=\"headerlink\" title=\"getCount()\"></a>getCount()</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getCount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> getState();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>AQS</strong>state</p>\n<h3 id=\"tryAcquiredShared\"><a href=\"#tryAcquiredShared\" class=\"headerlink\" title=\"tryAcquiredShared()\"></a>tryAcquiredShared()</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">int</span> <span class=\"title\">tryAcquireShared</span><span class=\"params\">(<span class=\"keyword\">int</span> acquires)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (getState() == <span class=\"number\">0</span>) ? <span class=\"number\">1</span> : -<span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<h3 id=\"tryReleaseShared\"><a href=\"#tryReleaseShared\" class=\"headerlink\" title=\"tryReleaseShared()\"></a>tryReleaseShared()</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryReleaseShared</span><span class=\"params\">(<span class=\"keyword\">int</span> releases)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Decrement count; signal when transition to zero</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> c = getState();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (c == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> nextc = c-<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (compareAndSetState(c, nextc))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> nextc == <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>0false000</p>\n<blockquote>\n<p>CountDownLatchAQS</p>\n</blockquote>\n<h2 id=\"countDown\"><a href=\"#countDown\" class=\"headerlink\" title=\"countDown()\"></a>countDown()</h2><p>demo</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">countDown</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    sync.releaseShared(<span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>sync<code>releaseShared()</code><strong>1</strong><strong>AQS</strong><code>tryReleaseShared</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> <span class=\"title\">releaseShared</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tryReleaseShared(arg)) &#123;</span><br><span class=\"line\">        doReleaseShared();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>tryReleaseShared</code>false0falsetrue</p>\n<h2 id=\"await\"><a href=\"#await\" class=\"headerlink\" title=\"await()\"></a>await()</h2><p>demo</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">await</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException </span>&#123;</span><br><span class=\"line\">    sync.acquireSharedInterruptibly(<span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>1</strong><strong>AQS</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">acquireSharedInterruptibly</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> InterruptedException </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (Thread.interrupted())</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> InterruptedException();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tryAcquireShared(arg) &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        doAcquireSharedInterruptibly(arg);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>0<code>(getState() == 0) ? 1 : -1</code>0100<code>doAcquireSharedInterruptibly()</code>volatilestate0</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>AQS</strong><strong>AQS</strong></p>\n","site":{"data":{}},"excerpt":"<p>synchronizedCountDownLatch</p>","more":"<h2 id=\"Demo\"><a href=\"#Demo\" class=\"headerlink\" title=\"Demo\"></a>Demo</h2><p>CountDownLatch</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException </span>&#123;</span><br><span class=\"line\">    CountDownLatch countDownLatch = <span class=\"keyword\">new</span> CountDownLatch(<span class=\"number\">10</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Thread(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;\\tleave the room ....&quot;</span>);</span><br><span class=\"line\">            countDownLatch.countDown();</span><br><span class=\"line\">        &#125;, String.valueOf(i)).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    countDownLatch.await();</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;Ok, lock the door ...&quot;</span>);</span><br></pre></td></tr></table></figure>\n<p><code>await()</code><code>countDown()</code></p>\n<h2 id=\"Sync\"><a href=\"#Sync\" class=\"headerlink\" title=\"Sync\"></a>Sync</h2><p>CountDownLatch<code>Sync</code><br><strong>AQS</strong><strong>AQS</strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Sync(<span class=\"keyword\">int</span> count) &#123;</span><br><span class=\"line\">    setState(count);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>count</code>demo<strong>AQS</strong><code>setState</code>statestate<strong>volatile</strong></p>\n<h3 id=\"getCount\"><a href=\"#getCount\" class=\"headerlink\" title=\"getCount()\"></a>getCount()</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getCount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> getState();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>AQS</strong>state</p>\n<h3 id=\"tryAcquiredShared\"><a href=\"#tryAcquiredShared\" class=\"headerlink\" title=\"tryAcquiredShared()\"></a>tryAcquiredShared()</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">int</span> <span class=\"title\">tryAcquireShared</span><span class=\"params\">(<span class=\"keyword\">int</span> acquires)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (getState() == <span class=\"number\">0</span>) ? <span class=\"number\">1</span> : -<span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<h3 id=\"tryReleaseShared\"><a href=\"#tryReleaseShared\" class=\"headerlink\" title=\"tryReleaseShared()\"></a>tryReleaseShared()</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryReleaseShared</span><span class=\"params\">(<span class=\"keyword\">int</span> releases)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Decrement count; signal when transition to zero</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> c = getState();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (c == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> nextc = c-<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (compareAndSetState(c, nextc))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> nextc == <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>0false000</p>\n<blockquote>\n<p>CountDownLatchAQS</p>\n</blockquote>\n<h2 id=\"countDown\"><a href=\"#countDown\" class=\"headerlink\" title=\"countDown()\"></a>countDown()</h2><p>demo</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">countDown</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    sync.releaseShared(<span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>sync<code>releaseShared()</code><strong>1</strong><strong>AQS</strong><code>tryReleaseShared</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> <span class=\"title\">releaseShared</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tryReleaseShared(arg)) &#123;</span><br><span class=\"line\">        doReleaseShared();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>tryReleaseShared</code>false0falsetrue</p>\n<h2 id=\"await\"><a href=\"#await\" class=\"headerlink\" title=\"await()\"></a>await()</h2><p>demo</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">await</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException </span>&#123;</span><br><span class=\"line\">    sync.acquireSharedInterruptibly(<span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>1</strong><strong>AQS</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">acquireSharedInterruptibly</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> InterruptedException </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (Thread.interrupted())</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> InterruptedException();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tryAcquireShared(arg) &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        doAcquireSharedInterruptibly(arg);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>0<code>(getState() == 0) ? 1 : -1</code>0100<code>doAcquireSharedInterruptibly()</code>volatilestate0</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>AQS</strong><strong>AQS</strong></p>"},{"title":"Spring Security AutoConfiguration","date":"2021-03-22T14:18:10.000Z","_content":"\n        *Spring Security*SpringBootjar*@EnableWebSecurity*\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n        SpringBootxml_@Configuration__@EnableWebSecurity_\n\n```java\n@Retention(value = java.lang.annotation.RetentionPolicy.RUNTIME)\n@Target(value = { java.lang.annotation.ElementType.TYPE })\n@Documented\n@Import({ WebSecurityConfiguration.class,\n        SpringWebMvcImportSelector.class,\n        OAuth2ImportSelector.class })\n@EnableGlobalAuthentication\n@Configuration\npublic @interface EnableWebSecurity {\n\n    /**\n     * Controls debugging support for Spring Security. Default is false.\n     * @return if true, enables debug support with Spring Security\n     */\n    boolean debug() default false;\n}\n```\n\n`@Import(...)`class_Selector_Spring`@Import(...)`Selector_WebSecurityConfiguration_\n\n\n\n> Add this annotation to an @Configuration class to have the Spring Security configuration defined in any WebSecurityConfigurer or more likely by extending the WebSecurityConfigurerAdapter base class and overriding individual methods\n\n\n\n```java\n@EnableWebSecurity\n@Configuration\npublic class MyWebSecurityConfiguration extends WebSecurityConfigurerAdapter {\n\n    @Override\n    public void confugre(HttpSecurity httpSecurity){\n        // ....\n    }\n}\n```\n\n\n\n# \n\nSpring SecuritySpringSpringIoCbean\n\n> Uses a WebSecurity to create the FilterChainProxy that performs the web based security for Spring Security. It then exports the necessary beans. Customizations can be made to WebSecurity by extending WebSecurityConfigurerAdapter and exposing it as a Configuration or implementing WebSecurityConfigurer and exposing it as a Configuration. This configuration is imported when using EnableWebSecurity.\n\nweb\n\n## setFilterChainProxySecurityConfigurer\n\n```java\n@Autowired(required = false)\npublic void setFilterChainProxySecurityConfigurer(\n    // \n    ObjectPostProcessor<Object> objectPostProcessor,\n    // \n    @Value(\"#{@autowiredWebSecurityConfigurersIgnoreParents.getWebSecurityConfigurers()}\") List<SecurityConfigurer<Filter, WebSecurity>> webSecurityConfigurers)\n    throws Exception {\n    webSecurity = objectPostProcessor\n        .postProcess(new WebSecurity(objectPostProcessor));\n    if (debugEnabled != null) {\n        webSecurity.debug(debugEnabled);\n    }\n\n    webSecurityConfigurers.sort(AnnotationAwareOrderComparator.INSTANCE);\n\n    Integer previousOrder = null;\n    Object previousConfig = null;\n    for (SecurityConfigurer<Filter, WebSecurity> config : webSecurityConfigurers) {\n        Integer order = AnnotationAwareOrderComparator.lookupOrder(config);\n        if (previousOrder != null && previousOrder.equals(order)) {\n            throw new IllegalStateException(\n                \"@Order on WebSecurityConfigurers must be unique. Order of \"\n                + order + \" was already used on \" + previousConfig + \", so it cannot be used on \"\n                + config + \" too.\");\n        }\n        previousOrder = order;\n        previousConfig = config;\n    }\n    for (SecurityConfigurer<Filter, WebSecurity> webSecurityConfigurer : webSecurityConfigurers) {\n        // webSecurityConfigureswebSecurityapply\n        webSecurity.apply(webSecurityConfigurer);\n    }\n    // confugures\n    this.webSecurityConfigurers = webSecurityConfigurers;\n}\n```\n\n### getWebSecurityConfigurers\n\n`AutowiredWebSecurityConfigurersIgnoreParents`*getWebSecurityConfigurers*configures\n\n```java\npublic List<SecurityConfigurer<Filter, WebSecurity>> getWebSecurityConfigurers() {\n   List<SecurityConfigurer<Filter, WebSecurity>> webSecurityConfigurers = new ArrayList<>();\n   Map<String, WebSecurityConfigurer> beansOfType = beanFactory\n         .getBeansOfType(WebSecurityConfigurer.class);\n   for (Entry<String, WebSecurityConfigurer> entry : beansOfType.entrySet()) {\n      webSecurityConfigurers.add(entry.getValue());\n   }\n   return webSecurityConfigurers;\n}\n```\n\n### apply\n\napplywebSecurityconfigureswebSecurity\n\n```java\nprivate <C extends SecurityConfigurer<O, B>> void add(C configurer) {\n    // ...\n    synchronized (configurers) {\n        // ...\n        List<SecurityConfigurer<O, B>> configs = allowConfigurersOfSameType ? this.configurers\n            .get(clazz) : null;\n        if (configs == null) {\n            configs = new ArrayList<>(1);\n        }\n        configs.add(configurer);\n        // private final LinkedHashMap<Class<? extends SecurityConfigurer<O, B>>, List<SecurityConfigurer<O, B>>> configurers = new LinkedHashMap<>();\n        this.configurers.put(clazz, configs);\n        // ...\n    }\n}\n```\n\n***WebSecurityConfigurer*\n\n```java\npublic abstract class WebSecurityConfigurerAdapter implements WebSecurityConfigurer<WebSecurity> {\n    // ...\n}\n```\n\nconfigurer*getWebSecurityConfigurers*webSecurity\n\n## springSecurityFilterChain\n\n\n\n```java\n//     public static final String DEFAULT_FILTER_NAME = \"springSecurityFilterChain\";\n@Bean(name = AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME)\npublic Filter springSecurityFilterChain() throws Exception {\n    //  true\n    boolean hasConfigurers = webSecurityConfigurers != null\n        && !webSecurityConfigurers.isEmpty();\n    if (!hasConfigurers) {\n        // \n        WebSecurityConfigurerAdapter adapter = objectObjectPostProcessor\n            .postProcess(new WebSecurityConfigurerAdapter() {\n            });\n        // apply\n        webSecurity.apply(adapter);\n    }\n    //  build\n    return webSecurity.build();\n}\n```\n\ndemoconfigurehttpSecuritybuild\n\n```java\nprivate AtomicBoolean building = new AtomicBoolean();\n\npublic final O build() throws Exception {\n    // buildCAS\n    if (this.building.compareAndSet(false, true)) {\n        this.object = doBuild();\n        return this.object;\n    }\n    throw new AlreadyBuiltException(\"This object has already been built\");\n}\n```\n\n*doBuild()*SpringBootrefresh\n\n### init\n\nconfigurerWebSecurityAdapterinit\n\n```java\npublic void init(final WebSecurity web) throws Exception {\n    // httpSecurity\n    final HttpSecurity http = getHttp();\n    // webwebSecurityhttpSecurity\n    web.addSecurityFilterChainBuilder(http).postBuildAction(() -> {\n        FilterSecurityInterceptor securityInterceptor = http\n            .getSharedObject(FilterSecurityInterceptor.class);\n        web.securityInterceptor(securityInterceptor);\n    });\n}\n```\n\n#### getHttp\n\n```java\nprotected final HttpSecurity getHttp() throws Exception {\n   if (http != null) {\n      return http;\n   }\n\n   AuthenticationEventPublisher eventPublisher = getAuthenticationEventPublisher();\n   localConfigureAuthenticationBldr.authenticationEventPublisher(eventPublisher);\n\n   AuthenticationManager authenticationManager = authenticationManager();\n   authenticationBuilder.parentAuthenticationManager(authenticationManager);\n   Map<Class<?>, Object> sharedObjects = createSharedObjects();\n\n    // \n   http = new HttpSecurity(objectPostProcessor, authenticationBuilder,\n         sharedObjects);\n    //  \n   if (!disableDefaults) {\n      // @formatter:off\n      http\n         .csrf().and()\n         .addFilter(new WebAsyncManagerIntegrationFilter())\n         .exceptionHandling().and()\n         .headers().and()\n         .sessionManagement().and()\n         .securityContext().and()\n         .requestCache().and()\n         .anonymous().and()\n         .servletApi().and()\n         .apply(new DefaultLoginPageConfigurer<>()).and()\n         .logout();\n      // @formatter:on\n      ClassLoader classLoader = this.context.getClassLoader();\n      List<AbstractHttpConfigurer> defaultHttpConfigurers =\n            SpringFactoriesLoader.loadFactories(AbstractHttpConfigurer.class, classLoader);\n\n      for (AbstractHttpConfigurer configurer : defaultHttpConfigurers) {\n         http.apply(configurer);\n      }\n   }\n    // httpSecurity\n   configure(http);\n   return http;\n}\n```\n\nhttpSecurity*configure*demo*@EnableSpringSecurity**configure*httpSecurity\n\n# \n\nSpringSecurity","source":"_posts/Spring-Security-AutoConfiguration.md","raw":"---\ntitle: Spring Security AutoConfiguration\ndate: 2021-03-22 22:18:10\ncategories: springsecurity\ntags: autoconfiguration\n---\n\n        *Spring Security*SpringBootjar*@EnableWebSecurity*\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n        SpringBootxml_@Configuration__@EnableWebSecurity_\n\n```java\n@Retention(value = java.lang.annotation.RetentionPolicy.RUNTIME)\n@Target(value = { java.lang.annotation.ElementType.TYPE })\n@Documented\n@Import({ WebSecurityConfiguration.class,\n        SpringWebMvcImportSelector.class,\n        OAuth2ImportSelector.class })\n@EnableGlobalAuthentication\n@Configuration\npublic @interface EnableWebSecurity {\n\n    /**\n     * Controls debugging support for Spring Security. Default is false.\n     * @return if true, enables debug support with Spring Security\n     */\n    boolean debug() default false;\n}\n```\n\n`@Import(...)`class_Selector_Spring`@Import(...)`Selector_WebSecurityConfiguration_\n\n\n\n> Add this annotation to an @Configuration class to have the Spring Security configuration defined in any WebSecurityConfigurer or more likely by extending the WebSecurityConfigurerAdapter base class and overriding individual methods\n\n\n\n```java\n@EnableWebSecurity\n@Configuration\npublic class MyWebSecurityConfiguration extends WebSecurityConfigurerAdapter {\n\n    @Override\n    public void confugre(HttpSecurity httpSecurity){\n        // ....\n    }\n}\n```\n\n\n\n# \n\nSpring SecuritySpringSpringIoCbean\n\n> Uses a WebSecurity to create the FilterChainProxy that performs the web based security for Spring Security. It then exports the necessary beans. Customizations can be made to WebSecurity by extending WebSecurityConfigurerAdapter and exposing it as a Configuration or implementing WebSecurityConfigurer and exposing it as a Configuration. This configuration is imported when using EnableWebSecurity.\n\nweb\n\n## setFilterChainProxySecurityConfigurer\n\n```java\n@Autowired(required = false)\npublic void setFilterChainProxySecurityConfigurer(\n    // \n    ObjectPostProcessor<Object> objectPostProcessor,\n    // \n    @Value(\"#{@autowiredWebSecurityConfigurersIgnoreParents.getWebSecurityConfigurers()}\") List<SecurityConfigurer<Filter, WebSecurity>> webSecurityConfigurers)\n    throws Exception {\n    webSecurity = objectPostProcessor\n        .postProcess(new WebSecurity(objectPostProcessor));\n    if (debugEnabled != null) {\n        webSecurity.debug(debugEnabled);\n    }\n\n    webSecurityConfigurers.sort(AnnotationAwareOrderComparator.INSTANCE);\n\n    Integer previousOrder = null;\n    Object previousConfig = null;\n    for (SecurityConfigurer<Filter, WebSecurity> config : webSecurityConfigurers) {\n        Integer order = AnnotationAwareOrderComparator.lookupOrder(config);\n        if (previousOrder != null && previousOrder.equals(order)) {\n            throw new IllegalStateException(\n                \"@Order on WebSecurityConfigurers must be unique. Order of \"\n                + order + \" was already used on \" + previousConfig + \", so it cannot be used on \"\n                + config + \" too.\");\n        }\n        previousOrder = order;\n        previousConfig = config;\n    }\n    for (SecurityConfigurer<Filter, WebSecurity> webSecurityConfigurer : webSecurityConfigurers) {\n        // webSecurityConfigureswebSecurityapply\n        webSecurity.apply(webSecurityConfigurer);\n    }\n    // confugures\n    this.webSecurityConfigurers = webSecurityConfigurers;\n}\n```\n\n### getWebSecurityConfigurers\n\n`AutowiredWebSecurityConfigurersIgnoreParents`*getWebSecurityConfigurers*configures\n\n```java\npublic List<SecurityConfigurer<Filter, WebSecurity>> getWebSecurityConfigurers() {\n   List<SecurityConfigurer<Filter, WebSecurity>> webSecurityConfigurers = new ArrayList<>();\n   Map<String, WebSecurityConfigurer> beansOfType = beanFactory\n         .getBeansOfType(WebSecurityConfigurer.class);\n   for (Entry<String, WebSecurityConfigurer> entry : beansOfType.entrySet()) {\n      webSecurityConfigurers.add(entry.getValue());\n   }\n   return webSecurityConfigurers;\n}\n```\n\n### apply\n\napplywebSecurityconfigureswebSecurity\n\n```java\nprivate <C extends SecurityConfigurer<O, B>> void add(C configurer) {\n    // ...\n    synchronized (configurers) {\n        // ...\n        List<SecurityConfigurer<O, B>> configs = allowConfigurersOfSameType ? this.configurers\n            .get(clazz) : null;\n        if (configs == null) {\n            configs = new ArrayList<>(1);\n        }\n        configs.add(configurer);\n        // private final LinkedHashMap<Class<? extends SecurityConfigurer<O, B>>, List<SecurityConfigurer<O, B>>> configurers = new LinkedHashMap<>();\n        this.configurers.put(clazz, configs);\n        // ...\n    }\n}\n```\n\n***WebSecurityConfigurer*\n\n```java\npublic abstract class WebSecurityConfigurerAdapter implements WebSecurityConfigurer<WebSecurity> {\n    // ...\n}\n```\n\nconfigurer*getWebSecurityConfigurers*webSecurity\n\n## springSecurityFilterChain\n\n\n\n```java\n//     public static final String DEFAULT_FILTER_NAME = \"springSecurityFilterChain\";\n@Bean(name = AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME)\npublic Filter springSecurityFilterChain() throws Exception {\n    //  true\n    boolean hasConfigurers = webSecurityConfigurers != null\n        && !webSecurityConfigurers.isEmpty();\n    if (!hasConfigurers) {\n        // \n        WebSecurityConfigurerAdapter adapter = objectObjectPostProcessor\n            .postProcess(new WebSecurityConfigurerAdapter() {\n            });\n        // apply\n        webSecurity.apply(adapter);\n    }\n    //  build\n    return webSecurity.build();\n}\n```\n\ndemoconfigurehttpSecuritybuild\n\n```java\nprivate AtomicBoolean building = new AtomicBoolean();\n\npublic final O build() throws Exception {\n    // buildCAS\n    if (this.building.compareAndSet(false, true)) {\n        this.object = doBuild();\n        return this.object;\n    }\n    throw new AlreadyBuiltException(\"This object has already been built\");\n}\n```\n\n*doBuild()*SpringBootrefresh\n\n### init\n\nconfigurerWebSecurityAdapterinit\n\n```java\npublic void init(final WebSecurity web) throws Exception {\n    // httpSecurity\n    final HttpSecurity http = getHttp();\n    // webwebSecurityhttpSecurity\n    web.addSecurityFilterChainBuilder(http).postBuildAction(() -> {\n        FilterSecurityInterceptor securityInterceptor = http\n            .getSharedObject(FilterSecurityInterceptor.class);\n        web.securityInterceptor(securityInterceptor);\n    });\n}\n```\n\n#### getHttp\n\n```java\nprotected final HttpSecurity getHttp() throws Exception {\n   if (http != null) {\n      return http;\n   }\n\n   AuthenticationEventPublisher eventPublisher = getAuthenticationEventPublisher();\n   localConfigureAuthenticationBldr.authenticationEventPublisher(eventPublisher);\n\n   AuthenticationManager authenticationManager = authenticationManager();\n   authenticationBuilder.parentAuthenticationManager(authenticationManager);\n   Map<Class<?>, Object> sharedObjects = createSharedObjects();\n\n    // \n   http = new HttpSecurity(objectPostProcessor, authenticationBuilder,\n         sharedObjects);\n    //  \n   if (!disableDefaults) {\n      // @formatter:off\n      http\n         .csrf().and()\n         .addFilter(new WebAsyncManagerIntegrationFilter())\n         .exceptionHandling().and()\n         .headers().and()\n         .sessionManagement().and()\n         .securityContext().and()\n         .requestCache().and()\n         .anonymous().and()\n         .servletApi().and()\n         .apply(new DefaultLoginPageConfigurer<>()).and()\n         .logout();\n      // @formatter:on\n      ClassLoader classLoader = this.context.getClassLoader();\n      List<AbstractHttpConfigurer> defaultHttpConfigurers =\n            SpringFactoriesLoader.loadFactories(AbstractHttpConfigurer.class, classLoader);\n\n      for (AbstractHttpConfigurer configurer : defaultHttpConfigurers) {\n         http.apply(configurer);\n      }\n   }\n    // httpSecurity\n   configure(http);\n   return http;\n}\n```\n\nhttpSecurity*configure*demo*@EnableSpringSecurity**configure*httpSecurity\n\n# \n\nSpringSecurity","slug":"Spring-Security-AutoConfiguration","published":1,"updated":"2022-12-09T14:46:05.954Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwc000o8py04dcn8r3n","content":"<p>        <em>Spring Security</em>SpringBootjar*@EnableWebSecurity*</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        SpringBootxml_@Configuration__@EnableWebSecurity_</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention(value = java.lang.annotation.RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Target(value = &#123; java.lang.annotation.ElementType.TYPE &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Import(&#123; WebSecurityConfiguration.class,</span></span><br><span class=\"line\"><span class=\"meta\">        SpringWebMvcImportSelector.class,</span></span><br><span class=\"line\"><span class=\"meta\">        OAuth2ImportSelector.class &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@EnableGlobalAuthentication</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> EnableWebSecurity &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Controls debugging support for Spring Security. Default is false.</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> if true, enables debug support with Spring Security</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">debug</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"keyword\">false</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Import(...)</code>class_Selector_Spring<code>@Import(...)</code>Selector_WebSecurityConfiguration_</p>\n<p></p>\n<blockquote>\n<p>Add this annotation to an @Configuration class to have the Spring Security configuration defined in any WebSecurityConfigurer or more likely by extending the WebSecurityConfigurerAdapter base class and overriding individual methods</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableWebSecurity</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyWebSecurityConfiguration</span> <span class=\"keyword\">extends</span> <span class=\"title\">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">confugre</span><span class=\"params\">(HttpSecurity httpSecurity)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ....</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring SecuritySpringSpringIoCbean</p>\n<blockquote>\n<p>Uses a WebSecurity to create the FilterChainProxy that performs the web based security for Spring Security. It then exports the necessary beans. Customizations can be made to WebSecurity by extending WebSecurityConfigurerAdapter and exposing it as a Configuration or implementing WebSecurityConfigurer and exposing it as a Configuration. This configuration is imported when using EnableWebSecurity.</p>\n</blockquote>\n<p>web</p>\n<h2 id=\"setFilterChainProxySecurityConfigurer\"><a href=\"#setFilterChainProxySecurityConfigurer\" class=\"headerlink\" title=\"setFilterChainProxySecurityConfigurer\"></a>setFilterChainProxySecurityConfigurer</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired(required = false)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setFilterChainProxySecurityConfigurer</span><span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    // </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    ObjectPostProcessor&lt;Object&gt; objectPostProcessor,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    // </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    <span class=\"meta\">@Value(&quot;#&#123;@autowiredWebSecurityConfigurersIgnoreParents.getWebSecurityConfigurers()&#125;&quot;)</span> List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; webSecurityConfigurers)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    webSecurity = objectPostProcessor</span><br><span class=\"line\">        .postProcess(<span class=\"keyword\">new</span> WebSecurity(objectPostProcessor));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (debugEnabled != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        webSecurity.debug(debugEnabled);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    webSecurityConfigurers.sort(AnnotationAwareOrderComparator.INSTANCE);</span><br><span class=\"line\"></span><br><span class=\"line\">    Integer previousOrder = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Object previousConfig = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (SecurityConfigurer&lt;Filter, WebSecurity&gt; config : webSecurityConfigurers) &#123;</span><br><span class=\"line\">        Integer order = AnnotationAwareOrderComparator.lookupOrder(config);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (previousOrder != <span class=\"keyword\">null</span> &amp;&amp; previousOrder.equals(order)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(</span><br><span class=\"line\">                <span class=\"string\">&quot;@Order on WebSecurityConfigurers must be unique. Order of &quot;</span></span><br><span class=\"line\">                + order + <span class=\"string\">&quot; was already used on &quot;</span> + previousConfig + <span class=\"string\">&quot;, so it cannot be used on &quot;</span></span><br><span class=\"line\">                + config + <span class=\"string\">&quot; too.&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        previousOrder = order;</span><br><span class=\"line\">        previousConfig = config;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (SecurityConfigurer&lt;Filter, WebSecurity&gt; webSecurityConfigurer : webSecurityConfigurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// webSecurityConfigureswebSecurityapply</span></span><br><span class=\"line\">        webSecurity.apply(webSecurityConfigurer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// confugures</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.webSecurityConfigurers = webSecurityConfigurers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"getWebSecurityConfigurers\"><a href=\"#getWebSecurityConfigurers\" class=\"headerlink\" title=\"getWebSecurityConfigurers\"></a>getWebSecurityConfigurers</h3><p><code>AutowiredWebSecurityConfigurersIgnoreParents</code><em>getWebSecurityConfigurers</em>configures</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; getWebSecurityConfigurers() &#123;</span><br><span class=\"line\">   List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; webSecurityConfigurers = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">   Map&lt;String, WebSecurityConfigurer&gt; beansOfType = beanFactory</span><br><span class=\"line\">         .getBeansOfType(WebSecurityConfigurer.class);</span><br><span class=\"line\">   <span class=\"keyword\">for</span> (Entry&lt;String, WebSecurityConfigurer&gt; entry : beansOfType.entrySet()) &#123;</span><br><span class=\"line\">      webSecurityConfigurers.add(entry.getValue());</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">return</span> webSecurityConfigurers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"apply\"><a href=\"#apply\" class=\"headerlink\" title=\"apply\"></a>apply</h3><p>applywebSecurityconfigureswebSecurity</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> &lt;C extends SecurityConfigurer&lt;O, B&gt;&gt; <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(C configurer)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (configurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">        List&lt;SecurityConfigurer&lt;O, B&gt;&gt; configs = allowConfigurersOfSameType ? <span class=\"keyword\">this</span>.configurers</span><br><span class=\"line\">            .get(clazz) : <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (configs == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            configs = <span class=\"keyword\">new</span> ArrayList&lt;&gt;(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        configs.add(configurer);</span><br><span class=\"line\">        <span class=\"comment\">// private final LinkedHashMap&lt;Class&lt;? extends SecurityConfigurer&lt;O, B&gt;&gt;, List&lt;SecurityConfigurer&lt;O, B&gt;&gt;&gt; configurers = new LinkedHashMap&lt;&gt;();</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.configurers.put(clazz, configs);</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em></em><em>WebSecurityConfigurer</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WebSecurityConfigurerAdapter</span> <span class=\"keyword\">implements</span> <span class=\"title\">WebSecurityConfigurer</span>&lt;<span class=\"title\">WebSecurity</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>configurer<em>getWebSecurityConfigurers</em>webSecurity</p>\n<h2 id=\"springSecurityFilterChain\"><a href=\"#springSecurityFilterChain\" class=\"headerlink\" title=\"springSecurityFilterChain\"></a>springSecurityFilterChain</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//     public static final String DEFAULT_FILTER_NAME = &quot;springSecurityFilterChain&quot;;</span></span><br><span class=\"line\"><span class=\"meta\">@Bean(name = AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Filter <span class=\"title\">springSecurityFilterChain</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//  true</span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> hasConfigurers = webSecurityConfigurers != <span class=\"keyword\">null</span></span><br><span class=\"line\">        &amp;&amp; !webSecurityConfigurers.isEmpty();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!hasConfigurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        WebSecurityConfigurerAdapter adapter = objectObjectPostProcessor</span><br><span class=\"line\">            .postProcess(<span class=\"keyword\">new</span> WebSecurityConfigurerAdapter() &#123;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        <span class=\"comment\">// apply</span></span><br><span class=\"line\">        webSecurity.apply(adapter);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  build</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> webSecurity.build();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>democonfigurehttpSecuritybuild</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> AtomicBoolean building = <span class=\"keyword\">new</span> AtomicBoolean();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> O <span class=\"title\">build</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// buildCAS</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.building.compareAndSet(<span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.object = doBuild();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.object;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> AlreadyBuiltException(<span class=\"string\">&quot;This object has already been built&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>*doBuild()*SpringBootrefresh</p>\n<h3 id=\"init\"><a href=\"#init\" class=\"headerlink\" title=\"init\"></a>init</h3><p>configurerWebSecurityAdapterinit</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"keyword\">final</span> WebSecurity web)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// httpSecurity</span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> HttpSecurity http = getHttp();</span><br><span class=\"line\">    <span class=\"comment\">// webwebSecurityhttpSecurity</span></span><br><span class=\"line\">    web.addSecurityFilterChainBuilder(http).postBuildAction(() -&gt; &#123;</span><br><span class=\"line\">        FilterSecurityInterceptor securityInterceptor = http</span><br><span class=\"line\">            .getSharedObject(FilterSecurityInterceptor.class);</span><br><span class=\"line\">        web.securityInterceptor(securityInterceptor);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getHttp\"><a href=\"#getHttp\" class=\"headerlink\" title=\"getHttp\"></a>getHttp</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> HttpSecurity <span class=\"title\">getHttp</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (http != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> http;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   AuthenticationEventPublisher eventPublisher = getAuthenticationEventPublisher();</span><br><span class=\"line\">   localConfigureAuthenticationBldr.authenticationEventPublisher(eventPublisher);</span><br><span class=\"line\"></span><br><span class=\"line\">   AuthenticationManager authenticationManager = authenticationManager();</span><br><span class=\"line\">   authenticationBuilder.parentAuthenticationManager(authenticationManager);</span><br><span class=\"line\">   Map&lt;Class&lt;?&gt;, Object&gt; sharedObjects = createSharedObjects();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">   http = <span class=\"keyword\">new</span> HttpSecurity(objectPostProcessor, authenticationBuilder,</span><br><span class=\"line\">         sharedObjects);</span><br><span class=\"line\">    <span class=\"comment\">//  </span></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!disableDefaults) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// @formatter:off</span></span><br><span class=\"line\">      http</span><br><span class=\"line\">         .csrf().and()</span><br><span class=\"line\">         .addFilter(<span class=\"keyword\">new</span> WebAsyncManagerIntegrationFilter())</span><br><span class=\"line\">         .exceptionHandling().and()</span><br><span class=\"line\">         .headers().and()</span><br><span class=\"line\">         .sessionManagement().and()</span><br><span class=\"line\">         .securityContext().and()</span><br><span class=\"line\">         .requestCache().and()</span><br><span class=\"line\">         .anonymous().and()</span><br><span class=\"line\">         .servletApi().and()</span><br><span class=\"line\">         .apply(<span class=\"keyword\">new</span> DefaultLoginPageConfigurer&lt;&gt;()).and()</span><br><span class=\"line\">         .logout();</span><br><span class=\"line\">      <span class=\"comment\">// @formatter:on</span></span><br><span class=\"line\">      ClassLoader classLoader = <span class=\"keyword\">this</span>.context.getClassLoader();</span><br><span class=\"line\">      List&lt;AbstractHttpConfigurer&gt; defaultHttpConfigurers =</span><br><span class=\"line\">            SpringFactoriesLoader.loadFactories(AbstractHttpConfigurer.class, classLoader);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">for</span> (AbstractHttpConfigurer configurer : defaultHttpConfigurers) &#123;</span><br><span class=\"line\">         http.apply(configurer);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">    <span class=\"comment\">// httpSecurity</span></span><br><span class=\"line\">   configure(http);</span><br><span class=\"line\">   <span class=\"keyword\">return</span> http;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>httpSecurity<em>configure</em>demo*@EnableSpringSecurity<em></em>configure*httpSecurity</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringSecurity</p>\n","site":{"data":{}},"excerpt":"<p>        <em>Spring Security</em>SpringBootjar*@EnableWebSecurity*</p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        SpringBootxml_@Configuration__@EnableWebSecurity_</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention(value = java.lang.annotation.RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Target(value = &#123; java.lang.annotation.ElementType.TYPE &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Import(&#123; WebSecurityConfiguration.class,</span></span><br><span class=\"line\"><span class=\"meta\">        SpringWebMvcImportSelector.class,</span></span><br><span class=\"line\"><span class=\"meta\">        OAuth2ImportSelector.class &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@EnableGlobalAuthentication</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> EnableWebSecurity &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Controls debugging support for Spring Security. Default is false.</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> if true, enables debug support with Spring Security</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">debug</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"keyword\">false</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Import(...)</code>class_Selector_Spring<code>@Import(...)</code>Selector_WebSecurityConfiguration_</p>\n<p></p>\n<blockquote>\n<p>Add this annotation to an @Configuration class to have the Spring Security configuration defined in any WebSecurityConfigurer or more likely by extending the WebSecurityConfigurerAdapter base class and overriding individual methods</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableWebSecurity</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyWebSecurityConfiguration</span> <span class=\"keyword\">extends</span> <span class=\"title\">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">confugre</span><span class=\"params\">(HttpSecurity httpSecurity)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ....</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring SecuritySpringSpringIoCbean</p>\n<blockquote>\n<p>Uses a WebSecurity to create the FilterChainProxy that performs the web based security for Spring Security. It then exports the necessary beans. Customizations can be made to WebSecurity by extending WebSecurityConfigurerAdapter and exposing it as a Configuration or implementing WebSecurityConfigurer and exposing it as a Configuration. This configuration is imported when using EnableWebSecurity.</p>\n</blockquote>\n<p>web</p>\n<h2 id=\"setFilterChainProxySecurityConfigurer\"><a href=\"#setFilterChainProxySecurityConfigurer\" class=\"headerlink\" title=\"setFilterChainProxySecurityConfigurer\"></a>setFilterChainProxySecurityConfigurer</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired(required = false)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setFilterChainProxySecurityConfigurer</span><span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    // </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    ObjectPostProcessor&lt;Object&gt; objectPostProcessor,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    // </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">    <span class=\"meta\">@Value(&quot;#&#123;@autowiredWebSecurityConfigurersIgnoreParents.getWebSecurityConfigurers()&#125;&quot;)</span> List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; webSecurityConfigurers)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    webSecurity = objectPostProcessor</span><br><span class=\"line\">        .postProcess(<span class=\"keyword\">new</span> WebSecurity(objectPostProcessor));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (debugEnabled != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        webSecurity.debug(debugEnabled);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    webSecurityConfigurers.sort(AnnotationAwareOrderComparator.INSTANCE);</span><br><span class=\"line\"></span><br><span class=\"line\">    Integer previousOrder = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Object previousConfig = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (SecurityConfigurer&lt;Filter, WebSecurity&gt; config : webSecurityConfigurers) &#123;</span><br><span class=\"line\">        Integer order = AnnotationAwareOrderComparator.lookupOrder(config);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (previousOrder != <span class=\"keyword\">null</span> &amp;&amp; previousOrder.equals(order)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(</span><br><span class=\"line\">                <span class=\"string\">&quot;@Order on WebSecurityConfigurers must be unique. Order of &quot;</span></span><br><span class=\"line\">                + order + <span class=\"string\">&quot; was already used on &quot;</span> + previousConfig + <span class=\"string\">&quot;, so it cannot be used on &quot;</span></span><br><span class=\"line\">                + config + <span class=\"string\">&quot; too.&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        previousOrder = order;</span><br><span class=\"line\">        previousConfig = config;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (SecurityConfigurer&lt;Filter, WebSecurity&gt; webSecurityConfigurer : webSecurityConfigurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// webSecurityConfigureswebSecurityapply</span></span><br><span class=\"line\">        webSecurity.apply(webSecurityConfigurer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// confugures</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.webSecurityConfigurers = webSecurityConfigurers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"getWebSecurityConfigurers\"><a href=\"#getWebSecurityConfigurers\" class=\"headerlink\" title=\"getWebSecurityConfigurers\"></a>getWebSecurityConfigurers</h3><p><code>AutowiredWebSecurityConfigurersIgnoreParents</code><em>getWebSecurityConfigurers</em>configures</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; getWebSecurityConfigurers() &#123;</span><br><span class=\"line\">   List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; webSecurityConfigurers = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">   Map&lt;String, WebSecurityConfigurer&gt; beansOfType = beanFactory</span><br><span class=\"line\">         .getBeansOfType(WebSecurityConfigurer.class);</span><br><span class=\"line\">   <span class=\"keyword\">for</span> (Entry&lt;String, WebSecurityConfigurer&gt; entry : beansOfType.entrySet()) &#123;</span><br><span class=\"line\">      webSecurityConfigurers.add(entry.getValue());</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">return</span> webSecurityConfigurers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"apply\"><a href=\"#apply\" class=\"headerlink\" title=\"apply\"></a>apply</h3><p>applywebSecurityconfigureswebSecurity</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> &lt;C extends SecurityConfigurer&lt;O, B&gt;&gt; <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(C configurer)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (configurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">        List&lt;SecurityConfigurer&lt;O, B&gt;&gt; configs = allowConfigurersOfSameType ? <span class=\"keyword\">this</span>.configurers</span><br><span class=\"line\">            .get(clazz) : <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (configs == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            configs = <span class=\"keyword\">new</span> ArrayList&lt;&gt;(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        configs.add(configurer);</span><br><span class=\"line\">        <span class=\"comment\">// private final LinkedHashMap&lt;Class&lt;? extends SecurityConfigurer&lt;O, B&gt;&gt;, List&lt;SecurityConfigurer&lt;O, B&gt;&gt;&gt; configurers = new LinkedHashMap&lt;&gt;();</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.configurers.put(clazz, configs);</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em></em><em>WebSecurityConfigurer</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WebSecurityConfigurerAdapter</span> <span class=\"keyword\">implements</span> <span class=\"title\">WebSecurityConfigurer</span>&lt;<span class=\"title\">WebSecurity</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>configurer<em>getWebSecurityConfigurers</em>webSecurity</p>\n<h2 id=\"springSecurityFilterChain\"><a href=\"#springSecurityFilterChain\" class=\"headerlink\" title=\"springSecurityFilterChain\"></a>springSecurityFilterChain</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//     public static final String DEFAULT_FILTER_NAME = &quot;springSecurityFilterChain&quot;;</span></span><br><span class=\"line\"><span class=\"meta\">@Bean(name = AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Filter <span class=\"title\">springSecurityFilterChain</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//  true</span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> hasConfigurers = webSecurityConfigurers != <span class=\"keyword\">null</span></span><br><span class=\"line\">        &amp;&amp; !webSecurityConfigurers.isEmpty();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!hasConfigurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        WebSecurityConfigurerAdapter adapter = objectObjectPostProcessor</span><br><span class=\"line\">            .postProcess(<span class=\"keyword\">new</span> WebSecurityConfigurerAdapter() &#123;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        <span class=\"comment\">// apply</span></span><br><span class=\"line\">        webSecurity.apply(adapter);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  build</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> webSecurity.build();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>democonfigurehttpSecuritybuild</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> AtomicBoolean building = <span class=\"keyword\">new</span> AtomicBoolean();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> O <span class=\"title\">build</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// buildCAS</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.building.compareAndSet(<span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.object = doBuild();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.object;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> AlreadyBuiltException(<span class=\"string\">&quot;This object has already been built&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>*doBuild()*SpringBootrefresh</p>\n<h3 id=\"init\"><a href=\"#init\" class=\"headerlink\" title=\"init\"></a>init</h3><p>configurerWebSecurityAdapterinit</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"keyword\">final</span> WebSecurity web)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// httpSecurity</span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> HttpSecurity http = getHttp();</span><br><span class=\"line\">    <span class=\"comment\">// webwebSecurityhttpSecurity</span></span><br><span class=\"line\">    web.addSecurityFilterChainBuilder(http).postBuildAction(() -&gt; &#123;</span><br><span class=\"line\">        FilterSecurityInterceptor securityInterceptor = http</span><br><span class=\"line\">            .getSharedObject(FilterSecurityInterceptor.class);</span><br><span class=\"line\">        web.securityInterceptor(securityInterceptor);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getHttp\"><a href=\"#getHttp\" class=\"headerlink\" title=\"getHttp\"></a>getHttp</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> HttpSecurity <span class=\"title\">getHttp</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (http != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> http;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   AuthenticationEventPublisher eventPublisher = getAuthenticationEventPublisher();</span><br><span class=\"line\">   localConfigureAuthenticationBldr.authenticationEventPublisher(eventPublisher);</span><br><span class=\"line\"></span><br><span class=\"line\">   AuthenticationManager authenticationManager = authenticationManager();</span><br><span class=\"line\">   authenticationBuilder.parentAuthenticationManager(authenticationManager);</span><br><span class=\"line\">   Map&lt;Class&lt;?&gt;, Object&gt; sharedObjects = createSharedObjects();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">   http = <span class=\"keyword\">new</span> HttpSecurity(objectPostProcessor, authenticationBuilder,</span><br><span class=\"line\">         sharedObjects);</span><br><span class=\"line\">    <span class=\"comment\">//  </span></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!disableDefaults) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// @formatter:off</span></span><br><span class=\"line\">      http</span><br><span class=\"line\">         .csrf().and()</span><br><span class=\"line\">         .addFilter(<span class=\"keyword\">new</span> WebAsyncManagerIntegrationFilter())</span><br><span class=\"line\">         .exceptionHandling().and()</span><br><span class=\"line\">         .headers().and()</span><br><span class=\"line\">         .sessionManagement().and()</span><br><span class=\"line\">         .securityContext().and()</span><br><span class=\"line\">         .requestCache().and()</span><br><span class=\"line\">         .anonymous().and()</span><br><span class=\"line\">         .servletApi().and()</span><br><span class=\"line\">         .apply(<span class=\"keyword\">new</span> DefaultLoginPageConfigurer&lt;&gt;()).and()</span><br><span class=\"line\">         .logout();</span><br><span class=\"line\">      <span class=\"comment\">// @formatter:on</span></span><br><span class=\"line\">      ClassLoader classLoader = <span class=\"keyword\">this</span>.context.getClassLoader();</span><br><span class=\"line\">      List&lt;AbstractHttpConfigurer&gt; defaultHttpConfigurers =</span><br><span class=\"line\">            SpringFactoriesLoader.loadFactories(AbstractHttpConfigurer.class, classLoader);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">for</span> (AbstractHttpConfigurer configurer : defaultHttpConfigurers) &#123;</span><br><span class=\"line\">         http.apply(configurer);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">    <span class=\"comment\">// httpSecurity</span></span><br><span class=\"line\">   configure(http);</span><br><span class=\"line\">   <span class=\"keyword\">return</span> http;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>httpSecurity<em>configure</em>demo*@EnableSpringSecurity<em></em>configure*httpSecurity</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringSecurity</p>"},{"title":"SpringBoot environment","date":"2021-02-15T08:19:17.000Z","_content":"\n        SpringBootSpringBootymlproperties\n\n<!--more-->\n\n<!--toc-->\n\nSpringBootSpringApplicationrunrun\n\n```java\nprivate ConfigurableEnvironment prepareEnvironment(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments) {\n    // \n    ConfigurableEnvironment environment = getOrCreateEnvironment();\n    configureEnvironment(environment, applicationArguments.getSourceArgs());\n    ConfigurationPropertySources.attach(environment);\n    listeners.environmentPrepared(environment);\n    bindToSpringApplication(environment);\n    if (!this.isCustomEnvironment) {\n        environment = new EnvironmentConverter(getClassLoader()).convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());\n    }\n    ConfigurationPropertySources.attach(environment);\n    return environment;\n}\n```\n\n\n\n# \n\n`getOrCreateEnvironment`***Servlet* *REACTIVE*`ConfigurableEnvironment`\n\n```java\nvoid setActiveProfiles(String... profiles);\n\nvoid addActiveProfile(String profile);\n\nvoid setDefaultProfiles(String... profiles);\n\nMutablePropertySources getPropertySources();\n\nMap<String, Object> getSystemProperties();\n\nMap<String, Object> getSystemEnvironment();\n\nvoid merge(ConfigurableEnvironment parent);\n```\n\nprofilepropertymap\n\n# \n\n`property``profile`profile\n\nConfigurationPropertySourcesattach \n\n```java\nprivate static final String ATTACHED_PROPERTY_SOURCE_NAME = \"configurationProperties\";\n```\n\nenvironmentpropertySourceMutablePropertySource*CopyOnWriteArrayList*PropertySource\n\neventlistenerlistener `ConfigFileApplicationListener`\n\n```java\nprivate void onApplicationEnvironmentPreparedEvent(ApplicationEnvironmentPreparedEvent event) {\n    List<EnvironmentPostProcessor> postProcessors = loadPostProcessors();\n    // listenerEnvironmentPostProcessor\n    postProcessors.add(this);\n    AnnotationAwareOrderComparator.sort(postProcessors);\n    for (EnvironmentPostProcessor postProcessor : postProcessors) {\n        postProcessor.postProcessEnvironment(event.getEnvironment(), event.getSpringApplication());\n    }\n}\n```\n\n\n\n```java\nList<EnvironmentPostProcessor> loadPostProcessors() {\n    // \n    return SpringFactoriesLoader.loadFactories(EnvironmentPostProcessor.class, getClass().getClassLoader());\n}\n```\n\n```properties\n# Environment Post Processors\norg.springframework.boot.env.EnvironmentPostProcessor=\\\norg.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\\norg.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\\\norg.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\\\norg.springframework.boot.reactor.DebugAgentEnvironmentPostProcessor\n```\n\nlistenerprocessorprocessor\n\n## Load\n\n\n\n```java\nprotected void addPropertySources(ConfigurableEnvironment environment, ResourceLoader resourceLoader) {\n    RandomValuePropertySource.addToEnvironment(environment);\n    // loaderload\n    new Loader(environment, resourceLoader).load();\n}\n```\n\n```java\nprivate static final Set<String> LOAD_FILTERED_PROPERTY;\n\nstatic {\n    Set<String> filteredProperties = new HashSet<>();\n    filteredProperties.add(\"spring.profiles.active\");\n    filteredProperties.add(\"spring.profiles.include\");\n    LOAD_FILTERED_PROPERTY = Collections.unmodifiableSet(filteredProperties);\n}\nvoid load() {\n    // defaultProperties\n    FilteredPropertySource.apply(this.environment, DEFAULT_PROPERTIES, LOAD_FILTERED_PROPERTY,\n                                 (defaultProperties) -> {\n                                     this.profiles = new LinkedList<>();\n                                     this.processedProfiles = new LinkedList<>();\n                                     this.activatedProfiles = false;\n                                     this.loaded = new LinkedHashMap<>();\n                                     initializeProfiles();\n                                     while (!this.profiles.isEmpty()) {\n                                         Profile profile = this.profiles.poll();\n                                         if (isDefaultProfile(profile)) {\n                                             addProfileToEnvironment(profile.getName());\n                                         }\n                                         // load\n                                         load(profile, this::getPositiveProfileFilter,\n                                              addToLoaded(MutablePropertySources::addLast, false));\n                                         this.processedProfiles.add(profile);\n                                     }\n                                     // load\n                                     load(null, this::getNegativeProfileFilter, addToLoaded(MutablePropertySources::addFirst, true));\n                                     addLoadedPropertySources();\n                                     applyActiveProfiles(defaultProperties);\n                                 });\n```\n\nlambdaapplyconsumerlistenerpropertiesymlloadload*propertySourceLoaders*loaderloadpropertySourceLoader`PropertiesPropertySourceLoader``YamlPropertySourceLoader`\n\n## \n\npostprocessorprocessorSPIMETA-INFspring.factorieskey`EnvironmentPostProcessor`","source":"_posts/SpringBoot-environment.md","raw":"---\ntitle: SpringBoot environment\ndate: 2021-02-15 16:19:17\ncategories: springboot\ntags: environment\n---\n\n        SpringBootSpringBootymlproperties\n\n<!--more-->\n\n<!--toc-->\n\nSpringBootSpringApplicationrunrun\n\n```java\nprivate ConfigurableEnvironment prepareEnvironment(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments) {\n    // \n    ConfigurableEnvironment environment = getOrCreateEnvironment();\n    configureEnvironment(environment, applicationArguments.getSourceArgs());\n    ConfigurationPropertySources.attach(environment);\n    listeners.environmentPrepared(environment);\n    bindToSpringApplication(environment);\n    if (!this.isCustomEnvironment) {\n        environment = new EnvironmentConverter(getClassLoader()).convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());\n    }\n    ConfigurationPropertySources.attach(environment);\n    return environment;\n}\n```\n\n\n\n# \n\n`getOrCreateEnvironment`***Servlet* *REACTIVE*`ConfigurableEnvironment`\n\n```java\nvoid setActiveProfiles(String... profiles);\n\nvoid addActiveProfile(String profile);\n\nvoid setDefaultProfiles(String... profiles);\n\nMutablePropertySources getPropertySources();\n\nMap<String, Object> getSystemProperties();\n\nMap<String, Object> getSystemEnvironment();\n\nvoid merge(ConfigurableEnvironment parent);\n```\n\nprofilepropertymap\n\n# \n\n`property``profile`profile\n\nConfigurationPropertySourcesattach \n\n```java\nprivate static final String ATTACHED_PROPERTY_SOURCE_NAME = \"configurationProperties\";\n```\n\nenvironmentpropertySourceMutablePropertySource*CopyOnWriteArrayList*PropertySource\n\neventlistenerlistener `ConfigFileApplicationListener`\n\n```java\nprivate void onApplicationEnvironmentPreparedEvent(ApplicationEnvironmentPreparedEvent event) {\n    List<EnvironmentPostProcessor> postProcessors = loadPostProcessors();\n    // listenerEnvironmentPostProcessor\n    postProcessors.add(this);\n    AnnotationAwareOrderComparator.sort(postProcessors);\n    for (EnvironmentPostProcessor postProcessor : postProcessors) {\n        postProcessor.postProcessEnvironment(event.getEnvironment(), event.getSpringApplication());\n    }\n}\n```\n\n\n\n```java\nList<EnvironmentPostProcessor> loadPostProcessors() {\n    // \n    return SpringFactoriesLoader.loadFactories(EnvironmentPostProcessor.class, getClass().getClassLoader());\n}\n```\n\n```properties\n# Environment Post Processors\norg.springframework.boot.env.EnvironmentPostProcessor=\\\norg.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\\norg.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\\\norg.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\\\norg.springframework.boot.reactor.DebugAgentEnvironmentPostProcessor\n```\n\nlistenerprocessorprocessor\n\n## Load\n\n\n\n```java\nprotected void addPropertySources(ConfigurableEnvironment environment, ResourceLoader resourceLoader) {\n    RandomValuePropertySource.addToEnvironment(environment);\n    // loaderload\n    new Loader(environment, resourceLoader).load();\n}\n```\n\n```java\nprivate static final Set<String> LOAD_FILTERED_PROPERTY;\n\nstatic {\n    Set<String> filteredProperties = new HashSet<>();\n    filteredProperties.add(\"spring.profiles.active\");\n    filteredProperties.add(\"spring.profiles.include\");\n    LOAD_FILTERED_PROPERTY = Collections.unmodifiableSet(filteredProperties);\n}\nvoid load() {\n    // defaultProperties\n    FilteredPropertySource.apply(this.environment, DEFAULT_PROPERTIES, LOAD_FILTERED_PROPERTY,\n                                 (defaultProperties) -> {\n                                     this.profiles = new LinkedList<>();\n                                     this.processedProfiles = new LinkedList<>();\n                                     this.activatedProfiles = false;\n                                     this.loaded = new LinkedHashMap<>();\n                                     initializeProfiles();\n                                     while (!this.profiles.isEmpty()) {\n                                         Profile profile = this.profiles.poll();\n                                         if (isDefaultProfile(profile)) {\n                                             addProfileToEnvironment(profile.getName());\n                                         }\n                                         // load\n                                         load(profile, this::getPositiveProfileFilter,\n                                              addToLoaded(MutablePropertySources::addLast, false));\n                                         this.processedProfiles.add(profile);\n                                     }\n                                     // load\n                                     load(null, this::getNegativeProfileFilter, addToLoaded(MutablePropertySources::addFirst, true));\n                                     addLoadedPropertySources();\n                                     applyActiveProfiles(defaultProperties);\n                                 });\n```\n\nlambdaapplyconsumerlistenerpropertiesymlloadload*propertySourceLoaders*loaderloadpropertySourceLoader`PropertiesPropertySourceLoader``YamlPropertySourceLoader`\n\n## \n\npostprocessorprocessorSPIMETA-INFspring.factorieskey`EnvironmentPostProcessor`","slug":"SpringBoot-environment","published":1,"updated":"2022-12-09T14:45:43.108Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwd000q8py0balf5ohw","content":"<p>        SpringBootSpringBootymlproperties</p>\n<span id=\"more\"></span>\n\n<!--toc-->\n\n<p>SpringBootSpringApplicationrunrun</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> ConfigurableEnvironment <span class=\"title\">prepareEnvironment</span><span class=\"params\">(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ConfigurableEnvironment environment = getOrCreateEnvironment();</span><br><span class=\"line\">    configureEnvironment(environment, applicationArguments.getSourceArgs());</span><br><span class=\"line\">    ConfigurationPropertySources.attach(environment);</span><br><span class=\"line\">    listeners.environmentPrepared(environment);</span><br><span class=\"line\">    bindToSpringApplication(environment);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.isCustomEnvironment) &#123;</span><br><span class=\"line\">        environment = <span class=\"keyword\">new</span> EnvironmentConverter(getClassLoader()).convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ConfigurationPropertySources.attach(environment);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> environment;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>getOrCreateEnvironment</code><em></em><em>Servlet</em> <em>REACTIVE</em><code>ConfigurableEnvironment</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setActiveProfiles</span><span class=\"params\">(String... profiles)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addActiveProfile</span><span class=\"params\">(String profile)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setDefaultProfiles</span><span class=\"params\">(String... profiles)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">MutablePropertySources <span class=\"title\">getPropertySources</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Map&lt;String, Object&gt; <span class=\"title\">getSystemProperties</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Map&lt;String, Object&gt; <span class=\"title\">getSystemEnvironment</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">merge</span><span class=\"params\">(ConfigurableEnvironment parent)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>profilepropertymap</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>property</code><code>profile</code>profile</p>\n<p>ConfigurationPropertySourcesattach </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String ATTACHED_PROPERTY_SOURCE_NAME = <span class=\"string\">&quot;configurationProperties&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>environmentpropertySourceMutablePropertySource<em>CopyOnWriteArrayList</em>PropertySource</p>\n<p>eventlistenerlistener <code>ConfigFileApplicationListener</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">onApplicationEnvironmentPreparedEvent</span><span class=\"params\">(ApplicationEnvironmentPreparedEvent event)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;EnvironmentPostProcessor&gt; postProcessors = loadPostProcessors();</span><br><span class=\"line\">    <span class=\"comment\">// listenerEnvironmentPostProcessor</span></span><br><span class=\"line\">    postProcessors.add(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    AnnotationAwareOrderComparator.sort(postProcessors);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (EnvironmentPostProcessor postProcessor : postProcessors) &#123;</span><br><span class=\"line\">        postProcessor.postProcessEnvironment(event.getEnvironment(), event.getSpringApplication());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">List&lt;EnvironmentPostProcessor&gt; <span class=\"title\">loadPostProcessors</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> SpringFactoriesLoader.loadFactories(EnvironmentPostProcessor.class, getClass().getClassLoader());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Environment Post Processors</span></span><br><span class=\"line\"><span class=\"meta\">org.springframework.boot.env.EnvironmentPostProcessor</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.reactor.DebugAgentEnvironmentPostProcessor</span></span><br></pre></td></tr></table></figure>\n\n<p>listenerprocessorprocessor</p>\n<h2 id=\"Load\"><a href=\"#Load\" class=\"headerlink\" title=\"Load\"></a>Load</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">addPropertySources</span><span class=\"params\">(ConfigurableEnvironment environment, ResourceLoader resourceLoader)</span> </span>&#123;</span><br><span class=\"line\">    RandomValuePropertySource.addToEnvironment(environment);</span><br><span class=\"line\">    <span class=\"comment\">// loaderload</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Loader(environment, resourceLoader).load();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Set&lt;String&gt; LOAD_FILTERED_PROPERTY;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">    Set&lt;String&gt; filteredProperties = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\">    filteredProperties.add(<span class=\"string\">&quot;spring.profiles.active&quot;</span>);</span><br><span class=\"line\">    filteredProperties.add(<span class=\"string\">&quot;spring.profiles.include&quot;</span>);</span><br><span class=\"line\">    LOAD_FILTERED_PROPERTY = Collections.unmodifiableSet(filteredProperties);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">load</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// defaultProperties</span></span><br><span class=\"line\">    FilteredPropertySource.apply(<span class=\"keyword\">this</span>.environment, DEFAULT_PROPERTIES, LOAD_FILTERED_PROPERTY,</span><br><span class=\"line\">                                 (defaultProperties) -&gt; &#123;</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.profiles = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.processedProfiles = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.activatedProfiles = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.loaded = <span class=\"keyword\">new</span> LinkedHashMap&lt;&gt;();</span><br><span class=\"line\">                                     initializeProfiles();</span><br><span class=\"line\">                                     <span class=\"keyword\">while</span> (!<span class=\"keyword\">this</span>.profiles.isEmpty()) &#123;</span><br><span class=\"line\">                                         Profile profile = <span class=\"keyword\">this</span>.profiles.poll();</span><br><span class=\"line\">                                         <span class=\"keyword\">if</span> (isDefaultProfile(profile)) &#123;</span><br><span class=\"line\">                                             addProfileToEnvironment(profile.getName());</span><br><span class=\"line\">                                         &#125;</span><br><span class=\"line\">                                         <span class=\"comment\">// load</span></span><br><span class=\"line\">                                         load(profile, <span class=\"keyword\">this</span>::getPositiveProfileFilter,</span><br><span class=\"line\">                                              addToLoaded(MutablePropertySources::addLast, <span class=\"keyword\">false</span>));</span><br><span class=\"line\">                                         <span class=\"keyword\">this</span>.processedProfiles.add(profile);</span><br><span class=\"line\">                                     &#125;</span><br><span class=\"line\">                                     <span class=\"comment\">// load</span></span><br><span class=\"line\">                                     load(<span class=\"keyword\">null</span>, <span class=\"keyword\">this</span>::getNegativeProfileFilter, addToLoaded(MutablePropertySources::addFirst, <span class=\"keyword\">true</span>));</span><br><span class=\"line\">                                     addLoadedPropertySources();</span><br><span class=\"line\">                                     applyActiveProfiles(defaultProperties);</span><br><span class=\"line\">                                 &#125;);</span><br></pre></td></tr></table></figure>\n\n<p>lambdaapplyconsumerlistenerpropertiesymlloadload<em>propertySourceLoaders</em>loaderloadpropertySourceLoader<code>PropertiesPropertySourceLoader</code><code>YamlPropertySourceLoader</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>postprocessorprocessorSPIMETA-INFspring.factorieskey<code>EnvironmentPostProcessor</code></p>\n","site":{"data":{}},"excerpt":"<p>        SpringBootSpringBootymlproperties</p>","more":"<!--toc-->\n\n<p>SpringBootSpringApplicationrunrun</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> ConfigurableEnvironment <span class=\"title\">prepareEnvironment</span><span class=\"params\">(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ConfigurableEnvironment environment = getOrCreateEnvironment();</span><br><span class=\"line\">    configureEnvironment(environment, applicationArguments.getSourceArgs());</span><br><span class=\"line\">    ConfigurationPropertySources.attach(environment);</span><br><span class=\"line\">    listeners.environmentPrepared(environment);</span><br><span class=\"line\">    bindToSpringApplication(environment);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.isCustomEnvironment) &#123;</span><br><span class=\"line\">        environment = <span class=\"keyword\">new</span> EnvironmentConverter(getClassLoader()).convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ConfigurationPropertySources.attach(environment);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> environment;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>getOrCreateEnvironment</code><em></em><em>Servlet</em> <em>REACTIVE</em><code>ConfigurableEnvironment</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setActiveProfiles</span><span class=\"params\">(String... profiles)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addActiveProfile</span><span class=\"params\">(String profile)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setDefaultProfiles</span><span class=\"params\">(String... profiles)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">MutablePropertySources <span class=\"title\">getPropertySources</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Map&lt;String, Object&gt; <span class=\"title\">getSystemProperties</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Map&lt;String, Object&gt; <span class=\"title\">getSystemEnvironment</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">merge</span><span class=\"params\">(ConfigurableEnvironment parent)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>profilepropertymap</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>property</code><code>profile</code>profile</p>\n<p>ConfigurationPropertySourcesattach </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String ATTACHED_PROPERTY_SOURCE_NAME = <span class=\"string\">&quot;configurationProperties&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>environmentpropertySourceMutablePropertySource<em>CopyOnWriteArrayList</em>PropertySource</p>\n<p>eventlistenerlistener <code>ConfigFileApplicationListener</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">onApplicationEnvironmentPreparedEvent</span><span class=\"params\">(ApplicationEnvironmentPreparedEvent event)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;EnvironmentPostProcessor&gt; postProcessors = loadPostProcessors();</span><br><span class=\"line\">    <span class=\"comment\">// listenerEnvironmentPostProcessor</span></span><br><span class=\"line\">    postProcessors.add(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    AnnotationAwareOrderComparator.sort(postProcessors);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (EnvironmentPostProcessor postProcessor : postProcessors) &#123;</span><br><span class=\"line\">        postProcessor.postProcessEnvironment(event.getEnvironment(), event.getSpringApplication());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">List&lt;EnvironmentPostProcessor&gt; <span class=\"title\">loadPostProcessors</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> SpringFactoriesLoader.loadFactories(EnvironmentPostProcessor.class, getClass().getClassLoader());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Environment Post Processors</span></span><br><span class=\"line\"><span class=\"meta\">org.springframework.boot.env.EnvironmentPostProcessor</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.reactor.DebugAgentEnvironmentPostProcessor</span></span><br></pre></td></tr></table></figure>\n\n<p>listenerprocessorprocessor</p>\n<h2 id=\"Load\"><a href=\"#Load\" class=\"headerlink\" title=\"Load\"></a>Load</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">addPropertySources</span><span class=\"params\">(ConfigurableEnvironment environment, ResourceLoader resourceLoader)</span> </span>&#123;</span><br><span class=\"line\">    RandomValuePropertySource.addToEnvironment(environment);</span><br><span class=\"line\">    <span class=\"comment\">// loaderload</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Loader(environment, resourceLoader).load();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Set&lt;String&gt; LOAD_FILTERED_PROPERTY;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">    Set&lt;String&gt; filteredProperties = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\">    filteredProperties.add(<span class=\"string\">&quot;spring.profiles.active&quot;</span>);</span><br><span class=\"line\">    filteredProperties.add(<span class=\"string\">&quot;spring.profiles.include&quot;</span>);</span><br><span class=\"line\">    LOAD_FILTERED_PROPERTY = Collections.unmodifiableSet(filteredProperties);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">load</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// defaultProperties</span></span><br><span class=\"line\">    FilteredPropertySource.apply(<span class=\"keyword\">this</span>.environment, DEFAULT_PROPERTIES, LOAD_FILTERED_PROPERTY,</span><br><span class=\"line\">                                 (defaultProperties) -&gt; &#123;</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.profiles = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.processedProfiles = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.activatedProfiles = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.loaded = <span class=\"keyword\">new</span> LinkedHashMap&lt;&gt;();</span><br><span class=\"line\">                                     initializeProfiles();</span><br><span class=\"line\">                                     <span class=\"keyword\">while</span> (!<span class=\"keyword\">this</span>.profiles.isEmpty()) &#123;</span><br><span class=\"line\">                                         Profile profile = <span class=\"keyword\">this</span>.profiles.poll();</span><br><span class=\"line\">                                         <span class=\"keyword\">if</span> (isDefaultProfile(profile)) &#123;</span><br><span class=\"line\">                                             addProfileToEnvironment(profile.getName());</span><br><span class=\"line\">                                         &#125;</span><br><span class=\"line\">                                         <span class=\"comment\">// load</span></span><br><span class=\"line\">                                         load(profile, <span class=\"keyword\">this</span>::getPositiveProfileFilter,</span><br><span class=\"line\">                                              addToLoaded(MutablePropertySources::addLast, <span class=\"keyword\">false</span>));</span><br><span class=\"line\">                                         <span class=\"keyword\">this</span>.processedProfiles.add(profile);</span><br><span class=\"line\">                                     &#125;</span><br><span class=\"line\">                                     <span class=\"comment\">// load</span></span><br><span class=\"line\">                                     load(<span class=\"keyword\">null</span>, <span class=\"keyword\">this</span>::getNegativeProfileFilter, addToLoaded(MutablePropertySources::addFirst, <span class=\"keyword\">true</span>));</span><br><span class=\"line\">                                     addLoadedPropertySources();</span><br><span class=\"line\">                                     applyActiveProfiles(defaultProperties);</span><br><span class=\"line\">                                 &#125;);</span><br></pre></td></tr></table></figure>\n\n<p>lambdaapplyconsumerlistenerpropertiesymlloadload<em>propertySourceLoaders</em>loaderloadpropertySourceLoader<code>PropertiesPropertySourceLoader</code><code>YamlPropertySourceLoader</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>postprocessorprocessorSPIMETA-INFspring.factorieskey<code>EnvironmentPostProcessor</code></p>"},{"title":"SpringBoot startup","date":"2021-02-15T05:18:14.000Z","_content":"\nSpringBootSpringBoot\n\n<!--more-->\n\n        SpringBootSpringStruts2SpringBootwebmainproperties/ymlSpringSpringBootIOCAOPweb\n\n<!--toc-->\n\n# \n\n```java\n@SpringBootApplication\npublic class MyApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(MyApplication.class, args);\n    }\n}\n```\n\nSpringBootresources\n\n- @SpringBootApplication\n- SpringApplicationrunclassmainargs\n\nrunrun\n\n- SpringApplication\n- run\n\n\n\n# \n\n```java\npublic SpringApplication(ResourceLoader resourceLoader, Class<?>... primarySources) {\n    // null\n    this.resourceLoader = resourceLoader;\n    Assert.notNull(primarySources, \"PrimarySources must not be null\");\n    // class\n    this.primarySources = new LinkedHashSet<>(Arrays.asList(primarySources));\n    // \n    this.webApplicationType = WebApplicationType.deduceFromClasspath();\n    // \n    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));\n    // \n    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));\n    // \n    this.mainApplicationClass = deduceMainApplicationClass();\n}\n```\n\n\n\n## \n\nSpringBootwebwebSpring\n\nwebSpringBootwebwebclasswebclass\n\n```java\nprivate static final String WEBMVC_INDICATOR_CLASS = \"org.springframework.web.servlet.DispatcherServlet\";\n\n    private static final String WEBFLUX_INDICATOR_CLASS = \"org.springframework.web.reactive.DispatcherHandler\";\n\n    private static final String JERSEY_INDICATOR_CLASS = \"org.glassfish.jersey.servlet.ServletContainer\";\n\nstatic WebApplicationType deduceFromClasspath() {\n    if (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, null) && !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, null)\n        && !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, null)) {\n        return WebApplicationType.REACTIVE;\n    }\n    for (String className : SERVLET_INDICATOR_CLASSES) {\n        if (!ClassUtils.isPresent(className, null)) {\n            return WebApplicationType.NONE;\n        }\n    }\n    return WebApplicationType.SERVLET;\n}\n```\n\n## SPI\n\nSPI\n\n```java\npublic static final String FACTORIES_RESOURCE_LOCATION = \"META-INF/spring.factories\";\n```\n\nSpringBootkey-value`ApplicaitonListener`class\n\n## \n\n```properties\norg.springframework.context.ApplicationListener=\\\norg.springframework.boot.ClearCachesApplicationListener,\\\norg.springframework.boot.builder.ParentContextCloserApplicationListener,\\\norg.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\\norg.springframework.boot.context.FileEncodingApplicationListener,\\\norg.springframework.boot.context.config.AnsiOutputApplicationListener,\\\norg.springframework.boot.context.config.ConfigFileApplicationListener,\\\norg.springframework.boot.context.config.DelegatingApplicationListener,\\\norg.springframework.boot.context.logging.ClasspathLoggingApplicationListener,\\\norg.springframework.boot.context.logging.LoggingApplicationListener,\\\norg.springframework.boot.liquibase.LiquibaseServiceLocatorApplicationListener\n```\n\n*spring.facories*listenerlistenerevent`ClearCachesApplicationListener`\n\nrunList\n\n## \n\n`ApplicationContextInitializer`\n\n```properties\norg.springframework.context.ApplicationContextInitializer=\\\norg.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\\\norg.springframework.boot.context.ContextIdApplicationContextInitializer,\\\norg.springframework.boot.context.config.DelegatingApplicationContextInitializer,\\\norg.springframework.boot.rsocket.context.RSocketPortInfoApplicationContextInitializer,\\\norg.springframework.boot.web.context.ServerPortInfoApplicationContextInitializ\n```\n\ncontextSpring warningsList\n\n# Run\n\nrunrunrun\n\n```java\npublic ConfigurableApplicationContext run(String... args) {\n    StopWatch stopWatch = new StopWatch();\n    stopWatch.start();\n    ConfigurableApplicationContext context = null;\n    Collection<SpringBootExceptionReporter> exceptionReporters = new ArrayList<>();\n    configureHeadlessProperty();\n    // listenerslistener\n    SpringApplicationRunListeners listeners = getRunListeners(args);\n    listeners.starting();\n    try {\n        ApplicationArguments applicationArguments = new DefaultApplicationArguments(args);\n        // \n        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);\n        configureIgnoreBeanInfo(environment);\n        Banner printedBanner = printBanner(environment);\n        // \n        context = createApplicationContext();\n        exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,\n                                                         new Class[] { ConfigurableApplicationContext.class }, context);\n        // \n        prepareContext(context, environment, listeners, applicationArguments, printedBanner);\n        // \n        refreshContext(context);\n        afterRefresh(context, applicationArguments);\n        stopWatch.stop();\n        if (this.logStartupInfo) {\n            new StartupInfoLogger(this.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);\n        }\n        listeners.started(context);\n        callRunners(context, applicationArguments);\n    }\n    catch (Throwable ex) {\n        handleRunFailure(context, ex, exceptionReporters, listeners);\n        throw new IllegalStateException(ex);\n    }\n\n    try {\n        listeners.running(context);\n    }\n    catch (Throwable ex) {\n        handleRunFailure(context, ex, exceptionReporters, null);\n        throw new IllegalStateException(ex);\n    }\n    return context;\n}\n```\n\n\n\n## RunListeners\n\n`SpringApplicaitonRunListeners`listener\n\n```java\nprivate SpringApplicationRunListeners getRunListeners(String[] args) {\n    Class<?>[] types = new Class<?>[] { SpringApplication.class, String[].class };\n    return new SpringApplicationRunListeners(logger,\n                                             getSpringFactoriesInstances(SpringApplicationRunListener.class, types, this, args));\n}\n```\n\n`EventPublishingRunListener``SpringApplicationRunListeners``EventPublishingRunListener`runlisteners`EventPublishingRunListenr`listeners\n\n`EventPublishingRunListener``SimpleApplicationEventMulticaster`\n\n```java\n@Override\npublic void starting() {\n    this.initialMulticaster.multicastEvent(new ApplicationStartingEvent(this.application, this.args));\n}\n```\n\n`this.application``SpringApplication``SpringApplication`getlistenerseventlistener\n\n## createApplicationContext\n\n```java\n    public static final String DEFAULT_CONTEXT_CLASS = \"org.springframework.context.\"\n            + \"annotation.AnnotationConfigApplicationContext\";\n\n    public static final String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = \"org.springframework.boot.\"\n            + \"web.servlet.context.AnnotationConfigServletWebServerApplicationContext\";\n\n    public static final String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = \"org.springframework.\"\n            + \"boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext\";\n\nprotected ConfigurableApplicationContext createApplicationContext() {\n    Class<?> contextClass = this.applicationContextClass;\n    if (contextClass == null) {\n        try {\n            switch (this.webApplicationType) {\n                case SERVLET:\n                    contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);\n                    break;\n                case REACTIVE:\n                    contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);\n                    break;\n                default:\n                    contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);\n            }\n        }\n        catch (ClassNotFoundException ex) {\n            throw new IllegalStateException(\n                \"Unable create a default ApplicationContext, please specify an ApplicationContextClass\", ex);\n        }\n    }\n    return (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);\n}\n```\n\n\n\n## prepareContext\n\n\n\n```java\nprivate void prepareContext(ConfigurableApplicationContext context, ConfigurableEnvironment environment,\n                            SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner) {\n    context.setEnvironment(environment);\n    // \n    postProcessApplicationContext(context);\n    // \n    applyInitializers(context);\n    listeners.contextPrepared(context);\n    if (this.logStartupInfo) {\n        logStartupInfo(context.getParent() == null);\n        logStartupProfileInfo(context);\n    }\n    // Add boot specific singleton beans\n    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();\n    beanFactory.registerSingleton(\"springApplicationArguments\", applicationArguments);\n    if (printedBanner != null) {\n        beanFactory.registerSingleton(\"springBootBanner\", printedBanner);\n    }\n    if (beanFactory instanceof DefaultListableBeanFactory) {\n        ((DefaultListableBeanFactory) beanFactory)\n        .setAllowBeanDefinitionOverriding(this.allowBeanDefinitionOverriding);\n    }\n    if (this.lazyInitialization) {\n        context.addBeanFactoryPostProcessor(new LazyInitializationBeanFactoryPostProcessor());\n    }\n    // Load the sources\n    Set<Object> sources = getAllSources();\n    Assert.notEmpty(sources, \"Sources must not be empty\");\n    // BeanDefinitionLoader\n    load(context, sources.toArray(new Object[0]));\n    listeners.contextLoaded(context);\n}\n```\n\nlisteners*contextPrepared**contextLoaded*bean\n\n### contextPrepared\n\n\n\n#### postProcess\n\n```java\nprotected void postProcessApplicationContext(ConfigurableApplicationContext context) {\n    if (this.beanNameGenerator != null) {\n        // bean\n        context.getBeanFactory().registerSingleton(AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR,\n                                                   this.beanNameGenerator);\n    }\n    if (this.resourceLoader != null) {\n        if (context instanceof GenericApplicationContext) {\n            ((GenericApplicationContext) context).setResourceLoader(this.resourceLoader);\n        }\n        if (context instanceof DefaultResourceLoader) {\n            ((DefaultResourceLoader) context).setClassLoader(this.resourceLoader.getClassLoader());\n        }\n    }\n    if (this.addConversionService) {\n        context.getBeanFactory().setConversionService(ApplicationConversionService.getSharedInstance());\n    }\n}\n```\n\n`beanNameGenerator`\n\n#### applyInitializers\n\n```java\nprotected void applyInitializers(ConfigurableApplicationContext context) {\n    for (ApplicationContextInitializer initializer : getInitializers()) {\n        Class<?> requiredType = GenericTypeResolver.resolveTypeArgument(initializer.getClass(),\n                                                                        ApplicationContextInitializer.class);\n        Assert.isInstanceOf(requiredType, context, \"Unable to call initializer.\");\n        initializer.initialize(context);\n    }\n}\n```\n\n\n\n### contextLoaded\n\n`BeanDefinitionLoader`xmljavaConfigbean\n\n```java\nprotected void load(ApplicationContext context, Object[] sources) {\n    if (logger.isDebugEnabled()) {\n        logger.debug(\"Loading source \" + StringUtils.arrayToCommaDelimitedString(sources));\n    }\n    BeanDefinitionLoader loader = createBeanDefinitionLoader(getBeanDefinitionRegistry(context), sources);\n    if (this.beanNameGenerator != null) {\n        loader.setBeanNameGenerator(this.beanNameGenerator);\n    }\n    if (this.resourceLoader != null) {\n        loader.setResourceLoader(this.resourceLoader);\n    }\n    if (this.environment != null) {\n        loader.setEnvironment(this.environment);\n    }\n    loader.load();\n}\n```\n\n# \n\nSpringBoot\n\n- \n- \n- ","source":"_posts/SpringBoot-startup.md","raw":"---\ntitle: SpringBoot startup\ndate: 2021-02-15 13:18:14\ncategories: springboot\ntags: startup\n---\n\nSpringBootSpringBoot\n\n<!--more-->\n\n        SpringBootSpringStruts2SpringBootwebmainproperties/ymlSpringSpringBootIOCAOPweb\n\n<!--toc-->\n\n# \n\n```java\n@SpringBootApplication\npublic class MyApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(MyApplication.class, args);\n    }\n}\n```\n\nSpringBootresources\n\n- @SpringBootApplication\n- SpringApplicationrunclassmainargs\n\nrunrun\n\n- SpringApplication\n- run\n\n\n\n# \n\n```java\npublic SpringApplication(ResourceLoader resourceLoader, Class<?>... primarySources) {\n    // null\n    this.resourceLoader = resourceLoader;\n    Assert.notNull(primarySources, \"PrimarySources must not be null\");\n    // class\n    this.primarySources = new LinkedHashSet<>(Arrays.asList(primarySources));\n    // \n    this.webApplicationType = WebApplicationType.deduceFromClasspath();\n    // \n    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));\n    // \n    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));\n    // \n    this.mainApplicationClass = deduceMainApplicationClass();\n}\n```\n\n\n\n## \n\nSpringBootwebwebSpring\n\nwebSpringBootwebwebclasswebclass\n\n```java\nprivate static final String WEBMVC_INDICATOR_CLASS = \"org.springframework.web.servlet.DispatcherServlet\";\n\n    private static final String WEBFLUX_INDICATOR_CLASS = \"org.springframework.web.reactive.DispatcherHandler\";\n\n    private static final String JERSEY_INDICATOR_CLASS = \"org.glassfish.jersey.servlet.ServletContainer\";\n\nstatic WebApplicationType deduceFromClasspath() {\n    if (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, null) && !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, null)\n        && !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, null)) {\n        return WebApplicationType.REACTIVE;\n    }\n    for (String className : SERVLET_INDICATOR_CLASSES) {\n        if (!ClassUtils.isPresent(className, null)) {\n            return WebApplicationType.NONE;\n        }\n    }\n    return WebApplicationType.SERVLET;\n}\n```\n\n## SPI\n\nSPI\n\n```java\npublic static final String FACTORIES_RESOURCE_LOCATION = \"META-INF/spring.factories\";\n```\n\nSpringBootkey-value`ApplicaitonListener`class\n\n## \n\n```properties\norg.springframework.context.ApplicationListener=\\\norg.springframework.boot.ClearCachesApplicationListener,\\\norg.springframework.boot.builder.ParentContextCloserApplicationListener,\\\norg.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\\norg.springframework.boot.context.FileEncodingApplicationListener,\\\norg.springframework.boot.context.config.AnsiOutputApplicationListener,\\\norg.springframework.boot.context.config.ConfigFileApplicationListener,\\\norg.springframework.boot.context.config.DelegatingApplicationListener,\\\norg.springframework.boot.context.logging.ClasspathLoggingApplicationListener,\\\norg.springframework.boot.context.logging.LoggingApplicationListener,\\\norg.springframework.boot.liquibase.LiquibaseServiceLocatorApplicationListener\n```\n\n*spring.facories*listenerlistenerevent`ClearCachesApplicationListener`\n\nrunList\n\n## \n\n`ApplicationContextInitializer`\n\n```properties\norg.springframework.context.ApplicationContextInitializer=\\\norg.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\\\norg.springframework.boot.context.ContextIdApplicationContextInitializer,\\\norg.springframework.boot.context.config.DelegatingApplicationContextInitializer,\\\norg.springframework.boot.rsocket.context.RSocketPortInfoApplicationContextInitializer,\\\norg.springframework.boot.web.context.ServerPortInfoApplicationContextInitializ\n```\n\ncontextSpring warningsList\n\n# Run\n\nrunrunrun\n\n```java\npublic ConfigurableApplicationContext run(String... args) {\n    StopWatch stopWatch = new StopWatch();\n    stopWatch.start();\n    ConfigurableApplicationContext context = null;\n    Collection<SpringBootExceptionReporter> exceptionReporters = new ArrayList<>();\n    configureHeadlessProperty();\n    // listenerslistener\n    SpringApplicationRunListeners listeners = getRunListeners(args);\n    listeners.starting();\n    try {\n        ApplicationArguments applicationArguments = new DefaultApplicationArguments(args);\n        // \n        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);\n        configureIgnoreBeanInfo(environment);\n        Banner printedBanner = printBanner(environment);\n        // \n        context = createApplicationContext();\n        exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,\n                                                         new Class[] { ConfigurableApplicationContext.class }, context);\n        // \n        prepareContext(context, environment, listeners, applicationArguments, printedBanner);\n        // \n        refreshContext(context);\n        afterRefresh(context, applicationArguments);\n        stopWatch.stop();\n        if (this.logStartupInfo) {\n            new StartupInfoLogger(this.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);\n        }\n        listeners.started(context);\n        callRunners(context, applicationArguments);\n    }\n    catch (Throwable ex) {\n        handleRunFailure(context, ex, exceptionReporters, listeners);\n        throw new IllegalStateException(ex);\n    }\n\n    try {\n        listeners.running(context);\n    }\n    catch (Throwable ex) {\n        handleRunFailure(context, ex, exceptionReporters, null);\n        throw new IllegalStateException(ex);\n    }\n    return context;\n}\n```\n\n\n\n## RunListeners\n\n`SpringApplicaitonRunListeners`listener\n\n```java\nprivate SpringApplicationRunListeners getRunListeners(String[] args) {\n    Class<?>[] types = new Class<?>[] { SpringApplication.class, String[].class };\n    return new SpringApplicationRunListeners(logger,\n                                             getSpringFactoriesInstances(SpringApplicationRunListener.class, types, this, args));\n}\n```\n\n`EventPublishingRunListener``SpringApplicationRunListeners``EventPublishingRunListener`runlisteners`EventPublishingRunListenr`listeners\n\n`EventPublishingRunListener``SimpleApplicationEventMulticaster`\n\n```java\n@Override\npublic void starting() {\n    this.initialMulticaster.multicastEvent(new ApplicationStartingEvent(this.application, this.args));\n}\n```\n\n`this.application``SpringApplication``SpringApplication`getlistenerseventlistener\n\n## createApplicationContext\n\n```java\n    public static final String DEFAULT_CONTEXT_CLASS = \"org.springframework.context.\"\n            + \"annotation.AnnotationConfigApplicationContext\";\n\n    public static final String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = \"org.springframework.boot.\"\n            + \"web.servlet.context.AnnotationConfigServletWebServerApplicationContext\";\n\n    public static final String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = \"org.springframework.\"\n            + \"boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext\";\n\nprotected ConfigurableApplicationContext createApplicationContext() {\n    Class<?> contextClass = this.applicationContextClass;\n    if (contextClass == null) {\n        try {\n            switch (this.webApplicationType) {\n                case SERVLET:\n                    contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);\n                    break;\n                case REACTIVE:\n                    contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);\n                    break;\n                default:\n                    contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);\n            }\n        }\n        catch (ClassNotFoundException ex) {\n            throw new IllegalStateException(\n                \"Unable create a default ApplicationContext, please specify an ApplicationContextClass\", ex);\n        }\n    }\n    return (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);\n}\n```\n\n\n\n## prepareContext\n\n\n\n```java\nprivate void prepareContext(ConfigurableApplicationContext context, ConfigurableEnvironment environment,\n                            SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner) {\n    context.setEnvironment(environment);\n    // \n    postProcessApplicationContext(context);\n    // \n    applyInitializers(context);\n    listeners.contextPrepared(context);\n    if (this.logStartupInfo) {\n        logStartupInfo(context.getParent() == null);\n        logStartupProfileInfo(context);\n    }\n    // Add boot specific singleton beans\n    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();\n    beanFactory.registerSingleton(\"springApplicationArguments\", applicationArguments);\n    if (printedBanner != null) {\n        beanFactory.registerSingleton(\"springBootBanner\", printedBanner);\n    }\n    if (beanFactory instanceof DefaultListableBeanFactory) {\n        ((DefaultListableBeanFactory) beanFactory)\n        .setAllowBeanDefinitionOverriding(this.allowBeanDefinitionOverriding);\n    }\n    if (this.lazyInitialization) {\n        context.addBeanFactoryPostProcessor(new LazyInitializationBeanFactoryPostProcessor());\n    }\n    // Load the sources\n    Set<Object> sources = getAllSources();\n    Assert.notEmpty(sources, \"Sources must not be empty\");\n    // BeanDefinitionLoader\n    load(context, sources.toArray(new Object[0]));\n    listeners.contextLoaded(context);\n}\n```\n\nlisteners*contextPrepared**contextLoaded*bean\n\n### contextPrepared\n\n\n\n#### postProcess\n\n```java\nprotected void postProcessApplicationContext(ConfigurableApplicationContext context) {\n    if (this.beanNameGenerator != null) {\n        // bean\n        context.getBeanFactory().registerSingleton(AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR,\n                                                   this.beanNameGenerator);\n    }\n    if (this.resourceLoader != null) {\n        if (context instanceof GenericApplicationContext) {\n            ((GenericApplicationContext) context).setResourceLoader(this.resourceLoader);\n        }\n        if (context instanceof DefaultResourceLoader) {\n            ((DefaultResourceLoader) context).setClassLoader(this.resourceLoader.getClassLoader());\n        }\n    }\n    if (this.addConversionService) {\n        context.getBeanFactory().setConversionService(ApplicationConversionService.getSharedInstance());\n    }\n}\n```\n\n`beanNameGenerator`\n\n#### applyInitializers\n\n```java\nprotected void applyInitializers(ConfigurableApplicationContext context) {\n    for (ApplicationContextInitializer initializer : getInitializers()) {\n        Class<?> requiredType = GenericTypeResolver.resolveTypeArgument(initializer.getClass(),\n                                                                        ApplicationContextInitializer.class);\n        Assert.isInstanceOf(requiredType, context, \"Unable to call initializer.\");\n        initializer.initialize(context);\n    }\n}\n```\n\n\n\n### contextLoaded\n\n`BeanDefinitionLoader`xmljavaConfigbean\n\n```java\nprotected void load(ApplicationContext context, Object[] sources) {\n    if (logger.isDebugEnabled()) {\n        logger.debug(\"Loading source \" + StringUtils.arrayToCommaDelimitedString(sources));\n    }\n    BeanDefinitionLoader loader = createBeanDefinitionLoader(getBeanDefinitionRegistry(context), sources);\n    if (this.beanNameGenerator != null) {\n        loader.setBeanNameGenerator(this.beanNameGenerator);\n    }\n    if (this.resourceLoader != null) {\n        loader.setResourceLoader(this.resourceLoader);\n    }\n    if (this.environment != null) {\n        loader.setEnvironment(this.environment);\n    }\n    loader.load();\n}\n```\n\n# \n\nSpringBoot\n\n- \n- \n- ","slug":"SpringBoot-startup","published":1,"updated":"2022-12-09T14:39:40.437Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwd000v8py06gbi88h3","content":"<p>SpringBootSpringBoot</p>\n<span id=\"more\"></span>\n\n<p>        SpringBootSpringStruts2SpringBootwebmainproperties/ymlSpringSpringBootIOCAOPweb</p>\n<!--toc-->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyApplication</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SpringBootresources</p>\n<ul>\n<li>@SpringBootApplication</li>\n<li>SpringApplicationrunclassmainargs</li>\n</ul>\n<p>runrun</p>\n<ul>\n<li>SpringApplication</li>\n<li>run</li>\n</ul>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SpringApplication</span><span class=\"params\">(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.resourceLoader = resourceLoader;</span><br><span class=\"line\">    Assert.notNull(primarySources, <span class=\"string\">&quot;PrimarySources must not be null&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// class</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.primarySources = <span class=\"keyword\">new</span> LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.webApplicationType = WebApplicationType.deduceFromClasspath();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.mainApplicationClass = deduceMainApplicationClass();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SpringBootwebwebSpring</p>\n<p>webSpringBootwebwebclasswebclass</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String WEBMVC_INDICATOR_CLASS = <span class=\"string\">&quot;org.springframework.web.servlet.DispatcherServlet&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String WEBFLUX_INDICATOR_CLASS = <span class=\"string\">&quot;org.springframework.web.reactive.DispatcherHandler&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String JERSEY_INDICATOR_CLASS = <span class=\"string\">&quot;org.glassfish.jersey.servlet.ServletContainer&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> WebApplicationType <span class=\"title\">deduceFromClasspath</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, <span class=\"keyword\">null</span>) &amp;&amp; !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        &amp;&amp; !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> WebApplicationType.REACTIVE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String className : SERVLET_INDICATOR_CLASSES) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!ClassUtils.isPresent(className, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> WebApplicationType.NONE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> WebApplicationType.SERVLET;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SPI\"><a href=\"#SPI\" class=\"headerlink\" title=\"SPI\"></a>SPI</h2><p>SPI</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String FACTORIES_RESOURCE_LOCATION = <span class=\"string\">&quot;META-INF/spring.factories&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>SpringBootkey-value<code>ApplicaitonListener</code>class</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.context.ApplicationListener</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.ClearCachesApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.builder.ParentContextCloserApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.FileEncodingApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.config.AnsiOutputApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.config.ConfigFileApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.config.DelegatingApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.logging.ClasspathLoggingApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.logging.LoggingApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.liquibase.LiquibaseServiceLocatorApplicationListener</span></span><br></pre></td></tr></table></figure>\n\n<p><em>spring.facories</em>listenerlistenerevent<code>ClearCachesApplicationListener</code></p>\n<p>runList</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>ApplicationContextInitializer</code></p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.context.ApplicationContextInitializer</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.ContextIdApplicationContextInitializer,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.config.DelegatingApplicationContextInitializer,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.rsocket.context.RSocketPortInfoApplicationContextInitializer,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.web.context.ServerPortInfoApplicationContextInitializ</span></span><br></pre></td></tr></table></figure>\n\n<p>contextSpring warningsList</p>\n<h1 id=\"Run\"><a href=\"#Run\" class=\"headerlink\" title=\"Run\"></a>Run</h1><p>runrunrun</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ConfigurableApplicationContext <span class=\"title\">run</span><span class=\"params\">(String... args)</span> </span>&#123;</span><br><span class=\"line\">    StopWatch stopWatch = <span class=\"keyword\">new</span> StopWatch();</span><br><span class=\"line\">    stopWatch.start();</span><br><span class=\"line\">    ConfigurableApplicationContext context = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    configureHeadlessProperty();</span><br><span class=\"line\">    <span class=\"comment\">// listenerslistener</span></span><br><span class=\"line\">    SpringApplicationRunListeners listeners = getRunListeners(args);</span><br><span class=\"line\">    listeners.starting();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        ApplicationArguments applicationArguments = <span class=\"keyword\">new</span> DefaultApplicationArguments(args);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);</span><br><span class=\"line\">        configureIgnoreBeanInfo(environment);</span><br><span class=\"line\">        Banner printedBanner = printBanner(environment);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        context = createApplicationContext();</span><br><span class=\"line\">        exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,</span><br><span class=\"line\">                                                         <span class=\"keyword\">new</span> Class[] &#123; ConfigurableApplicationContext.class &#125;, context);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        prepareContext(context, environment, listeners, applicationArguments, printedBanner);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        refreshContext(context);</span><br><span class=\"line\">        afterRefresh(context, applicationArguments);</span><br><span class=\"line\">        stopWatch.stop();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.logStartupInfo) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> StartupInfoLogger(<span class=\"keyword\">this</span>.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        listeners.started(context);</span><br><span class=\"line\">        callRunners(context, applicationArguments);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        handleRunFailure(context, ex, exceptionReporters, listeners);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        listeners.running(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        handleRunFailure(context, ex, exceptionReporters, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> context;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"RunListeners\"><a href=\"#RunListeners\" class=\"headerlink\" title=\"RunListeners\"></a>RunListeners</h2><p><code>SpringApplicaitonRunListeners</code>listener</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> SpringApplicationRunListeners <span class=\"title\">getRunListeners</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    Class&lt;?&gt;[] types = <span class=\"keyword\">new</span> Class&lt;?&gt;[] &#123; SpringApplication.class, String[].class &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> SpringApplicationRunListeners(logger,</span><br><span class=\"line\">                                             getSpringFactoriesInstances(SpringApplicationRunListener.class, types, <span class=\"keyword\">this</span>, args));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>EventPublishingRunListener</code><code>SpringApplicationRunListeners</code><code>EventPublishingRunListener</code>runlisteners<code>EventPublishingRunListenr</code>listeners</p>\n<p><code>EventPublishingRunListener</code><code>SimpleApplicationEventMulticaster</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">starting</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.initialMulticaster.multicastEvent(<span class=\"keyword\">new</span> ApplicationStartingEvent(<span class=\"keyword\">this</span>.application, <span class=\"keyword\">this</span>.args));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>this.application</code><code>SpringApplication</code><code>SpringApplication</code>getlistenerseventlistener</p>\n<h2 id=\"createApplicationContext\"><a href=\"#createApplicationContext\" class=\"headerlink\" title=\"createApplicationContext\"></a>createApplicationContext</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.context.&quot;</span></span><br><span class=\"line\">            + <span class=\"string\">&quot;annotation.AnnotationConfigApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.boot.&quot;</span></span><br><span class=\"line\">            + <span class=\"string\">&quot;web.servlet.context.AnnotationConfigServletWebServerApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.&quot;</span></span><br><span class=\"line\">            + <span class=\"string\">&quot;boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> ConfigurableApplicationContext <span class=\"title\">createApplicationContext</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    Class&lt;?&gt; contextClass = <span class=\"keyword\">this</span>.applicationContextClass;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (contextClass == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">switch</span> (<span class=\"keyword\">this</span>.webApplicationType) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> SERVLET:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> REACTIVE:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (ClassNotFoundException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(</span><br><span class=\"line\">                <span class=\"string\">&quot;Unable create a default ApplicationContext, please specify an ApplicationContextClass&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"prepareContext\"><a href=\"#prepareContext\" class=\"headerlink\" title=\"prepareContext\"></a>prepareContext</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">prepareContext</span><span class=\"params\">(ConfigurableApplicationContext context, ConfigurableEnvironment environment,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                            SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner)</span> </span>&#123;</span><br><span class=\"line\">    context.setEnvironment(environment);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    postProcessApplicationContext(context);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    applyInitializers(context);</span><br><span class=\"line\">    listeners.contextPrepared(context);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.logStartupInfo) &#123;</span><br><span class=\"line\">        logStartupInfo(context.getParent() == <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        logStartupProfileInfo(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Add boot specific singleton beans</span></span><br><span class=\"line\">    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();</span><br><span class=\"line\">    beanFactory.registerSingleton(<span class=\"string\">&quot;springApplicationArguments&quot;</span>, applicationArguments);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (printedBanner != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        beanFactory.registerSingleton(<span class=\"string\">&quot;springBootBanner&quot;</span>, printedBanner);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanFactory <span class=\"keyword\">instanceof</span> DefaultListableBeanFactory) &#123;</span><br><span class=\"line\">        ((DefaultListableBeanFactory) beanFactory)</span><br><span class=\"line\">        .setAllowBeanDefinitionOverriding(<span class=\"keyword\">this</span>.allowBeanDefinitionOverriding);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.lazyInitialization) &#123;</span><br><span class=\"line\">        context.addBeanFactoryPostProcessor(<span class=\"keyword\">new</span> LazyInitializationBeanFactoryPostProcessor());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Load the sources</span></span><br><span class=\"line\">    Set&lt;Object&gt; sources = getAllSources();</span><br><span class=\"line\">    Assert.notEmpty(sources, <span class=\"string\">&quot;Sources must not be empty&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// BeanDefinitionLoader</span></span><br><span class=\"line\">    load(context, sources.toArray(<span class=\"keyword\">new</span> Object[<span class=\"number\">0</span>]));</span><br><span class=\"line\">    listeners.contextLoaded(context);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>listeners<em>contextPrepared</em><em>contextLoaded</em>bean</p>\n<h3 id=\"contextPrepared\"><a href=\"#contextPrepared\" class=\"headerlink\" title=\"contextPrepared\"></a>contextPrepared</h3><p></p>\n<h4 id=\"postProcess\"><a href=\"#postProcess\" class=\"headerlink\" title=\"postProcess\"></a>postProcess</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">postProcessApplicationContext</span><span class=\"params\">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.beanNameGenerator != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// bean</span></span><br><span class=\"line\">        context.getBeanFactory().registerSingleton(AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR,</span><br><span class=\"line\">                                                   <span class=\"keyword\">this</span>.beanNameGenerator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.resourceLoader != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context <span class=\"keyword\">instanceof</span> GenericApplicationContext) &#123;</span><br><span class=\"line\">            ((GenericApplicationContext) context).setResourceLoader(<span class=\"keyword\">this</span>.resourceLoader);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context <span class=\"keyword\">instanceof</span> DefaultResourceLoader) &#123;</span><br><span class=\"line\">            ((DefaultResourceLoader) context).setClassLoader(<span class=\"keyword\">this</span>.resourceLoader.getClassLoader());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.addConversionService) &#123;</span><br><span class=\"line\">        context.getBeanFactory().setConversionService(ApplicationConversionService.getSharedInstance());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>beanNameGenerator</code></p>\n<h4 id=\"applyInitializers\"><a href=\"#applyInitializers\" class=\"headerlink\" title=\"applyInitializers\"></a>applyInitializers</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">applyInitializers</span><span class=\"params\">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ApplicationContextInitializer initializer : getInitializers()) &#123;</span><br><span class=\"line\">        Class&lt;?&gt; requiredType = GenericTypeResolver.resolveTypeArgument(initializer.getClass(),</span><br><span class=\"line\">                                                                        ApplicationContextInitializer.class);</span><br><span class=\"line\">        Assert.isInstanceOf(requiredType, context, <span class=\"string\">&quot;Unable to call initializer.&quot;</span>);</span><br><span class=\"line\">        initializer.initialize(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"contextLoaded\"><a href=\"#contextLoaded\" class=\"headerlink\" title=\"contextLoaded\"></a>contextLoaded</h3><p><code>BeanDefinitionLoader</code>xmljavaConfigbean</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">load</span><span class=\"params\">(ApplicationContext context, Object[] sources)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class=\"line\">        logger.debug(<span class=\"string\">&quot;Loading source &quot;</span> + StringUtils.arrayToCommaDelimitedString(sources));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    BeanDefinitionLoader loader = createBeanDefinitionLoader(getBeanDefinitionRegistry(context), sources);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.beanNameGenerator != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setBeanNameGenerator(<span class=\"keyword\">this</span>.beanNameGenerator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.resourceLoader != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setResourceLoader(<span class=\"keyword\">this</span>.resourceLoader);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.environment != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setEnvironment(<span class=\"keyword\">this</span>.environment);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    loader.load();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringBoot</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>SpringBootSpringBoot</p>","more":"<p>        SpringBootSpringStruts2SpringBootwebmainproperties/ymlSpringSpringBootIOCAOPweb</p>\n<!--toc-->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyApplication</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SpringBootresources</p>\n<ul>\n<li>@SpringBootApplication</li>\n<li>SpringApplicationrunclassmainargs</li>\n</ul>\n<p>runrun</p>\n<ul>\n<li>SpringApplication</li>\n<li>run</li>\n</ul>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SpringApplication</span><span class=\"params\">(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.resourceLoader = resourceLoader;</span><br><span class=\"line\">    Assert.notNull(primarySources, <span class=\"string\">&quot;PrimarySources must not be null&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// class</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.primarySources = <span class=\"keyword\">new</span> LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.webApplicationType = WebApplicationType.deduceFromClasspath();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.mainApplicationClass = deduceMainApplicationClass();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SpringBootwebwebSpring</p>\n<p>webSpringBootwebwebclasswebclass</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String WEBMVC_INDICATOR_CLASS = <span class=\"string\">&quot;org.springframework.web.servlet.DispatcherServlet&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String WEBFLUX_INDICATOR_CLASS = <span class=\"string\">&quot;org.springframework.web.reactive.DispatcherHandler&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String JERSEY_INDICATOR_CLASS = <span class=\"string\">&quot;org.glassfish.jersey.servlet.ServletContainer&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> WebApplicationType <span class=\"title\">deduceFromClasspath</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, <span class=\"keyword\">null</span>) &amp;&amp; !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        &amp;&amp; !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> WebApplicationType.REACTIVE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String className : SERVLET_INDICATOR_CLASSES) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!ClassUtils.isPresent(className, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> WebApplicationType.NONE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> WebApplicationType.SERVLET;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SPI\"><a href=\"#SPI\" class=\"headerlink\" title=\"SPI\"></a>SPI</h2><p>SPI</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String FACTORIES_RESOURCE_LOCATION = <span class=\"string\">&quot;META-INF/spring.factories&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>SpringBootkey-value<code>ApplicaitonListener</code>class</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.context.ApplicationListener</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.ClearCachesApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.builder.ParentContextCloserApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.FileEncodingApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.config.AnsiOutputApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.config.ConfigFileApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.config.DelegatingApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.logging.ClasspathLoggingApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.logging.LoggingApplicationListener,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.liquibase.LiquibaseServiceLocatorApplicationListener</span></span><br></pre></td></tr></table></figure>\n\n<p><em>spring.facories</em>listenerlistenerevent<code>ClearCachesApplicationListener</code></p>\n<p>runList</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>ApplicationContextInitializer</code></p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.context.ApplicationContextInitializer</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.ContextIdApplicationContextInitializer,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.context.config.DelegatingApplicationContextInitializer,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.rsocket.context.RSocketPortInfoApplicationContextInitializer,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.web.context.ServerPortInfoApplicationContextInitializ</span></span><br></pre></td></tr></table></figure>\n\n<p>contextSpring warningsList</p>\n<h1 id=\"Run\"><a href=\"#Run\" class=\"headerlink\" title=\"Run\"></a>Run</h1><p>runrunrun</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ConfigurableApplicationContext <span class=\"title\">run</span><span class=\"params\">(String... args)</span> </span>&#123;</span><br><span class=\"line\">    StopWatch stopWatch = <span class=\"keyword\">new</span> StopWatch();</span><br><span class=\"line\">    stopWatch.start();</span><br><span class=\"line\">    ConfigurableApplicationContext context = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    configureHeadlessProperty();</span><br><span class=\"line\">    <span class=\"comment\">// listenerslistener</span></span><br><span class=\"line\">    SpringApplicationRunListeners listeners = getRunListeners(args);</span><br><span class=\"line\">    listeners.starting();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        ApplicationArguments applicationArguments = <span class=\"keyword\">new</span> DefaultApplicationArguments(args);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);</span><br><span class=\"line\">        configureIgnoreBeanInfo(environment);</span><br><span class=\"line\">        Banner printedBanner = printBanner(environment);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        context = createApplicationContext();</span><br><span class=\"line\">        exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,</span><br><span class=\"line\">                                                         <span class=\"keyword\">new</span> Class[] &#123; ConfigurableApplicationContext.class &#125;, context);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        prepareContext(context, environment, listeners, applicationArguments, printedBanner);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        refreshContext(context);</span><br><span class=\"line\">        afterRefresh(context, applicationArguments);</span><br><span class=\"line\">        stopWatch.stop();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.logStartupInfo) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> StartupInfoLogger(<span class=\"keyword\">this</span>.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        listeners.started(context);</span><br><span class=\"line\">        callRunners(context, applicationArguments);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        handleRunFailure(context, ex, exceptionReporters, listeners);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        listeners.running(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        handleRunFailure(context, ex, exceptionReporters, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> context;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"RunListeners\"><a href=\"#RunListeners\" class=\"headerlink\" title=\"RunListeners\"></a>RunListeners</h2><p><code>SpringApplicaitonRunListeners</code>listener</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> SpringApplicationRunListeners <span class=\"title\">getRunListeners</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    Class&lt;?&gt;[] types = <span class=\"keyword\">new</span> Class&lt;?&gt;[] &#123; SpringApplication.class, String[].class &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> SpringApplicationRunListeners(logger,</span><br><span class=\"line\">                                             getSpringFactoriesInstances(SpringApplicationRunListener.class, types, <span class=\"keyword\">this</span>, args));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>EventPublishingRunListener</code><code>SpringApplicationRunListeners</code><code>EventPublishingRunListener</code>runlisteners<code>EventPublishingRunListenr</code>listeners</p>\n<p><code>EventPublishingRunListener</code><code>SimpleApplicationEventMulticaster</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">starting</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.initialMulticaster.multicastEvent(<span class=\"keyword\">new</span> ApplicationStartingEvent(<span class=\"keyword\">this</span>.application, <span class=\"keyword\">this</span>.args));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>this.application</code><code>SpringApplication</code><code>SpringApplication</code>getlistenerseventlistener</p>\n<h2 id=\"createApplicationContext\"><a href=\"#createApplicationContext\" class=\"headerlink\" title=\"createApplicationContext\"></a>createApplicationContext</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.context.&quot;</span></span><br><span class=\"line\">            + <span class=\"string\">&quot;annotation.AnnotationConfigApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.boot.&quot;</span></span><br><span class=\"line\">            + <span class=\"string\">&quot;web.servlet.context.AnnotationConfigServletWebServerApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.&quot;</span></span><br><span class=\"line\">            + <span class=\"string\">&quot;boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> ConfigurableApplicationContext <span class=\"title\">createApplicationContext</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    Class&lt;?&gt; contextClass = <span class=\"keyword\">this</span>.applicationContextClass;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (contextClass == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">switch</span> (<span class=\"keyword\">this</span>.webApplicationType) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> SERVLET:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> REACTIVE:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (ClassNotFoundException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(</span><br><span class=\"line\">                <span class=\"string\">&quot;Unable create a default ApplicationContext, please specify an ApplicationContextClass&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"prepareContext\"><a href=\"#prepareContext\" class=\"headerlink\" title=\"prepareContext\"></a>prepareContext</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">prepareContext</span><span class=\"params\">(ConfigurableApplicationContext context, ConfigurableEnvironment environment,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                            SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner)</span> </span>&#123;</span><br><span class=\"line\">    context.setEnvironment(environment);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    postProcessApplicationContext(context);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    applyInitializers(context);</span><br><span class=\"line\">    listeners.contextPrepared(context);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.logStartupInfo) &#123;</span><br><span class=\"line\">        logStartupInfo(context.getParent() == <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        logStartupProfileInfo(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Add boot specific singleton beans</span></span><br><span class=\"line\">    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();</span><br><span class=\"line\">    beanFactory.registerSingleton(<span class=\"string\">&quot;springApplicationArguments&quot;</span>, applicationArguments);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (printedBanner != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        beanFactory.registerSingleton(<span class=\"string\">&quot;springBootBanner&quot;</span>, printedBanner);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanFactory <span class=\"keyword\">instanceof</span> DefaultListableBeanFactory) &#123;</span><br><span class=\"line\">        ((DefaultListableBeanFactory) beanFactory)</span><br><span class=\"line\">        .setAllowBeanDefinitionOverriding(<span class=\"keyword\">this</span>.allowBeanDefinitionOverriding);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.lazyInitialization) &#123;</span><br><span class=\"line\">        context.addBeanFactoryPostProcessor(<span class=\"keyword\">new</span> LazyInitializationBeanFactoryPostProcessor());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Load the sources</span></span><br><span class=\"line\">    Set&lt;Object&gt; sources = getAllSources();</span><br><span class=\"line\">    Assert.notEmpty(sources, <span class=\"string\">&quot;Sources must not be empty&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// BeanDefinitionLoader</span></span><br><span class=\"line\">    load(context, sources.toArray(<span class=\"keyword\">new</span> Object[<span class=\"number\">0</span>]));</span><br><span class=\"line\">    listeners.contextLoaded(context);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>listeners<em>contextPrepared</em><em>contextLoaded</em>bean</p>\n<h3 id=\"contextPrepared\"><a href=\"#contextPrepared\" class=\"headerlink\" title=\"contextPrepared\"></a>contextPrepared</h3><p></p>\n<h4 id=\"postProcess\"><a href=\"#postProcess\" class=\"headerlink\" title=\"postProcess\"></a>postProcess</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">postProcessApplicationContext</span><span class=\"params\">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.beanNameGenerator != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// bean</span></span><br><span class=\"line\">        context.getBeanFactory().registerSingleton(AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR,</span><br><span class=\"line\">                                                   <span class=\"keyword\">this</span>.beanNameGenerator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.resourceLoader != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context <span class=\"keyword\">instanceof</span> GenericApplicationContext) &#123;</span><br><span class=\"line\">            ((GenericApplicationContext) context).setResourceLoader(<span class=\"keyword\">this</span>.resourceLoader);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context <span class=\"keyword\">instanceof</span> DefaultResourceLoader) &#123;</span><br><span class=\"line\">            ((DefaultResourceLoader) context).setClassLoader(<span class=\"keyword\">this</span>.resourceLoader.getClassLoader());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.addConversionService) &#123;</span><br><span class=\"line\">        context.getBeanFactory().setConversionService(ApplicationConversionService.getSharedInstance());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>beanNameGenerator</code></p>\n<h4 id=\"applyInitializers\"><a href=\"#applyInitializers\" class=\"headerlink\" title=\"applyInitializers\"></a>applyInitializers</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">applyInitializers</span><span class=\"params\">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ApplicationContextInitializer initializer : getInitializers()) &#123;</span><br><span class=\"line\">        Class&lt;?&gt; requiredType = GenericTypeResolver.resolveTypeArgument(initializer.getClass(),</span><br><span class=\"line\">                                                                        ApplicationContextInitializer.class);</span><br><span class=\"line\">        Assert.isInstanceOf(requiredType, context, <span class=\"string\">&quot;Unable to call initializer.&quot;</span>);</span><br><span class=\"line\">        initializer.initialize(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"contextLoaded\"><a href=\"#contextLoaded\" class=\"headerlink\" title=\"contextLoaded\"></a>contextLoaded</h3><p><code>BeanDefinitionLoader</code>xmljavaConfigbean</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">load</span><span class=\"params\">(ApplicationContext context, Object[] sources)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class=\"line\">        logger.debug(<span class=\"string\">&quot;Loading source &quot;</span> + StringUtils.arrayToCommaDelimitedString(sources));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    BeanDefinitionLoader loader = createBeanDefinitionLoader(getBeanDefinitionRegistry(context), sources);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.beanNameGenerator != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setBeanNameGenerator(<span class=\"keyword\">this</span>.beanNameGenerator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.resourceLoader != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setResourceLoader(<span class=\"keyword\">this</span>.resourceLoader);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.environment != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setEnvironment(<span class=\"keyword\">this</span>.environment);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    loader.load();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringBoot</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>"},{"title":"SpringBoot refresh","date":"2021-02-15T08:19:30.000Z","_content":"\nSpringBootrun*refresh*\n\n<!--more-->\n\nSpringBootrefreshrefreshrefreshrefresh\n\n```java\nsynchronized (this.startupShutdownMonitor) {\n    // Prepare this context for refreshing.\n    prepareRefresh();\n\n    // Tell the subclass to refresh the internal bean factory.\n    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();\n\n    // Prepare the bean factory for use in this context.\n    prepareBeanFactory(beanFactory);\n\n    try {\n        // Allows post-processing of the bean factory in context subclasses.\n        postProcessBeanFactory(beanFactory);\n\n        // Invoke factory processors registered as beans in the context.\n        invokeBeanFactoryPostProcessors(beanFactory);\n\n        // Register bean processors that intercept bean creation.\n        registerBeanPostProcessors(beanFactory);\n\n        // Initialize message source for this context.\n        initMessageSource();\n\n        // Initialize event multicaster for this context.\n        initApplicationEventMulticaster();\n\n        // Initialize other special beans in specific context subclasses.\n        onRefresh();\n\n        // Check for listener beans and register them.\n        registerListeners();\n\n        // Instantiate all remaining (non-lazy-init) singletons.\n        finishBeanFactoryInitialization(beanFactory);\n\n        // Last step: publish corresponding event.\n        finishRefresh();\n    }\n```\n\n<!--toc-->\n\n# prepareRefresh\n\nproperty\n\n# prepareBeanFactory\n\nbeanFactory\n\n1. bean\n\n2. beanPostProcessor`ApplicationContextAwarePostProcessor`\n   \n   ```java\n   // Configure the bean factory with context callbacks.\n   beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));\n   beanFactory.ignoreDependencyInterface(EnvironmentAware.class);\n   beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);\n   beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);\n   beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);\n   beanFactory.ignoreDependencyInterface(MessageSourceAware.class);\n   beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);\n   ```\n\n3. bean*registerResolvableDependency*key-valuemap\n   \n   ```java\n   // BeanFactory interface not registered as resolvable type in a plain factory.\n   // MessageSource registered (and found for autowiring) as a bean.\n   beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);\n   // this\n   beanFactory.registerResolvableDependency(ResourceLoader.class, this);\n   beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this);\n   beanFactory.registerResolvableDependency(ApplicationContext.class, this);\n   ```\n\n# postProcessBeanFactory\n\npostProcessorbeanFacotrywebbeanservletContext\n\n```java\nprotected void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) {\n    // addignoreprocessor\n    beanFactory.addBeanPostProcessor(new ServletContextAwareProcessor(this.servletContext, this.servletConfig));\n    beanFactory.ignoreDependencyInterface(ServletContextAware.class);\n    beanFactory.ignoreDependencyInterface(ServletConfigAware.class);\n\n    WebApplicationContextUtils.registerWebApplicationScopes(beanFactory, this.servletContext);\n    WebApplicationContextUtils.registerEnvironmentBeans(beanFactory, this.servletContext, this.servletConfig);\n}\n```\n\n# invokeBeanFactoryPostProcessors\n\npostProcessContextpostProcessorBeanFactory`PostProcessorRegistrationDelegate`\n\n        postProcessorpriorityOrdered, ordered, regularprocessorcontextcontext*BeanDefinitionRegistry*postProcessor\n\n```java\nString[] postProcessorNames =\n    beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);\nfor (String ppName : postProcessorNames) {\n    if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {\n        // configurationClassPostProcessor@Config\n        currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));\n        processedBeans.add(ppName);\n    }\n}\nsortPostProcessors(currentRegistryProcessors, beanFactory);\nregistryProcessors.addAll(currentRegistryProcessors);\ninvokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);\ncurrentRegistryProcessors.clear();\n```\n\n        Configertaion@SpringApplication`ConfigurationClassParser`beanBeanDefinitionHolderbeanDefinitionbean*doProcessConfigurationClass*@PropertySource@ComponentScan@Import@ImportResourceimport`selector`\n\n        @SpringApplication\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@SpringBootConfiguration\n@EnableAutoConfiguration // \n@ComponentScan(excludeFilters = { @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),\n        @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) })\npublic @interface SpringBootApplication {\n    // ...\n}\n```\n\n\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@AutoConfigurationPackage\n@Import(AutoConfigurationImportSelector.class) // \npublic @interface EnableAutoConfiguration {\n    // ...\n}\n```\n\nAutoConfigurationImportSelectorselectImport`getCandidateConfigurations`*EnableAutoConfiguration.class*key*spring.factories*values\n\n```properties\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\\norg.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\\n# ...\n```\n\nbeanFactory\n\n# registerBeanPostProcessors\n\n`PostProcessorRegistrationDelegate`\n\n# InitMessageSource\n\n\n\n# initApplicationEventMulticaster\n\n\n\n# onRefresh\n\nServletweb\n\n# registerListeners\n\n\n\n# finishBeanFactoryInitialization\n\nbean\n\n# finishRefresh\n\n\n\n# \n\nrefresh\n\n- \n- \n- bean","source":"_posts/SpringBoot-refresh.md","raw":"---\ntitle: SpringBoot refresh\ndate: 2021-02-15 16:19:30\ncategories: springboot\ntags: refresh\n---\n\nSpringBootrun*refresh*\n\n<!--more-->\n\nSpringBootrefreshrefreshrefreshrefresh\n\n```java\nsynchronized (this.startupShutdownMonitor) {\n    // Prepare this context for refreshing.\n    prepareRefresh();\n\n    // Tell the subclass to refresh the internal bean factory.\n    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();\n\n    // Prepare the bean factory for use in this context.\n    prepareBeanFactory(beanFactory);\n\n    try {\n        // Allows post-processing of the bean factory in context subclasses.\n        postProcessBeanFactory(beanFactory);\n\n        // Invoke factory processors registered as beans in the context.\n        invokeBeanFactoryPostProcessors(beanFactory);\n\n        // Register bean processors that intercept bean creation.\n        registerBeanPostProcessors(beanFactory);\n\n        // Initialize message source for this context.\n        initMessageSource();\n\n        // Initialize event multicaster for this context.\n        initApplicationEventMulticaster();\n\n        // Initialize other special beans in specific context subclasses.\n        onRefresh();\n\n        // Check for listener beans and register them.\n        registerListeners();\n\n        // Instantiate all remaining (non-lazy-init) singletons.\n        finishBeanFactoryInitialization(beanFactory);\n\n        // Last step: publish corresponding event.\n        finishRefresh();\n    }\n```\n\n<!--toc-->\n\n# prepareRefresh\n\nproperty\n\n# prepareBeanFactory\n\nbeanFactory\n\n1. bean\n\n2. beanPostProcessor`ApplicationContextAwarePostProcessor`\n   \n   ```java\n   // Configure the bean factory with context callbacks.\n   beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));\n   beanFactory.ignoreDependencyInterface(EnvironmentAware.class);\n   beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);\n   beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);\n   beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);\n   beanFactory.ignoreDependencyInterface(MessageSourceAware.class);\n   beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);\n   ```\n\n3. bean*registerResolvableDependency*key-valuemap\n   \n   ```java\n   // BeanFactory interface not registered as resolvable type in a plain factory.\n   // MessageSource registered (and found for autowiring) as a bean.\n   beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);\n   // this\n   beanFactory.registerResolvableDependency(ResourceLoader.class, this);\n   beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this);\n   beanFactory.registerResolvableDependency(ApplicationContext.class, this);\n   ```\n\n# postProcessBeanFactory\n\npostProcessorbeanFacotrywebbeanservletContext\n\n```java\nprotected void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) {\n    // addignoreprocessor\n    beanFactory.addBeanPostProcessor(new ServletContextAwareProcessor(this.servletContext, this.servletConfig));\n    beanFactory.ignoreDependencyInterface(ServletContextAware.class);\n    beanFactory.ignoreDependencyInterface(ServletConfigAware.class);\n\n    WebApplicationContextUtils.registerWebApplicationScopes(beanFactory, this.servletContext);\n    WebApplicationContextUtils.registerEnvironmentBeans(beanFactory, this.servletContext, this.servletConfig);\n}\n```\n\n# invokeBeanFactoryPostProcessors\n\npostProcessContextpostProcessorBeanFactory`PostProcessorRegistrationDelegate`\n\n        postProcessorpriorityOrdered, ordered, regularprocessorcontextcontext*BeanDefinitionRegistry*postProcessor\n\n```java\nString[] postProcessorNames =\n    beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);\nfor (String ppName : postProcessorNames) {\n    if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {\n        // configurationClassPostProcessor@Config\n        currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));\n        processedBeans.add(ppName);\n    }\n}\nsortPostProcessors(currentRegistryProcessors, beanFactory);\nregistryProcessors.addAll(currentRegistryProcessors);\ninvokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);\ncurrentRegistryProcessors.clear();\n```\n\n        Configertaion@SpringApplication`ConfigurationClassParser`beanBeanDefinitionHolderbeanDefinitionbean*doProcessConfigurationClass*@PropertySource@ComponentScan@Import@ImportResourceimport`selector`\n\n        @SpringApplication\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@SpringBootConfiguration\n@EnableAutoConfiguration // \n@ComponentScan(excludeFilters = { @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),\n        @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) })\npublic @interface SpringBootApplication {\n    // ...\n}\n```\n\n\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@AutoConfigurationPackage\n@Import(AutoConfigurationImportSelector.class) // \npublic @interface EnableAutoConfiguration {\n    // ...\n}\n```\n\nAutoConfigurationImportSelectorselectImport`getCandidateConfigurations`*EnableAutoConfiguration.class*key*spring.factories*values\n\n```properties\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\\norg.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\\n# ...\n```\n\nbeanFactory\n\n# registerBeanPostProcessors\n\n`PostProcessorRegistrationDelegate`\n\n# InitMessageSource\n\n\n\n# initApplicationEventMulticaster\n\n\n\n# onRefresh\n\nServletweb\n\n# registerListeners\n\n\n\n# finishBeanFactoryInitialization\n\nbean\n\n# finishRefresh\n\n\n\n# \n\nrefresh\n\n- \n- \n- bean","slug":"SpringBoot-refresh","published":1,"updated":"2022-12-09T14:45:28.913Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwe000w8py010p4f0mh","content":"<p>SpringBootrun<em>refresh</em></p>\n<span id=\"more\"></span>\n\n<p>SpringBootrefreshrefreshrefreshrefresh</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.startupShutdownMonitor) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Prepare this context for refreshing.</span></span><br><span class=\"line\">    prepareRefresh();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Tell the subclass to refresh the internal bean factory.</span></span><br><span class=\"line\">    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Prepare the bean factory for use in this context.</span></span><br><span class=\"line\">    prepareBeanFactory(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Allows post-processing of the bean factory in context subclasses.</span></span><br><span class=\"line\">        postProcessBeanFactory(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Invoke factory processors registered as beans in the context.</span></span><br><span class=\"line\">        invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Register bean processors that intercept bean creation.</span></span><br><span class=\"line\">        registerBeanPostProcessors(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize message source for this context.</span></span><br><span class=\"line\">        initMessageSource();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize event multicaster for this context.</span></span><br><span class=\"line\">        initApplicationEventMulticaster();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize other special beans in specific context subclasses.</span></span><br><span class=\"line\">        onRefresh();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Check for listener beans and register them.</span></span><br><span class=\"line\">        registerListeners();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Instantiate all remaining (non-lazy-init) singletons.</span></span><br><span class=\"line\">        finishBeanFactoryInitialization(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Last step: publish corresponding event.</span></span><br><span class=\"line\">        finishRefresh();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<!--toc-->\n\n<h1 id=\"prepareRefresh\"><a href=\"#prepareRefresh\" class=\"headerlink\" title=\"prepareRefresh\"></a>prepareRefresh</h1><p>property</p>\n<h1 id=\"prepareBeanFactory\"><a href=\"#prepareBeanFactory\" class=\"headerlink\" title=\"prepareBeanFactory\"></a>prepareBeanFactory</h1><p>beanFactory</p>\n<ol>\n<li><p>bean</p>\n</li>\n<li><p>beanPostProcessor<code>ApplicationContextAwarePostProcessor</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Configure the bean factory with context callbacks.</span></span><br><span class=\"line\">beanFactory.addBeanPostProcessor(<span class=\"keyword\">new</span> ApplicationContextAwareProcessor(<span class=\"keyword\">this</span>));</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(EnvironmentAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(MessageSourceAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>bean<em>registerResolvableDependency</em>key-valuemap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// BeanFactory interface not registered as resolvable type in a plain factory.</span></span><br><span class=\"line\"><span class=\"comment\">// MessageSource registered (and found for autowiring) as a bean.</span></span><br><span class=\"line\">beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);</span><br><span class=\"line\"><span class=\"comment\">// this</span></span><br><span class=\"line\">beanFactory.registerResolvableDependency(ResourceLoader.class, <span class=\"keyword\">this</span>);</span><br><span class=\"line\">beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, <span class=\"keyword\">this</span>);</span><br><span class=\"line\">beanFactory.registerResolvableDependency(ApplicationContext.class, <span class=\"keyword\">this</span>);</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h1 id=\"postProcessBeanFactory\"><a href=\"#postProcessBeanFactory\" class=\"headerlink\" title=\"postProcessBeanFactory\"></a>postProcessBeanFactory</h1><p>postProcessorbeanFacotrywebbeanservletContext</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">postProcessBeanFactory</span><span class=\"params\">(ConfigurableListableBeanFactory beanFactory)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// addignoreprocessor</span></span><br><span class=\"line\">    beanFactory.addBeanPostProcessor(<span class=\"keyword\">new</span> ServletContextAwareProcessor(<span class=\"keyword\">this</span>.servletContext, <span class=\"keyword\">this</span>.servletConfig));</span><br><span class=\"line\">    beanFactory.ignoreDependencyInterface(ServletContextAware.class);</span><br><span class=\"line\">    beanFactory.ignoreDependencyInterface(ServletConfigAware.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    WebApplicationContextUtils.registerWebApplicationScopes(beanFactory, <span class=\"keyword\">this</span>.servletContext);</span><br><span class=\"line\">    WebApplicationContextUtils.registerEnvironmentBeans(beanFactory, <span class=\"keyword\">this</span>.servletContext, <span class=\"keyword\">this</span>.servletConfig);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"invokeBeanFactoryPostProcessors\"><a href=\"#invokeBeanFactoryPostProcessors\" class=\"headerlink\" title=\"invokeBeanFactoryPostProcessors\"></a>invokeBeanFactoryPostProcessors</h1><p>postProcessContextpostProcessorBeanFactory<code>PostProcessorRegistrationDelegate</code></p>\n<p>        postProcessorpriorityOrdered, ordered, regularprocessorcontextcontext<em>BeanDefinitionRegistry</em>postProcessor</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String[] postProcessorNames =</span><br><span class=\"line\">    beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, <span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String ppName : postProcessorNames) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// configurationClassPostProcessor@Config</span></span><br><span class=\"line\">        currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));</span><br><span class=\"line\">        processedBeans.add(ppName);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">sortPostProcessors(currentRegistryProcessors, beanFactory);</span><br><span class=\"line\">registryProcessors.addAll(currentRegistryProcessors);</span><br><span class=\"line\">invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);</span><br><span class=\"line\">currentRegistryProcessors.clear();</span><br></pre></td></tr></table></figure>\n\n<p>        Configertaion@SpringApplication<code>ConfigurationClassParser</code>beanBeanDefinitionHolderbeanDefinitionbean<em>doProcessConfigurationClass</em>@PropertySource@ComponentScan@Import@ImportResourceimport<code>selector</code></p>\n<p>        @SpringApplication</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootConfiguration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableAutoConfiguration</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan(excludeFilters = &#123; @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),</span></span><br><span class=\"line\"><span class=\"meta\">        @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) &#125;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> SpringBootApplication &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@AutoConfigurationPackage</span></span><br><span class=\"line\"><span class=\"meta\">@Import(AutoConfigurationImportSelector.class)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> EnableAutoConfiguration &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AutoConfigurationImportSelectorselectImport<code>getCandidateConfigurations</code><em>EnableAutoConfiguration.class</em>key<em>spring.factories</em>values</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\</span></span><br><span class=\"line\"><span class=\"string\"># ...</span></span><br></pre></td></tr></table></figure>\n\n<p>beanFactory</p>\n<h1 id=\"registerBeanPostProcessors\"><a href=\"#registerBeanPostProcessors\" class=\"headerlink\" title=\"registerBeanPostProcessors\"></a>registerBeanPostProcessors</h1><p><code>PostProcessorRegistrationDelegate</code></p>\n<h1 id=\"InitMessageSource\"><a href=\"#InitMessageSource\" class=\"headerlink\" title=\"InitMessageSource\"></a>InitMessageSource</h1><p></p>\n<h1 id=\"initApplicationEventMulticaster\"><a href=\"#initApplicationEventMulticaster\" class=\"headerlink\" title=\"initApplicationEventMulticaster\"></a>initApplicationEventMulticaster</h1><p></p>\n<h1 id=\"onRefresh\"><a href=\"#onRefresh\" class=\"headerlink\" title=\"onRefresh\"></a>onRefresh</h1><p>Servletweb</p>\n<h1 id=\"registerListeners\"><a href=\"#registerListeners\" class=\"headerlink\" title=\"registerListeners\"></a>registerListeners</h1><p></p>\n<h1 id=\"finishBeanFactoryInitialization\"><a href=\"#finishBeanFactoryInitialization\" class=\"headerlink\" title=\"finishBeanFactoryInitialization\"></a>finishBeanFactoryInitialization</h1><p>bean</p>\n<h1 id=\"finishRefresh\"><a href=\"#finishRefresh\" class=\"headerlink\" title=\"finishRefresh\"></a>finishRefresh</h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>refresh</p>\n<ul>\n<li></li>\n<li></li>\n<li>bean</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>SpringBootrun<em>refresh</em></p>","more":"<p>SpringBootrefreshrefreshrefreshrefresh</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.startupShutdownMonitor) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Prepare this context for refreshing.</span></span><br><span class=\"line\">    prepareRefresh();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Tell the subclass to refresh the internal bean factory.</span></span><br><span class=\"line\">    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Prepare the bean factory for use in this context.</span></span><br><span class=\"line\">    prepareBeanFactory(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Allows post-processing of the bean factory in context subclasses.</span></span><br><span class=\"line\">        postProcessBeanFactory(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Invoke factory processors registered as beans in the context.</span></span><br><span class=\"line\">        invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Register bean processors that intercept bean creation.</span></span><br><span class=\"line\">        registerBeanPostProcessors(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize message source for this context.</span></span><br><span class=\"line\">        initMessageSource();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize event multicaster for this context.</span></span><br><span class=\"line\">        initApplicationEventMulticaster();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize other special beans in specific context subclasses.</span></span><br><span class=\"line\">        onRefresh();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Check for listener beans and register them.</span></span><br><span class=\"line\">        registerListeners();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Instantiate all remaining (non-lazy-init) singletons.</span></span><br><span class=\"line\">        finishBeanFactoryInitialization(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Last step: publish corresponding event.</span></span><br><span class=\"line\">        finishRefresh();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<!--toc-->\n\n<h1 id=\"prepareRefresh\"><a href=\"#prepareRefresh\" class=\"headerlink\" title=\"prepareRefresh\"></a>prepareRefresh</h1><p>property</p>\n<h1 id=\"prepareBeanFactory\"><a href=\"#prepareBeanFactory\" class=\"headerlink\" title=\"prepareBeanFactory\"></a>prepareBeanFactory</h1><p>beanFactory</p>\n<ol>\n<li><p>bean</p>\n</li>\n<li><p>beanPostProcessor<code>ApplicationContextAwarePostProcessor</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Configure the bean factory with context callbacks.</span></span><br><span class=\"line\">beanFactory.addBeanPostProcessor(<span class=\"keyword\">new</span> ApplicationContextAwareProcessor(<span class=\"keyword\">this</span>));</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(EnvironmentAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(MessageSourceAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>bean<em>registerResolvableDependency</em>key-valuemap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// BeanFactory interface not registered as resolvable type in a plain factory.</span></span><br><span class=\"line\"><span class=\"comment\">// MessageSource registered (and found for autowiring) as a bean.</span></span><br><span class=\"line\">beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);</span><br><span class=\"line\"><span class=\"comment\">// this</span></span><br><span class=\"line\">beanFactory.registerResolvableDependency(ResourceLoader.class, <span class=\"keyword\">this</span>);</span><br><span class=\"line\">beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, <span class=\"keyword\">this</span>);</span><br><span class=\"line\">beanFactory.registerResolvableDependency(ApplicationContext.class, <span class=\"keyword\">this</span>);</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h1 id=\"postProcessBeanFactory\"><a href=\"#postProcessBeanFactory\" class=\"headerlink\" title=\"postProcessBeanFactory\"></a>postProcessBeanFactory</h1><p>postProcessorbeanFacotrywebbeanservletContext</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">postProcessBeanFactory</span><span class=\"params\">(ConfigurableListableBeanFactory beanFactory)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// addignoreprocessor</span></span><br><span class=\"line\">    beanFactory.addBeanPostProcessor(<span class=\"keyword\">new</span> ServletContextAwareProcessor(<span class=\"keyword\">this</span>.servletContext, <span class=\"keyword\">this</span>.servletConfig));</span><br><span class=\"line\">    beanFactory.ignoreDependencyInterface(ServletContextAware.class);</span><br><span class=\"line\">    beanFactory.ignoreDependencyInterface(ServletConfigAware.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    WebApplicationContextUtils.registerWebApplicationScopes(beanFactory, <span class=\"keyword\">this</span>.servletContext);</span><br><span class=\"line\">    WebApplicationContextUtils.registerEnvironmentBeans(beanFactory, <span class=\"keyword\">this</span>.servletContext, <span class=\"keyword\">this</span>.servletConfig);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"invokeBeanFactoryPostProcessors\"><a href=\"#invokeBeanFactoryPostProcessors\" class=\"headerlink\" title=\"invokeBeanFactoryPostProcessors\"></a>invokeBeanFactoryPostProcessors</h1><p>postProcessContextpostProcessorBeanFactory<code>PostProcessorRegistrationDelegate</code></p>\n<p>        postProcessorpriorityOrdered, ordered, regularprocessorcontextcontext<em>BeanDefinitionRegistry</em>postProcessor</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String[] postProcessorNames =</span><br><span class=\"line\">    beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, <span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String ppName : postProcessorNames) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// configurationClassPostProcessor@Config</span></span><br><span class=\"line\">        currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));</span><br><span class=\"line\">        processedBeans.add(ppName);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">sortPostProcessors(currentRegistryProcessors, beanFactory);</span><br><span class=\"line\">registryProcessors.addAll(currentRegistryProcessors);</span><br><span class=\"line\">invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);</span><br><span class=\"line\">currentRegistryProcessors.clear();</span><br></pre></td></tr></table></figure>\n\n<p>        Configertaion@SpringApplication<code>ConfigurationClassParser</code>beanBeanDefinitionHolderbeanDefinitionbean<em>doProcessConfigurationClass</em>@PropertySource@ComponentScan@Import@ImportResourceimport<code>selector</code></p>\n<p>        @SpringApplication</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootConfiguration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableAutoConfiguration</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan(excludeFilters = &#123; @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),</span></span><br><span class=\"line\"><span class=\"meta\">        @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) &#125;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> SpringBootApplication &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@AutoConfigurationPackage</span></span><br><span class=\"line\"><span class=\"meta\">@Import(AutoConfigurationImportSelector.class)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> EnableAutoConfiguration &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AutoConfigurationImportSelectorselectImport<code>getCandidateConfigurations</code><em>EnableAutoConfiguration.class</em>key<em>spring.factories</em>values</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\</span></span><br><span class=\"line\"><span class=\"string\">org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\</span></span><br><span class=\"line\"><span class=\"string\"># ...</span></span><br></pre></td></tr></table></figure>\n\n<p>beanFactory</p>\n<h1 id=\"registerBeanPostProcessors\"><a href=\"#registerBeanPostProcessors\" class=\"headerlink\" title=\"registerBeanPostProcessors\"></a>registerBeanPostProcessors</h1><p><code>PostProcessorRegistrationDelegate</code></p>\n<h1 id=\"InitMessageSource\"><a href=\"#InitMessageSource\" class=\"headerlink\" title=\"InitMessageSource\"></a>InitMessageSource</h1><p></p>\n<h1 id=\"initApplicationEventMulticaster\"><a href=\"#initApplicationEventMulticaster\" class=\"headerlink\" title=\"initApplicationEventMulticaster\"></a>initApplicationEventMulticaster</h1><p></p>\n<h1 id=\"onRefresh\"><a href=\"#onRefresh\" class=\"headerlink\" title=\"onRefresh\"></a>onRefresh</h1><p>Servletweb</p>\n<h1 id=\"registerListeners\"><a href=\"#registerListeners\" class=\"headerlink\" title=\"registerListeners\"></a>registerListeners</h1><p></p>\n<h1 id=\"finishBeanFactoryInitialization\"><a href=\"#finishBeanFactoryInitialization\" class=\"headerlink\" title=\"finishBeanFactoryInitialization\"></a>finishBeanFactoryInitialization</h1><p>bean</p>\n<h1 id=\"finishRefresh\"><a href=\"#finishRefresh\" class=\"headerlink\" title=\"finishRefresh\"></a>finishRefresh</h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>refresh</p>\n<ul>\n<li></li>\n<li></li>\n<li>bean</li>\n</ul>"},{"title":"acm standard inputoutput","date":"2021-04-19T13:56:55.000Z","_content":"\n        LeetCodeACM\n\n<!-- more -->\n\n# \n\nwhilefor****\n\n## \n\n#### A\n\n:\n\n```\na,b(1 <= a, b <= 10^9),\n```\n\n:\n\n```markdown\na+b\n```\n\n1\n\n\n\n```\n1 5\n10 20\n```\n\n\n\n```markdown\n6\n30\n```\n\nTHINKING\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){ // next() or nextInt() is ok\n            int a = sc.nextInt();\n            int b = sc.nextInt();\n            // your business\n            System.out.println(a+b);\n        }\n    }\n}\n```\n\n#### B\n\n:\n\n```\n, \nn(1 <= n <= 100)\nn, \n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n4 1 2 3 4\n5 1 2 3 4 5\n```\n\n\n\n```\n10\n15\n```\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n\n    }\n}\n```\n\nTHINKING****\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            int n = sc.nextInt();\n            int[] arr = new int[n];\n            for(int i=0; i<n; i++){\n                arr[i] = sc.nextInt();\n            }\n            // your business\n            int sum = 0;\n            for(int num : arr){\n                sum += num;\n            }\n            System.out.println(sum);\n        }\n    }\n}\n```\n\n####  C\n\n:\n\n```\n\n\nnn100\n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\na c bb\nf dddd\nnowcoder\n```\n\n\n\n```\na bb c\ndddd f\nnowcoder\n```\n\nTHINKING\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            String[] str = sc.nextLine().split(\" \");\n            //  your business\n            Arrays.sort(str);\n            StringBuilder sb = new StringBuilder(str[0]);\n            for(int i=1; i<str.length; i++){\n                sb.append(\" \").append(str[i]);\n            }\n            System.out.println(sb.toString());\n        }\n    }\n}\n```\n\n### \n\nwhile\n\n####  A\n\n:\n\n```\na,b(1 <= a, b <= 10^9),, 0 0\n```\n\n:\n\n```\na+b\n```\n\n1\n\n\n\n```\n1 5\n10 20\n0 0\n```\n\n\n\n```\n6\n30\n```\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            int a = sc.nextInt();\n            int b = sc.nextInt();\n            if(a == 0 && b == 0) return;\n            // your business\n            System.out.println(a+b);\n        }\n    }\n}\n```\n\n#### B\n\n\n\n:\n\n```\n\n,n(1 <= n <= 100), n0\nn,\n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n4 1 2 3 4\n5 1 2 3 4 5\n0\n```\n\n\n\n```\n10\n15\n```\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            // \n            int n = sc.nextInt();\n            if(n == 0) return;\n            int[] arr = new int[n];\n            for(int i=0; i<n; i++){\n                arr[i] = sc.nextInt();\n            }\n            // your business\n            int sum = 0;\n            for(int num : arr){\n                sum += num;\n            }\n            System.out.println(sum);\n        }\n    }\n}\n```\n\n#### C\n\n:\n\n```\n, \n\nn(1 <= n <= 100)\n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n1 2 3\n4 5\n0 0 0 0 0\n```\n\n\n\n```\n6\n9\n0\n```\n\nTHINKINGjava`nextLine()``nextInt()`******`nextLine()`**\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            String[] str = sc.nextLine().split(\" \");\n            // your business\n            int sum = 0;\n            for(String s : str){\n                sum += Integer.parseInt(s);\n            }\n            System.out.println(sum);\n        }\n    }\n}\n```\n\n## \n\n#### A\n\n:\n\n```\nt(1 <= t <= 100)\na,b(1 <= a, b <= 10^9)\n```\n\n:\n\n```\na+b\n```\n\n1\n\n\n\n```\n2\n1 5\n10 20\n```\n\n\n\n```\n6\n30\n```\n\nTHINKINGwhile \n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        int t = sc.nextInt();\n        for(int i=0; i<t; i++){\n            int a = sc.nextInt();\n            int b = sc.nextInt();\n            // your business\n            System.out.println(a+b);\n        }\n    }\n}\n```\n\n#### B\n\n:\n\n```\nt(1 <= t <= 100), \nt, \nn(1 <= n <= 100)\nn, \n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n2\n4 1 2 3 4\n5 1 2 3 4 5\n```\n\n\n\n```\n10\n15\n```\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        int t = sc.nextInt();\n        for(int i=0; i<t; i++){\n            int n= sc.nextInt();\n            int[] arr = new int[n];\n            for(int j=0; j<n; j++){\n                arr[j] = sc.nextInt();\n            }\n            // your business\n            int sum = 0;\n            for(int num : arr){\n                sum += num;\n            }\n            System.out.println(sum);\n        }\n    }\n}\n```\n\n# \n\n**for****while**`hasNext()`\n\n#### A\n\n:\n\n```\nn\n\nn\n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n5\nc d a bb e\n```\n\n\n\n```\na bb c d e\n```\n\nTHINKING**splitok**\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        // nextLine\n        int n = Integer.parseInt(sc.nextLine());\n        String[] str = sc.nextLine().split(\" \");\n        // your business\n        Arrays.sort(str);\n        StringBuilder sb = new StringBuilder(str[0]);\n        for(int i=1; i<n; i++){\n            sb.append(\" \").append(str[i]);\n        }\n        System.out.println(sb.toString());\n    }\n}\n```\n\n# \n\n        LeetcodeACMACACMPATCodeForcesACM\n\n        `hasNext()``nextLine()``split()`****","source":"_posts/acm-standard-inputoutput.md","raw":"---\ntitle: acm standard inputoutput\ndate: 2021-04-19 21:56:55\ncategories: leetcode\ntags: standard\n---\n\n        LeetCodeACM\n\n<!-- more -->\n\n# \n\nwhilefor****\n\n## \n\n#### A\n\n:\n\n```\na,b(1 <= a, b <= 10^9),\n```\n\n:\n\n```markdown\na+b\n```\n\n1\n\n\n\n```\n1 5\n10 20\n```\n\n\n\n```markdown\n6\n30\n```\n\nTHINKING\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){ // next() or nextInt() is ok\n            int a = sc.nextInt();\n            int b = sc.nextInt();\n            // your business\n            System.out.println(a+b);\n        }\n    }\n}\n```\n\n#### B\n\n:\n\n```\n, \nn(1 <= n <= 100)\nn, \n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n4 1 2 3 4\n5 1 2 3 4 5\n```\n\n\n\n```\n10\n15\n```\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n\n    }\n}\n```\n\nTHINKING****\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            int n = sc.nextInt();\n            int[] arr = new int[n];\n            for(int i=0; i<n; i++){\n                arr[i] = sc.nextInt();\n            }\n            // your business\n            int sum = 0;\n            for(int num : arr){\n                sum += num;\n            }\n            System.out.println(sum);\n        }\n    }\n}\n```\n\n####  C\n\n:\n\n```\n\n\nnn100\n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\na c bb\nf dddd\nnowcoder\n```\n\n\n\n```\na bb c\ndddd f\nnowcoder\n```\n\nTHINKING\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            String[] str = sc.nextLine().split(\" \");\n            //  your business\n            Arrays.sort(str);\n            StringBuilder sb = new StringBuilder(str[0]);\n            for(int i=1; i<str.length; i++){\n                sb.append(\" \").append(str[i]);\n            }\n            System.out.println(sb.toString());\n        }\n    }\n}\n```\n\n### \n\nwhile\n\n####  A\n\n:\n\n```\na,b(1 <= a, b <= 10^9),, 0 0\n```\n\n:\n\n```\na+b\n```\n\n1\n\n\n\n```\n1 5\n10 20\n0 0\n```\n\n\n\n```\n6\n30\n```\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            int a = sc.nextInt();\n            int b = sc.nextInt();\n            if(a == 0 && b == 0) return;\n            // your business\n            System.out.println(a+b);\n        }\n    }\n}\n```\n\n#### B\n\n\n\n:\n\n```\n\n,n(1 <= n <= 100), n0\nn,\n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n4 1 2 3 4\n5 1 2 3 4 5\n0\n```\n\n\n\n```\n10\n15\n```\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            // \n            int n = sc.nextInt();\n            if(n == 0) return;\n            int[] arr = new int[n];\n            for(int i=0; i<n; i++){\n                arr[i] = sc.nextInt();\n            }\n            // your business\n            int sum = 0;\n            for(int num : arr){\n                sum += num;\n            }\n            System.out.println(sum);\n        }\n    }\n}\n```\n\n#### C\n\n:\n\n```\n, \n\nn(1 <= n <= 100)\n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n1 2 3\n4 5\n0 0 0 0 0\n```\n\n\n\n```\n6\n9\n0\n```\n\nTHINKINGjava`nextLine()``nextInt()`******`nextLine()`**\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        while(sc.hasNext()){\n            String[] str = sc.nextLine().split(\" \");\n            // your business\n            int sum = 0;\n            for(String s : str){\n                sum += Integer.parseInt(s);\n            }\n            System.out.println(sum);\n        }\n    }\n}\n```\n\n## \n\n#### A\n\n:\n\n```\nt(1 <= t <= 100)\na,b(1 <= a, b <= 10^9)\n```\n\n:\n\n```\na+b\n```\n\n1\n\n\n\n```\n2\n1 5\n10 20\n```\n\n\n\n```\n6\n30\n```\n\nTHINKINGwhile \n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        int t = sc.nextInt();\n        for(int i=0; i<t; i++){\n            int a = sc.nextInt();\n            int b = sc.nextInt();\n            // your business\n            System.out.println(a+b);\n        }\n    }\n}\n```\n\n#### B\n\n:\n\n```\nt(1 <= t <= 100), \nt, \nn(1 <= n <= 100)\nn, \n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n2\n4 1 2 3 4\n5 1 2 3 4 5\n```\n\n\n\n```\n10\n15\n```\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        int t = sc.nextInt();\n        for(int i=0; i<t; i++){\n            int n= sc.nextInt();\n            int[] arr = new int[n];\n            for(int j=0; j<n; j++){\n                arr[j] = sc.nextInt();\n            }\n            // your business\n            int sum = 0;\n            for(int num : arr){\n                sum += num;\n            }\n            System.out.println(sum);\n        }\n    }\n}\n```\n\n# \n\n**for****while**`hasNext()`\n\n#### A\n\n:\n\n```\nn\n\nn\n```\n\n:\n\n```\n\n```\n\n1\n\n\n\n```\n5\nc d a bb e\n```\n\n\n\n```\na bb c d e\n```\n\nTHINKING**splitok**\n\n```java\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args){\n        Scanner sc = new Scanner(System.in);\n        // nextLine\n        int n = Integer.parseInt(sc.nextLine());\n        String[] str = sc.nextLine().split(\" \");\n        // your business\n        Arrays.sort(str);\n        StringBuilder sb = new StringBuilder(str[0]);\n        for(int i=1; i<n; i++){\n            sb.append(\" \").append(str[i]);\n        }\n        System.out.println(sb.toString());\n    }\n}\n```\n\n# \n\n        LeetcodeACMACACMPATCodeForcesACM\n\n        `hasNext()``nextLine()``split()`****","slug":"acm-standard-inputoutput","published":1,"updated":"2022-12-09T14:52:25.640Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwe00108py0e1dxbws3","content":"<p>        LeetCodeACM</p>\n<span id=\"more\"></span>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>whilefor<strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h4 id=\"A\"><a href=\"#A\" class=\"headerlink\" title=\"A\"></a>A</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a,b(1 &lt;= a, b &lt;= 10^9),</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a+b</span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 5</span><br><span class=\"line\">10 20</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6</span><br><span class=\"line\">30</span><br></pre></td></tr></table></figure>\n\n<p>THINKING</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123; <span class=\"comment\">// next() or nextInt() is ok</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> a = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span> b = sc.nextInt();</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            System.out.println(a+b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"B\"><a href=\"#B\" class=\"headerlink\" title=\"B\"></a>B</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">, </span><br><span class=\"line\">n(1 &lt;= n &lt;= 100)</span><br><span class=\"line\">n, </span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">4 1 2 3 4</span><br><span class=\"line\">5 1 2 3 4 5</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">10</span><br><span class=\"line\">15</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>THINKING<strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> n = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[n];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;n; i++)&#123;</span><br><span class=\"line\">                arr[i] = sc.nextInt();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : arr)&#123;</span><br><span class=\"line\">                sum += num;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-C\"><a href=\"#-C\" class=\"headerlink\" title=\" C\"></a> C</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">nn100</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a c bb</span><br><span class=\"line\">f dddd</span><br><span class=\"line\">nowcoder</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a bb c</span><br><span class=\"line\">dddd f</span><br><span class=\"line\">nowcoder</span><br></pre></td></tr></table></figure>\n\n<p>THINKING</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            String[] str = sc.nextLine().split(<span class=\"string\">&quot; &quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">//  your business</span></span><br><span class=\"line\">            Arrays.sort(str);</span><br><span class=\"line\">            StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder(str[<span class=\"number\">0</span>]);</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;str.length; i++)&#123;</span><br><span class=\"line\">                sb.append(<span class=\"string\">&quot; &quot;</span>).append(str[i]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sb.toString());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>while</p>\n<h4 id=\"-A\"><a href=\"#-A\" class=\"headerlink\" title=\" A\"></a> A</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a,b(1 &lt;= a, b &lt;= 10^9),, 0 0</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a+b</span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 5</span><br><span class=\"line\">10 20</span><br><span class=\"line\">0 0</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6</span><br><span class=\"line\">30</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> a = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span> b = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(a == <span class=\"number\">0</span> &amp;&amp; b == <span class=\"number\">0</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            System.out.println(a+b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"B-1\"><a href=\"#B-1\" class=\"headerlink\" title=\"B\"></a>B</h4><p></p>\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">,n(1 &lt;= n &lt;= 100), n0</span><br><span class=\"line\">n,</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">4 1 2 3 4</span><br><span class=\"line\">5 1 2 3 4 5</span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">10</span><br><span class=\"line\">15</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> n = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(n == <span class=\"number\">0</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            <span class=\"keyword\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[n];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;n; i++)&#123;</span><br><span class=\"line\">                arr[i] = sc.nextInt();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : arr)&#123;</span><br><span class=\"line\">                sum += num;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"C\"><a href=\"#C\" class=\"headerlink\" title=\"C\"></a>C</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">, </span><br><span class=\"line\"></span><br><span class=\"line\">n(1 &lt;= n &lt;= 100)</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 2 3</span><br><span class=\"line\">4 5</span><br><span class=\"line\">0 0 0 0 0</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6</span><br><span class=\"line\">9</span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n\n<p>THINKINGjava<code>nextLine()</code><code>nextInt()</code><strong></strong><strong><code>nextLine()</code></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            String[] str = sc.nextLine().split(<span class=\"string\">&quot; &quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(String s : str)&#123;</span><br><span class=\"line\">                sum += Integer.parseInt(s);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h4 id=\"A-1\"><a href=\"#A-1\" class=\"headerlink\" title=\"A\"></a>A</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">t(1 &lt;= t &lt;= 100)</span><br><span class=\"line\">a,b(1 &lt;= a, b &lt;= 10^9)</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a+b</span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2</span><br><span class=\"line\">1 5</span><br><span class=\"line\">10 20</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6</span><br><span class=\"line\">30</span><br></pre></td></tr></table></figure>\n\n<p>THINKINGwhile </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = sc.nextInt();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;t; i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> a = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span> b = sc.nextInt();</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            System.out.println(a+b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"B-2\"><a href=\"#B-2\" class=\"headerlink\" title=\"B\"></a>B</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">t(1 &lt;= t &lt;= 100), </span><br><span class=\"line\">t, </span><br><span class=\"line\">n(1 &lt;= n &lt;= 100)</span><br><span class=\"line\">n, </span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2</span><br><span class=\"line\">4 1 2 3 4</span><br><span class=\"line\">5 1 2 3 4 5</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">10</span><br><span class=\"line\">15</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = sc.nextInt();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;t; i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> n= sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[n];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">0</span>; j&lt;n; j++)&#123;</span><br><span class=\"line\">                arr[j] = sc.nextInt();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : arr)&#123;</span><br><span class=\"line\">                sum += num;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong>for</strong><strong>while</strong><code>hasNext()</code></p>\n<h4 id=\"A-2\"><a href=\"#A-2\" class=\"headerlink\" title=\"A\"></a>A</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">n</span><br><span class=\"line\"></span><br><span class=\"line\">n</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5</span><br><span class=\"line\">c d a bb e</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a bb c d e</span><br></pre></td></tr></table></figure>\n\n<p>THINKING<strong>splitok</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"comment\">// nextLine</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> n = Integer.parseInt(sc.nextLine());</span><br><span class=\"line\">        String[] str = sc.nextLine().split(<span class=\"string\">&quot; &quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// your business</span></span><br><span class=\"line\">        Arrays.sort(str);</span><br><span class=\"line\">        StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder(str[<span class=\"number\">0</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;n; i++)&#123;</span><br><span class=\"line\">            sb.append(<span class=\"string\">&quot; &quot;</span>).append(str[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(sb.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        LeetcodeACMACACMPATCodeForcesACM</p>\n<p>        <code>hasNext()</code><code>nextLine()</code><code>split()</code><strong></strong></p>\n","site":{"data":{}},"excerpt":"<p>        LeetCodeACM</p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>whilefor<strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h4 id=\"A\"><a href=\"#A\" class=\"headerlink\" title=\"A\"></a>A</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a,b(1 &lt;= a, b &lt;= 10^9),</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a+b</span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 5</span><br><span class=\"line\">10 20</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6</span><br><span class=\"line\">30</span><br></pre></td></tr></table></figure>\n\n<p>THINKING</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123; <span class=\"comment\">// next() or nextInt() is ok</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> a = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span> b = sc.nextInt();</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            System.out.println(a+b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"B\"><a href=\"#B\" class=\"headerlink\" title=\"B\"></a>B</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">, </span><br><span class=\"line\">n(1 &lt;= n &lt;= 100)</span><br><span class=\"line\">n, </span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">4 1 2 3 4</span><br><span class=\"line\">5 1 2 3 4 5</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">10</span><br><span class=\"line\">15</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>THINKING<strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> n = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[n];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;n; i++)&#123;</span><br><span class=\"line\">                arr[i] = sc.nextInt();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : arr)&#123;</span><br><span class=\"line\">                sum += num;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-C\"><a href=\"#-C\" class=\"headerlink\" title=\" C\"></a> C</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">nn100</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a c bb</span><br><span class=\"line\">f dddd</span><br><span class=\"line\">nowcoder</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a bb c</span><br><span class=\"line\">dddd f</span><br><span class=\"line\">nowcoder</span><br></pre></td></tr></table></figure>\n\n<p>THINKING</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            String[] str = sc.nextLine().split(<span class=\"string\">&quot; &quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">//  your business</span></span><br><span class=\"line\">            Arrays.sort(str);</span><br><span class=\"line\">            StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder(str[<span class=\"number\">0</span>]);</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;str.length; i++)&#123;</span><br><span class=\"line\">                sb.append(<span class=\"string\">&quot; &quot;</span>).append(str[i]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sb.toString());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>while</p>\n<h4 id=\"-A\"><a href=\"#-A\" class=\"headerlink\" title=\" A\"></a> A</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a,b(1 &lt;= a, b &lt;= 10^9),, 0 0</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a+b</span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 5</span><br><span class=\"line\">10 20</span><br><span class=\"line\">0 0</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6</span><br><span class=\"line\">30</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> a = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span> b = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(a == <span class=\"number\">0</span> &amp;&amp; b == <span class=\"number\">0</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            System.out.println(a+b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"B-1\"><a href=\"#B-1\" class=\"headerlink\" title=\"B\"></a>B</h4><p></p>\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">,n(1 &lt;= n &lt;= 100), n0</span><br><span class=\"line\">n,</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">4 1 2 3 4</span><br><span class=\"line\">5 1 2 3 4 5</span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">10</span><br><span class=\"line\">15</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> n = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(n == <span class=\"number\">0</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            <span class=\"keyword\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[n];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;n; i++)&#123;</span><br><span class=\"line\">                arr[i] = sc.nextInt();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : arr)&#123;</span><br><span class=\"line\">                sum += num;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"C\"><a href=\"#C\" class=\"headerlink\" title=\"C\"></a>C</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">, </span><br><span class=\"line\"></span><br><span class=\"line\">n(1 &lt;= n &lt;= 100)</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 2 3</span><br><span class=\"line\">4 5</span><br><span class=\"line\">0 0 0 0 0</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6</span><br><span class=\"line\">9</span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n\n<p>THINKINGjava<code>nextLine()</code><code>nextInt()</code><strong></strong><strong><code>nextLine()</code></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sc.hasNext())&#123;</span><br><span class=\"line\">            String[] str = sc.nextLine().split(<span class=\"string\">&quot; &quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(String s : str)&#123;</span><br><span class=\"line\">                sum += Integer.parseInt(s);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h4 id=\"A-1\"><a href=\"#A-1\" class=\"headerlink\" title=\"A\"></a>A</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">t(1 &lt;= t &lt;= 100)</span><br><span class=\"line\">a,b(1 &lt;= a, b &lt;= 10^9)</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a+b</span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2</span><br><span class=\"line\">1 5</span><br><span class=\"line\">10 20</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6</span><br><span class=\"line\">30</span><br></pre></td></tr></table></figure>\n\n<p>THINKINGwhile </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = sc.nextInt();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;t; i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> a = sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span> b = sc.nextInt();</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            System.out.println(a+b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"B-2\"><a href=\"#B-2\" class=\"headerlink\" title=\"B\"></a>B</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">t(1 &lt;= t &lt;= 100), </span><br><span class=\"line\">t, </span><br><span class=\"line\">n(1 &lt;= n &lt;= 100)</span><br><span class=\"line\">n, </span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2</span><br><span class=\"line\">4 1 2 3 4</span><br><span class=\"line\">5 1 2 3 4 5</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">10</span><br><span class=\"line\">15</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = sc.nextInt();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;t; i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> n= sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[n];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">0</span>; j&lt;n; j++)&#123;</span><br><span class=\"line\">                arr[j] = sc.nextInt();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// your business</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : arr)&#123;</span><br><span class=\"line\">                sum += num;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong>for</strong><strong>while</strong><code>hasNext()</code></p>\n<h4 id=\"A-2\"><a href=\"#A-2\" class=\"headerlink\" title=\"A\"></a>A</h4><p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">n</span><br><span class=\"line\"></span><br><span class=\"line\">n</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>1</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5</span><br><span class=\"line\">c d a bb e</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a bb c d e</span><br></pre></td></tr></table></figure>\n\n<p>THINKING<strong>splitok</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Scanner sc = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        <span class=\"comment\">// nextLine</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> n = Integer.parseInt(sc.nextLine());</span><br><span class=\"line\">        String[] str = sc.nextLine().split(<span class=\"string\">&quot; &quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// your business</span></span><br><span class=\"line\">        Arrays.sort(str);</span><br><span class=\"line\">        StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder(str[<span class=\"number\">0</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;n; i++)&#123;</span><br><span class=\"line\">            sb.append(<span class=\"string\">&quot; &quot;</span>).append(str[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(sb.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        LeetcodeACMACACMPATCodeForcesACM</p>\n<p>        <code>hasNext()</code><code>nextLine()</code><code>split()</code><strong></strong></p>"},{"title":"arraylist-grow","date":"2021-05-12T15:35:52.000Z","_content":"\narrayListHashMap\n\n<!-- more -->\n\n<!-- toc -->\n\n*jdk8*\n\n```java\npublic boolean add(E e) {\n    ensureCapacityInternal(size + 1);  // Increments modCount!!\n    elementData[size++] = e;\n    return true;\n}\n```\n\n*ensureCapacityInternal*size1*size++*size1`modCount``size``elementData`\n\n- `modCount`AbstractListaddremove1. **fail-fast****modCountexpectedModCountmodCountcurrentModificationExpections**\n- `size`\n- `elementData`ArrayList\n\n# \n\n```java\nprivate void ensureCapacityInternal(int minCapacity) {\n    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));\n}\n```\n\n\n\n## capacity\n\n```java\nprivate static int calculateCapacity(Object[] elementData, int minCapacity) {\n    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n        return Math.max(DEFAULT_CAPACITY, minCapacity);\n    }\n    return minCapacity;\n}\n```\n\nminCapacity\n\n## capacity\n\n```java\nprivate void ensureExplicitCapacity(int minCapacity) {\n    modCount++;\n\n    // overflow-conscious code\n    if (minCapacity - elementData.length > 0)\n        grow(minCapacity);\n}\n```\n\naddmodCountminCapacitysize+1size102size+1*grow*\n\n## \n\n```java\nprivate void grow(int minCapacity) {\n    // overflow-conscious code\n    int oldCapacity = elementData.length;\n    int newCapacity = oldCapacity + (oldCapacity >> 1);\n    if (newCapacity - minCapacity < 0)\n        newCapacity = minCapacity;\n    if (newCapacity - MAX_ARRAY_SIZE > 0)\n        newCapacity = hugeCapacity(minCapacity);\n    // minCapacity is usually close to size, so this is a win:\n    elementData = Arrays.copyOf(elementData, newCapacity);\n}\n```\n\n \n\n- `oldCapacity`\n- `newCapacity` + /2 **1.5**\n\n`minCapacity`\n\n- \n- *hugeCapacity*1.5\n  - 1.51.5\n  - 1.5\n\n```java\nprivate static int hugeCapacity(int minCapacity) {\n    if (minCapacity < 0) // overflow\n        throw new OutOfMemoryError();\n    return (minCapacity > MAX_ARRAY_SIZE) ?\n        Integer.MAX_VALUE :\n        MAX_ARRAY_SIZE;\n}\n```\n\n0 size+1\n\n# \n\nsize","source":"_posts/arraylist-grow.md","raw":"---\ntitle: arraylist-grow\ndate: 2021-05-12 23:35:52\ncategories: java\ntags: arraylist\n---\n\narrayListHashMap\n\n<!-- more -->\n\n<!-- toc -->\n\n*jdk8*\n\n```java\npublic boolean add(E e) {\n    ensureCapacityInternal(size + 1);  // Increments modCount!!\n    elementData[size++] = e;\n    return true;\n}\n```\n\n*ensureCapacityInternal*size1*size++*size1`modCount``size``elementData`\n\n- `modCount`AbstractListaddremove1. **fail-fast****modCountexpectedModCountmodCountcurrentModificationExpections**\n- `size`\n- `elementData`ArrayList\n\n# \n\n```java\nprivate void ensureCapacityInternal(int minCapacity) {\n    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));\n}\n```\n\n\n\n## capacity\n\n```java\nprivate static int calculateCapacity(Object[] elementData, int minCapacity) {\n    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n        return Math.max(DEFAULT_CAPACITY, minCapacity);\n    }\n    return minCapacity;\n}\n```\n\nminCapacity\n\n## capacity\n\n```java\nprivate void ensureExplicitCapacity(int minCapacity) {\n    modCount++;\n\n    // overflow-conscious code\n    if (minCapacity - elementData.length > 0)\n        grow(minCapacity);\n}\n```\n\naddmodCountminCapacitysize+1size102size+1*grow*\n\n## \n\n```java\nprivate void grow(int minCapacity) {\n    // overflow-conscious code\n    int oldCapacity = elementData.length;\n    int newCapacity = oldCapacity + (oldCapacity >> 1);\n    if (newCapacity - minCapacity < 0)\n        newCapacity = minCapacity;\n    if (newCapacity - MAX_ARRAY_SIZE > 0)\n        newCapacity = hugeCapacity(minCapacity);\n    // minCapacity is usually close to size, so this is a win:\n    elementData = Arrays.copyOf(elementData, newCapacity);\n}\n```\n\n \n\n- `oldCapacity`\n- `newCapacity` + /2 **1.5**\n\n`minCapacity`\n\n- \n- *hugeCapacity*1.5\n  - 1.51.5\n  - 1.5\n\n```java\nprivate static int hugeCapacity(int minCapacity) {\n    if (minCapacity < 0) // overflow\n        throw new OutOfMemoryError();\n    return (minCapacity > MAX_ARRAY_SIZE) ?\n        Integer.MAX_VALUE :\n        MAX_ARRAY_SIZE;\n}\n```\n\n0 size+1\n\n# \n\nsize","slug":"arraylist-grow","published":1,"updated":"2022-11-24T11:54:56.284Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwe00128py06fv0emnb","content":"<p>arrayListHashMap</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<p><em>jdk8</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">add</span><span class=\"params\">(E e)</span> </span>&#123;</span><br><span class=\"line\">    ensureCapacityInternal(size + <span class=\"number\">1</span>);  <span class=\"comment\">// Increments modCount!!</span></span><br><span class=\"line\">    elementData[size++] = e;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>ensureCapacityInternal</em>size1*size++*size1<code>modCount</code><code>size</code><code>elementData</code></p>\n<ul>\n<li><code>modCount</code>AbstractListaddremove1. <strong>fail-fast</strong><strong>modCountexpectedModCountmodCountcurrentModificationExpections</strong></li>\n<li><code>size</code></li>\n<li><code>elementData</code>ArrayList</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">ensureCapacityInternal</span><span class=\"params\">(<span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"capacity\"><a href=\"#capacity\" class=\"headerlink\" title=\"capacity\"></a>capacity</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">calculateCapacity</span><span class=\"params\">(Object[] elementData, <span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> minCapacity;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>minCapacity</p>\n<h2 id=\"capacity\"><a href=\"#capacity\" class=\"headerlink\" title=\"capacity\"></a>capacity</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">ensureExplicitCapacity</span><span class=\"params\">(<span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    modCount++;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// overflow-conscious code</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (minCapacity - elementData.length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        grow(minCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>addmodCountminCapacitysize+1size102size+1<em>grow</em></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">grow</span><span class=\"params\">(<span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// overflow-conscious code</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldCapacity = elementData.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - minCapacity &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = minCapacity;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = hugeCapacity(minCapacity);</span><br><span class=\"line\">    <span class=\"comment\">// minCapacity is usually close to size, so this is a win:</span></span><br><span class=\"line\">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n<ul>\n<li><code>oldCapacity</code></li>\n<li><code>newCapacity</code> + /2 <strong>1.5</strong></li>\n</ul>\n<p><code>minCapacity</code></p>\n<ul>\n<li></li>\n<li><em>hugeCapacity</em>1.5<ul>\n<li>1.51.5</li>\n<li>1.5</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">hugeCapacity</span><span class=\"params\">(<span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (minCapacity &lt; <span class=\"number\">0</span>) <span class=\"comment\">// overflow</span></span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> OutOfMemoryError();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class=\"line\">        Integer.MAX_VALUE :</span><br><span class=\"line\">        MAX_ARRAY_SIZE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>0 size+1</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>size</p>\n","site":{"data":{}},"excerpt":"<p>arrayListHashMap</p>","more":"<!-- toc -->\n\n<p><em>jdk8</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">add</span><span class=\"params\">(E e)</span> </span>&#123;</span><br><span class=\"line\">    ensureCapacityInternal(size + <span class=\"number\">1</span>);  <span class=\"comment\">// Increments modCount!!</span></span><br><span class=\"line\">    elementData[size++] = e;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>ensureCapacityInternal</em>size1*size++*size1<code>modCount</code><code>size</code><code>elementData</code></p>\n<ul>\n<li><code>modCount</code>AbstractListaddremove1. <strong>fail-fast</strong><strong>modCountexpectedModCountmodCountcurrentModificationExpections</strong></li>\n<li><code>size</code></li>\n<li><code>elementData</code>ArrayList</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">ensureCapacityInternal</span><span class=\"params\">(<span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"capacity\"><a href=\"#capacity\" class=\"headerlink\" title=\"capacity\"></a>capacity</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">calculateCapacity</span><span class=\"params\">(Object[] elementData, <span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> minCapacity;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>minCapacity</p>\n<h2 id=\"capacity\"><a href=\"#capacity\" class=\"headerlink\" title=\"capacity\"></a>capacity</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">ensureExplicitCapacity</span><span class=\"params\">(<span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    modCount++;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// overflow-conscious code</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (minCapacity - elementData.length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        grow(minCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>addmodCountminCapacitysize+1size102size+1<em>grow</em></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">grow</span><span class=\"params\">(<span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// overflow-conscious code</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldCapacity = elementData.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - minCapacity &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = minCapacity;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        newCapacity = hugeCapacity(minCapacity);</span><br><span class=\"line\">    <span class=\"comment\">// minCapacity is usually close to size, so this is a win:</span></span><br><span class=\"line\">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n<ul>\n<li><code>oldCapacity</code></li>\n<li><code>newCapacity</code> + /2 <strong>1.5</strong></li>\n</ul>\n<p><code>minCapacity</code></p>\n<ul>\n<li></li>\n<li><em>hugeCapacity</em>1.5<ul>\n<li>1.51.5</li>\n<li>1.5</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">hugeCapacity</span><span class=\"params\">(<span class=\"keyword\">int</span> minCapacity)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (minCapacity &lt; <span class=\"number\">0</span>) <span class=\"comment\">// overflow</span></span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> OutOfMemoryError();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class=\"line\">        Integer.MAX_VALUE :</span><br><span class=\"line\">        MAX_ARRAY_SIZE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>0 size+1</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>size</p>"},{"title":"bitwise","date":"2020-06-01T13:11:25.000Z","_content":"\nIntroduction of Java bitwise and operation.\n\n<!-- more -->\n\n# \n\n|  |      |                 |\n| --- | ------ | ----------------- |\n| &   |       | 1 & 1 = 1 (only)  |\n| \\|  |       | 0 \\| 0 = 0 (only) |\n| ^   |      | 1 ^ 0 = 1         |\n| ~   |       | ~ 1 = 0           |\n| <<  |      | 0          |\n| >>  |  |            |\n| >>> |  | 0          |\n\nbyte, short, int, long=|=<<=>>>=\n\n\n\n## \n\n```java\nint a = -1;\n// 11111111111111111111111111111111111(321)\nSystem.out.println(Integer.toBinaryString(a));\n// -1\nSystem.out.printlnl(a>>1);\n// 1111111111111111111111111111111111(321)\nSystem.out.println(Integer.toBinaryString(a>>1));\n// 2147483647\nSystem.out.println(a>>>1);\n// 0111111111111111111111111111111111(311)\nSystem.out.prinlnt(Integer.toBinaryString(a>>>1));\n```\n\n### \n\n#### a>>1\n\n10000000000000000000000000000001\n\n1111111111111111111111111111111111110\n\n1111111111111111111111111111111111111\n\n111111111111111111111111111111111111111\n\n10000000000000000000000000000000\n\n10000000000000000000000000000001  -1.\n\n#### a>>>1\n\n\n\n0111111111111111111111111111111111110\n\n\n\n# \n\n## HashMap\n\n```java\nstatic final int hash(Object key) {\n        int h;\n        return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n    }\n```\n\njdk1.8hashmaphash`^`, `|`, `<<`, `<<<`\n\n## \n\n```java\n2 & 1; // 0\n8 & 1; // 0\n7 & 1; // 1\n```\n\n10001\n\n81000\n\n70111\n\n**1,0**.\n\n## \n\n```markdown\n2 ^ 2 ^ 1 = 1\n4 ^ 2 ^ 1 ^ 1 ^ 2 = 4\n```\n\n****`^``0`****\n\n## etc\n\n\n","source":"_posts/bitwise.md","raw":"---\ntitle: bitwise\ndate: 2020-06-01 21:11:25\ncategories: java\ntags: bitwise\n---\n\nIntroduction of Java bitwise and operation.\n\n<!-- more -->\n\n# \n\n|  |      |                 |\n| --- | ------ | ----------------- |\n| &   |       | 1 & 1 = 1 (only)  |\n| \\|  |       | 0 \\| 0 = 0 (only) |\n| ^   |      | 1 ^ 0 = 1         |\n| ~   |       | ~ 1 = 0           |\n| <<  |      | 0          |\n| >>  |  |            |\n| >>> |  | 0          |\n\nbyte, short, int, long=|=<<=>>>=\n\n\n\n## \n\n```java\nint a = -1;\n// 11111111111111111111111111111111111(321)\nSystem.out.println(Integer.toBinaryString(a));\n// -1\nSystem.out.printlnl(a>>1);\n// 1111111111111111111111111111111111(321)\nSystem.out.println(Integer.toBinaryString(a>>1));\n// 2147483647\nSystem.out.println(a>>>1);\n// 0111111111111111111111111111111111(311)\nSystem.out.prinlnt(Integer.toBinaryString(a>>>1));\n```\n\n### \n\n#### a>>1\n\n10000000000000000000000000000001\n\n1111111111111111111111111111111111110\n\n1111111111111111111111111111111111111\n\n111111111111111111111111111111111111111\n\n10000000000000000000000000000000\n\n10000000000000000000000000000001  -1.\n\n#### a>>>1\n\n\n\n0111111111111111111111111111111111110\n\n\n\n# \n\n## HashMap\n\n```java\nstatic final int hash(Object key) {\n        int h;\n        return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n    }\n```\n\njdk1.8hashmaphash`^`, `|`, `<<`, `<<<`\n\n## \n\n```java\n2 & 1; // 0\n8 & 1; // 0\n7 & 1; // 1\n```\n\n10001\n\n81000\n\n70111\n\n**1,0**.\n\n## \n\n```markdown\n2 ^ 2 ^ 1 = 1\n4 ^ 2 ^ 1 ^ 1 ^ 2 = 4\n```\n\n****`^``0`****\n\n## etc\n\n\n","slug":"bitwise","published":1,"updated":"2022-11-24T11:53:50.152Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwf00168py01j7i78xr","content":"<p>Introduction of Java bitwise and operation.</p>\n<span id=\"more\"></span>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&amp;</td>\n<td></td>\n<td>1 &amp; 1 = 1 (only)</td>\n</tr>\n<tr>\n<td>|</td>\n<td></td>\n<td>0 | 0 = 0 (only)</td>\n</tr>\n<tr>\n<td>^</td>\n<td></td>\n<td>1 ^ 0 = 1</td>\n</tr>\n<tr>\n<td>~</td>\n<td></td>\n<td>~ 1 = 0</td>\n</tr>\n<tr>\n<td>&lt;&lt;</td>\n<td></td>\n<td>0</td>\n</tr>\n<tr>\n<td>&gt;&gt;</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>&gt;&gt;&gt;</td>\n<td></td>\n<td>0</td>\n</tr>\n</tbody></table>\n<p>byte, short, int, long=|=&lt;&lt;=&gt;&gt;&gt;=</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"comment\">// 11111111111111111111111111111111111(321)</span></span><br><span class=\"line\">System.out.println(Integer.toBinaryString(a));</span><br><span class=\"line\"><span class=\"comment\">// -1</span></span><br><span class=\"line\">System.out.printlnl(a&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">// 1111111111111111111111111111111111(321)</span></span><br><span class=\"line\">System.out.println(Integer.toBinaryString(a&gt;&gt;<span class=\"number\">1</span>));</span><br><span class=\"line\"><span class=\"comment\">// 2147483647</span></span><br><span class=\"line\">System.out.println(a&gt;&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">// 0111111111111111111111111111111111(311)</span></span><br><span class=\"line\">System.out.prinlnt(Integer.toBinaryString(a&gt;&gt;&gt;<span class=\"number\">1</span>));</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"a-gt-gt-1\"><a href=\"#a-gt-gt-1\" class=\"headerlink\" title=\"a&gt;&gt;1\"></a>a&gt;&gt;1</h4><p>10000000000000000000000000000001</p>\n<p>1111111111111111111111111111111111110</p>\n<p>1111111111111111111111111111111111111</p>\n<p>111111111111111111111111111111111111111</p>\n<p>10000000000000000000000000000000</p>\n<p>10000000000000000000000000000001  -1.</p>\n<h4 id=\"a-gt-gt-gt-1\"><a href=\"#a-gt-gt-gt-1\" class=\"headerlink\" title=\"a&gt;&gt;&gt;1\"></a>a&gt;&gt;&gt;1</h4><p></p>\n<p>0111111111111111111111111111111111110</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"HashMap\"><a href=\"#HashMap\" class=\"headerlink\" title=\"HashMap\"></a>HashMap</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">hash</span><span class=\"params\">(Object key)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> h;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (key == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>jdk1.8hashmaphash<code>^</code>, <code>|</code>, <code>&lt;&lt;</code>, <code>&lt;&lt;&lt;</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"number\">8</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"number\">7</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n\n<p>10001</p>\n<p>81000</p>\n<p>70111</p>\n<p><strong>1,0</strong>.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2 ^ 2 ^ 1 = 1</span><br><span class=\"line\">4 ^ 2 ^ 1 ^ 1 ^ 2 = 4</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong><code>^</code><code>0</code><strong></strong></p>\n<h2 id=\"etc\"><a href=\"#etc\" class=\"headerlink\" title=\"etc\"></a>etc</h2><p></p>\n","site":{"data":{}},"excerpt":"<p>Introduction of Java bitwise and operation.</p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&amp;</td>\n<td></td>\n<td>1 &amp; 1 = 1 (only)</td>\n</tr>\n<tr>\n<td>|</td>\n<td></td>\n<td>0 | 0 = 0 (only)</td>\n</tr>\n<tr>\n<td>^</td>\n<td></td>\n<td>1 ^ 0 = 1</td>\n</tr>\n<tr>\n<td>~</td>\n<td></td>\n<td>~ 1 = 0</td>\n</tr>\n<tr>\n<td>&lt;&lt;</td>\n<td></td>\n<td>0</td>\n</tr>\n<tr>\n<td>&gt;&gt;</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>&gt;&gt;&gt;</td>\n<td></td>\n<td>0</td>\n</tr>\n</tbody></table>\n<p>byte, short, int, long=|=&lt;&lt;=&gt;&gt;&gt;=</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"comment\">// 11111111111111111111111111111111111(321)</span></span><br><span class=\"line\">System.out.println(Integer.toBinaryString(a));</span><br><span class=\"line\"><span class=\"comment\">// -1</span></span><br><span class=\"line\">System.out.printlnl(a&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">// 1111111111111111111111111111111111(321)</span></span><br><span class=\"line\">System.out.println(Integer.toBinaryString(a&gt;&gt;<span class=\"number\">1</span>));</span><br><span class=\"line\"><span class=\"comment\">// 2147483647</span></span><br><span class=\"line\">System.out.println(a&gt;&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">// 0111111111111111111111111111111111(311)</span></span><br><span class=\"line\">System.out.prinlnt(Integer.toBinaryString(a&gt;&gt;&gt;<span class=\"number\">1</span>));</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"a-gt-gt-1\"><a href=\"#a-gt-gt-1\" class=\"headerlink\" title=\"a&gt;&gt;1\"></a>a&gt;&gt;1</h4><p>10000000000000000000000000000001</p>\n<p>1111111111111111111111111111111111110</p>\n<p>1111111111111111111111111111111111111</p>\n<p>111111111111111111111111111111111111111</p>\n<p>10000000000000000000000000000000</p>\n<p>10000000000000000000000000000001  -1.</p>\n<h4 id=\"a-gt-gt-gt-1\"><a href=\"#a-gt-gt-gt-1\" class=\"headerlink\" title=\"a&gt;&gt;&gt;1\"></a>a&gt;&gt;&gt;1</h4><p></p>\n<p>0111111111111111111111111111111111110</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"HashMap\"><a href=\"#HashMap\" class=\"headerlink\" title=\"HashMap\"></a>HashMap</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">hash</span><span class=\"params\">(Object key)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> h;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (key == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>jdk1.8hashmaphash<code>^</code>, <code>|</code>, <code>&lt;&lt;</code>, <code>&lt;&lt;&lt;</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"number\">8</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"number\">7</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n\n<p>10001</p>\n<p>81000</p>\n<p>70111</p>\n<p><strong>1,0</strong>.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2 ^ 2 ^ 1 = 1</span><br><span class=\"line\">4 ^ 2 ^ 1 ^ 1 ^ 2 = 4</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong><code>^</code><code>0</code><strong></strong></p>\n<h2 id=\"etc\"><a href=\"#etc\" class=\"headerlink\" title=\"etc\"></a>etc</h2><p></p>"},{"title":"bst","date":"2021-02-27T07:58:06.000Z","_content":"\n\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n\n\n```java\npublic List<Integer> getValuesFromBST(TreeNode root){\n    TreeNode p = root;\n    List<Integer> list = new ArrayList<>();\n    Deque<TreeNode> deque = new ArrayDeque<>();\n    whlie(p != null || deque.isEmpty()){\n        while(p != null){\n            deque.offerLast(p);\n            p = p.left;\n        }\n        p = deque.pollLast();\n        list.add(p.val); // u can do anything here\n        p = p.right;\n    }\n\n    return list;\n}\n```\n\nNBST\n\n# \n\n\n\n```java\npublic boolean isBSTValid(TreeNode root){\n    TreeNode p = root;\n    TreeNode pre = null; // \n    Deque<TreeNode> deque = new ArrayDeque<>();\n    whlie(p != null || deque.isEmpty()){\n        while(p.left != null){\n            deque.offerLast(p);\n            p = p.left;\n        }\n        p = deque.pollLast();\n        if(pre != null && p.val <= pre.val){ // \n            return false;\n        }\n        pre = p;\n        p = p.right;\n    }\n\n    return true;\n}\n```\n\n# \n\nBSTBST*[Score of Parentheses](https://leetcode.com/problems/score-of-parentheses/)*","source":"_posts/bst.md","raw":"---\ntitle: bst\ndate: 2021-02-27 15:58:06\ncategories: leetcode\ntags: binary_search_tree\n---\n\n\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n\n\n```java\npublic List<Integer> getValuesFromBST(TreeNode root){\n    TreeNode p = root;\n    List<Integer> list = new ArrayList<>();\n    Deque<TreeNode> deque = new ArrayDeque<>();\n    whlie(p != null || deque.isEmpty()){\n        while(p != null){\n            deque.offerLast(p);\n            p = p.left;\n        }\n        p = deque.pollLast();\n        list.add(p.val); // u can do anything here\n        p = p.right;\n    }\n\n    return list;\n}\n```\n\nNBST\n\n# \n\n\n\n```java\npublic boolean isBSTValid(TreeNode root){\n    TreeNode p = root;\n    TreeNode pre = null; // \n    Deque<TreeNode> deque = new ArrayDeque<>();\n    whlie(p != null || deque.isEmpty()){\n        while(p.left != null){\n            deque.offerLast(p);\n            p = p.left;\n        }\n        p = deque.pollLast();\n        if(pre != null && p.val <= pre.val){ // \n            return false;\n        }\n        pre = p;\n        p = p.right;\n    }\n\n    return true;\n}\n```\n\n# \n\nBSTBST*[Score of Parentheses](https://leetcode.com/problems/score-of-parentheses/)*","slug":"bst","published":1,"updated":"2022-12-09T14:51:54.123Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwf00188py090q6cufh","content":"<p></p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">getValuesFromBST</span><span class=\"params\">(TreeNode root)</span></span>&#123;</span><br><span class=\"line\">    TreeNode p = root;</span><br><span class=\"line\">    List&lt;Integer&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    Deque&lt;TreeNode&gt; deque = <span class=\"keyword\">new</span> ArrayDeque&lt;&gt;();</span><br><span class=\"line\">    whlie(p != <span class=\"keyword\">null</span> || deque.isEmpty())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(p != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            deque.offerLast(p);</span><br><span class=\"line\">            p = p.left;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        p = deque.pollLast();</span><br><span class=\"line\">        list.add(p.val); <span class=\"comment\">// u can do anything here</span></span><br><span class=\"line\">        p = p.right;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>NBST</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isBSTValid</span><span class=\"params\">(TreeNode root)</span></span>&#123;</span><br><span class=\"line\">    TreeNode p = root;</span><br><span class=\"line\">    TreeNode pre = <span class=\"keyword\">null</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">    Deque&lt;TreeNode&gt; deque = <span class=\"keyword\">new</span> ArrayDeque&lt;&gt;();</span><br><span class=\"line\">    whlie(p != <span class=\"keyword\">null</span> || deque.isEmpty())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(p.left != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            deque.offerLast(p);</span><br><span class=\"line\">            p = p.left;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        p = deque.pollLast();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pre != <span class=\"keyword\">null</span> &amp;&amp; p.val &lt;= pre.val)&#123; <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pre = p;</span><br><span class=\"line\">        p = p.right;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>BSTBST*<a class=\"link\"   href=\"https://leetcode.com/problems/score-of-parentheses/\" >Score of Parentheses<i class=\"fas fa-external-link-alt\"></i></a>*</p>\n","site":{"data":{}},"excerpt":"<p></p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">getValuesFromBST</span><span class=\"params\">(TreeNode root)</span></span>&#123;</span><br><span class=\"line\">    TreeNode p = root;</span><br><span class=\"line\">    List&lt;Integer&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    Deque&lt;TreeNode&gt; deque = <span class=\"keyword\">new</span> ArrayDeque&lt;&gt;();</span><br><span class=\"line\">    whlie(p != <span class=\"keyword\">null</span> || deque.isEmpty())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(p != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            deque.offerLast(p);</span><br><span class=\"line\">            p = p.left;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        p = deque.pollLast();</span><br><span class=\"line\">        list.add(p.val); <span class=\"comment\">// u can do anything here</span></span><br><span class=\"line\">        p = p.right;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>NBST</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isBSTValid</span><span class=\"params\">(TreeNode root)</span></span>&#123;</span><br><span class=\"line\">    TreeNode p = root;</span><br><span class=\"line\">    TreeNode pre = <span class=\"keyword\">null</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">    Deque&lt;TreeNode&gt; deque = <span class=\"keyword\">new</span> ArrayDeque&lt;&gt;();</span><br><span class=\"line\">    whlie(p != <span class=\"keyword\">null</span> || deque.isEmpty())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(p.left != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            deque.offerLast(p);</span><br><span class=\"line\">            p = p.left;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        p = deque.pollLast();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pre != <span class=\"keyword\">null</span> &amp;&amp; p.val &lt;= pre.val)&#123; <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pre = p;</span><br><span class=\"line\">        p = p.right;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>BSTBST*<a class=\"link\"   href=\"https://leetcode.com/problems/score-of-parentheses/\" >Score of Parentheses<i class=\"fas fa-external-link-alt\"></i></a>*</p>"},{"title":"gateway","date":"2022-11-25T09:50:49.000Z","_content":"\nsringcloudgateway[](https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-starter)\n\n<!-- more -->\n\n## \n- Route\n- Predicate\n- Filter\n\npredicatefilterspring securityGatewaypredicatejava8predicatejava8spring securityGatewayservletNetty\n\n### \nGatewaySpring\n#### predicate\n\n```yaml\nspring:\n  cloud:\n    gateway:\n      routes:\n      - id: xforwarded_remoteaddr_route # destination\n        uri: https://example.org\n        predicates:\n        - After=2017-01-20T17:42:47.789-07:00[America/Denver]\n        # - Before=2017-01-20T17:42:47.789-07:00[America/Denver]\n        # - Between=2017-01-20T17:42:47.789-07:00[America/Denver], 2017-01-21T17:42:47.789-07:00[America/Denver]\n        # - Cookie=chocolate, ch.p\n        # - Header=X-Request-Id, \\d+\n        # - Host=**.somehost.org,**.anotherhost.org\n        # - Method=GET,POST\n        # - Path=/red/{segment},/blue/{segment}\n        # - Query=green\n        # - RemoteAddr=192.168.1.1/24\n\n```\n#### Filter\n****[](https://github.com/spring-cloud/spring-cloud-gateway/tree/main/spring-cloud-gateway-server/src/test/java/org/springframework/cloud/gateway/filter/factory)\n\n## \n\n### \nredis****`RequestRateLimiter``spring-boot-starter-data-redis-reactive`\n```yml\nspring:\n  cloud:\n    gateway:\n      routes:\n        - id: requestRateLimiter\n          uri: http://localhost:8080\n          predicates:\n            - Path=/book/**\n          filters:\n            -name: RequestRateLimiter\n            args:\n              redis-rate-limiter.replenishRate: 1 # \n              redis-rate-limiter.burstCapacity: 2 # \n              key-resolver: \"#{@pathKeyResolver}\" # beanipuri\n```\n```java\n    @Bean\n    public KeyResolver pathKeyResolver() {\n\n        return exchange -> Mono.just(exchange.getRequest().getURI().getPath());\n    }\n```\n\n## \nNginx\n\n### \ndestinationURIIP\n\n## \n","source":"_posts/gateway.md","raw":"---\ntitle: gateway\ndate: 2022-11-25 17:50:49\ncategories: springcloud\ntags: gateway\n---\n\nsringcloudgateway[](https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-starter)\n\n<!-- more -->\n\n## \n- Route\n- Predicate\n- Filter\n\npredicatefilterspring securityGatewaypredicatejava8predicatejava8spring securityGatewayservletNetty\n\n### \nGatewaySpring\n#### predicate\n\n```yaml\nspring:\n  cloud:\n    gateway:\n      routes:\n      - id: xforwarded_remoteaddr_route # destination\n        uri: https://example.org\n        predicates:\n        - After=2017-01-20T17:42:47.789-07:00[America/Denver]\n        # - Before=2017-01-20T17:42:47.789-07:00[America/Denver]\n        # - Between=2017-01-20T17:42:47.789-07:00[America/Denver], 2017-01-21T17:42:47.789-07:00[America/Denver]\n        # - Cookie=chocolate, ch.p\n        # - Header=X-Request-Id, \\d+\n        # - Host=**.somehost.org,**.anotherhost.org\n        # - Method=GET,POST\n        # - Path=/red/{segment},/blue/{segment}\n        # - Query=green\n        # - RemoteAddr=192.168.1.1/24\n\n```\n#### Filter\n****[](https://github.com/spring-cloud/spring-cloud-gateway/tree/main/spring-cloud-gateway-server/src/test/java/org/springframework/cloud/gateway/filter/factory)\n\n## \n\n### \nredis****`RequestRateLimiter``spring-boot-starter-data-redis-reactive`\n```yml\nspring:\n  cloud:\n    gateway:\n      routes:\n        - id: requestRateLimiter\n          uri: http://localhost:8080\n          predicates:\n            - Path=/book/**\n          filters:\n            -name: RequestRateLimiter\n            args:\n              redis-rate-limiter.replenishRate: 1 # \n              redis-rate-limiter.burstCapacity: 2 # \n              key-resolver: \"#{@pathKeyResolver}\" # beanipuri\n```\n```java\n    @Bean\n    public KeyResolver pathKeyResolver() {\n\n        return exchange -> Mono.just(exchange.getRequest().getURI().getPath());\n    }\n```\n\n## \nNginx\n\n### \ndestinationURIIP\n\n## \n","slug":"gateway","published":1,"updated":"2022-11-28T07:04:07.402Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwf001c8py0cjhq7x1d","content":"<p>sringcloudgateway<a class=\"link\"   href=\"https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-starter\" ><i class=\"fas fa-external-link-alt\"></i></a></p>\n<span id=\"more\"></span>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>Route</li>\n<li>Predicate</li>\n<li>Filter</li>\n</ul>\n<p>predicatefilterspring securityGatewaypredicatejava8predicatejava8spring securityGatewayservletNetty</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>GatewaySpring</p>\n<h4 id=\"predicate\"><a href=\"#predicate\" class=\"headerlink\" title=\"predicate\"></a>predicate</h4><p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">cloud:</span></span><br><span class=\"line\">    <span class=\"attr\">gateway:</span></span><br><span class=\"line\">      <span class=\"attr\">routes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">id:</span> <span class=\"string\">xforwarded_remoteaddr_route</span> <span class=\"comment\"># destination</span></span><br><span class=\"line\">        <span class=\"attr\">uri:</span> <span class=\"string\">https://example.org</span></span><br><span class=\"line\">        <span class=\"attr\">predicates:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"string\">After=2017-01-20T17:42:47.789-07:00[America/Denver]</span></span><br><span class=\"line\">        <span class=\"comment\"># - Before=2017-01-20T17:42:47.789-07:00[America/Denver]</span></span><br><span class=\"line\">        <span class=\"comment\"># - Between=2017-01-20T17:42:47.789-07:00[America/Denver], 2017-01-21T17:42:47.789-07:00[America/Denver]</span></span><br><span class=\"line\">        <span class=\"comment\"># - Cookie=chocolate, ch.p</span></span><br><span class=\"line\">        <span class=\"comment\"># - Header=X-Request-Id, \\d+</span></span><br><span class=\"line\">        <span class=\"comment\"># - Host=**.somehost.org,**.anotherhost.org</span></span><br><span class=\"line\">        <span class=\"comment\"># - Method=GET,POST</span></span><br><span class=\"line\">        <span class=\"comment\"># - Path=/red/&#123;segment&#125;,/blue/&#123;segment&#125;</span></span><br><span class=\"line\">        <span class=\"comment\"># - Query=green</span></span><br><span class=\"line\">        <span class=\"comment\"># - RemoteAddr=192.168.1.1/24</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"Filter\"><a href=\"#Filter\" class=\"headerlink\" title=\"Filter\"></a>Filter</h4><p><strong></strong><a href=\"https://github.com/spring-cloud/spring-cloud-gateway/tree/main/spring-cloud-gateway-server/src/test/java/org/springframework/cloud/gateway/filter/factory\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>redis<strong></strong><code>RequestRateLimiter</code><code>spring-boot-starter-data-redis-reactive</code></p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">cloud:</span></span><br><span class=\"line\">    <span class=\"attr\">gateway:</span></span><br><span class=\"line\">      <span class=\"attr\">routes:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">id:</span> <span class=\"string\">requestRateLimiter</span></span><br><span class=\"line\">          <span class=\"attr\">uri:</span> <span class=\"string\">http://localhost:8080</span></span><br><span class=\"line\">          <span class=\"attr\">predicates:</span></span><br><span class=\"line\">            <span class=\"bullet\">-</span> <span class=\"string\">Path=/book/**</span></span><br><span class=\"line\">          <span class=\"attr\">filters:</span></span><br><span class=\"line\">            <span class=\"string\">-name:</span> <span class=\"string\">RequestRateLimiter</span></span><br><span class=\"line\">            <span class=\"attr\">args:</span></span><br><span class=\"line\">              <span class=\"attr\">redis-rate-limiter.replenishRate:</span> <span class=\"number\">1</span> <span class=\"comment\"># </span></span><br><span class=\"line\">              <span class=\"attr\">redis-rate-limiter.burstCapacity:</span> <span class=\"number\">2</span> <span class=\"comment\"># </span></span><br><span class=\"line\">              <span class=\"attr\">key-resolver:</span> <span class=\"string\">&quot;#&#123;@pathKeyResolver&#125;&quot;</span> <span class=\"comment\"># beanipuri</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> KeyResolver <span class=\"title\">pathKeyResolver</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> exchange -&gt; Mono.just(exchange.getRequest().getURI().getPath());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Nginx</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>destinationURIIP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2>","site":{"data":{}},"excerpt":"<p>sringcloudgateway<a class=\"link\"   href=\"https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-starter\" ><i class=\"fas fa-external-link-alt\"></i></a></p>","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>Route</li>\n<li>Predicate</li>\n<li>Filter</li>\n</ul>\n<p>predicatefilterspring securityGatewaypredicatejava8predicatejava8spring securityGatewayservletNetty</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>GatewaySpring</p>\n<h4 id=\"predicate\"><a href=\"#predicate\" class=\"headerlink\" title=\"predicate\"></a>predicate</h4><p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">cloud:</span></span><br><span class=\"line\">    <span class=\"attr\">gateway:</span></span><br><span class=\"line\">      <span class=\"attr\">routes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">id:</span> <span class=\"string\">xforwarded_remoteaddr_route</span> <span class=\"comment\"># destination</span></span><br><span class=\"line\">        <span class=\"attr\">uri:</span> <span class=\"string\">https://example.org</span></span><br><span class=\"line\">        <span class=\"attr\">predicates:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"string\">After=2017-01-20T17:42:47.789-07:00[America/Denver]</span></span><br><span class=\"line\">        <span class=\"comment\"># - Before=2017-01-20T17:42:47.789-07:00[America/Denver]</span></span><br><span class=\"line\">        <span class=\"comment\"># - Between=2017-01-20T17:42:47.789-07:00[America/Denver], 2017-01-21T17:42:47.789-07:00[America/Denver]</span></span><br><span class=\"line\">        <span class=\"comment\"># - Cookie=chocolate, ch.p</span></span><br><span class=\"line\">        <span class=\"comment\"># - Header=X-Request-Id, \\d+</span></span><br><span class=\"line\">        <span class=\"comment\"># - Host=**.somehost.org,**.anotherhost.org</span></span><br><span class=\"line\">        <span class=\"comment\"># - Method=GET,POST</span></span><br><span class=\"line\">        <span class=\"comment\"># - Path=/red/&#123;segment&#125;,/blue/&#123;segment&#125;</span></span><br><span class=\"line\">        <span class=\"comment\"># - Query=green</span></span><br><span class=\"line\">        <span class=\"comment\"># - RemoteAddr=192.168.1.1/24</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"Filter\"><a href=\"#Filter\" class=\"headerlink\" title=\"Filter\"></a>Filter</h4><p><strong></strong><a href=\"https://github.com/spring-cloud/spring-cloud-gateway/tree/main/spring-cloud-gateway-server/src/test/java/org/springframework/cloud/gateway/filter/factory\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>redis<strong></strong><code>RequestRateLimiter</code><code>spring-boot-starter-data-redis-reactive</code></p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">cloud:</span></span><br><span class=\"line\">    <span class=\"attr\">gateway:</span></span><br><span class=\"line\">      <span class=\"attr\">routes:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">id:</span> <span class=\"string\">requestRateLimiter</span></span><br><span class=\"line\">          <span class=\"attr\">uri:</span> <span class=\"string\">http://localhost:8080</span></span><br><span class=\"line\">          <span class=\"attr\">predicates:</span></span><br><span class=\"line\">            <span class=\"bullet\">-</span> <span class=\"string\">Path=/book/**</span></span><br><span class=\"line\">          <span class=\"attr\">filters:</span></span><br><span class=\"line\">            <span class=\"string\">-name:</span> <span class=\"string\">RequestRateLimiter</span></span><br><span class=\"line\">            <span class=\"attr\">args:</span></span><br><span class=\"line\">              <span class=\"attr\">redis-rate-limiter.replenishRate:</span> <span class=\"number\">1</span> <span class=\"comment\"># </span></span><br><span class=\"line\">              <span class=\"attr\">redis-rate-limiter.burstCapacity:</span> <span class=\"number\">2</span> <span class=\"comment\"># </span></span><br><span class=\"line\">              <span class=\"attr\">key-resolver:</span> <span class=\"string\">&quot;#&#123;@pathKeyResolver&#125;&quot;</span> <span class=\"comment\"># beanipuri</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> KeyResolver <span class=\"title\">pathKeyResolver</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> exchange -&gt; Mono.just(exchange.getRequest().getURI().getPath());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Nginx</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>destinationURIIP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2>"},{"title":"decorating","date":"2020-06-12T10:30:28.000Z","_content":"\n\n\n<!-- more -->\n\n# \n\n`Beverage`*cost()*HouseBlend, DarkRoast Decaf, Espresso... \n\n\n\n> \n\n# \n\n\n\n1. DarkRoast\n2. \n3. \n4. costdelegate\n\n# \n\n![Screenshot from 2020-06-12 20-50-33.png](https://i.loli.net/2020/06/12/jQwAkbz7V6n8dGK.png)\n\n`Condiment``Beverage``getDescription`Whip\n\n```java\npublic class Whip extends Condiment {\n    Beverage beverage;\n\n    public Whip(Beverage beverage) {\n        this.beverage = beverage;\n    }\n\n    @Override\n    public String getDescription() {\n        return beverage.getDescription() + \", Whip\";\n    }\n\n    @Override\n    public double cost() {\n        return .30 + beverage.cost();\n    }\n}\n```\n\n_cost_description\n\n```java\nBeverage beverage1 = new DarRoast();\nbeverage1 = new Mocha(beverage1);\nbeverage1 = new Mocha(beverage1);\nbeverage1 = new Whip(beverage1);\nSystem.out.println(beverage1.getDescription() + \" $\" + beverage1.cost());\n```\n\n```console\nBrazil Dark Roast Coffee, Mocha, Mocha, Whip $2.75\n```\n\n****.\n\n# \n\n## Java I/O\n\n`Decorator Pattern`javaio0101_FileInputStream__Beverage__BufferedInputStream__Espresso__LineNumberInutStream__Mocha_\n\n```flow\npara1=>parallel: FileInputStream\npara2=>parallel: BufferedInputStream\npara3=>parallel: LineNumberInputStream\nop1=>operation: Beferage\nop2=>operation: Espresso\nop3=>operation: Mocha\npara1(path1, bottom)->para2\npara2(path1,bottom)->para3\npara1(path2, right)->op1\npara2(path2, right)->op2\npara3(path2, right)->op3\n```\n","source":"_posts/decorating.md","raw":"---\ntitle: decorating\ndate: 2020-06-12 18:30:28\ncategories: designpatterns\ntags: decorating\n---\n\n\n\n<!-- more -->\n\n# \n\n`Beverage`*cost()*HouseBlend, DarkRoast Decaf, Espresso... \n\n\n\n> \n\n# \n\n\n\n1. DarkRoast\n2. \n3. \n4. costdelegate\n\n# \n\n![Screenshot from 2020-06-12 20-50-33.png](https://i.loli.net/2020/06/12/jQwAkbz7V6n8dGK.png)\n\n`Condiment``Beverage``getDescription`Whip\n\n```java\npublic class Whip extends Condiment {\n    Beverage beverage;\n\n    public Whip(Beverage beverage) {\n        this.beverage = beverage;\n    }\n\n    @Override\n    public String getDescription() {\n        return beverage.getDescription() + \", Whip\";\n    }\n\n    @Override\n    public double cost() {\n        return .30 + beverage.cost();\n    }\n}\n```\n\n_cost_description\n\n```java\nBeverage beverage1 = new DarRoast();\nbeverage1 = new Mocha(beverage1);\nbeverage1 = new Mocha(beverage1);\nbeverage1 = new Whip(beverage1);\nSystem.out.println(beverage1.getDescription() + \" $\" + beverage1.cost());\n```\n\n```console\nBrazil Dark Roast Coffee, Mocha, Mocha, Whip $2.75\n```\n\n****.\n\n# \n\n## Java I/O\n\n`Decorator Pattern`javaio0101_FileInputStream__Beverage__BufferedInputStream__Espresso__LineNumberInutStream__Mocha_\n\n```flow\npara1=>parallel: FileInputStream\npara2=>parallel: BufferedInputStream\npara3=>parallel: LineNumberInputStream\nop1=>operation: Beferage\nop2=>operation: Espresso\nop3=>operation: Mocha\npara1(path1, bottom)->para2\npara2(path1,bottom)->para3\npara1(path2, right)->op1\npara2(path2, right)->op2\npara3(path2, right)->op3\n```\n","slug":"decorating","published":1,"updated":"2022-12-09T09:40:50.910Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwg001f8py0gfh3etkj","content":"<p></p>\n<span id=\"more\"></span>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>Beverage</code>*cost()*HouseBlend, DarkRoast Decaf, Espresso </p>\n<p></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li>DarkRoast</li>\n<li></li>\n<li></li>\n<li>costdelegate</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/06/12/jQwAkbz7V6n8dGK.png\" alt=\"Screenshot from 2020-06-12 20-50-33.png\"></p>\n<p><code>Condiment</code><code>Beverage</code><code>getDescription</code>Whip</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Whip</span> <span class=\"keyword\">extends</span> <span class=\"title\">Condiment</span> </span>&#123;</span><br><span class=\"line\">    Beverage beverage;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Whip</span><span class=\"params\">(Beverage beverage)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.beverage = beverage;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getDescription</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> beverage.getDescription() + <span class=\"string\">&quot;, Whip&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">double</span> <span class=\"title\">cost</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">.30</span> + beverage.cost();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>_cost_description</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Beverage beverage1 = <span class=\"keyword\">new</span> DarRoast();</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Mocha(beverage1);</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Mocha(beverage1);</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Whip(beverage1);</span><br><span class=\"line\">System.out.println(beverage1.getDescription() + <span class=\"string\">&quot; $&quot;</span> + beverage1.cost());</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Brazil Dark Roast Coffee, Mocha, Mocha, Whip $2.75</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong>.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Java-I-O\"><a href=\"#Java-I-O\" class=\"headerlink\" title=\"Java I/O\"></a>Java I/O</h2><p><code>Decorator Pattern</code>javaio0101_FileInputStream__Beverage__BufferedInputStream__Espresso__LineNumberInutStream__Mocha_</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">para1=&gt;parallel: FileInputStream</span><br><span class=\"line\">para2=&gt;parallel: BufferedInputStream</span><br><span class=\"line\">para3=&gt;parallel: LineNumberInputStream</span><br><span class=\"line\">op1=&gt;operation: Beferage</span><br><span class=\"line\">op2=&gt;operation: Espresso</span><br><span class=\"line\">op3=&gt;operation: Mocha</span><br><span class=\"line\">para1(path1, bottom)-&gt;para2</span><br><span class=\"line\">para2(path1,bottom)-&gt;para3</span><br><span class=\"line\">para1(path2, right)-&gt;op1</span><br><span class=\"line\">para2(path2, right)-&gt;op2</span><br><span class=\"line\">para3(path2, right)-&gt;op3</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p></p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>Beverage</code>*cost()*HouseBlend, DarkRoast Decaf, Espresso </p>\n<p></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li>DarkRoast</li>\n<li></li>\n<li></li>\n<li>costdelegate</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/06/12/jQwAkbz7V6n8dGK.png\" alt=\"Screenshot from 2020-06-12 20-50-33.png\"></p>\n<p><code>Condiment</code><code>Beverage</code><code>getDescription</code>Whip</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Whip</span> <span class=\"keyword\">extends</span> <span class=\"title\">Condiment</span> </span>&#123;</span><br><span class=\"line\">    Beverage beverage;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Whip</span><span class=\"params\">(Beverage beverage)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.beverage = beverage;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getDescription</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> beverage.getDescription() + <span class=\"string\">&quot;, Whip&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">double</span> <span class=\"title\">cost</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">.30</span> + beverage.cost();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>_cost_description</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Beverage beverage1 = <span class=\"keyword\">new</span> DarRoast();</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Mocha(beverage1);</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Mocha(beverage1);</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Whip(beverage1);</span><br><span class=\"line\">System.out.println(beverage1.getDescription() + <span class=\"string\">&quot; $&quot;</span> + beverage1.cost());</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Brazil Dark Roast Coffee, Mocha, Mocha, Whip $2.75</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong>.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Java-I-O\"><a href=\"#Java-I-O\" class=\"headerlink\" title=\"Java I/O\"></a>Java I/O</h2><p><code>Decorator Pattern</code>javaio0101_FileInputStream__Beverage__BufferedInputStream__Espresso__LineNumberInutStream__Mocha_</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">para1=&gt;parallel: FileInputStream</span><br><span class=\"line\">para2=&gt;parallel: BufferedInputStream</span><br><span class=\"line\">para3=&gt;parallel: LineNumberInputStream</span><br><span class=\"line\">op1=&gt;operation: Beferage</span><br><span class=\"line\">op2=&gt;operation: Espresso</span><br><span class=\"line\">op3=&gt;operation: Mocha</span><br><span class=\"line\">para1(path1, bottom)-&gt;para2</span><br><span class=\"line\">para2(path1,bottom)-&gt;para3</span><br><span class=\"line\">para1(path2, right)-&gt;op1</span><br><span class=\"line\">para2(path2, right)-&gt;op2</span><br><span class=\"line\">para3(path2, right)-&gt;op3</span><br></pre></td></tr></table></figure>"},{"title":"graph","date":"2022-12-04T08:51:25.000Z","_content":"","source":"_posts/graph.md","raw":"---\ntitle: graph\ndate: 2022-12-04 16:51:25\ntags:\n---\n","slug":"graph","published":1,"updated":"2022-12-04T08:51:25.465Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwg001h8py03rqk1ajp","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"hashmap","date":"2020-08-20T15:04:30.000Z","_content":"\nJava Hashmapjdk8\n\n<!--more-->\n\n# Example\n\n```java\nMap<String, Object> map = new HashMap<>();\nmap.put(\"name\", \"Gloria\");\nmap.put(\"age\", 3);\nmap.put(\"wage\", 539.8);\nSystem.out.println(map);\n```\n\n`put`\n\n## \n\nHashMapmap\n\n```java\nMap<String, Object> map1 = new HashMap<>(map); // map\n```\n\n\n\n```java\n    /**\n     * The load factor for the hash table.\n     *\n     * @serial\n     */\n    final float loadFactor;\n```\n\nHashMap`0.75`,\n\n```java\nMap<String, Object> map = new HashMap<>(16);\n```\n\nmap****12`0.75`,****\n\n## put\n\n```java\n/**\n * Implements Map.put and related methods.\n *\n * @param hash hash for key\n * @param key the key\n * @param value the value to put\n * @param onlyIfAbsent if true, don't change existing value\n * @param evict if false, the table is in creation mode.\n * @return previous value, or null if none\n */\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    return putVal(hash(key), key, value, false, true);\n}key\n```\n\nputhashhashkeyhashhash\n\n```java\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n}\n```\n\neasykeynull0hashmapkeynull,keynull****:\n\n- ^ (0)\n- \\>\\>\\> 0\n\nhkeyhashCodekeyhashcodeObject`native`h16\n\n`table``Noe<K,V> []`Node\n\n# Node\n\nHahsMap\n\n```java\n /**\n  * Basic hash bin node, used for most entries.  (See below for\n  * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)\n  */\nstatic class Node<K,V> implements Map.Entry<K,V> {\n    final int hash; // \n    final K key;\n    V value;\n    Node<K,V> next; // Node\n\n    Node(int hash, K key, V value, Node<K,V> next) {\n        this.hash = hash;\n        this.key = key;\n        this.value = value;\n        this.next = next;\n    }\n\n    // get, set equals ...\n}\n```\n\n-  `Node<K, V> next`\n- `table`Node+\n- `Map.Entry<K, V>`k-v\n- `next``hash`, `key`, `value`\n\nkey\n\n# \n\n\n\n=+`Node<K, V>``Node<K, V> []`hashmap`+`\n\nhashmap****`table`****\n\n```java\n/**\n  * The number of key-value mappings contained in this map.\n  */\ntransient int size;\n\n/**\n  * The number of times this HashMap has been structurally modified\n  * Structural modifications are those that change the number of mappings in\n  * the HashMap or otherwise modify its internal structure (e.g.,\n  * rehash).  This field is used to make iterators on Collection-views of\n  * the HashMap fail-fast.  (See ConcurrentModificationException).\n  */\ntransient int modCount;\n\n/**\n  * The next size value at which to resize (capacity * load factor).\n  *\n  * @serial\n  */\n// (The javadoc description is true upon serialization.\n// Additionally, if the table array has not been allocated, this\n// field holds the initial array capacity, or zero signifying\n// DEFAULT_INITIAL_CAPACITY.)\nint threshold;\n\n/**\n  * The load factor for the hash table.\n  *\n  * @serial\n  */\nfinal float loadFactor;\n```\n\n`threshold`k-vNode<K,V>[] tablelength16, loadFactor0.75,\n\n> threshold = loadFactor * length\n\ntableNode`threshold`12.Node12 16,12,1.\n\nsizeNode\n\nHashMaptable2n****\n\n- 2n````\n\nHashTable`initialCapacity`11. jdk8****8hashmap\n\n### ?\n\nkeyhashvalueNodehashvaluekeykeyvalue\n\n# \n\nhahsmapk-vNodetablekeyhashtableindex uhash\n\n> keyhashCode\n\nkeyhashCodehashNode hashmap\n\n```java\nif ((p = tab[i = (n - 1) & hash]) == null)\n            tab[i] = newNode(hash, key, value, null);\n```\n\nnhashkeyn2n`(n-1)&hash`length`%`\n\n# put\n\n```java\n/**\n * Implements Map.put and related methods.\n *\n * @param hash hash for key\n * @param key the key\n * @param value the value to put\n * @param onlyIfAbsent if true, don't change existing value\n * @param evict if false, the table is in creation mode.\n * @return previous value, or null if none\n */\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // table\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // null\n    if ((p = tab[i = (n - 1) & hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n    else {\n        Node<K,V> e; K k;\n        // keyugovalue\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n            e = p;\n        // \n        else if (p instanceof TreeNode)\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        else {\n            // table\n            for (int binCount = 0; ; ++binCount) {\n                if ((e = p.next) == null) {\n                    // \n                    p.next = newNode(hash, key, value, null);\n                    // 8\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                }\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    break;\n                p = e;\n            }\n        }\n        if (e != null) { // existing mapping for key\n            V oldValue = e.value;\n            if (!onlyIfAbsent || oldValue == null)\n                e.value = value;\n            afterNodeAccess(e);\n            return oldValue;\n        }\n    }\n    ++modCount;\n    // \n    if (++size > threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n}\n```\n\n# \n\nHashMapArrayListHashMapNode\n\n> note: HashMap\n\n```java\n/**\n * Initializes or doubles table size.  If null, allocates in\n * accord with initial capacity target held in field threshold.\n * Otherwise, because we are using power-of-two expansion, the\n * elements from each bin must either stay at same index, or move\n * with a power of two offset in the new table.\n *\n * @return the table\n */\nfinal Node<K,V>[] resize() {\n    Node<K,V>[] oldTab = table;\n    int oldCap = (oldTab == null) ? 0 : oldTab.length;\n    int oldThr = threshold;\n    int newCap, newThr = 0;\n    if (oldCap > 0) {\n        // let it go\n        if (oldCap >= MAXIMUM_CAPACITY) {\n            threshold = Integer.MAX_VALUE;\n            return oldTab;\n        }\n        // X2\n        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                 oldCap >= DEFAULT_INITIAL_CAPACITY)\n            newThr = oldThr << 1; // double threshold\n    }\n    else if (oldThr > 0) // initial capacity was placed in threshold\n        newCap = oldThr;\n    else {               // zero initial threshold signifies using defaults\n        newCap = DEFAULT_INITIAL_CAPACITY;\n        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    }\n    // resize\n    if (newThr == 0) {\n        float ft = (float)newCap * loadFactor;\n        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    }\n    threshold = newThr;\n    @SuppressWarnings({\"rawtypes\",\"unchecked\"})\n    Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];\n    table = newTab;\n    if (oldTab != null) {\n        // \n        for (int j = 0; j < oldCap; ++j) {\n            Node<K,V> e;\n            if ((e = oldTab[j]) != null) {\n                oldTab[j] = null;\n                if (e.next == null)\n                    newTab[e.hash & (newCap - 1)] = e;\n                else if (e instanceof TreeNode)\n                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                else { // preserve order\n                    Node<K,V> loHead = null, loTail = null;\n                    Node<K,V> hiHead = null, hiTail = null;\n                    Node<K,V> next;\n                    do {\n                        next = e.next;\n                        if ((e.hash & oldCap) == 0) {\n                            if (loTail == null)\n                                loHead = e;\n                            else\n                                loTail.next = e;\n                            loTail = e;\n                        }\n                        else {\n                            if (hiTail == null)\n                                hiHead = e;\n                            else\n                                hiTail.next = e;\n                            hiTail = e;\n                        }\n                    } while ((e = next) != null);\n                    if (loTail != null) {\n                        loTail.next = null;\n                        newTab[j] = loHead;\n                    }\n                    if (hiTail != null) {\n                        hiTail.next = null;\n                        newTab[j + oldCap] = hiHead;\n                    }\n                }\n            }\n        }\n    }\n    return newTab;\n}\n```\n\n# todo\n\n","source":"_posts/hashmap.md","raw":"---\ntitle: hashmap\ndate: 2020-08-20 23:04:30\ncategories: datastructure\ntags: hashmap \n---\n\nJava Hashmapjdk8\n\n<!--more-->\n\n# Example\n\n```java\nMap<String, Object> map = new HashMap<>();\nmap.put(\"name\", \"Gloria\");\nmap.put(\"age\", 3);\nmap.put(\"wage\", 539.8);\nSystem.out.println(map);\n```\n\n`put`\n\n## \n\nHashMapmap\n\n```java\nMap<String, Object> map1 = new HashMap<>(map); // map\n```\n\n\n\n```java\n    /**\n     * The load factor for the hash table.\n     *\n     * @serial\n     */\n    final float loadFactor;\n```\n\nHashMap`0.75`,\n\n```java\nMap<String, Object> map = new HashMap<>(16);\n```\n\nmap****12`0.75`,****\n\n## put\n\n```java\n/**\n * Implements Map.put and related methods.\n *\n * @param hash hash for key\n * @param key the key\n * @param value the value to put\n * @param onlyIfAbsent if true, don't change existing value\n * @param evict if false, the table is in creation mode.\n * @return previous value, or null if none\n */\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    return putVal(hash(key), key, value, false, true);\n}key\n```\n\nputhashhashkeyhashhash\n\n```java\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n}\n```\n\neasykeynull0hashmapkeynull,keynull****:\n\n- ^ (0)\n- \\>\\>\\> 0\n\nhkeyhashCodekeyhashcodeObject`native`h16\n\n`table``Noe<K,V> []`Node\n\n# Node\n\nHahsMap\n\n```java\n /**\n  * Basic hash bin node, used for most entries.  (See below for\n  * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)\n  */\nstatic class Node<K,V> implements Map.Entry<K,V> {\n    final int hash; // \n    final K key;\n    V value;\n    Node<K,V> next; // Node\n\n    Node(int hash, K key, V value, Node<K,V> next) {\n        this.hash = hash;\n        this.key = key;\n        this.value = value;\n        this.next = next;\n    }\n\n    // get, set equals ...\n}\n```\n\n-  `Node<K, V> next`\n- `table`Node+\n- `Map.Entry<K, V>`k-v\n- `next``hash`, `key`, `value`\n\nkey\n\n# \n\n\n\n=+`Node<K, V>``Node<K, V> []`hashmap`+`\n\nhashmap****`table`****\n\n```java\n/**\n  * The number of key-value mappings contained in this map.\n  */\ntransient int size;\n\n/**\n  * The number of times this HashMap has been structurally modified\n  * Structural modifications are those that change the number of mappings in\n  * the HashMap or otherwise modify its internal structure (e.g.,\n  * rehash).  This field is used to make iterators on Collection-views of\n  * the HashMap fail-fast.  (See ConcurrentModificationException).\n  */\ntransient int modCount;\n\n/**\n  * The next size value at which to resize (capacity * load factor).\n  *\n  * @serial\n  */\n// (The javadoc description is true upon serialization.\n// Additionally, if the table array has not been allocated, this\n// field holds the initial array capacity, or zero signifying\n// DEFAULT_INITIAL_CAPACITY.)\nint threshold;\n\n/**\n  * The load factor for the hash table.\n  *\n  * @serial\n  */\nfinal float loadFactor;\n```\n\n`threshold`k-vNode<K,V>[] tablelength16, loadFactor0.75,\n\n> threshold = loadFactor * length\n\ntableNode`threshold`12.Node12 16,12,1.\n\nsizeNode\n\nHashMaptable2n****\n\n- 2n````\n\nHashTable`initialCapacity`11. jdk8****8hashmap\n\n### ?\n\nkeyhashvalueNodehashvaluekeykeyvalue\n\n# \n\nhahsmapk-vNodetablekeyhashtableindex uhash\n\n> keyhashCode\n\nkeyhashCodehashNode hashmap\n\n```java\nif ((p = tab[i = (n - 1) & hash]) == null)\n            tab[i] = newNode(hash, key, value, null);\n```\n\nnhashkeyn2n`(n-1)&hash`length`%`\n\n# put\n\n```java\n/**\n * Implements Map.put and related methods.\n *\n * @param hash hash for key\n * @param key the key\n * @param value the value to put\n * @param onlyIfAbsent if true, don't change existing value\n * @param evict if false, the table is in creation mode.\n * @return previous value, or null if none\n */\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // table\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // null\n    if ((p = tab[i = (n - 1) & hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n    else {\n        Node<K,V> e; K k;\n        // keyugovalue\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n            e = p;\n        // \n        else if (p instanceof TreeNode)\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        else {\n            // table\n            for (int binCount = 0; ; ++binCount) {\n                if ((e = p.next) == null) {\n                    // \n                    p.next = newNode(hash, key, value, null);\n                    // 8\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                }\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    break;\n                p = e;\n            }\n        }\n        if (e != null) { // existing mapping for key\n            V oldValue = e.value;\n            if (!onlyIfAbsent || oldValue == null)\n                e.value = value;\n            afterNodeAccess(e);\n            return oldValue;\n        }\n    }\n    ++modCount;\n    // \n    if (++size > threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n}\n```\n\n# \n\nHashMapArrayListHashMapNode\n\n> note: HashMap\n\n```java\n/**\n * Initializes or doubles table size.  If null, allocates in\n * accord with initial capacity target held in field threshold.\n * Otherwise, because we are using power-of-two expansion, the\n * elements from each bin must either stay at same index, or move\n * with a power of two offset in the new table.\n *\n * @return the table\n */\nfinal Node<K,V>[] resize() {\n    Node<K,V>[] oldTab = table;\n    int oldCap = (oldTab == null) ? 0 : oldTab.length;\n    int oldThr = threshold;\n    int newCap, newThr = 0;\n    if (oldCap > 0) {\n        // let it go\n        if (oldCap >= MAXIMUM_CAPACITY) {\n            threshold = Integer.MAX_VALUE;\n            return oldTab;\n        }\n        // X2\n        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                 oldCap >= DEFAULT_INITIAL_CAPACITY)\n            newThr = oldThr << 1; // double threshold\n    }\n    else if (oldThr > 0) // initial capacity was placed in threshold\n        newCap = oldThr;\n    else {               // zero initial threshold signifies using defaults\n        newCap = DEFAULT_INITIAL_CAPACITY;\n        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    }\n    // resize\n    if (newThr == 0) {\n        float ft = (float)newCap * loadFactor;\n        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    }\n    threshold = newThr;\n    @SuppressWarnings({\"rawtypes\",\"unchecked\"})\n    Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];\n    table = newTab;\n    if (oldTab != null) {\n        // \n        for (int j = 0; j < oldCap; ++j) {\n            Node<K,V> e;\n            if ((e = oldTab[j]) != null) {\n                oldTab[j] = null;\n                if (e.next == null)\n                    newTab[e.hash & (newCap - 1)] = e;\n                else if (e instanceof TreeNode)\n                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                else { // preserve order\n                    Node<K,V> loHead = null, loTail = null;\n                    Node<K,V> hiHead = null, hiTail = null;\n                    Node<K,V> next;\n                    do {\n                        next = e.next;\n                        if ((e.hash & oldCap) == 0) {\n                            if (loTail == null)\n                                loHead = e;\n                            else\n                                loTail.next = e;\n                            loTail = e;\n                        }\n                        else {\n                            if (hiTail == null)\n                                hiHead = e;\n                            else\n                                hiTail.next = e;\n                            hiTail = e;\n                        }\n                    } while ((e = next) != null);\n                    if (loTail != null) {\n                        loTail.next = null;\n                        newTab[j] = loHead;\n                    }\n                    if (hiTail != null) {\n                        hiTail.next = null;\n                        newTab[j + oldCap] = hiHead;\n                    }\n                }\n            }\n        }\n    }\n    return newTab;\n}\n```\n\n# todo\n\n","slug":"hashmap","published":1,"updated":"2022-12-09T09:42:38.257Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwg001m8py03uff66z3","content":"<p>Java Hashmapjdk8</p>\n<span id=\"more\"></span>\n\n<h1 id=\"Example\"><a href=\"#Example\" class=\"headerlink\" title=\"Example\"></a>Example</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;name&quot;</span>, <span class=\"string\">&quot;Gloria&quot;</span>);</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;age&quot;</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;wage&quot;</span>, <span class=\"number\">539.8</span>);</span><br><span class=\"line\">System.out.println(map);</span><br></pre></td></tr></table></figure>\n\n<p><code>put</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HashMapmap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map1 = <span class=\"keyword\">new</span> HashMap&lt;&gt;(map); <span class=\"comment\">// map</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * The load factor for the hash table.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">float</span> loadFactor;</span><br></pre></td></tr></table></figure>\n\n<p>HashMap<code>0.75</code>,</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">16</span>);</span><br></pre></td></tr></table></figure>\n\n<p>map<strong></strong>12<code>0.75</code>,<strong></strong></p>\n<h2 id=\"put\"><a href=\"#put\" class=\"headerlink\" title=\"put\"></a>put</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Implements Map.put and related methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> hash hash for key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> key the key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> value the value to put</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> evict if false, the table is in creation mode.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> previous value, or null if none</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> V <span class=\"title\">putVal</span><span class=\"params\">(<span class=\"keyword\">int</span> hash, K key, V value, <span class=\"keyword\">boolean</span> onlyIfAbsent,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">               <span class=\"keyword\">boolean</span> evict)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> putVal(hash(key), key, value, <span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>);</span><br><span class=\"line\">&#125;key</span><br></pre></td></tr></table></figure>\n\n<p>puthashhashkeyhashhash</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">hash</span><span class=\"params\">(Object key)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> h;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (key == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>easykeynull0hashmapkeynull,keynull<strong></strong>:</p>\n<ul>\n<li>^ (0)</li>\n<li>&gt;&gt;&gt; 0</li>\n</ul>\n<p>hkeyhashCodekeyhashcodeObject<code>native</code>h16</p>\n<p><code>table</code><code>Noe&lt;K,V&gt; []</code>Node</p>\n<h1 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a>Node</h1><p>HahsMap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * Basic hash bin node, used for most entries.  (See below for</span></span><br><span class=\"line\"><span class=\"comment\">  * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Node</span>&lt;<span class=\"title\">K</span>,<span class=\"title\">V</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">Map</span>.<span class=\"title\">Entry</span>&lt;<span class=\"title\">K</span>,<span class=\"title\">V</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> hash; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> K key;</span><br><span class=\"line\">    V value;</span><br><span class=\"line\">    Node&lt;K,V&gt; next; <span class=\"comment\">// Node</span></span><br><span class=\"line\"></span><br><span class=\"line\">    Node(<span class=\"keyword\">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hash = hash;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.key = key;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// get, set equals ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> <code>Node&lt;K, V&gt; next</code></li>\n<li><code>table</code>Node+</li>\n<li><code>Map.Entry&lt;K, V&gt;</code>k-v</li>\n<li><code>next</code><code>hash</code>, <code>key</code>, <code>value</code></li>\n</ul>\n<p>key</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>=+<code>Node&lt;K, V&gt;</code><code>Node&lt;K, V&gt; []</code>hashmap<code>+</code></p>\n<p>hashmap<strong></strong><code>table</code><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The number of key-value mappings contained in this map.</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">transient</span> <span class=\"keyword\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The number of times this HashMap has been structurally modified</span></span><br><span class=\"line\"><span class=\"comment\">  * Structural modifications are those that change the number of mappings in</span></span><br><span class=\"line\"><span class=\"comment\">  * the HashMap or otherwise modify its internal structure (e.g.,</span></span><br><span class=\"line\"><span class=\"comment\">  * rehash).  This field is used to make iterators on Collection-views of</span></span><br><span class=\"line\"><span class=\"comment\">  * the HashMap fail-fast.  (See ConcurrentModificationException).</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">transient</span> <span class=\"keyword\">int</span> modCount;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The next size value at which to resize (capacity * load factor).</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"comment\">// (The javadoc description is true upon serialization.</span></span><br><span class=\"line\"><span class=\"comment\">// Additionally, if the table array has not been allocated, this</span></span><br><span class=\"line\"><span class=\"comment\">// field holds the initial array capacity, or zero signifying</span></span><br><span class=\"line\"><span class=\"comment\">// DEFAULT_INITIAL_CAPACITY.)</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> threshold;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The load factor for the hash table.</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">float</span> loadFactor;</span><br></pre></td></tr></table></figure>\n\n<p><code>threshold</code>k-vNode&lt;K,V&gt;[] tablelength16, loadFactor0.75,</p>\n<blockquote>\n<p>threshold = loadFactor * length</p>\n</blockquote>\n<p>tableNode<code>threshold</code>12.Node12 16,12,1.</p>\n<p>sizeNode</p>\n<p>HashMaptable2n<strong></strong></p>\n<ul>\n<li>2n<code></code><code></code></li>\n</ul>\n<p>HashTable<code>initialCapacity</code>11. jdk8<strong></strong>8hashmap</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"?\"></a>?</h3><p>keyhashvalueNodehashvaluekeykeyvalue</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>hahsmapk-vNodetablekeyhashtableindex uhash</p>\n<blockquote>\n<p>keyhashCode</p>\n</blockquote>\n<p>keyhashCodehashNode hashmap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            tab[i] = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br></pre></td></tr></table></figure>\n\n<p>nhashkeyn2n<code>(n-1)&amp;hash</code>length<code>%</code></p>\n<h1 id=\"put\"><a href=\"#put\" class=\"headerlink\" title=\"put\"></a>put</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Implements Map.put and related methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> hash hash for key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> key the key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> value the value to put</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> evict if false, the table is in creation mode.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> previous value, or null if none</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> V <span class=\"title\">putVal</span><span class=\"params\">(<span class=\"keyword\">int</span> hash, K key, V value, <span class=\"keyword\">boolean</span> onlyIfAbsent,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">               <span class=\"keyword\">boolean</span> evict)</span> </span>&#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class=\"keyword\">int</span> n, i;</span><br><span class=\"line\">    <span class=\"comment\">// table</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tab = table) == <span class=\"keyword\">null</span> || (n = tab.length) == <span class=\"number\">0</span>)</span><br><span class=\"line\">        n = (tab = resize()).length;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        tab[i] = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        Node&lt;K,V&gt; e; K k;</span><br><span class=\"line\">        <span class=\"comment\">// keyugovalue</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.hash == hash &amp;&amp;</span><br><span class=\"line\">            ((k = p.key) == key || (key != <span class=\"keyword\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">            e = p;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (p <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class=\"keyword\">this</span>, tab, hash, key, value);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// table</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> binCount = <span class=\"number\">0</span>; ; ++binCount) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((e = p.next) == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    p.next = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// 8</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class=\"number\">1</span>) <span class=\"comment\">// -1 for 1st</span></span><br><span class=\"line\">                        treeifyBin(tab, hash);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.hash == hash &amp;&amp;</span><br><span class=\"line\">                    ((k = e.key) == key || (key != <span class=\"keyword\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                p = e;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123; <span class=\"comment\">// existing mapping for key</span></span><br><span class=\"line\">            V oldValue = e.value;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!onlyIfAbsent || oldValue == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                e.value = value;</span><br><span class=\"line\">            afterNodeAccess(e);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ++modCount;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (++size &gt; threshold)</span><br><span class=\"line\">        resize();</span><br><span class=\"line\">    afterNodeInsertion(evict);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>HashMapArrayListHashMapNode</p>\n<blockquote>\n<p>note: HashMap</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Initializes or doubles table size.  If null, allocates in</span></span><br><span class=\"line\"><span class=\"comment\"> * accord with initial capacity target held in field threshold.</span></span><br><span class=\"line\"><span class=\"comment\"> * Otherwise, because we are using power-of-two expansion, the</span></span><br><span class=\"line\"><span class=\"comment\"> * elements from each bin must either stay at same index, or move</span></span><br><span class=\"line\"><span class=\"comment\"> * with a power of two offset in the new table.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> the table</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldCap = (oldTab == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : oldTab.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldThr = threshold;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> newCap, newThr = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldCap &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// let it go</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class=\"line\">            threshold = Integer.MAX_VALUE;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldTab;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// X2</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ((newCap = oldCap &lt;&lt; <span class=\"number\">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class=\"line\">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class=\"line\">            newThr = oldThr &lt;&lt; <span class=\"number\">1</span>; <span class=\"comment\">// double threshold</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (oldThr &gt; <span class=\"number\">0</span>) <span class=\"comment\">// initial capacity was placed in threshold</span></span><br><span class=\"line\">        newCap = oldThr;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;               <span class=\"comment\">// zero initial threshold signifies using defaults</span></span><br><span class=\"line\">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class=\"line\">        newThr = (<span class=\"keyword\">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// resize</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newThr == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">float</span> ft = (<span class=\"keyword\">float</span>)newCap * loadFactor;</span><br><span class=\"line\">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class=\"keyword\">float</span>)MAXIMUM_CAPACITY ?</span><br><span class=\"line\">                  (<span class=\"keyword\">int</span>)ft : Integer.MAX_VALUE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    threshold = newThr;</span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class=\"line\">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class=\"keyword\">new</span> Node[newCap];</span><br><span class=\"line\">    table = newTab;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldTab != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class=\"line\">            Node&lt;K,V&gt; e;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((e = oldTab[j]) != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                oldTab[j] = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.next == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                    newTab[e.hash &amp; (newCap - <span class=\"number\">1</span>)] = e;</span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (e <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">                    ((TreeNode&lt;K,V&gt;)e).split(<span class=\"keyword\">this</span>, newTab, j, oldCap);</span><br><span class=\"line\">                <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// preserve order</span></span><br><span class=\"line\">                    Node&lt;K,V&gt; loHead = <span class=\"keyword\">null</span>, loTail = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; hiHead = <span class=\"keyword\">null</span>, hiTail = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; next;</span><br><span class=\"line\">                    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">                        next = e.next;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> ((e.hash &amp; oldCap) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (loTail == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                                loHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                loTail.next = e;</span><br><span class=\"line\">                            loTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (hiTail == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                                hiHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                hiTail.next = e;</span><br><span class=\"line\">                            hiTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">while</span> ((e = next) != <span class=\"keyword\">null</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (loTail != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        loTail.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        newTab[j] = loHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (hiTail != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        hiTail.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        newTab[j + oldCap] = hiHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> newTab;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"todo\"><a href=\"#todo\" class=\"headerlink\" title=\"todo\"></a>todo</h1><p></p>\n","site":{"data":{}},"excerpt":"<p>Java Hashmapjdk8</p>","more":"<h1 id=\"Example\"><a href=\"#Example\" class=\"headerlink\" title=\"Example\"></a>Example</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;name&quot;</span>, <span class=\"string\">&quot;Gloria&quot;</span>);</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;age&quot;</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;wage&quot;</span>, <span class=\"number\">539.8</span>);</span><br><span class=\"line\">System.out.println(map);</span><br></pre></td></tr></table></figure>\n\n<p><code>put</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HashMapmap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map1 = <span class=\"keyword\">new</span> HashMap&lt;&gt;(map); <span class=\"comment\">// map</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * The load factor for the hash table.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">float</span> loadFactor;</span><br></pre></td></tr></table></figure>\n\n<p>HashMap<code>0.75</code>,</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">16</span>);</span><br></pre></td></tr></table></figure>\n\n<p>map<strong></strong>12<code>0.75</code>,<strong></strong></p>\n<h2 id=\"put\"><a href=\"#put\" class=\"headerlink\" title=\"put\"></a>put</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Implements Map.put and related methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> hash hash for key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> key the key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> value the value to put</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> evict if false, the table is in creation mode.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> previous value, or null if none</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> V <span class=\"title\">putVal</span><span class=\"params\">(<span class=\"keyword\">int</span> hash, K key, V value, <span class=\"keyword\">boolean</span> onlyIfAbsent,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">               <span class=\"keyword\">boolean</span> evict)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> putVal(hash(key), key, value, <span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>);</span><br><span class=\"line\">&#125;key</span><br></pre></td></tr></table></figure>\n\n<p>puthashhashkeyhashhash</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">hash</span><span class=\"params\">(Object key)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> h;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (key == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>easykeynull0hashmapkeynull,keynull<strong></strong>:</p>\n<ul>\n<li>^ (0)</li>\n<li>&gt;&gt;&gt; 0</li>\n</ul>\n<p>hkeyhashCodekeyhashcodeObject<code>native</code>h16</p>\n<p><code>table</code><code>Noe&lt;K,V&gt; []</code>Node</p>\n<h1 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a>Node</h1><p>HahsMap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * Basic hash bin node, used for most entries.  (See below for</span></span><br><span class=\"line\"><span class=\"comment\">  * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Node</span>&lt;<span class=\"title\">K</span>,<span class=\"title\">V</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">Map</span>.<span class=\"title\">Entry</span>&lt;<span class=\"title\">K</span>,<span class=\"title\">V</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> hash; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> K key;</span><br><span class=\"line\">    V value;</span><br><span class=\"line\">    Node&lt;K,V&gt; next; <span class=\"comment\">// Node</span></span><br><span class=\"line\"></span><br><span class=\"line\">    Node(<span class=\"keyword\">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hash = hash;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.key = key;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// get, set equals ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> <code>Node&lt;K, V&gt; next</code></li>\n<li><code>table</code>Node+</li>\n<li><code>Map.Entry&lt;K, V&gt;</code>k-v</li>\n<li><code>next</code><code>hash</code>, <code>key</code>, <code>value</code></li>\n</ul>\n<p>key</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>=+<code>Node&lt;K, V&gt;</code><code>Node&lt;K, V&gt; []</code>hashmap<code>+</code></p>\n<p>hashmap<strong></strong><code>table</code><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The number of key-value mappings contained in this map.</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">transient</span> <span class=\"keyword\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The number of times this HashMap has been structurally modified</span></span><br><span class=\"line\"><span class=\"comment\">  * Structural modifications are those that change the number of mappings in</span></span><br><span class=\"line\"><span class=\"comment\">  * the HashMap or otherwise modify its internal structure (e.g.,</span></span><br><span class=\"line\"><span class=\"comment\">  * rehash).  This field is used to make iterators on Collection-views of</span></span><br><span class=\"line\"><span class=\"comment\">  * the HashMap fail-fast.  (See ConcurrentModificationException).</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">transient</span> <span class=\"keyword\">int</span> modCount;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The next size value at which to resize (capacity * load factor).</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"comment\">// (The javadoc description is true upon serialization.</span></span><br><span class=\"line\"><span class=\"comment\">// Additionally, if the table array has not been allocated, this</span></span><br><span class=\"line\"><span class=\"comment\">// field holds the initial array capacity, or zero signifying</span></span><br><span class=\"line\"><span class=\"comment\">// DEFAULT_INITIAL_CAPACITY.)</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> threshold;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The load factor for the hash table.</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">float</span> loadFactor;</span><br></pre></td></tr></table></figure>\n\n<p><code>threshold</code>k-vNode&lt;K,V&gt;[] tablelength16, loadFactor0.75,</p>\n<blockquote>\n<p>threshold = loadFactor * length</p>\n</blockquote>\n<p>tableNode<code>threshold</code>12.Node12 16,12,1.</p>\n<p>sizeNode</p>\n<p>HashMaptable2n<strong></strong></p>\n<ul>\n<li>2n<code></code><code></code></li>\n</ul>\n<p>HashTable<code>initialCapacity</code>11. jdk8<strong></strong>8hashmap</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"?\"></a>?</h3><p>keyhashvalueNodehashvaluekeykeyvalue</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>hahsmapk-vNodetablekeyhashtableindex uhash</p>\n<blockquote>\n<p>keyhashCode</p>\n</blockquote>\n<p>keyhashCodehashNode hashmap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            tab[i] = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br></pre></td></tr></table></figure>\n\n<p>nhashkeyn2n<code>(n-1)&amp;hash</code>length<code>%</code></p>\n<h1 id=\"put\"><a href=\"#put\" class=\"headerlink\" title=\"put\"></a>put</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Implements Map.put and related methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> hash hash for key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> key the key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> value the value to put</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> evict if false, the table is in creation mode.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> previous value, or null if none</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> V <span class=\"title\">putVal</span><span class=\"params\">(<span class=\"keyword\">int</span> hash, K key, V value, <span class=\"keyword\">boolean</span> onlyIfAbsent,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">               <span class=\"keyword\">boolean</span> evict)</span> </span>&#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class=\"keyword\">int</span> n, i;</span><br><span class=\"line\">    <span class=\"comment\">// table</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tab = table) == <span class=\"keyword\">null</span> || (n = tab.length) == <span class=\"number\">0</span>)</span><br><span class=\"line\">        n = (tab = resize()).length;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        tab[i] = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        Node&lt;K,V&gt; e; K k;</span><br><span class=\"line\">        <span class=\"comment\">// keyugovalue</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.hash == hash &amp;&amp;</span><br><span class=\"line\">            ((k = p.key) == key || (key != <span class=\"keyword\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">            e = p;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (p <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class=\"keyword\">this</span>, tab, hash, key, value);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// table</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> binCount = <span class=\"number\">0</span>; ; ++binCount) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((e = p.next) == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    p.next = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// 8</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class=\"number\">1</span>) <span class=\"comment\">// -1 for 1st</span></span><br><span class=\"line\">                        treeifyBin(tab, hash);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.hash == hash &amp;&amp;</span><br><span class=\"line\">                    ((k = e.key) == key || (key != <span class=\"keyword\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                p = e;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123; <span class=\"comment\">// existing mapping for key</span></span><br><span class=\"line\">            V oldValue = e.value;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!onlyIfAbsent || oldValue == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                e.value = value;</span><br><span class=\"line\">            afterNodeAccess(e);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ++modCount;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (++size &gt; threshold)</span><br><span class=\"line\">        resize();</span><br><span class=\"line\">    afterNodeInsertion(evict);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>HashMapArrayListHashMapNode</p>\n<blockquote>\n<p>note: HashMap</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Initializes or doubles table size.  If null, allocates in</span></span><br><span class=\"line\"><span class=\"comment\"> * accord with initial capacity target held in field threshold.</span></span><br><span class=\"line\"><span class=\"comment\"> * Otherwise, because we are using power-of-two expansion, the</span></span><br><span class=\"line\"><span class=\"comment\"> * elements from each bin must either stay at same index, or move</span></span><br><span class=\"line\"><span class=\"comment\"> * with a power of two offset in the new table.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> the table</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldCap = (oldTab == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : oldTab.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldThr = threshold;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> newCap, newThr = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldCap &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// let it go</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class=\"line\">            threshold = Integer.MAX_VALUE;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldTab;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// X2</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ((newCap = oldCap &lt;&lt; <span class=\"number\">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class=\"line\">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class=\"line\">            newThr = oldThr &lt;&lt; <span class=\"number\">1</span>; <span class=\"comment\">// double threshold</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (oldThr &gt; <span class=\"number\">0</span>) <span class=\"comment\">// initial capacity was placed in threshold</span></span><br><span class=\"line\">        newCap = oldThr;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;               <span class=\"comment\">// zero initial threshold signifies using defaults</span></span><br><span class=\"line\">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class=\"line\">        newThr = (<span class=\"keyword\">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// resize</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newThr == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">float</span> ft = (<span class=\"keyword\">float</span>)newCap * loadFactor;</span><br><span class=\"line\">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class=\"keyword\">float</span>)MAXIMUM_CAPACITY ?</span><br><span class=\"line\">                  (<span class=\"keyword\">int</span>)ft : Integer.MAX_VALUE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    threshold = newThr;</span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class=\"line\">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class=\"keyword\">new</span> Node[newCap];</span><br><span class=\"line\">    table = newTab;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldTab != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class=\"line\">            Node&lt;K,V&gt; e;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((e = oldTab[j]) != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                oldTab[j] = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.next == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                    newTab[e.hash &amp; (newCap - <span class=\"number\">1</span>)] = e;</span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (e <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">                    ((TreeNode&lt;K,V&gt;)e).split(<span class=\"keyword\">this</span>, newTab, j, oldCap);</span><br><span class=\"line\">                <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// preserve order</span></span><br><span class=\"line\">                    Node&lt;K,V&gt; loHead = <span class=\"keyword\">null</span>, loTail = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; hiHead = <span class=\"keyword\">null</span>, hiTail = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; next;</span><br><span class=\"line\">                    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">                        next = e.next;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> ((e.hash &amp; oldCap) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (loTail == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                                loHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                loTail.next = e;</span><br><span class=\"line\">                            loTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (hiTail == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                                hiHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                hiTail.next = e;</span><br><span class=\"line\">                            hiTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">while</span> ((e = next) != <span class=\"keyword\">null</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (loTail != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        loTail.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        newTab[j] = loHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (hiTail != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        hiTail.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        newTab[j + oldCap] = hiHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> newTab;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"todo\"><a href=\"#todo\" class=\"headerlink\" title=\"todo\"></a>todo</h1><p></p>"},{"title":"heap","date":"2020-06-06T14:54:27.000Z","_content":"\nJVM\n\ntopN\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n    \n\n## \n\n- \n- \n- \n\n## \n\n- \n- \n\nBSTBST\n\n# \n\n\n\n\n\n![Screenshot from 2020-06-06 15-24-34.png](https://i.loli.net/2020/06/06/JbDlczXVh35sEF1.png)\n\n{62,42,59,32,39,44,13,22,29,14,33,30,17,9}\n\n_i__2i+1__2i+2__(i-1)/2_39424+1=9\n\n## \n\n \n\n\n\n\n\n## \n\nO(nlogn)\n\nlognlogn\n\n**n**nnlogn\n\n# \n\n## \n\ntop n \n\n## TOP N\n\n/\n\n```java\n// n\npublic static int[] topN(int[] array, int n) {\n    if (n == 0) {\n        return new int[0];\n    }\n    // default big heap, lambda make it small heap\n    Queue<Integer> heap = new PriorityQueue<>(n, ((o1, o2) -> Integer.compare(o2, o1)));\n\n    for (int e : array) {\n        // put the integer in when it smaller than the top of integer\n        if (heap.isEmpty() || heap.size() < n || e < heap.peek()) {\n            heap.offer(e);\n        }\n        if (heap.size() > n) {\n            // delete the top of heap integer\n            heap.poll();\n        }\n    }\n\n    int[] res = new int[heap.size()];\n    int j = 0;\n    for (int e : heap) {\n        res[j++] = e;\n    }\n    return res;\n}\n```\n\nforFIFO\n\nn\n\n```java\n// \nQueue<Integer> heap = new PriorityQueue<>(n);\nfor(int e: array){\n    // \n    if(heap.isEmpty() || heap.size() < n || e > heap.peak()){\n        heap.offer(e);\n    }\n    // \n    if(heap.size() > n){\n        heap.pool();\n    }\n}\n```\n\n### \n\n\n\n- K\n- K\n\n100101\n\n- 100\n- 101\n\n*****O(k\\*n)*kKn\n","source":"_posts/heap.md","raw":"---\ntitle: heap\ndate: 2020-06-06 22:54:27\ncategories: datastructure\ntags: heap\n---\n\nJVM\n\ntopN\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n    \n\n## \n\n- \n- \n- \n\n## \n\n- \n- \n\nBSTBST\n\n# \n\n\n\n\n\n![Screenshot from 2020-06-06 15-24-34.png](https://i.loli.net/2020/06/06/JbDlczXVh35sEF1.png)\n\n{62,42,59,32,39,44,13,22,29,14,33,30,17,9}\n\n_i__2i+1__2i+2__(i-1)/2_39424+1=9\n\n## \n\n \n\n\n\n\n\n## \n\nO(nlogn)\n\nlognlogn\n\n**n**nnlogn\n\n# \n\n## \n\ntop n \n\n## TOP N\n\n/\n\n```java\n// n\npublic static int[] topN(int[] array, int n) {\n    if (n == 0) {\n        return new int[0];\n    }\n    // default big heap, lambda make it small heap\n    Queue<Integer> heap = new PriorityQueue<>(n, ((o1, o2) -> Integer.compare(o2, o1)));\n\n    for (int e : array) {\n        // put the integer in when it smaller than the top of integer\n        if (heap.isEmpty() || heap.size() < n || e < heap.peek()) {\n            heap.offer(e);\n        }\n        if (heap.size() > n) {\n            // delete the top of heap integer\n            heap.poll();\n        }\n    }\n\n    int[] res = new int[heap.size()];\n    int j = 0;\n    for (int e : heap) {\n        res[j++] = e;\n    }\n    return res;\n}\n```\n\nforFIFO\n\nn\n\n```java\n// \nQueue<Integer> heap = new PriorityQueue<>(n);\nfor(int e: array){\n    // \n    if(heap.isEmpty() || heap.size() < n || e > heap.peak()){\n        heap.offer(e);\n    }\n    // \n    if(heap.size() > n){\n        heap.pool();\n    }\n}\n```\n\n### \n\n\n\n- K\n- K\n\n100101\n\n- 100\n- 101\n\n*****O(k\\*n)*kKn\n","slug":"heap","published":1,"updated":"2022-11-24T11:44:08.041Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwg001o8py06rga587o","content":"<p>JVM</p>\n<p>topN</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>    </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<p>BSTBST</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2020/06/06/JbDlczXVh35sEF1.png\" alt=\"Screenshot from 2020-06-06 15-24-34.png\"></p>\n<p>{62,42,59,32,39,44,13,22,29,14,33,30,17,9}</p>\n<p>_i__2i+1__2i+2__(i-1)/2_39424+1=9</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> </p>\n<p></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>O(nlogn)</p>\n<p>lognlogn</p>\n<p><strong>n</strong>nnlogn</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>top n </p>\n<h2 id=\"TOP-N\"><a href=\"#TOP-N\" class=\"headerlink\" title=\"TOP N\"></a>TOP N</h2><p>/</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// n</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span>[] topN(<span class=\"keyword\">int</span>[] array, <span class=\"keyword\">int</span> n) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// default big heap, lambda make it small heap</span></span><br><span class=\"line\">    Queue&lt;Integer&gt; heap = <span class=\"keyword\">new</span> PriorityQueue&lt;&gt;(n, ((o1, o2) -&gt; Integer.compare(o2, o1)));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> e : array) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// put the integer in when it smaller than the top of integer</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (heap.isEmpty() || heap.size() &lt; n || e &lt; heap.peek()) &#123;</span><br><span class=\"line\">            heap.offer(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (heap.size() &gt; n) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// delete the top of heap integer</span></span><br><span class=\"line\">            heap.poll();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] res = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[heap.size()];</span><br><span class=\"line\">    <span class=\"keyword\">int</span> j = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> e : heap) &#123;</span><br><span class=\"line\">        res[j++] = e;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>forFIFO</p>\n<p>n</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">Queue&lt;Integer&gt; heap = <span class=\"keyword\">new</span> PriorityQueue&lt;&gt;(n);</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e: array)&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(heap.isEmpty() || heap.size() &lt; n || e &gt; heap.peak())&#123;</span><br><span class=\"line\">        heap.offer(e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(heap.size() &gt; n)&#123;</span><br><span class=\"line\">        heap.pool();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li>K</li>\n<li>K</li>\n</ul>\n<p>100101</p>\n<ul>\n<li>100</li>\n<li>101</li>\n</ul>\n<p><strong></strong><em>O(k\\</em>n)*kKn</p>\n","site":{"data":{}},"excerpt":"<p>JVM</p>\n<p>topN</p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>    </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<p>BSTBST</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2020/06/06/JbDlczXVh35sEF1.png\" alt=\"Screenshot from 2020-06-06 15-24-34.png\"></p>\n<p>{62,42,59,32,39,44,13,22,29,14,33,30,17,9}</p>\n<p>_i__2i+1__2i+2__(i-1)/2_39424+1=9</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> </p>\n<p></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>O(nlogn)</p>\n<p>lognlogn</p>\n<p><strong>n</strong>nnlogn</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>top n </p>\n<h2 id=\"TOP-N\"><a href=\"#TOP-N\" class=\"headerlink\" title=\"TOP N\"></a>TOP N</h2><p>/</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// n</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span>[] topN(<span class=\"keyword\">int</span>[] array, <span class=\"keyword\">int</span> n) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// default big heap, lambda make it small heap</span></span><br><span class=\"line\">    Queue&lt;Integer&gt; heap = <span class=\"keyword\">new</span> PriorityQueue&lt;&gt;(n, ((o1, o2) -&gt; Integer.compare(o2, o1)));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> e : array) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// put the integer in when it smaller than the top of integer</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (heap.isEmpty() || heap.size() &lt; n || e &lt; heap.peek()) &#123;</span><br><span class=\"line\">            heap.offer(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (heap.size() &gt; n) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// delete the top of heap integer</span></span><br><span class=\"line\">            heap.poll();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] res = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[heap.size()];</span><br><span class=\"line\">    <span class=\"keyword\">int</span> j = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> e : heap) &#123;</span><br><span class=\"line\">        res[j++] = e;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>forFIFO</p>\n<p>n</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">Queue&lt;Integer&gt; heap = <span class=\"keyword\">new</span> PriorityQueue&lt;&gt;(n);</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e: array)&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(heap.isEmpty() || heap.size() &lt; n || e &gt; heap.peak())&#123;</span><br><span class=\"line\">        heap.offer(e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(heap.size() &gt; n)&#123;</span><br><span class=\"line\">        heap.pool();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li>K</li>\n<li>K</li>\n</ul>\n<p>100101</p>\n<ul>\n<li>100</li>\n<li>101</li>\n</ul>\n<p><strong></strong><em>O(k\\</em>n)*kKn</p>"},{"title":"https","date":"2020-03-14T02:43:29.000Z","_content":"\n**Hypertext Transfer Protocol Secure**, an extension of the Hypertext Transfer Protocol. \n\nHow to encrypt communication? Through referred to as **HTTP over TLS**, or **HTTP over SSL**\n\n- Transport Layer Security\n- Secure Sockets Layer\n\n<!-- more -->\n\n# HTTPHTTPS\n\n## Difference\n\nHTTPSURL`https://``443`httpTCPSSLTSLheader\n\n---\n\nHTTPURL`http://``80`TCP\n\n## \n\nHTTPsHTTPHTTPTCPSSL\n\n************\n\n****HTTPSSLHTTPSHTTPSSLSSLTCPTCPTCPSSLSSL\n\nhttpstcphttps****\n\n- https443\n- ****\n- SSL\n- \n- \n- \n- \n\n****\n\n## TLS VS SSL\n","source":"_posts/https.md","raw":"---\ntitle: https\ndate: 2020-03-14 10:43:29\ncategories: network\ntags: ['http','https']\n---\n\n**Hypertext Transfer Protocol Secure**, an extension of the Hypertext Transfer Protocol. \n\nHow to encrypt communication? Through referred to as **HTTP over TLS**, or **HTTP over SSL**\n\n- Transport Layer Security\n- Secure Sockets Layer\n\n<!-- more -->\n\n# HTTPHTTPS\n\n## Difference\n\nHTTPSURL`https://``443`httpTCPSSLTSLheader\n\n---\n\nHTTPURL`http://``80`TCP\n\n## \n\nHTTPsHTTPHTTPTCPSSL\n\n************\n\n****HTTPSSLHTTPSHTTPSSLSSLTCPTCPTCPSSLSSL\n\nhttpstcphttps****\n\n- https443\n- ****\n- SSL\n- \n- \n- \n- \n\n****\n\n## TLS VS SSL\n","slug":"https","published":1,"updated":"2022-11-24T11:43:50.857Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwh001s8py0bjnjcqxk","content":"<p><strong>Hypertext Transfer Protocol Secure</strong>, an extension of the Hypertext Transfer Protocol. </p>\n<p>How to encrypt communication? Through referred to as <strong>HTTP over TLS</strong>, or <strong>HTTP over SSL</strong></p>\n<ul>\n<li>Transport Layer Security</li>\n<li>Secure Sockets Layer</li>\n</ul>\n<span id=\"more\"></span>\n\n<h1 id=\"HTTPHTTPS\"><a href=\"#HTTPHTTPS\" class=\"headerlink\" title=\"HTTPHTTPS\"></a>HTTPHTTPS</h1><h2 id=\"Difference\"><a href=\"#Difference\" class=\"headerlink\" title=\"Difference\"></a>Difference</h2><p>HTTPSURL<code>https://</code><code>443</code>httpTCPSSLTSLheader</p>\n<hr>\n<p>HTTPURL<code>http://</code><code>80</code>TCP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HTTPsHTTPHTTPTCPSSL</p>\n<p><strong></strong><strong></strong><strong></strong></p>\n<p><strong></strong>HTTPSSLHTTPSHTTPSSLSSLTCPTCPTCPSSLSSL</p>\n<p>httpstcphttps<strong></strong></p>\n<ul>\n<li>https443</li>\n<li><strong></strong></li>\n<li>SSL</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong></strong></p>\n<h2 id=\"TLS-VS-SSL\"><a href=\"#TLS-VS-SSL\" class=\"headerlink\" title=\"TLS VS SSL\"></a>TLS VS SSL</h2>","site":{"data":{}},"excerpt":"<p><strong>Hypertext Transfer Protocol Secure</strong>, an extension of the Hypertext Transfer Protocol. </p>\n<p>How to encrypt communication? Through referred to as <strong>HTTP over TLS</strong>, or <strong>HTTP over SSL</strong></p>\n<ul>\n<li>Transport Layer Security</li>\n<li>Secure Sockets Layer</li>\n</ul>","more":"<h1 id=\"HTTPHTTPS\"><a href=\"#HTTPHTTPS\" class=\"headerlink\" title=\"HTTPHTTPS\"></a>HTTPHTTPS</h1><h2 id=\"Difference\"><a href=\"#Difference\" class=\"headerlink\" title=\"Difference\"></a>Difference</h2><p>HTTPSURL<code>https://</code><code>443</code>httpTCPSSLTSLheader</p>\n<hr>\n<p>HTTPURL<code>http://</code><code>80</code>TCP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HTTPsHTTPHTTPTCPSSL</p>\n<p><strong></strong><strong></strong><strong></strong></p>\n<p><strong></strong>HTTPSSLHTTPSHTTPSSLSSLTCPTCPTCPSSLSSL</p>\n<p>httpstcphttps<strong></strong></p>\n<ul>\n<li>https443</li>\n<li><strong></strong></li>\n<li>SSL</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong></strong></p>\n<h2 id=\"TLS-VS-SSL\"><a href=\"#TLS-VS-SSL\" class=\"headerlink\" title=\"TLS VS SSL\"></a>TLS VS SSL</h2>"},{"title":"java collection framework","date":"2021-03-06T04:03:11.000Z","_content":"\n****\n\n<!-- more-->\n\n<!-- toc -->\n\n# \n\n        jdk--JDKjdkObjectemmmidea\n\n# \n\n        \n\n        `Collection`collectionfor`iterator``collection``iterator`iterator\n\n```java\npublic abstract Iterator<E> iterator();\n\npublic abstract int size();\n\npublic void clear() {\n    Iterator<E> it = iterator();\n    while (it.hasNext()) {\n        it.next();\n        it.remove();\n    }\n}\n\npublic Object[] toArray() {\n    // Estimate size of array; be prepared to see more or fewer elements\n    Object[] r = new Object[size()];\n    Iterator<E> it = iterator();\n    for (int i = 0; i < r.length; i++) {\n        if (! it.hasNext()) // fewer elements than expected\n            return Arrays.copyOf(r, i);\n        r[i] = it.next();\n    }\n    return it.hasNext() ? finishToArray(r, it) : r;\n}\n\npublic boolean add(E e) {\n    throw new UnsupportedOperationException();\n}\n```\n\n`collection`collection`List``Set``Queue``Collection``Collection``Collection``Collection`collectionMap\n\njdk\n\n# \n\n \n","source":"_posts/java-collection-framework.md","raw":"---\ntitle: java collection framework\ndate: 2021-03-06 12:03:11\ncategories: java\ntags: framework\n---\n\n****\n\n<!-- more-->\n\n<!-- toc -->\n\n# \n\n        jdk--JDKjdkObjectemmmidea\n\n# \n\n        \n\n        `Collection`collectionfor`iterator``collection``iterator`iterator\n\n```java\npublic abstract Iterator<E> iterator();\n\npublic abstract int size();\n\npublic void clear() {\n    Iterator<E> it = iterator();\n    while (it.hasNext()) {\n        it.next();\n        it.remove();\n    }\n}\n\npublic Object[] toArray() {\n    // Estimate size of array; be prepared to see more or fewer elements\n    Object[] r = new Object[size()];\n    Iterator<E> it = iterator();\n    for (int i = 0; i < r.length; i++) {\n        if (! it.hasNext()) // fewer elements than expected\n            return Arrays.copyOf(r, i);\n        r[i] = it.next();\n    }\n    return it.hasNext() ? finishToArray(r, it) : r;\n}\n\npublic boolean add(E e) {\n    throw new UnsupportedOperationException();\n}\n```\n\n`collection`collection`List``Set``Queue``Collection``Collection``Collection``Collection`collectionMap\n\njdk\n\n# \n\n \n","slug":"java-collection-framework","published":1,"updated":"2022-12-09T14:49:47.922Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwh001v8py01yzcfljg","content":"<p><strong></strong></p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        jdkJDKjdkObjectemmmidea</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        </p>\n<p>        <code>Collection</code>collectionfor<code>iterator</code><code>collection</code><code>iterator</code>iterator</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> Iterator&lt;E&gt; <span class=\"title\">iterator</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">int</span> <span class=\"title\">size</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">clear</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    Iterator&lt;E&gt; it = iterator();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (it.hasNext()) &#123;</span><br><span class=\"line\">        it.next();</span><br><span class=\"line\">        it.remove();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> Object[] toArray() &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Estimate size of array; be prepared to see more or fewer elements</span></span><br><span class=\"line\">    Object[] r = <span class=\"keyword\">new</span> Object[size()];</span><br><span class=\"line\">    Iterator&lt;E&gt; it = iterator();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; r.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! it.hasNext()) <span class=\"comment\">// fewer elements than expected</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> Arrays.copyOf(r, i);</span><br><span class=\"line\">        r[i] = it.next();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> it.hasNext() ? finishToArray(r, it) : r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">add</span><span class=\"params\">(E e)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> UnsupportedOperationException();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>collection</code>collection<code>List</code><code>Set</code><code>Queue</code><code>Collection</code><code>Collection</code><code>Collection</code><code>Collection</code>collectionMap</p>\n<p>jdk</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> </p>\n","site":{"data":{}},"excerpt":"<p><strong></strong></p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        jdkJDKjdkObjectemmmidea</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        </p>\n<p>        <code>Collection</code>collectionfor<code>iterator</code><code>collection</code><code>iterator</code>iterator</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> Iterator&lt;E&gt; <span class=\"title\">iterator</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">int</span> <span class=\"title\">size</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">clear</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    Iterator&lt;E&gt; it = iterator();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (it.hasNext()) &#123;</span><br><span class=\"line\">        it.next();</span><br><span class=\"line\">        it.remove();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> Object[] toArray() &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Estimate size of array; be prepared to see more or fewer elements</span></span><br><span class=\"line\">    Object[] r = <span class=\"keyword\">new</span> Object[size()];</span><br><span class=\"line\">    Iterator&lt;E&gt; it = iterator();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; r.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! it.hasNext()) <span class=\"comment\">// fewer elements than expected</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> Arrays.copyOf(r, i);</span><br><span class=\"line\">        r[i] = it.next();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> it.hasNext() ? finishToArray(r, it) : r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">add</span><span class=\"params\">(E e)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> UnsupportedOperationException();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>collection</code>collection<code>List</code><code>Set</code><code>Queue</code><code>Collection</code><code>Collection</code><code>Collection</code><code>Collection</code>collectionMap</p>\n<p>jdk</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> </p>"},{"title":"jump games","date":"2021-05-24T04:13:39.000Z","_content":"\n*Jump Games*LeetCode\n\n<!-- more -->\n\n<!-- toc -->\n\n# Jump Game\n\n> 0\n\nid(i+1, i+d)O(n^2)TLE\n\n### dp\n\ninii-1ii-1ii-1dpi-1numsdp\n\n```java\npublic boolean canReach(int[] nums){\n    int len = nums.length, res = 0;\n    int[] dp = new int[len];\n    for(int i=1; i<nums.length; i++){\n        res = Math.max(dp[i-1], nums[i-1]) - 1;\n        if(res < 0) return false;\n    }\n\n    return true;\n}\n```\n\n### greedy\n\ndp\n\n```java\npublic boolean canReach(int[] nums){\n    int len = nums.length, reach = 0;\n    for(int i=0; i<len; i++){\n        if(i > reach || reach >= len - 1) break;\n        reach = Math.max(reach, i + nums[i]);\n    }\n\n    return reach >= len - 1;\n}\n```\n\n# Jump Game II\n\n> 0\n\njumpcurEndcurFarthestcurEndcurEndcurFarthestjumpjump\n\n```java\npublic boolean minJumpTimes(int[] nums){\n    int jumps = 0, curEnd = 0, curFarthest = 0;\n    for(int i=0; i<nums.length-1; i++){\n        curFarthest = Math.max(curFarthest, i + nums[i]);\n        if(i == curEnd){\n            jumps++;\n            curEnd = curFarthest;\n        }\n    }\n\n    return jumps;\n}\n```\n\n# Jump Game III\n\n> starti-starti+start0\n\n\n\n### dfs\n\n\n\n```java\npublic boolean canReach(int][] nums, int start){\n    if(start >= 0 && start < nums.length && nums[start] < nums.length){\n        int jump = nums[start];\n        nums[start] += nums.length; // nums[start]\n        return jump == 0 || canReach(nums, start + jump) || canReach(nums, start - jump);\n    }\n\n    return false;\n}\n```\n\n### bfs\n\n\n\n# JumpGame VII\n\n> minJumpmaxJump01000(i+minJump, i+maxJump)0\n\n0ndpO(n^2) ","source":"_posts/jump-games.md","raw":"---\ntitle: jump games\ndate: 2021-05-24 12:13:39\ncategories: leetcode\ntags: \n- greedy\n- dp\n- stratey\n---\n\n*Jump Games*LeetCode\n\n<!-- more -->\n\n<!-- toc -->\n\n# Jump Game\n\n> 0\n\nid(i+1, i+d)O(n^2)TLE\n\n### dp\n\ninii-1ii-1ii-1dpi-1numsdp\n\n```java\npublic boolean canReach(int[] nums){\n    int len = nums.length, res = 0;\n    int[] dp = new int[len];\n    for(int i=1; i<nums.length; i++){\n        res = Math.max(dp[i-1], nums[i-1]) - 1;\n        if(res < 0) return false;\n    }\n\n    return true;\n}\n```\n\n### greedy\n\ndp\n\n```java\npublic boolean canReach(int[] nums){\n    int len = nums.length, reach = 0;\n    for(int i=0; i<len; i++){\n        if(i > reach || reach >= len - 1) break;\n        reach = Math.max(reach, i + nums[i]);\n    }\n\n    return reach >= len - 1;\n}\n```\n\n# Jump Game II\n\n> 0\n\njumpcurEndcurFarthestcurEndcurEndcurFarthestjumpjump\n\n```java\npublic boolean minJumpTimes(int[] nums){\n    int jumps = 0, curEnd = 0, curFarthest = 0;\n    for(int i=0; i<nums.length-1; i++){\n        curFarthest = Math.max(curFarthest, i + nums[i]);\n        if(i == curEnd){\n            jumps++;\n            curEnd = curFarthest;\n        }\n    }\n\n    return jumps;\n}\n```\n\n# Jump Game III\n\n> starti-starti+start0\n\n\n\n### dfs\n\n\n\n```java\npublic boolean canReach(int][] nums, int start){\n    if(start >= 0 && start < nums.length && nums[start] < nums.length){\n        int jump = nums[start];\n        nums[start] += nums.length; // nums[start]\n        return jump == 0 || canReach(nums, start + jump) || canReach(nums, start - jump);\n    }\n\n    return false;\n}\n```\n\n### bfs\n\n\n\n# JumpGame VII\n\n> minJumpmaxJump01000(i+minJump, i+maxJump)0\n\n0ndpO(n^2) ","slug":"jump-games","published":1,"updated":"2022-12-09T14:49:38.535Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwi001z8py02kfle5tw","content":"<p><em>Jump Games</em>LeetCode</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"Jump-Game\"><a href=\"#Jump-Game\" class=\"headerlink\" title=\"Jump Game\"></a>Jump Game</h1><blockquote>\n<p>0</p>\n</blockquote>\n<p>id(i+1, i+d)O(n^2)TLE</p>\n<h3 id=\"dp\"><a href=\"#dp\" class=\"headerlink\" title=\"dp\"></a>dp</h3><p>inii-1ii-1ii-1dpi-1numsdp</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canReach</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = nums.length, res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] dp = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[len];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;nums.length; i++)&#123;</span><br><span class=\"line\">        res = Math.max(dp[i-<span class=\"number\">1</span>], nums[i-<span class=\"number\">1</span>]) - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(res &lt; <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"greedy\"><a href=\"#greedy\" class=\"headerlink\" title=\"greedy\"></a>greedy</h3><p>dp</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canReach</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = nums.length, reach = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;len; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i &gt; reach || reach &gt;= len - <span class=\"number\">1</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        reach = Math.max(reach, i + nums[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> reach &gt;= len - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Jump-Game-II\"><a href=\"#Jump-Game-II\" class=\"headerlink\" title=\"Jump Game II\"></a>Jump Game II</h1><blockquote>\n<p>0</p>\n</blockquote>\n<p>jumpcurEndcurFarthestcurEndcurEndcurFarthestjumpjump</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">minJumpTimes</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> jumps = <span class=\"number\">0</span>, curEnd = <span class=\"number\">0</span>, curFarthest = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;nums.length-<span class=\"number\">1</span>; i++)&#123;</span><br><span class=\"line\">        curFarthest = Math.max(curFarthest, i + nums[i]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i == curEnd)&#123;</span><br><span class=\"line\">            jumps++;</span><br><span class=\"line\">            curEnd = curFarthest;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> jumps;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Jump-Game-III\"><a href=\"#Jump-Game-III\" class=\"headerlink\" title=\"Jump Game III\"></a>Jump Game III</h1><blockquote>\n<p>starti-starti+start0</p>\n</blockquote>\n<p></p>\n<h3 id=\"dfs\"><a href=\"#dfs\" class=\"headerlink\" title=\"dfs\"></a>dfs</h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canReach</span><span class=\"params\">(<span class=\"keyword\">int</span>][] nums, <span class=\"keyword\">int</span> start)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(start &gt;= <span class=\"number\">0</span> &amp;&amp; start &lt; nums.length &amp;&amp; nums[start] &lt; nums.length)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> jump = nums[start];</span><br><span class=\"line\">        nums[start] += nums.length; <span class=\"comment\">// nums[start]</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> jump == <span class=\"number\">0</span> || canReach(nums, start + jump) || canReach(nums, start - jump);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"bfs\"><a href=\"#bfs\" class=\"headerlink\" title=\"bfs\"></a>bfs</h3><p></p>\n<h1 id=\"JumpGame-VII\"><a href=\"#JumpGame-VII\" class=\"headerlink\" title=\"JumpGame VII\"></a>JumpGame VII</h1><blockquote>\n<p>minJumpmaxJump01000(i+minJump, i+maxJump)0</p>\n</blockquote>\n<p>0ndpO(n^2) </p>\n","site":{"data":{}},"excerpt":"<p><em>Jump Games</em>LeetCode</p>","more":"<!-- toc -->\n\n<h1 id=\"Jump-Game\"><a href=\"#Jump-Game\" class=\"headerlink\" title=\"Jump Game\"></a>Jump Game</h1><blockquote>\n<p>0</p>\n</blockquote>\n<p>id(i+1, i+d)O(n^2)TLE</p>\n<h3 id=\"dp\"><a href=\"#dp\" class=\"headerlink\" title=\"dp\"></a>dp</h3><p>inii-1ii-1ii-1dpi-1numsdp</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canReach</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = nums.length, res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] dp = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[len];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;nums.length; i++)&#123;</span><br><span class=\"line\">        res = Math.max(dp[i-<span class=\"number\">1</span>], nums[i-<span class=\"number\">1</span>]) - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(res &lt; <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"greedy\"><a href=\"#greedy\" class=\"headerlink\" title=\"greedy\"></a>greedy</h3><p>dp</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canReach</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = nums.length, reach = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;len; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i &gt; reach || reach &gt;= len - <span class=\"number\">1</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        reach = Math.max(reach, i + nums[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> reach &gt;= len - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Jump-Game-II\"><a href=\"#Jump-Game-II\" class=\"headerlink\" title=\"Jump Game II\"></a>Jump Game II</h1><blockquote>\n<p>0</p>\n</blockquote>\n<p>jumpcurEndcurFarthestcurEndcurEndcurFarthestjumpjump</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">minJumpTimes</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> jumps = <span class=\"number\">0</span>, curEnd = <span class=\"number\">0</span>, curFarthest = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;nums.length-<span class=\"number\">1</span>; i++)&#123;</span><br><span class=\"line\">        curFarthest = Math.max(curFarthest, i + nums[i]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i == curEnd)&#123;</span><br><span class=\"line\">            jumps++;</span><br><span class=\"line\">            curEnd = curFarthest;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> jumps;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Jump-Game-III\"><a href=\"#Jump-Game-III\" class=\"headerlink\" title=\"Jump Game III\"></a>Jump Game III</h1><blockquote>\n<p>starti-starti+start0</p>\n</blockquote>\n<p></p>\n<h3 id=\"dfs\"><a href=\"#dfs\" class=\"headerlink\" title=\"dfs\"></a>dfs</h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canReach</span><span class=\"params\">(<span class=\"keyword\">int</span>][] nums, <span class=\"keyword\">int</span> start)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(start &gt;= <span class=\"number\">0</span> &amp;&amp; start &lt; nums.length &amp;&amp; nums[start] &lt; nums.length)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> jump = nums[start];</span><br><span class=\"line\">        nums[start] += nums.length; <span class=\"comment\">// nums[start]</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> jump == <span class=\"number\">0</span> || canReach(nums, start + jump) || canReach(nums, start - jump);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"bfs\"><a href=\"#bfs\" class=\"headerlink\" title=\"bfs\"></a>bfs</h3><p></p>\n<h1 id=\"JumpGame-VII\"><a href=\"#JumpGame-VII\" class=\"headerlink\" title=\"JumpGame VII\"></a>JumpGame VII</h1><blockquote>\n<p>minJumpmaxJump01000(i+minJump, i+maxJump)0</p>\n</blockquote>\n<p>0ndpO(n^2) </p>"},{"title":"jvm-GC","date":"2022-11-24T06:11:47.000Z","_content":"\njava\n\n## JVM\n\n> GC\n\nJVMGC\n\nJavaGC**OutOfMemoryError**\n\n**OutOfMemoryError**\n\n## \n\n> *stop the world*\n\n\n\n\n\n\n\n\n\n## \n\n> GC\n\n\n\n- Serial\n\n- ParNew\n\n- Parallel Scavenge\n\n- Serial Old\n\n- Parallel Old\n\n- CMS\n\n- Garbage First\n\n- Shenandoah\n\n- ZGC\n\n- Epsilon\n\n## GC Root\n\nGC\n\nGC RootGC\n\n\n\n\n\n\n\nnative\n\n\n\n## OOM\n\nJVM~~~~\n\n1. dumpjdkjvisualvmdumpOOM *Memory Leak**Memory Overflow*\n   \n   - GC Root\n\n2. JVM\"-Xmx, -Xms\"\n\n3. \n\n### Memory Leak\n\nGCOOM\n","source":"_posts/jvm-GC.md","raw":"---\ntitle: jvm-GC\ndate: 2022-11-24 14:11:47\ncategories: jvm\ntags: GC\n---\n\njava\n\n## JVM\n\n> GC\n\nJVMGC\n\nJavaGC**OutOfMemoryError**\n\n**OutOfMemoryError**\n\n## \n\n> *stop the world*\n\n\n\n\n\n\n\n\n\n## \n\n> GC\n\n\n\n- Serial\n\n- ParNew\n\n- Parallel Scavenge\n\n- Serial Old\n\n- Parallel Old\n\n- CMS\n\n- Garbage First\n\n- Shenandoah\n\n- ZGC\n\n- Epsilon\n\n## GC Root\n\nGC\n\nGC RootGC\n\n\n\n\n\n\n\nnative\n\n\n\n## OOM\n\nJVM~~~~\n\n1. dumpjdkjvisualvmdumpOOM *Memory Leak**Memory Overflow*\n   \n   - GC Root\n\n2. JVM\"-Xmx, -Xms\"\n\n3. \n\n### Memory Leak\n\nGCOOM\n","slug":"jvm-GC","published":1,"updated":"2022-12-09T09:35:45.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwi00218py081lr1k8x","content":"<p>java</p>\n<h2 id=\"JVM\"><a href=\"#JVM\" class=\"headerlink\" title=\"JVM\"></a>JVM</h2><blockquote>\n<p>GC</p>\n</blockquote>\n<p>JVMGC</p>\n<p>JavaGC<strong>OutOfMemoryError</strong></p>\n<p><strong>OutOfMemoryError</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p><em>stop the world</em></p>\n</blockquote>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p>GC</p>\n</blockquote>\n<p></p>\n<ul>\n<li><p>Serial</p>\n</li>\n<li><p>ParNew</p>\n</li>\n<li><p>Parallel Scavenge</p>\n</li>\n<li><p>Serial Old</p>\n</li>\n<li><p>Parallel Old</p>\n</li>\n<li><p>CMS</p>\n</li>\n<li><p>Garbage First</p>\n</li>\n<li><p>Shenandoah</p>\n</li>\n<li><p>ZGC</p>\n</li>\n<li><p>Epsilon</p>\n</li>\n</ul>\n<h2 id=\"GC-Root\"><a href=\"#GC-Root\" class=\"headerlink\" title=\"GC Root\"></a>GC Root</h2><p>GC</p>\n<p>GC RootGC</p>\n<p></p>\n<p></p>\n<p></p>\n<p>native</p>\n<p></p>\n<h2 id=\"OOM\"><a href=\"#OOM\" class=\"headerlink\" title=\"OOM\"></a>OOM</h2><p>JVM<del></del></p>\n<ol>\n<li><p>dumpjdkjvisualvmdumpOOM <em>Memory Leak</em><em>Memory Overflow</em></p>\n<ul>\n<li>GC Root</li>\n</ul>\n</li>\n<li><p>JVM-Xmx, -Xms</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h3 id=\"Memory-Leak\"><a href=\"#Memory-Leak\" class=\"headerlink\" title=\"Memory Leak\"></a>Memory Leak</h3><p>GCOOM</p>\n","site":{"data":{}},"excerpt":"","more":"<p>java</p>\n<h2 id=\"JVM\"><a href=\"#JVM\" class=\"headerlink\" title=\"JVM\"></a>JVM</h2><blockquote>\n<p>GC</p>\n</blockquote>\n<p>JVMGC</p>\n<p>JavaGC<strong>OutOfMemoryError</strong></p>\n<p><strong>OutOfMemoryError</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p><em>stop the world</em></p>\n</blockquote>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote>\n<p>GC</p>\n</blockquote>\n<p></p>\n<ul>\n<li><p>Serial</p>\n</li>\n<li><p>ParNew</p>\n</li>\n<li><p>Parallel Scavenge</p>\n</li>\n<li><p>Serial Old</p>\n</li>\n<li><p>Parallel Old</p>\n</li>\n<li><p>CMS</p>\n</li>\n<li><p>Garbage First</p>\n</li>\n<li><p>Shenandoah</p>\n</li>\n<li><p>ZGC</p>\n</li>\n<li><p>Epsilon</p>\n</li>\n</ul>\n<h2 id=\"GC-Root\"><a href=\"#GC-Root\" class=\"headerlink\" title=\"GC Root\"></a>GC Root</h2><p>GC</p>\n<p>GC RootGC</p>\n<p></p>\n<p></p>\n<p></p>\n<p>native</p>\n<p></p>\n<h2 id=\"OOM\"><a href=\"#OOM\" class=\"headerlink\" title=\"OOM\"></a>OOM</h2><p>JVM<del></del></p>\n<ol>\n<li><p>dumpjdkjvisualvmdumpOOM <em>Memory Leak</em><em>Memory Overflow</em></p>\n<ul>\n<li>GC Root</li>\n</ul>\n</li>\n<li><p>JVM-Xmx, -Xms</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h3 id=\"Memory-Leak\"><a href=\"#Memory-Leak\" class=\"headerlink\" title=\"Memory Leak\"></a>Memory Leak</h3><p>GCOOM</p>\n"},{"title":"jvm classloader","date":"2021-03-23T15:32:02.000Z","_content":"\njava\n\n<!-- more -->\n\n<!-- toc -->\n\n# class\n\nclass\n\n# classLoader\n\n# ","source":"_posts/jvm-classloader.md","raw":"---\ntitle: jvm classloader\ndate: 2021-03-23 23:32:02\ncategories: jvm\ntags: classloader\n---\n\njava\n\n<!-- more -->\n\n<!-- toc -->\n\n# class\n\nclass\n\n# classLoader\n\n# ","slug":"jvm-classloader","published":1,"updated":"2022-12-09T14:49:24.283Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwi00258py0865v1mjj","content":"<p>java</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"class\"><a href=\"#class\" class=\"headerlink\" title=\"class\"></a>class</h1><p>class</p>\n<h1 id=\"classLoader\"><a href=\"#classLoader\" class=\"headerlink\" title=\"classLoader\"></a>classLoader</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>","site":{"data":{}},"excerpt":"<p>java</p>","more":"<!-- toc -->\n\n<h1 id=\"class\"><a href=\"#class\" class=\"headerlink\" title=\"class\"></a>class</h1><p>class</p>\n<h1 id=\"classLoader\"><a href=\"#classLoader\" class=\"headerlink\" title=\"classLoader\"></a>classLoader</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>"},{"title":"junit5","date":"2022-12-20T08:33:48.000Z","_content":"\nJunit5[](https://junit.org/junit5/docs/current/user-guide/)\n\n<!-- more -->\n\n## \n\n- \n- SpringDB\nJUnit5SpockMockJacoco\n\n## \n\n\n## \n\n- \n- \n- TDD\n- \n\nmockMockitoAPImock\n## JUnit5\nJUnit5\n\n### @DisplayName\n*at_5_floor_to_up_and_down_3_floor*\n\n### @ParameterizedTest\n\n```java\n@ParameterizedTest\n@ValueSource(ints = {1, 3, 10, 23})\n@DisplayName(\"\")\nvoid invoke(int count) {\n    // given\n    PickOneService pickOneService = new PickOneService();\n    // when\n    CommonResult<List<WordDetail>> invoke = pickOneService.invoke(count);\n    // then\n    List<WordDetail> data = invoke.getData();\n    assertEquals(count, data.size());\n}\n```\n`@ValueSource``count``@MethodSource`\n```java\n@ParameterizedTest\n@MethodSource(\"stringProvider\")\nvoid testWithExplicitLocalMethodSource(String argument) {\n    assertNotNull(argument);\n}\n\nstatic Stream<String> stringProvider() {\n    return Stream.of(\"apple\", \"banana\");\n}\n```\n\n## \n","source":"_posts/junit5.md","raw":"---\ntitle: junit5\ndate: 2022-12-20 16:33:48\ncategories: unit_test\ntags: junit5\n---\n\nJunit5[](https://junit.org/junit5/docs/current/user-guide/)\n\n<!-- more -->\n\n## \n\n- \n- SpringDB\nJUnit5SpockMockJacoco\n\n## \n\n\n## \n\n- \n- \n- TDD\n- \n\nmockMockitoAPImock\n## JUnit5\nJUnit5\n\n### @DisplayName\n*at_5_floor_to_up_and_down_3_floor*\n\n### @ParameterizedTest\n\n```java\n@ParameterizedTest\n@ValueSource(ints = {1, 3, 10, 23})\n@DisplayName(\"\")\nvoid invoke(int count) {\n    // given\n    PickOneService pickOneService = new PickOneService();\n    // when\n    CommonResult<List<WordDetail>> invoke = pickOneService.invoke(count);\n    // then\n    List<WordDetail> data = invoke.getData();\n    assertEquals(count, data.size());\n}\n```\n`@ValueSource``count``@MethodSource`\n```java\n@ParameterizedTest\n@MethodSource(\"stringProvider\")\nvoid testWithExplicitLocalMethodSource(String argument) {\n    assertNotNull(argument);\n}\n\nstatic Stream<String> stringProvider() {\n    return Stream.of(\"apple\", \"banana\");\n}\n```\n\n## \n","slug":"junit5","published":1,"updated":"2022-12-20T11:28:30.234Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwi00288py0hzj1bfgk","content":"<p>Junit5<a class=\"link\"   href=\"https://junit.org/junit5/docs/current/user-guide/\" ><i class=\"fas fa-external-link-alt\"></i></a></p>\n<span id=\"more\"></span>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li></li>\n<li>SpringDB<br>JUnit5SpockMockJacoco</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li></li>\n<li></li>\n<li>TDD</li>\n<li><br><br>mockMockitoAPImock<h2 id=\"JUnit5\"><a href=\"#JUnit5\" class=\"headerlink\" title=\"JUnit5\"></a>JUnit5</h2>JUnit5</li>\n</ul>\n<h3 id=\"DisplayName\"><a href=\"#DisplayName\" class=\"headerlink\" title=\"@DisplayName\"></a>@DisplayName</h3><p><em>at_5_floor_to_up_and_down_3_floor</em></p>\n<h3 id=\"ParameterizedTest\"><a href=\"#ParameterizedTest\" class=\"headerlink\" title=\"@ParameterizedTest\"></a>@ParameterizedTest</h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ParameterizedTest</span></span><br><span class=\"line\"><span class=\"meta\">@ValueSource(ints = &#123;1, 3, 10, 23&#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@DisplayName(&quot;&quot;)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">invoke</span><span class=\"params\">(<span class=\"keyword\">int</span> count)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// given</span></span><br><span class=\"line\">    PickOneService pickOneService = <span class=\"keyword\">new</span> PickOneService();</span><br><span class=\"line\">    <span class=\"comment\">// when</span></span><br><span class=\"line\">    CommonResult&lt;List&lt;WordDetail&gt;&gt; invoke = pickOneService.invoke(count);</span><br><span class=\"line\">    <span class=\"comment\">// then</span></span><br><span class=\"line\">    List&lt;WordDetail&gt; data = invoke.getData();</span><br><span class=\"line\">    assertEquals(count, data.size());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>@ValueSource</code><code>count</code><code>@MethodSource</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ParameterizedTest</span></span><br><span class=\"line\"><span class=\"meta\">@MethodSource(&quot;stringProvider&quot;)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">testWithExplicitLocalMethodSource</span><span class=\"params\">(String argument)</span> </span>&#123;</span><br><span class=\"line\">    assertNotNull(argument);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> Stream&lt;String&gt; <span class=\"title\">stringProvider</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Stream.of(<span class=\"string\">&quot;apple&quot;</span>, <span class=\"string\">&quot;banana&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n","site":{"data":{}},"excerpt":"<p>Junit5<a class=\"link\"   href=\"https://junit.org/junit5/docs/current/user-guide/\" ><i class=\"fas fa-external-link-alt\"></i></a></p>","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li></li>\n<li>SpringDB<br>JUnit5SpockMockJacoco</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li></li>\n<li></li>\n<li>TDD</li>\n<li><br><br>mockMockitoAPImock<h2 id=\"JUnit5\"><a href=\"#JUnit5\" class=\"headerlink\" title=\"JUnit5\"></a>JUnit5</h2>JUnit5</li>\n</ul>\n<h3 id=\"DisplayName\"><a href=\"#DisplayName\" class=\"headerlink\" title=\"@DisplayName\"></a>@DisplayName</h3><p><em>at_5_floor_to_up_and_down_3_floor</em></p>\n<h3 id=\"ParameterizedTest\"><a href=\"#ParameterizedTest\" class=\"headerlink\" title=\"@ParameterizedTest\"></a>@ParameterizedTest</h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ParameterizedTest</span></span><br><span class=\"line\"><span class=\"meta\">@ValueSource(ints = &#123;1, 3, 10, 23&#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@DisplayName(&quot;&quot;)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">invoke</span><span class=\"params\">(<span class=\"keyword\">int</span> count)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// given</span></span><br><span class=\"line\">    PickOneService pickOneService = <span class=\"keyword\">new</span> PickOneService();</span><br><span class=\"line\">    <span class=\"comment\">// when</span></span><br><span class=\"line\">    CommonResult&lt;List&lt;WordDetail&gt;&gt; invoke = pickOneService.invoke(count);</span><br><span class=\"line\">    <span class=\"comment\">// then</span></span><br><span class=\"line\">    List&lt;WordDetail&gt; data = invoke.getData();</span><br><span class=\"line\">    assertEquals(count, data.size());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>@ValueSource</code><code>count</code><code>@MethodSource</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ParameterizedTest</span></span><br><span class=\"line\"><span class=\"meta\">@MethodSource(&quot;stringProvider&quot;)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">testWithExplicitLocalMethodSource</span><span class=\"params\">(String argument)</span> </span>&#123;</span><br><span class=\"line\">    assertNotNull(argument);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> Stream&lt;String&gt; <span class=\"title\">stringProvider</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Stream.of(<span class=\"string\">&quot;apple&quot;</span>, <span class=\"string\">&quot;banana&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>"},{"title":"jvm memory-manage","date":"2021-03-23T15:38:15.000Z","_content":"\njvmoomjavajavajvmC++\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\njvmjvm****jvm\n\n        java**new**InitializeSpring**new**classjvm\n\n        jvmnewnew****2newstar\n\n## \n\n\n\n*Mark Word***GC\n\n********java\n\n> reference ->  ->\n\nreferencejavareferencereference\n\n# \n\n\n\n\n\n**Bump the Pointer****Free List****CAS+****Thread Local Allocation Buffer, TLAB**\n\n# \n\n        javajavajavajvmjvmG1\n\n\n\n\n\nG1","source":"_posts/jvm-memory-manage.md","raw":"---\ntitle: jvm memory-manage\ndate: 2021-03-23 23:38:15\ncategories: jvm\ntags: memory\n---\n\njvmoomjavajavajvmC++\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\njvmjvm****jvm\n\n        java**new**InitializeSpring**new**classjvm\n\n        jvmnewnew****2newstar\n\n## \n\n\n\n*Mark Word***GC\n\n********java\n\n> reference ->  ->\n\nreferencejavareferencereference\n\n# \n\n\n\n\n\n**Bump the Pointer****Free List****CAS+****Thread Local Allocation Buffer, TLAB**\n\n# \n\n        javajavajavajvmjvmG1\n\n\n\n\n\nG1","slug":"jvm-memory-manage","published":1,"updated":"2022-11-24T11:42:41.913Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwj002b8py05uaq47o9","content":"<p>jvmoomjavajavajvmC++</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jvmjvm<strong></strong>jvm</p>\n<p>        java<strong>new</strong>InitializeSpring<strong>new</strong>classjvm</p>\n<p>        jvmnewnew<strong></strong>2newstar</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p><em>Mark Word</em><em></em>GC</p>\n<p><strong></strong><strong></strong>java</p>\n<blockquote>\n<p>reference -&gt;  -&gt;</p>\n</blockquote>\n<p>referencejavareferencereference</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p><strong>Bump the Pointer</strong><strong>Free List</strong><strong>CAS+</strong><strong>Thread Local Allocation Buffer, TLAB</strong></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        javajavajavajvmjvmG1</p>\n<p></p>\n<p></p>\n<p>G1</p>\n","site":{"data":{}},"excerpt":"<p>jvmoomjavajavajvmC++</p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jvmjvm<strong></strong>jvm</p>\n<p>        java<strong>new</strong>InitializeSpring<strong>new</strong>classjvm</p>\n<p>        jvmnewnew<strong></strong>2newstar</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p><em>Mark Word</em><em></em>GC</p>\n<p><strong></strong><strong></strong>java</p>\n<blockquote>\n<p>reference -&gt;  -&gt;</p>\n</blockquote>\n<p>referencejavareferencereference</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p><strong>Bump the Pointer</strong><strong>Free List</strong><strong>CAS+</strong><strong>Thread Local Allocation Buffer, TLAB</strong></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        javajavajavajvmjvmG1</p>\n<p></p>\n<p></p>\n<p>G1</p>"},{"title":"jvm","date":"2020-05-24T09:39:25.000Z","_content":"\nassociate with juc\n\n<!--more-->\n\n<!--toc-->\n\n# \n\n![Screenshot from 2020-06-04 20-11-48.png](https://i.loli.net/2020/06/04/UQfq2lrGu9mLc4C.png)\n\n- \n- \n\n# \n\njavacxxx.classJVMxxx.ClassclassClass\n\n> Car.class -> Class Loader -> Car Class -> car1/car2/car3\n\nCar Classcar1car2car3car\n\n![Screenshot from 2020-06-04 20-33-54.png](https://i.loli.net/2020/06/04/EYRbMN1fgIOuHBk.png)\n\n## \n\n### Bootstrap\n\nC++Object, ArrayList, String\n\n### Extension\n\nJavaExtensionjavaxjava\n\n### AppClassLoader\n\n\n\n### \n\nClassLoader\n\n## \n\nA.javaBootstrapExtensionApplication\n\n**Bootstrap** --> **Extension** --> **Application**\n\n```java\npublic class String{\n    public static void main(String[] args){\n        System.out.println(\"hello world!\");\n    }\n}\n```\n\n> java.lang.StringmainBootstrap\n\n## \n\n**note**: jdkObject\n\n## Native Interface\n\nJavaC/C++nativejava\n\nSocketwebService\n\n### Native\n\nC\n\n### \n\nnativenativenativeExecution Engine\n\n# PC\n\n\n\n\n\n# \n\n- \n- ====/\n\n**Java**\n\n## \n\njava\n\n- Local Variables: \n  \n  ```java\n  //  x, y resultresult\n  public int add(int x, int y){\n      int result = 0;\n      result = x + y;\n      return result;\n  }\n  ```\n\n- Operand Stack: \n\n- Frame Data: \n\n## \n\nStack FrameMethodA\n\n```java\n//  Exception: StackOverflowError \npublic static void m1(){\n    m1();\n}\n```\n\nJVM256K756K\n\n\n\n# \n\nclassClassLoaderJVMClass`(PermGen space)``(Metaspace)`\n\n- ====\n- \n\n****\n\n```java\npublic class Car{\n    int price = 1233435;\n    public park(){\n        System.out.println(\"stop ...\");\n    }\n}\n```\n\n\n\njvmjava8****native memoryjavaMaxPermSize\n\ni.e.\n\n```java\npublic class Demo{\n    public void hello(){}\n    public static void main(String[] args){\n        Demo demo = new Demo();\n        demo.hello();\n    }\n}\n```\n\nnewhellodemo\n\n# \n\n```java\nPerson person1 = new Person();\nPerson person2 = new Person();\n```\n\nnew\n\nperson1person2\n\nhotsoptjavaClass -->-->\n\n# \n\nJava7    Jvm\n\n(Java8)    \n\n+\n\n## \n\n++\n\n Youg Generation Space (Eden Sapce + Survivor 0 space + Survivor 1 space)\n\nTenure Generation Space\n\nPermanent Space\n\n- Eden: 0space: 1space  = 8 : 1 : 1\n- Young : Old = 1 : 2\n\n## \n\nEden Sapce,GCSurvivior 0 spaceEden SpaceSurvivor 0 spaceGCSurvivor 1 spaceTenure Genreration SpaceFull GCOutOfMemoryError(OOM)\n\n## \n\nSurvivor 0 space: from\n\nSurrivor 1 space: to\n\nGCto\n\n1. Eden, SurvivorFrom copy to SurviviorTo\n2. clean up Eden, SurvivorFrom\n3. Swap SurvivorTo and SurvivorFrom\n\n## \n\njdkClassInterfaceJVM\n\n## \n\n```java\npublic static void main(String[] args){\n    // Returns the maximum amount of memory that the Java virtual machine will attempt to use.\n    long l = Runtime.getRuntime().maxMemory();\n\n    // Returns the total amount of memory in the Java virtual machine.\n    long l1 = Runtime.getRuntime().totalMemory();\n\n    // 1/4\n    System.out.println(\"(-xmx) MAX_MEMORY: \" + l + \"bytes, \" + (l / (double) 1024 / 1024 + \"MB\"));\n\n    // 1/64\n    System.out.println(\"(-xms) TOTAL_MEMORY: \" + l1 + \"bytes, \" + (l1 / (double) 1024 / 1024 + \"MB\"));\n}\n```\n\n**note:** \n\n> -XX:MaxTenuringThreshold java815\n\n# GC\n\n- minor GC\n- major/full GC\n\nmajor GCminor GCyoungold\n\n## \n\n\n\n### \n\n1,0JVM\n\n### Copying\n\nMinor GCCopying\n\n\n\n### Mark-Sweep\n\nMajor GCMark-SweepMark-Compact--CopyingJVM\n\n### Mark-Compact\n\nMark-Sweep-Compact\n\nGC\n\n# JMM\n\nJavaJava Memory  Model)****\n\n``java\n\n\n\n## violatile\n\njavasyncronized\n\n- \n- \n- \n\n# \n\njvmjavajava*native**class*jvmjvmjavajmmjmmjvm\n","source":"_posts/jvm.md","raw":"---\ntitle: jvm\ndate: 2020-05-24 17:39:25\ncategories: jvm\ntags: summary\n---\n\nassociate with juc\n\n<!--more-->\n\n<!--toc-->\n\n# \n\n![Screenshot from 2020-06-04 20-11-48.png](https://i.loli.net/2020/06/04/UQfq2lrGu9mLc4C.png)\n\n- \n- \n\n# \n\njavacxxx.classJVMxxx.ClassclassClass\n\n> Car.class -> Class Loader -> Car Class -> car1/car2/car3\n\nCar Classcar1car2car3car\n\n![Screenshot from 2020-06-04 20-33-54.png](https://i.loli.net/2020/06/04/EYRbMN1fgIOuHBk.png)\n\n## \n\n### Bootstrap\n\nC++Object, ArrayList, String\n\n### Extension\n\nJavaExtensionjavaxjava\n\n### AppClassLoader\n\n\n\n### \n\nClassLoader\n\n## \n\nA.javaBootstrapExtensionApplication\n\n**Bootstrap** --> **Extension** --> **Application**\n\n```java\npublic class String{\n    public static void main(String[] args){\n        System.out.println(\"hello world!\");\n    }\n}\n```\n\n> java.lang.StringmainBootstrap\n\n## \n\n**note**: jdkObject\n\n## Native Interface\n\nJavaC/C++nativejava\n\nSocketwebService\n\n### Native\n\nC\n\n### \n\nnativenativenativeExecution Engine\n\n# PC\n\n\n\n\n\n# \n\n- \n- ====/\n\n**Java**\n\n## \n\njava\n\n- Local Variables: \n  \n  ```java\n  //  x, y resultresult\n  public int add(int x, int y){\n      int result = 0;\n      result = x + y;\n      return result;\n  }\n  ```\n\n- Operand Stack: \n\n- Frame Data: \n\n## \n\nStack FrameMethodA\n\n```java\n//  Exception: StackOverflowError \npublic static void m1(){\n    m1();\n}\n```\n\nJVM256K756K\n\n\n\n# \n\nclassClassLoaderJVMClass`(PermGen space)``(Metaspace)`\n\n- ====\n- \n\n****\n\n```java\npublic class Car{\n    int price = 1233435;\n    public park(){\n        System.out.println(\"stop ...\");\n    }\n}\n```\n\n\n\njvmjava8****native memoryjavaMaxPermSize\n\ni.e.\n\n```java\npublic class Demo{\n    public void hello(){}\n    public static void main(String[] args){\n        Demo demo = new Demo();\n        demo.hello();\n    }\n}\n```\n\nnewhellodemo\n\n# \n\n```java\nPerson person1 = new Person();\nPerson person2 = new Person();\n```\n\nnew\n\nperson1person2\n\nhotsoptjavaClass -->-->\n\n# \n\nJava7    Jvm\n\n(Java8)    \n\n+\n\n## \n\n++\n\n Youg Generation Space (Eden Sapce + Survivor 0 space + Survivor 1 space)\n\nTenure Generation Space\n\nPermanent Space\n\n- Eden: 0space: 1space  = 8 : 1 : 1\n- Young : Old = 1 : 2\n\n## \n\nEden Sapce,GCSurvivior 0 spaceEden SpaceSurvivor 0 spaceGCSurvivor 1 spaceTenure Genreration SpaceFull GCOutOfMemoryError(OOM)\n\n## \n\nSurvivor 0 space: from\n\nSurrivor 1 space: to\n\nGCto\n\n1. Eden, SurvivorFrom copy to SurviviorTo\n2. clean up Eden, SurvivorFrom\n3. Swap SurvivorTo and SurvivorFrom\n\n## \n\njdkClassInterfaceJVM\n\n## \n\n```java\npublic static void main(String[] args){\n    // Returns the maximum amount of memory that the Java virtual machine will attempt to use.\n    long l = Runtime.getRuntime().maxMemory();\n\n    // Returns the total amount of memory in the Java virtual machine.\n    long l1 = Runtime.getRuntime().totalMemory();\n\n    // 1/4\n    System.out.println(\"(-xmx) MAX_MEMORY: \" + l + \"bytes, \" + (l / (double) 1024 / 1024 + \"MB\"));\n\n    // 1/64\n    System.out.println(\"(-xms) TOTAL_MEMORY: \" + l1 + \"bytes, \" + (l1 / (double) 1024 / 1024 + \"MB\"));\n}\n```\n\n**note:** \n\n> -XX:MaxTenuringThreshold java815\n\n# GC\n\n- minor GC\n- major/full GC\n\nmajor GCminor GCyoungold\n\n## \n\n\n\n### \n\n1,0JVM\n\n### Copying\n\nMinor GCCopying\n\n\n\n### Mark-Sweep\n\nMajor GCMark-SweepMark-Compact--CopyingJVM\n\n### Mark-Compact\n\nMark-Sweep-Compact\n\nGC\n\n# JMM\n\nJavaJava Memory  Model)****\n\n``java\n\n\n\n## violatile\n\njavasyncronized\n\n- \n- \n- \n\n# \n\njvmjavajava*native**class*jvmjvmjavajmmjmmjvm\n","slug":"jvm","published":1,"updated":"2022-11-24T11:42:38.022Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwj002f8py0d7cla3km","content":"<p>associate with juc</p>\n<span id=\"more\"></span>\n\n<!--toc-->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/06/04/UQfq2lrGu9mLc4C.png\" alt=\"Screenshot from 2020-06-04 20-11-48.png\"></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>javacxxx.classJVMxxx.ClassclassClass</p>\n<blockquote>\n<p>Car.class -&gt; Class Loader -&gt; Car Class -&gt; car1/car2/car3</p>\n</blockquote>\n<p>Car Classcar1car2car3car</p>\n<p><img src=\"https://i.loli.net/2020/06/04/EYRbMN1fgIOuHBk.png\" alt=\"Screenshot from 2020-06-04 20-33-54.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Bootstrap\"><a href=\"#Bootstrap\" class=\"headerlink\" title=\"Bootstrap\"></a>Bootstrap</h3><p>C++Object, ArrayList, String</p>\n<h3 id=\"Extension\"><a href=\"#Extension\" class=\"headerlink\" title=\"Extension\"></a>Extension</h3><p>JavaExtensionjavaxjava</p>\n<h3 id=\"AppClassLoader\"><a href=\"#AppClassLoader\" class=\"headerlink\" title=\"AppClassLoader\"></a>AppClassLoader</h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ClassLoader</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>A.javaBootstrapExtensionApplication</p>\n<p><strong>Bootstrap</strong> &gt; <strong>Extension</strong> &gt; <strong>Application</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">String</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;hello world!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>java.lang.StringmainBootstrap</p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>note</strong>: jdkObject</p>\n<h2 id=\"Native-Interface\"><a href=\"#Native-Interface\" class=\"headerlink\" title=\"Native Interface\"></a>Native Interface</h2><p>JavaC/C++nativejava</p>\n<p>SocketwebService</p>\n<h3 id=\"Native\"><a href=\"#Native\" class=\"headerlink\" title=\"Native\"></a>Native</h3><p>C</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nativenativenativeExecution Engine</p>\n<h1 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC\"></a>PC</h1><p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li>====/</li>\n</ul>\n<p><strong>Java</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>java</p>\n<ul>\n<li><p>Local Variables: </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  x, y resultresult</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> result = <span class=\"number\">0</span>;</span><br><span class=\"line\">    result = x + y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Operand Stack: </p>\n</li>\n<li><p>Frame Data: </p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Stack FrameMethodA</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Exception: StackOverflowError </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">m1</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    m1();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JVM256K756K</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>classClassLoaderJVMClass<code>(PermGen space)</code><code>(Metaspace)</code></p>\n<ul>\n<li>====</li>\n<li></li>\n</ul>\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> price = <span class=\"number\">1233435</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">park</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;stop ...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>jvmjava8<strong></strong>native memoryjavaMaxPermSize</p>\n<p>i.e.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Demo</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">hello</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Demo demo = <span class=\"keyword\">new</span> Demo();</span><br><span class=\"line\">        demo.hello();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>newhellodemo</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Person person1 = <span class=\"keyword\">new</span> Person();</span><br><span class=\"line\">Person person2 = <span class=\"keyword\">new</span> Person();</span><br></pre></td></tr></table></figure>\n\n<p>new</p>\n<p>person1person2</p>\n<p>hotsoptjavaClass &gt;&gt;</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Java7    Jvm</p>\n<p>(Java8)    </p>\n<p>+</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>++</p>\n<p> Youg Generation Space (Eden Sapce + Survivor 0 space + Survivor 1 space)</p>\n<p>Tenure Generation Space</p>\n<p>Permanent Space</p>\n<ul>\n<li>Eden: 0space: 1space  = 8 : 1 : 1</li>\n<li>Young : Old = 1 : 2</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Eden Sapce,GCSurvivior 0 spaceEden SpaceSurvivor 0 spaceGCSurvivor 1 spaceTenure Genreration SpaceFull GCOutOfMemoryError(OOM)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Survivor 0 space: from</p>\n<p>Surrivor 1 space: to</p>\n<p>GCto</p>\n<ol>\n<li>Eden, SurvivorFrom copy to SurviviorTo</li>\n<li>clean up Eden, SurvivorFrom</li>\n<li>Swap SurvivorTo and SurvivorFrom</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>jdkClassInterfaceJVM</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Returns the maximum amount of memory that the Java virtual machine will attempt to use.</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span> l = Runtime.getRuntime().maxMemory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Returns the total amount of memory in the Java virtual machine.</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span> l1 = Runtime.getRuntime().totalMemory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1/4</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;(-xmx) MAX_MEMORY: &quot;</span> + l + <span class=\"string\">&quot;bytes, &quot;</span> + (l / (<span class=\"keyword\">double</span>) <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;MB&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1/64</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;(-xms) TOTAL_MEMORY: &quot;</span> + l1 + <span class=\"string\">&quot;bytes, &quot;</span> + (l1 / (<span class=\"keyword\">double</span>) <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;MB&quot;</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>note:</strong> </p>\n<blockquote>\n<p>-XX:MaxTenuringThreshold java815</p>\n</blockquote>\n<h1 id=\"GC\"><a href=\"#GC\" class=\"headerlink\" title=\"GC\"></a>GC</h1><ul>\n<li>minor GC</li>\n<li>major/full GC</li>\n</ul>\n<p>major GCminor GCyoungold</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1,0JVM</p>\n<h3 id=\"Copying\"><a href=\"#Copying\" class=\"headerlink\" title=\"Copying\"></a>Copying</h3><p>Minor GCCopying</p>\n<p></p>\n<h3 id=\"Mark-Sweep\"><a href=\"#Mark-Sweep\" class=\"headerlink\" title=\"Mark-Sweep\"></a>Mark-Sweep</h3><p>Major GCMark-SweepMark-Compact--CopyingJVM</p>\n<h3 id=\"Mark-Compact\"><a href=\"#Mark-Compact\" class=\"headerlink\" title=\"Mark-Compact\"></a>Mark-Compact</h3><p>Mark-Sweep-Compact</p>\n<p>GC</p>\n<h1 id=\"JMM\"><a href=\"#JMM\" class=\"headerlink\" title=\"JMM\"></a>JMM</h1><p>JavaJava Memory  Model)<strong></strong></p>\n<p><code></code>java</p>\n<p></p>\n<h2 id=\"violatile\"><a href=\"#violatile\" class=\"headerlink\" title=\"violatile\"></a>violatile</h2><p>javasyncronized</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jvmjavajava<em>native</em><em>class</em>jvmjvmjavajmmjmmjvm</p>\n","site":{"data":{}},"excerpt":"<p>associate with juc</p>","more":"<!--toc-->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/06/04/UQfq2lrGu9mLc4C.png\" alt=\"Screenshot from 2020-06-04 20-11-48.png\"></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>javacxxx.classJVMxxx.ClassclassClass</p>\n<blockquote>\n<p>Car.class -&gt; Class Loader -&gt; Car Class -&gt; car1/car2/car3</p>\n</blockquote>\n<p>Car Classcar1car2car3car</p>\n<p><img src=\"https://i.loli.net/2020/06/04/EYRbMN1fgIOuHBk.png\" alt=\"Screenshot from 2020-06-04 20-33-54.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Bootstrap\"><a href=\"#Bootstrap\" class=\"headerlink\" title=\"Bootstrap\"></a>Bootstrap</h3><p>C++Object, ArrayList, String</p>\n<h3 id=\"Extension\"><a href=\"#Extension\" class=\"headerlink\" title=\"Extension\"></a>Extension</h3><p>JavaExtensionjavaxjava</p>\n<h3 id=\"AppClassLoader\"><a href=\"#AppClassLoader\" class=\"headerlink\" title=\"AppClassLoader\"></a>AppClassLoader</h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ClassLoader</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>A.javaBootstrapExtensionApplication</p>\n<p><strong>Bootstrap</strong> &gt; <strong>Extension</strong> &gt; <strong>Application</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">String</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;hello world!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>java.lang.StringmainBootstrap</p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>note</strong>: jdkObject</p>\n<h2 id=\"Native-Interface\"><a href=\"#Native-Interface\" class=\"headerlink\" title=\"Native Interface\"></a>Native Interface</h2><p>JavaC/C++nativejava</p>\n<p>SocketwebService</p>\n<h3 id=\"Native\"><a href=\"#Native\" class=\"headerlink\" title=\"Native\"></a>Native</h3><p>C</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nativenativenativeExecution Engine</p>\n<h1 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC\"></a>PC</h1><p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li>====/</li>\n</ul>\n<p><strong>Java</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>java</p>\n<ul>\n<li><p>Local Variables: </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  x, y resultresult</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> result = <span class=\"number\">0</span>;</span><br><span class=\"line\">    result = x + y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Operand Stack: </p>\n</li>\n<li><p>Frame Data: </p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Stack FrameMethodA</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Exception: StackOverflowError </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">m1</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    m1();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JVM256K756K</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>classClassLoaderJVMClass<code>(PermGen space)</code><code>(Metaspace)</code></p>\n<ul>\n<li>====</li>\n<li></li>\n</ul>\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> price = <span class=\"number\">1233435</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">park</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;stop ...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>jvmjava8<strong></strong>native memoryjavaMaxPermSize</p>\n<p>i.e.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Demo</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">hello</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Demo demo = <span class=\"keyword\">new</span> Demo();</span><br><span class=\"line\">        demo.hello();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>newhellodemo</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Person person1 = <span class=\"keyword\">new</span> Person();</span><br><span class=\"line\">Person person2 = <span class=\"keyword\">new</span> Person();</span><br></pre></td></tr></table></figure>\n\n<p>new</p>\n<p>person1person2</p>\n<p>hotsoptjavaClass &gt;&gt;</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Java7    Jvm</p>\n<p>(Java8)    </p>\n<p>+</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>++</p>\n<p> Youg Generation Space (Eden Sapce + Survivor 0 space + Survivor 1 space)</p>\n<p>Tenure Generation Space</p>\n<p>Permanent Space</p>\n<ul>\n<li>Eden: 0space: 1space  = 8 : 1 : 1</li>\n<li>Young : Old = 1 : 2</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Eden Sapce,GCSurvivior 0 spaceEden SpaceSurvivor 0 spaceGCSurvivor 1 spaceTenure Genreration SpaceFull GCOutOfMemoryError(OOM)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Survivor 0 space: from</p>\n<p>Surrivor 1 space: to</p>\n<p>GCto</p>\n<ol>\n<li>Eden, SurvivorFrom copy to SurviviorTo</li>\n<li>clean up Eden, SurvivorFrom</li>\n<li>Swap SurvivorTo and SurvivorFrom</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>jdkClassInterfaceJVM</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Returns the maximum amount of memory that the Java virtual machine will attempt to use.</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span> l = Runtime.getRuntime().maxMemory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Returns the total amount of memory in the Java virtual machine.</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span> l1 = Runtime.getRuntime().totalMemory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1/4</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;(-xmx) MAX_MEMORY: &quot;</span> + l + <span class=\"string\">&quot;bytes, &quot;</span> + (l / (<span class=\"keyword\">double</span>) <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;MB&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1/64</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;(-xms) TOTAL_MEMORY: &quot;</span> + l1 + <span class=\"string\">&quot;bytes, &quot;</span> + (l1 / (<span class=\"keyword\">double</span>) <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;MB&quot;</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>note:</strong> </p>\n<blockquote>\n<p>-XX:MaxTenuringThreshold java815</p>\n</blockquote>\n<h1 id=\"GC\"><a href=\"#GC\" class=\"headerlink\" title=\"GC\"></a>GC</h1><ul>\n<li>minor GC</li>\n<li>major/full GC</li>\n</ul>\n<p>major GCminor GCyoungold</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1,0JVM</p>\n<h3 id=\"Copying\"><a href=\"#Copying\" class=\"headerlink\" title=\"Copying\"></a>Copying</h3><p>Minor GCCopying</p>\n<p></p>\n<h3 id=\"Mark-Sweep\"><a href=\"#Mark-Sweep\" class=\"headerlink\" title=\"Mark-Sweep\"></a>Mark-Sweep</h3><p>Major GCMark-SweepMark-Compact--CopyingJVM</p>\n<h3 id=\"Mark-Compact\"><a href=\"#Mark-Compact\" class=\"headerlink\" title=\"Mark-Compact\"></a>Mark-Compact</h3><p>Mark-Sweep-Compact</p>\n<p>GC</p>\n<h1 id=\"JMM\"><a href=\"#JMM\" class=\"headerlink\" title=\"JMM\"></a>JMM</h1><p>JavaJava Memory  Model)<strong></strong></p>\n<p><code></code>java</p>\n<p></p>\n<h2 id=\"violatile\"><a href=\"#violatile\" class=\"headerlink\" title=\"violatile\"></a>violatile</h2><p>javasyncronized</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jvmjavajava<em>native</em><em>class</em>jvmjvmjavajmmjmmjvm</p>"},{"title":"leetcode_contest_55&247","date":"2021-06-27T04:55:29.000Z","_content":"\n\n\n<!-- more -->\n\n# 247\n\n## \n\n1000****pass****WAWA==\n\n+\n\n```java\npublic boolean canBeIncreasing(int[] nums) {\n    // \n    if(check(nums)) return true;\n    int len = nums.length;\n    for(int i=0; i<len; i++){\n        int[] t = new int[len - 1];\n        int k = 0;\n        for(int j=0; j<len; j++){\n            if(j == i) continue;\n            t[k++] = nums[j];\n        }\n        if(check(t)) return true;\n    }\n\n    return false;\n}\n\nprivate boolean check(int[] nums) {\n    for(int i=1; i<nums.length; i++){\n        if(nums[i] <= nums[i-1]) return false;\n    }\n\n    return true;\n}\n```\n\n## \n\n1000.\n\n**python**.\n\n```python\ndef removeOccurences(self, s: str, part: str) -> str:\n    while part in s:\n        s = s.replace(part, '')\n\n    return s\n```\n\n## \n","source":"_posts/leetcode-contest-55-247.md","raw":"---\ntitle: leetcode_contest_55&247\ndate: 2021-06-27 12:55:29\ncategories: leetcode\ntags: summary\n---\n\n\n\n<!-- more -->\n\n# 247\n\n## \n\n1000****pass****WAWA==\n\n+\n\n```java\npublic boolean canBeIncreasing(int[] nums) {\n    // \n    if(check(nums)) return true;\n    int len = nums.length;\n    for(int i=0; i<len; i++){\n        int[] t = new int[len - 1];\n        int k = 0;\n        for(int j=0; j<len; j++){\n            if(j == i) continue;\n            t[k++] = nums[j];\n        }\n        if(check(t)) return true;\n    }\n\n    return false;\n}\n\nprivate boolean check(int[] nums) {\n    for(int i=1; i<nums.length; i++){\n        if(nums[i] <= nums[i-1]) return false;\n    }\n\n    return true;\n}\n```\n\n## \n\n1000.\n\n**python**.\n\n```python\ndef removeOccurences(self, s: str, part: str) -> str:\n    while part in s:\n        s = s.replace(part, '')\n\n    return s\n```\n\n## \n","slug":"leetcode-contest-55-247","published":1,"updated":"2022-12-09T14:48:51.801Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwj002i8py05ygk16cw","content":"<p></p>\n<span id=\"more\"></span>\n\n<h1 id=\"247\"><a href=\"#247\" class=\"headerlink\" title=\"247\"></a>247</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>1000<strong></strong>pass<strong></strong>WAWA==</p>\n<p>+</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canBeIncreasing</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(check(nums)) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = nums.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;len; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] t = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[len - <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> k = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">0</span>; j&lt;len; j++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(j == i) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            t[k++] = nums[j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(check(t)) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">check</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;nums.length; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(nums[i] &lt;= nums[i-<span class=\"number\">1</span>]) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>1000.</p>\n<p><strong>python</strong>.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">removeOccurences</span>(<span class=\"params\">self, s: <span class=\"built_in\">str</span>, part: <span class=\"built_in\">str</span></span>) -&gt; <span class=\"built_in\">str</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> part <span class=\"keyword\">in</span> s:</span><br><span class=\"line\">        s = s.replace(part, <span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2>","site":{"data":{}},"excerpt":"<p></p>","more":"<h1 id=\"247\"><a href=\"#247\" class=\"headerlink\" title=\"247\"></a>247</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>1000<strong></strong>pass<strong></strong>WAWA==</p>\n<p>+</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canBeIncreasing</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(check(nums)) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = nums.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;len; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] t = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[len - <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> k = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">0</span>; j&lt;len; j++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(j == i) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            t[k++] = nums[j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(check(t)) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">check</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;nums.length; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(nums[i] &lt;= nums[i-<span class=\"number\">1</span>]) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>1000.</p>\n<p><strong>python</strong>.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">removeOccurences</span>(<span class=\"params\">self, s: <span class=\"built_in\">str</span>, part: <span class=\"built_in\">str</span></span>) -&gt; <span class=\"built_in\">str</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> part <span class=\"keyword\">in</span> s:</span><br><span class=\"line\">        s = s.replace(part, <span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2>"},{"title":"linux-command-line","date":"2021-04-20T06:12:03.000Z","_content":"\nlinuxbashUbuntu\n\n<!-- more -->\n\n\n\n<!-- toc -->\n\n# \n\n1. \n   \n   `netstat``lsof`\n   \n   ```shell\n   lsof -i:8080 -- list openfiles\n   netstat -nlt | grep 8080\n   ```\n\n2. \n   \n   ```shell\n   df -h\n   ```\n\n# \n\n**** \n\n## \n\n1. \n   \n   ```shell\n   find / -name xxx.md\n   ```\n\n2. \n   \n   ```shell\n   find . -name *.java\n   ```\n\n## \n\n1. \n   \n   ```shell\n   tail -n 10 xx.txt\n   ```\n\n2. \n   \n   ```shell\n   head -n 10 xx.txt\n   ```\n\n3. \n   \n   ```shell\n   grep println Main.java\n   ```","source":"_posts/linux-command-line.md","raw":"---\ntitle: linux-command-line\ndate: 2021-04-20 14:12:03\ncategories: linux\ntags: utils\n---\n\nlinuxbashUbuntu\n\n<!-- more -->\n\n\n\n<!-- toc -->\n\n# \n\n1. \n   \n   `netstat``lsof`\n   \n   ```shell\n   lsof -i:8080 -- list openfiles\n   netstat -nlt | grep 8080\n   ```\n\n2. \n   \n   ```shell\n   df -h\n   ```\n\n# \n\n**** \n\n## \n\n1. \n   \n   ```shell\n   find / -name xxx.md\n   ```\n\n2. \n   \n   ```shell\n   find . -name *.java\n   ```\n\n## \n\n1. \n   \n   ```shell\n   tail -n 10 xx.txt\n   ```\n\n2. \n   \n   ```shell\n   head -n 10 xx.txt\n   ```\n\n3. \n   \n   ```shell\n   grep println Main.java\n   ```","slug":"linux-command-line","published":1,"updated":"2022-11-24T11:42:29.026Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwk002l8py0ap025j4o","content":"<p>linuxbashUbuntu</p>\n<span id=\"more\"></span>\n\n<p></p>\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li><p></p>\n<p><code>netstat</code><code>lsof</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">lsof -i:8080 -- list openfiles</span><br><span class=\"line\">netstat -nlt | grep 8080</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df -h</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong></strong> </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find / -name xxx.md</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find . -name *.java</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -n 10 xx.txt</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head -n 10 xx.txt</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep println Main.java</span><br></pre></td></tr></table></figure></li>\n</ol>\n","site":{"data":{}},"excerpt":"<p>linuxbashUbuntu</p>","more":"<p></p>\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li><p></p>\n<p><code>netstat</code><code>lsof</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">lsof -i:8080 -- list openfiles</span><br><span class=\"line\">netstat -nlt | grep 8080</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df -h</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong></strong> </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find / -name xxx.md</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find . -name *.java</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -n 10 xx.txt</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head -n 10 xx.txt</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep println Main.java</span><br></pre></td></tr></table></figure></li>\n</ol>"},{"title":"lock","date":"2020-07-20T13:46:41.000Z","_content":"\n\n\n<!--more-->\n\n# \n\n![image.png](https://i.loli.net/2020/07/20/AwVJYTyQqzUpEPl.png)\n\n# |\n\n**JVM**java\n\n- Java`synchronized``Lock`\n- Java****`CAS`Java**CAS**\n\n********\n\n```java\n// synchronized\npublic synchronized void testMehthod(){\n    // do something...\n}\n\n// ReentrantLock\nprivate ReentrantLock lock = new ReentrantLock();\npublic void modifyPublicResources(){\n    try{\n        lock.lock();\n        // do something...\n    }finally{\n        lock.unlock();\n    }\n}\n\n// \nprivate AtomicInteger ai = new AtomicInteger();\natomicInteger.incrementAndGet(); // 1\n```\n\n# Compare And Swap\n\nCASjava****\n\n- V \n- A\n- B\n\n`V=A`CASBV\n\n## AtomicInteger\n\n```java\npublic class AtomicInteger extends Number implements java.io.Serializable {\n    private static final long serialVersionUID = 6214790243416807050L;\n\n    // setup to use Unsafe.compareAndSwapInt for updates\n    // \n    private static final Unsafe unsafe = Unsafe.getUnsafe();\n    // valueAtomicInteger\n    private static final long valueOffset;\n\n    static {\n        try {\n            valueOffset = unsafe.objectFieldOffset\n                (AtomicInteger.class.getDeclaredField(\"value\"));\n        } catch (Exception ex) { throw new Error(ex); }\n    }\n    // AtomicIntegerint\n    private volatile int value;\n```\n\n```java\npublic final int getAndIncrement() {\n    return unsafe.getAndAddInt(this, valueOffset, 1);\n}\n```\n\n```java\npublic final int getAndAddInt(Object var1, long var2, int var4) {\n    int var5;\n    do {\n        var5 = this.getIntVolatile(var1, var2);\n    } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n\n    return var5;\n}\n```\n\n```java\npublic final native boolean compareAndSwapInt(Object var1, long var2, int var4, int var5);\n```\n\n`compareAndSwapInt``native`+JDKCPUcmpxchgAVCAS\n\n- `do-while`CPU\n\n**note:** ABAABACASfalse1A-2B-3A\"\n\n# |\n\n\n\nCPU\n\nreference [here](https://mp.weixin.qq.com/s?__biz=MjM5NjQ5MTI5OA==&mid=2651749434&idx=3&sn=5ffa63ad47fe166f2f1a9f604ed10091&chksm=bd12a5778a652c61509d9e718ab086ff27ad8768586ea9b38c3dcf9e017a8e49bcae3df9bcc8&scene=38#wechat_redirect)\n\n# |\n\n\n\n`ReentrantLock``Sync``AbstractQueuedSnchronizer``Sync``FairSync``NonfairSync``ReentrantLock`\n\n# |\n\n==JDK`synchronized``Lock`\n\n\n\nAQS`ReentrantReadWriteLock``ReadLock``WriteLock`","source":"_posts/lock.md","raw":"---\ntitle: lock\ndate: 2020-07-20 21:46:41\ncategories: java\ntags: lock\n---\n\n\n\n<!--more-->\n\n# \n\n![image.png](https://i.loli.net/2020/07/20/AwVJYTyQqzUpEPl.png)\n\n# |\n\n**JVM**java\n\n- Java`synchronized``Lock`\n- Java****`CAS`Java**CAS**\n\n********\n\n```java\n// synchronized\npublic synchronized void testMehthod(){\n    // do something...\n}\n\n// ReentrantLock\nprivate ReentrantLock lock = new ReentrantLock();\npublic void modifyPublicResources(){\n    try{\n        lock.lock();\n        // do something...\n    }finally{\n        lock.unlock();\n    }\n}\n\n// \nprivate AtomicInteger ai = new AtomicInteger();\natomicInteger.incrementAndGet(); // 1\n```\n\n# Compare And Swap\n\nCASjava****\n\n- V \n- A\n- B\n\n`V=A`CASBV\n\n## AtomicInteger\n\n```java\npublic class AtomicInteger extends Number implements java.io.Serializable {\n    private static final long serialVersionUID = 6214790243416807050L;\n\n    // setup to use Unsafe.compareAndSwapInt for updates\n    // \n    private static final Unsafe unsafe = Unsafe.getUnsafe();\n    // valueAtomicInteger\n    private static final long valueOffset;\n\n    static {\n        try {\n            valueOffset = unsafe.objectFieldOffset\n                (AtomicInteger.class.getDeclaredField(\"value\"));\n        } catch (Exception ex) { throw new Error(ex); }\n    }\n    // AtomicIntegerint\n    private volatile int value;\n```\n\n```java\npublic final int getAndIncrement() {\n    return unsafe.getAndAddInt(this, valueOffset, 1);\n}\n```\n\n```java\npublic final int getAndAddInt(Object var1, long var2, int var4) {\n    int var5;\n    do {\n        var5 = this.getIntVolatile(var1, var2);\n    } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n\n    return var5;\n}\n```\n\n```java\npublic final native boolean compareAndSwapInt(Object var1, long var2, int var4, int var5);\n```\n\n`compareAndSwapInt``native`+JDKCPUcmpxchgAVCAS\n\n- `do-while`CPU\n\n**note:** ABAABACASfalse1A-2B-3A\"\n\n# |\n\n\n\nCPU\n\nreference [here](https://mp.weixin.qq.com/s?__biz=MjM5NjQ5MTI5OA==&mid=2651749434&idx=3&sn=5ffa63ad47fe166f2f1a9f604ed10091&chksm=bd12a5778a652c61509d9e718ab086ff27ad8768586ea9b38c3dcf9e017a8e49bcae3df9bcc8&scene=38#wechat_redirect)\n\n# |\n\n\n\n`ReentrantLock``Sync``AbstractQueuedSnchronizer``Sync``FairSync``NonfairSync``ReentrantLock`\n\n# |\n\n==JDK`synchronized``Lock`\n\n\n\nAQS`ReentrantReadWriteLock``ReadLock``WriteLock`","slug":"lock","published":1,"updated":"2022-12-09T09:36:51.465Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwk002p8py09g7i3puh","content":"<p></p>\n<span id=\"more\"></span>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/07/20/AwVJYTyQqzUpEPl.png\" alt=\"image.png\"></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p><strong>JVM</strong>java</p>\n<ul>\n<li>Java<code>synchronized</code><code>Lock</code></li>\n<li>Java<strong></strong><code>CAS</code>Java<strong>CAS</strong></li>\n</ul>\n<p><strong></strong><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// synchronized</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">testMehthod</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ReentrantLock</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> ReentrantLock lock = <span class=\"keyword\">new</span> ReentrantLock();</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">modifyPublicResources</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">        lock.lock();</span><br><span class=\"line\">        <span class=\"comment\">// do something...</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">        lock.unlock();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">private</span> AtomicInteger ai = <span class=\"keyword\">new</span> AtomicInteger();</span><br><span class=\"line\">atomicInteger.incrementAndGet(); <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Compare-And-Swap\"><a href=\"#Compare-And-Swap\" class=\"headerlink\" title=\"Compare And Swap\"></a>Compare And Swap</h1><p>CASjava<strong></strong></p>\n<ul>\n<li>V </li>\n<li>A</li>\n<li>B</li>\n</ul>\n<p><code>V=A</code>CASBV</p>\n<h2 id=\"AtomicInteger\"><a href=\"#AtomicInteger\" class=\"headerlink\" title=\"AtomicInteger\"></a>AtomicInteger</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AtomicInteger</span> <span class=\"keyword\">extends</span> <span class=\"title\">Number</span> <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> serialVersionUID = <span class=\"number\">6214790243416807050L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// setup to use Unsafe.compareAndSwapInt for updates</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Unsafe unsafe = Unsafe.getUnsafe();</span><br><span class=\"line\">    <span class=\"comment\">// valueAtomicInteger</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> valueOffset;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            valueOffset = unsafe.objectFieldOffset</span><br><span class=\"line\">                (AtomicInteger.class.getDeclaredField(<span class=\"string\">&quot;value&quot;</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(ex); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// AtomicIntegerint</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> value;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndIncrement</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> unsafe.getAndAddInt(<span class=\"keyword\">this</span>, valueOffset, <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndAddInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> var5;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">        var5 = <span class=\"keyword\">this</span>.getIntVolatile(var1, var2);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">while</span>(!<span class=\"keyword\">this</span>.compareAndSwapInt(var1, var2, var5, var5 + var4));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> var5;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">boolean</span> <span class=\"title\">compareAndSwapInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4, <span class=\"keyword\">int</span> var5)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><code>compareAndSwapInt</code><code>native</code>+JDKCPUcmpxchgAVCAS</p>\n<ul>\n<li><code>do-while</code>CPU</li>\n</ul>\n<p><strong>note:</strong> ABAABACASfalse1A-2B-3A</p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p></p>\n<p>CPU</p>\n<p>reference <a class=\"link\"   href=\"https://mp.weixin.qq.com/s?__biz=MjM5NjQ5MTI5OA==&mid=2651749434&idx=3&sn=5ffa63ad47fe166f2f1a9f604ed10091&chksm=bd12a5778a652c61509d9e718ab086ff27ad8768586ea9b38c3dcf9e017a8e49bcae3df9bcc8&scene=38#wechat_redirect\" >here<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p></p>\n<p><code>ReentrantLock</code><code>Sync</code><code>AbstractQueuedSnchronizer</code><code>Sync</code><code>FairSync</code><code>NonfairSync</code><code>ReentrantLock</code></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p>==JDK<code>synchronized</code><code>Lock</code></p>\n<p></p>\n<p>AQS<code>ReentrantReadWriteLock</code><code>ReadLock</code><code>WriteLock</code></p>\n","site":{"data":{}},"excerpt":"<p></p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/07/20/AwVJYTyQqzUpEPl.png\" alt=\"image.png\"></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p><strong>JVM</strong>java</p>\n<ul>\n<li>Java<code>synchronized</code><code>Lock</code></li>\n<li>Java<strong></strong><code>CAS</code>Java<strong>CAS</strong></li>\n</ul>\n<p><strong></strong><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// synchronized</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">testMehthod</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ReentrantLock</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> ReentrantLock lock = <span class=\"keyword\">new</span> ReentrantLock();</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">modifyPublicResources</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">        lock.lock();</span><br><span class=\"line\">        <span class=\"comment\">// do something...</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">        lock.unlock();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">private</span> AtomicInteger ai = <span class=\"keyword\">new</span> AtomicInteger();</span><br><span class=\"line\">atomicInteger.incrementAndGet(); <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Compare-And-Swap\"><a href=\"#Compare-And-Swap\" class=\"headerlink\" title=\"Compare And Swap\"></a>Compare And Swap</h1><p>CASjava<strong></strong></p>\n<ul>\n<li>V </li>\n<li>A</li>\n<li>B</li>\n</ul>\n<p><code>V=A</code>CASBV</p>\n<h2 id=\"AtomicInteger\"><a href=\"#AtomicInteger\" class=\"headerlink\" title=\"AtomicInteger\"></a>AtomicInteger</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AtomicInteger</span> <span class=\"keyword\">extends</span> <span class=\"title\">Number</span> <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> serialVersionUID = <span class=\"number\">6214790243416807050L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// setup to use Unsafe.compareAndSwapInt for updates</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Unsafe unsafe = Unsafe.getUnsafe();</span><br><span class=\"line\">    <span class=\"comment\">// valueAtomicInteger</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> valueOffset;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            valueOffset = unsafe.objectFieldOffset</span><br><span class=\"line\">                (AtomicInteger.class.getDeclaredField(<span class=\"string\">&quot;value&quot;</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(ex); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// AtomicIntegerint</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> value;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndIncrement</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> unsafe.getAndAddInt(<span class=\"keyword\">this</span>, valueOffset, <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndAddInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> var5;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">        var5 = <span class=\"keyword\">this</span>.getIntVolatile(var1, var2);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">while</span>(!<span class=\"keyword\">this</span>.compareAndSwapInt(var1, var2, var5, var5 + var4));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> var5;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">boolean</span> <span class=\"title\">compareAndSwapInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4, <span class=\"keyword\">int</span> var5)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><code>compareAndSwapInt</code><code>native</code>+JDKCPUcmpxchgAVCAS</p>\n<ul>\n<li><code>do-while</code>CPU</li>\n</ul>\n<p><strong>note:</strong> ABAABACASfalse1A-2B-3A</p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p></p>\n<p>CPU</p>\n<p>reference <a class=\"link\"   href=\"https://mp.weixin.qq.com/s?__biz=MjM5NjQ5MTI5OA==&mid=2651749434&idx=3&sn=5ffa63ad47fe166f2f1a9f604ed10091&chksm=bd12a5778a652c61509d9e718ab086ff27ad8768586ea9b38c3dcf9e017a8e49bcae3df9bcc8&scene=38#wechat_redirect\" >here<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p></p>\n<p><code>ReentrantLock</code><code>Sync</code><code>AbstractQueuedSnchronizer</code><code>Sync</code><code>FairSync</code><code>NonfairSync</code><code>ReentrantLock</code></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p>==JDK<code>synchronized</code><code>Lock</code></p>\n<p></p>\n<p>AQS<code>ReentrantReadWriteLock</code><code>ReadLock</code><code>WriteLock</code></p>"},{"title":"mybatis autoconfiguration","date":"2021-03-09T12:48:57.000Z","_content":"\nmybatisspringbootSpringBootSpringmybatisstarterspringboot\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\nSpringBoot`META-INF``spring.factories``EnableAutoConfiguration`mybatismybatis\n\n```properties\n# Auto Configure\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.mybatis.spring.boot.autoconfigure.MybatisLanguageDriverAutoConfiguration,\\\norg.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration\n```\n\n*thymeleaf**framemarker*web`MybatisAutoConfiguration`\n\n# \n\n\n\n```java\n@Configuration\n@ConditionalOnClass({SqlSessionFactory.class, SqlSessionFactoryBean.class}) // class\n@ConditionalOnSingleCandidate(DataSource.class) // \n@EnableConfigurationProperties({MybatisProperties.class}) // mybatis\n@AutoConfigureAfter({DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class}) // \npublic class MybatisAutoConfiguration implements InitializingBean {\n    // ...\n}\n```\n\n## sqlSessionFactory\n\n```java\n@Bean\n@ConditionalOnMissingBean // bean\npublic SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {\n    // ...\n}\n```\n\nsqlSessionFactorysqlSessionsqlsqlSessionfactory`MapperProperties`facotry\n\n## sqlSessionTemplate\n\n```java\n@Bean\n@ConditionalOnMissingBean // sqlSessionFactory\npublic SqlSessionTemplate sqlSessionTemplate(SqlSessionFactory sqlSessionFactory) {\n    ExecutorType executorType = this.properties.getExecutorType();\n    return executorType != null ? new SqlSessionTemplate(sqlSessionFactory, executorType) : new SqlSessionTemplate(sqlSessionFactory);\n}\n```\n\nsqlSessionFactorysqlSessionFactory`executorType`sqlSessionTemplatebeansqlSession`executorType`\n\n- SIMPLE\n- REUSE\n- BATCH\n\n## MapperScannerRegistrarNotFoundConfiguration\n\n```java\n@Configuration\n@Import({MybatisAutoConfiguration.AutoConfiguredMapperScannerRegistrar.class}) // \n@ConditionalOnMissingBean({MapperFactoryBean.class, MapperScannerConfigurer.class}) // \npublic static class MapperScannerRegistrarNotFoundConfiguration implements InitializingBean {\n    public MapperScannerRegistrarNotFoundConfiguration() {\n    }\n\n    public void afterPropertiesSet() {\n        MybatisAutoConfiguration.logger.debug(\"Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.\");\n    }\n}\n```\n\n`MapperFactoryBean``MapperScannerConfigure.class`**_@MapperScan_**\n\n```java\npublic class MapperFactoryBean<T> extends SqlSessionDaoSupport implements FactoryBean<T> {\n    private Class<T> mapperInterface;\n    private boolean addToConfig = true;\n\n    public MapperFactoryBean() {\n    }\n\n    public MapperFactoryBean(Class<T> mapperInterface) {\n        this.mapperInterface = mapperInterface;\n    }\n\n    protected void checkDaoConfig() {\n        super.checkDaoConfig();\n        Assert.notNull(this.mapperInterface, \"Property 'mapperInterface' is required\");\n        Configuration configuration = this.getSqlSession().getConfiguration();\n        // \n        if (this.addToConfig && !configuration.hasMapper(this.mapperInterface)) {\n            try {\n                // mybatis\n                configuration.addMapper(this.mapperInterface);\n            } catch (Exception var6) {\n                this.logger.error(\"Error while adding the mapper '\" + this.mapperInterface + \"' to configuration.\", var6);\n                throw new IllegalArgumentException(var6);\n            } finally {\n                ErrorContext.instance().reset();\n            }\n        }\n\n    }\n    // ...\n}\n```\n\n\n\n1. \n2. sqlSessionFactorybeandataSource\n3. sqlSessionTemplatebeansqlSessionFactory\n4. mapperbeanmapper\n\nmybatismappersqlSessionFactorysqlSessionTemplatemybatisConfigurationmapper`mapperRegister`mappermapperHashMap","source":"_posts/mybatis-autoconfiguration.md","raw":"---\ntitle: mybatis autoconfiguration\ndate: 2021-03-09 20:48:57\ncategories: springbot\ntags: mybatis\n---\n\nmybatisspringbootSpringBootSpringmybatisstarterspringboot\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\nSpringBoot`META-INF``spring.factories``EnableAutoConfiguration`mybatismybatis\n\n```properties\n# Auto Configure\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.mybatis.spring.boot.autoconfigure.MybatisLanguageDriverAutoConfiguration,\\\norg.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration\n```\n\n*thymeleaf**framemarker*web`MybatisAutoConfiguration`\n\n# \n\n\n\n```java\n@Configuration\n@ConditionalOnClass({SqlSessionFactory.class, SqlSessionFactoryBean.class}) // class\n@ConditionalOnSingleCandidate(DataSource.class) // \n@EnableConfigurationProperties({MybatisProperties.class}) // mybatis\n@AutoConfigureAfter({DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class}) // \npublic class MybatisAutoConfiguration implements InitializingBean {\n    // ...\n}\n```\n\n## sqlSessionFactory\n\n```java\n@Bean\n@ConditionalOnMissingBean // bean\npublic SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {\n    // ...\n}\n```\n\nsqlSessionFactorysqlSessionsqlsqlSessionfactory`MapperProperties`facotry\n\n## sqlSessionTemplate\n\n```java\n@Bean\n@ConditionalOnMissingBean // sqlSessionFactory\npublic SqlSessionTemplate sqlSessionTemplate(SqlSessionFactory sqlSessionFactory) {\n    ExecutorType executorType = this.properties.getExecutorType();\n    return executorType != null ? new SqlSessionTemplate(sqlSessionFactory, executorType) : new SqlSessionTemplate(sqlSessionFactory);\n}\n```\n\nsqlSessionFactorysqlSessionFactory`executorType`sqlSessionTemplatebeansqlSession`executorType`\n\n- SIMPLE\n- REUSE\n- BATCH\n\n## MapperScannerRegistrarNotFoundConfiguration\n\n```java\n@Configuration\n@Import({MybatisAutoConfiguration.AutoConfiguredMapperScannerRegistrar.class}) // \n@ConditionalOnMissingBean({MapperFactoryBean.class, MapperScannerConfigurer.class}) // \npublic static class MapperScannerRegistrarNotFoundConfiguration implements InitializingBean {\n    public MapperScannerRegistrarNotFoundConfiguration() {\n    }\n\n    public void afterPropertiesSet() {\n        MybatisAutoConfiguration.logger.debug(\"Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.\");\n    }\n}\n```\n\n`MapperFactoryBean``MapperScannerConfigure.class`**_@MapperScan_**\n\n```java\npublic class MapperFactoryBean<T> extends SqlSessionDaoSupport implements FactoryBean<T> {\n    private Class<T> mapperInterface;\n    private boolean addToConfig = true;\n\n    public MapperFactoryBean() {\n    }\n\n    public MapperFactoryBean(Class<T> mapperInterface) {\n        this.mapperInterface = mapperInterface;\n    }\n\n    protected void checkDaoConfig() {\n        super.checkDaoConfig();\n        Assert.notNull(this.mapperInterface, \"Property 'mapperInterface' is required\");\n        Configuration configuration = this.getSqlSession().getConfiguration();\n        // \n        if (this.addToConfig && !configuration.hasMapper(this.mapperInterface)) {\n            try {\n                // mybatis\n                configuration.addMapper(this.mapperInterface);\n            } catch (Exception var6) {\n                this.logger.error(\"Error while adding the mapper '\" + this.mapperInterface + \"' to configuration.\", var6);\n                throw new IllegalArgumentException(var6);\n            } finally {\n                ErrorContext.instance().reset();\n            }\n        }\n\n    }\n    // ...\n}\n```\n\n\n\n1. \n2. sqlSessionFactorybeandataSource\n3. sqlSessionTemplatebeansqlSessionFactory\n4. mapperbeanmapper\n\nmybatismappersqlSessionFactorysqlSessionTemplatemybatisConfigurationmapper`mapperRegister`mappermapperHashMap","slug":"mybatis-autoconfiguration","published":1,"updated":"2022-12-09T08:55:14.118Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwk002s8py001bj4e4s","content":"<p>mybatisspringbootSpringBootSpringmybatisstarterspringboot</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringBoot<code>META-INF</code><code>spring.factories</code><code>EnableAutoConfiguration</code>mybatismybatis</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Auto Configure</span></span><br><span class=\"line\"><span class=\"meta\">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.mybatis.spring.boot.autoconfigure.MybatisLanguageDriverAutoConfiguration,\\</span></span><br><span class=\"line\"><span class=\"string\">org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration</span></span><br></pre></td></tr></table></figure>\n\n<p><em>thymeleaf</em><em>framemarker</em>web<code>MybatisAutoConfiguration</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnClass(&#123;SqlSessionFactory.class, SqlSessionFactoryBean.class&#125;)</span> <span class=\"comment\">// class</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnSingleCandidate(DataSource.class)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@EnableConfigurationProperties(&#123;MybatisProperties.class&#125;)</span> <span class=\"comment\">// mybatis</span></span><br><span class=\"line\"><span class=\"meta\">@AutoConfigureAfter(&#123;DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MybatisAutoConfiguration</span> <span class=\"keyword\">implements</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"sqlSessionFactory\"><a href=\"#sqlSessionFactory\" class=\"headerlink\" title=\"sqlSessionFactory\"></a>sqlSessionFactory</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// bean</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> SqlSessionFactory <span class=\"title\">sqlSessionFactory</span><span class=\"params\">(DataSource dataSource)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sqlSessionFactorysqlSessionsqlsqlSessionfactory<code>MapperProperties</code>facotry</p>\n<h2 id=\"sqlSessionTemplate\"><a href=\"#sqlSessionTemplate\" class=\"headerlink\" title=\"sqlSessionTemplate\"></a>sqlSessionTemplate</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// sqlSessionFactory</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> SqlSessionTemplate <span class=\"title\">sqlSessionTemplate</span><span class=\"params\">(SqlSessionFactory sqlSessionFactory)</span> </span>&#123;</span><br><span class=\"line\">    ExecutorType executorType = <span class=\"keyword\">this</span>.properties.getExecutorType();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> executorType != <span class=\"keyword\">null</span> ? <span class=\"keyword\">new</span> SqlSessionTemplate(sqlSessionFactory, executorType) : <span class=\"keyword\">new</span> SqlSessionTemplate(sqlSessionFactory);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sqlSessionFactorysqlSessionFactory<code>executorType</code>sqlSessionTemplatebeansqlSession<code>executorType</code></p>\n<ul>\n<li>SIMPLE</li>\n<li>REUSE</li>\n<li>BATCH</li>\n</ul>\n<h2 id=\"MapperScannerRegistrarNotFoundConfiguration\"><a href=\"#MapperScannerRegistrarNotFoundConfiguration\" class=\"headerlink\" title=\"MapperScannerRegistrarNotFoundConfiguration\"></a>MapperScannerRegistrarNotFoundConfiguration</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@Import(&#123;MybatisAutoConfiguration.AutoConfiguredMapperScannerRegistrar.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean(&#123;MapperFactoryBean.class, MapperScannerConfigurer.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MapperScannerRegistrarNotFoundConfiguration</span> <span class=\"keyword\">implements</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperScannerRegistrarNotFoundConfiguration</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterPropertiesSet</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        MybatisAutoConfiguration.logger.debug(<span class=\"string\">&quot;Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>MapperFactoryBean</code><code>MapperScannerConfigure.class</code><strong>_@MapperScan_</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MapperFactoryBean</span>&lt;<span class=\"title\">T</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title\">SqlSessionDaoSupport</span> <span class=\"keyword\">implements</span> <span class=\"title\">FactoryBean</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Class&lt;T&gt; mapperInterface;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> addToConfig = <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperFactoryBean</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperFactoryBean</span><span class=\"params\">(Class&lt;T&gt; mapperInterface)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.mapperInterface = mapperInterface;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">checkDaoConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.checkDaoConfig();</span><br><span class=\"line\">        Assert.notNull(<span class=\"keyword\">this</span>.mapperInterface, <span class=\"string\">&quot;Property &#x27;mapperInterface&#x27; is required&quot;</span>);</span><br><span class=\"line\">        Configuration configuration = <span class=\"keyword\">this</span>.getSqlSession().getConfiguration();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.addToConfig &amp;&amp; !configuration.hasMapper(<span class=\"keyword\">this</span>.mapperInterface)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// mybatis</span></span><br><span class=\"line\">                configuration.addMapper(<span class=\"keyword\">this</span>.mapperInterface);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (Exception var6) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.logger.error(<span class=\"string\">&quot;Error while adding the mapper &#x27;&quot;</span> + <span class=\"keyword\">this</span>.mapperInterface + <span class=\"string\">&quot;&#x27; to configuration.&quot;</span>, var6);</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalArgumentException(var6);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                ErrorContext.instance().reset();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ol>\n<li></li>\n<li>sqlSessionFactorybeandataSource</li>\n<li>sqlSessionTemplatebeansqlSessionFactory</li>\n<li>mapperbeanmapper</li>\n</ol>\n<p>mybatismappersqlSessionFactorysqlSessionTemplatemybatisConfigurationmapper<code>mapperRegister</code>mappermapperHashMap</p>\n","site":{"data":{}},"excerpt":"<p>mybatisspringbootSpringBootSpringmybatisstarterspringboot</p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringBoot<code>META-INF</code><code>spring.factories</code><code>EnableAutoConfiguration</code>mybatismybatis</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Auto Configure</span></span><br><span class=\"line\"><span class=\"meta\">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">org.mybatis.spring.boot.autoconfigure.MybatisLanguageDriverAutoConfiguration,\\</span></span><br><span class=\"line\"><span class=\"string\">org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration</span></span><br></pre></td></tr></table></figure>\n\n<p><em>thymeleaf</em><em>framemarker</em>web<code>MybatisAutoConfiguration</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnClass(&#123;SqlSessionFactory.class, SqlSessionFactoryBean.class&#125;)</span> <span class=\"comment\">// class</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnSingleCandidate(DataSource.class)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@EnableConfigurationProperties(&#123;MybatisProperties.class&#125;)</span> <span class=\"comment\">// mybatis</span></span><br><span class=\"line\"><span class=\"meta\">@AutoConfigureAfter(&#123;DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MybatisAutoConfiguration</span> <span class=\"keyword\">implements</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"sqlSessionFactory\"><a href=\"#sqlSessionFactory\" class=\"headerlink\" title=\"sqlSessionFactory\"></a>sqlSessionFactory</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// bean</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> SqlSessionFactory <span class=\"title\">sqlSessionFactory</span><span class=\"params\">(DataSource dataSource)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sqlSessionFactorysqlSessionsqlsqlSessionfactory<code>MapperProperties</code>facotry</p>\n<h2 id=\"sqlSessionTemplate\"><a href=\"#sqlSessionTemplate\" class=\"headerlink\" title=\"sqlSessionTemplate\"></a>sqlSessionTemplate</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// sqlSessionFactory</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> SqlSessionTemplate <span class=\"title\">sqlSessionTemplate</span><span class=\"params\">(SqlSessionFactory sqlSessionFactory)</span> </span>&#123;</span><br><span class=\"line\">    ExecutorType executorType = <span class=\"keyword\">this</span>.properties.getExecutorType();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> executorType != <span class=\"keyword\">null</span> ? <span class=\"keyword\">new</span> SqlSessionTemplate(sqlSessionFactory, executorType) : <span class=\"keyword\">new</span> SqlSessionTemplate(sqlSessionFactory);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sqlSessionFactorysqlSessionFactory<code>executorType</code>sqlSessionTemplatebeansqlSession<code>executorType</code></p>\n<ul>\n<li>SIMPLE</li>\n<li>REUSE</li>\n<li>BATCH</li>\n</ul>\n<h2 id=\"MapperScannerRegistrarNotFoundConfiguration\"><a href=\"#MapperScannerRegistrarNotFoundConfiguration\" class=\"headerlink\" title=\"MapperScannerRegistrarNotFoundConfiguration\"></a>MapperScannerRegistrarNotFoundConfiguration</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@Import(&#123;MybatisAutoConfiguration.AutoConfiguredMapperScannerRegistrar.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean(&#123;MapperFactoryBean.class, MapperScannerConfigurer.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MapperScannerRegistrarNotFoundConfiguration</span> <span class=\"keyword\">implements</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperScannerRegistrarNotFoundConfiguration</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterPropertiesSet</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        MybatisAutoConfiguration.logger.debug(<span class=\"string\">&quot;Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>MapperFactoryBean</code><code>MapperScannerConfigure.class</code><strong>_@MapperScan_</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MapperFactoryBean</span>&lt;<span class=\"title\">T</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title\">SqlSessionDaoSupport</span> <span class=\"keyword\">implements</span> <span class=\"title\">FactoryBean</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Class&lt;T&gt; mapperInterface;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> addToConfig = <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperFactoryBean</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperFactoryBean</span><span class=\"params\">(Class&lt;T&gt; mapperInterface)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.mapperInterface = mapperInterface;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">checkDaoConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.checkDaoConfig();</span><br><span class=\"line\">        Assert.notNull(<span class=\"keyword\">this</span>.mapperInterface, <span class=\"string\">&quot;Property &#x27;mapperInterface&#x27; is required&quot;</span>);</span><br><span class=\"line\">        Configuration configuration = <span class=\"keyword\">this</span>.getSqlSession().getConfiguration();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.addToConfig &amp;&amp; !configuration.hasMapper(<span class=\"keyword\">this</span>.mapperInterface)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// mybatis</span></span><br><span class=\"line\">                configuration.addMapper(<span class=\"keyword\">this</span>.mapperInterface);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (Exception var6) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.logger.error(<span class=\"string\">&quot;Error while adding the mapper &#x27;&quot;</span> + <span class=\"keyword\">this</span>.mapperInterface + <span class=\"string\">&quot;&#x27; to configuration.&quot;</span>, var6);</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalArgumentException(var6);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                ErrorContext.instance().reset();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ol>\n<li></li>\n<li>sqlSessionFactorybeandataSource</li>\n<li>sqlSessionTemplatebeansqlSessionFactory</li>\n<li>mapperbeanmapper</li>\n</ol>\n<p>mybatismappersqlSessionFactorysqlSessionTemplatemybatisConfigurationmapper<code>mapperRegister</code>mappermapperHashMap</p>"},{"title":"mybatis sql resolution","date":"2021-03-07T11:03:54.000Z","_content":"\nmybatismybatisspringsqlsql\n\n<!-- more -->\n\n<!-- toc -->\n\n```java\npublic class Test {\n\n    // pojo\n    static class User {\n        int age;\n        int name;\n    }\n\n    public static void main(String[] args) {\n        // \n        UserMapper userMapper = (UserMapper) Proxy.newProxyInstance(Test.class.getClassLoader(), new Class<?>[]{UserMapper.class}, new InvocationHandler() {\n            @Override\n            public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n                // \n                Select annotation = method.getAnnotation(Select.class);\n                // \n                Map<String, Object> map = buildMethodArgNameMap(method, args);\n\n                System.out.println(map.toString());\n                if (annotation != null) {\n                    String[] value = annotation.value();\n                    String s = parseSql(value[0], map);\n                    System.out.println(s);\n                }\n                return null;\n            }\n        });\n        userMapper.selectUesList(2);\n    }\n\n    // sql\n    public static String parseSql(String sql, Map<String, Object> map) {\n        StringBuilder sb = new StringBuilder();\n        int length = sql.length();\n        for (int i = 0; i < length; i++) {\n            char c = sql.charAt(i);\n            if (c == '#') {\n                int nextIndex = i + 1;\n                char nextChar = sql.charAt(nextIndex);\n                if (nextChar != '{') {\n                    throw new RuntimeException(\"sql { \");\n                }\n                StringBuilder argSb = new StringBuilder();\n                i = parseSqlArg(argSb, sql, nextIndex);\n                String argName = argSb.toString();\n                Object argValue = map.get(argName);\n                sb.append(argValue.toString());\n                continue;\n            }\n            sb.append(c);\n        }\n\n        // sql\n        return sb.toString();\n    }\n\n    /**\n     * {}\n     */\n    private static int parseSqlArg(StringBuilder argSb, String sql, int nextIndex) {\n        for (int i = nextIndex + 1; i < sql.length(); i++) {\n            char c = sql.charAt(i);\n            if (c != '}') {\n                argSb.append(c);\n            } else {\n                return i;\n            }\n        }\n        throw new RuntimeException(\"sql } \");\n    }\n\n    /**\n     * \n     *\n     * @param method method\n     * @param args   \n     * @return \n     */\n    public static Map<String, Object> buildMethodArgNameMap(Method method, Object[] args) {\n        Map<String, Object> map = new HashMap<>(6);\n        // Integer id, args 6\n        Parameter[] parameters = method.getParameters();\n        for (int i = 0; i < parameters.length; i++) {\n            map.put(parameters[i].getName(), args[i]);\n        }\n        return map;\n    }\n}\n\n\ninterface UserMapper {\n\n    @Select(\"select * from User where id = #{id}\")\n    List<Test.User> selectUesList(Integer id);\n}    \n```\n\nmybatissql![mybatis_structure.jpg](https://i.loli.net/2021/03/07/cPamMLRFU4xHXu8.jpg)\n\nsqlsqlmybatisxml`#{}`mybatissqlsqlsql","source":"_posts/mybatis-sql-resolution.md","raw":"---\ntitle: mybatis sql resolution\ndate: 2021-03-07 19:03:54\ncategories: mybatis\ntags: mybatis\n---\n\nmybatismybatisspringsqlsql\n\n<!-- more -->\n\n<!-- toc -->\n\n```java\npublic class Test {\n\n    // pojo\n    static class User {\n        int age;\n        int name;\n    }\n\n    public static void main(String[] args) {\n        // \n        UserMapper userMapper = (UserMapper) Proxy.newProxyInstance(Test.class.getClassLoader(), new Class<?>[]{UserMapper.class}, new InvocationHandler() {\n            @Override\n            public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n                // \n                Select annotation = method.getAnnotation(Select.class);\n                // \n                Map<String, Object> map = buildMethodArgNameMap(method, args);\n\n                System.out.println(map.toString());\n                if (annotation != null) {\n                    String[] value = annotation.value();\n                    String s = parseSql(value[0], map);\n                    System.out.println(s);\n                }\n                return null;\n            }\n        });\n        userMapper.selectUesList(2);\n    }\n\n    // sql\n    public static String parseSql(String sql, Map<String, Object> map) {\n        StringBuilder sb = new StringBuilder();\n        int length = sql.length();\n        for (int i = 0; i < length; i++) {\n            char c = sql.charAt(i);\n            if (c == '#') {\n                int nextIndex = i + 1;\n                char nextChar = sql.charAt(nextIndex);\n                if (nextChar != '{') {\n                    throw new RuntimeException(\"sql { \");\n                }\n                StringBuilder argSb = new StringBuilder();\n                i = parseSqlArg(argSb, sql, nextIndex);\n                String argName = argSb.toString();\n                Object argValue = map.get(argName);\n                sb.append(argValue.toString());\n                continue;\n            }\n            sb.append(c);\n        }\n\n        // sql\n        return sb.toString();\n    }\n\n    /**\n     * {}\n     */\n    private static int parseSqlArg(StringBuilder argSb, String sql, int nextIndex) {\n        for (int i = nextIndex + 1; i < sql.length(); i++) {\n            char c = sql.charAt(i);\n            if (c != '}') {\n                argSb.append(c);\n            } else {\n                return i;\n            }\n        }\n        throw new RuntimeException(\"sql } \");\n    }\n\n    /**\n     * \n     *\n     * @param method method\n     * @param args   \n     * @return \n     */\n    public static Map<String, Object> buildMethodArgNameMap(Method method, Object[] args) {\n        Map<String, Object> map = new HashMap<>(6);\n        // Integer id, args 6\n        Parameter[] parameters = method.getParameters();\n        for (int i = 0; i < parameters.length; i++) {\n            map.put(parameters[i].getName(), args[i]);\n        }\n        return map;\n    }\n}\n\n\ninterface UserMapper {\n\n    @Select(\"select * from User where id = #{id}\")\n    List<Test.User> selectUesList(Integer id);\n}    \n```\n\nmybatissql![mybatis_structure.jpg](https://i.loli.net/2021/03/07/cPamMLRFU4xHXu8.jpg)\n\nsqlsqlmybatisxml`#{}`mybatissqlsqlsql","slug":"mybatis-sql-resolution","published":1,"updated":"2022-11-24T11:41:31.525Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwk002w8py0d6rd5ign","content":"<p>mybatismybatisspringsqlsql</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// pojo</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> age;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        UserMapper userMapper = (UserMapper) Proxy.newProxyInstance(Test.class.getClassLoader(), <span class=\"keyword\">new</span> Class&lt;?&gt;[]&#123;UserMapper.class&#125;, <span class=\"keyword\">new</span> InvocationHandler() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                Select annotation = method.getAnnotation(Select.class);</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                Map&lt;String, Object&gt; map = buildMethodArgNameMap(method, args);</span><br><span class=\"line\"></span><br><span class=\"line\">                System.out.println(map.toString());</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (annotation != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    String[] value = annotation.value();</span><br><span class=\"line\">                    String s = parseSql(value[<span class=\"number\">0</span>], map);</span><br><span class=\"line\">                    System.out.println(s);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        userMapper.selectUesList(<span class=\"number\">2</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// sql</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">parseSql</span><span class=\"params\">(String sql, Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class=\"line\">        StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length = sql.length();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = sql.charAt(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c == <span class=\"string\">&#x27;#&#x27;</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> nextIndex = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">char</span> nextChar = sql.charAt(nextIndex);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nextChar != <span class=\"string\">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">&quot;sql &#123; &quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                StringBuilder argSb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">                i = parseSqlArg(argSb, sql, nextIndex);</span><br><span class=\"line\">                String argName = argSb.toString();</span><br><span class=\"line\">                Object argValue = map.get(argName);</span><br><span class=\"line\">                sb.append(argValue.toString());</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            sb.append(c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// sql</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * &#123;&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">parseSqlArg</span><span class=\"params\">(StringBuilder argSb, String sql, <span class=\"keyword\">int</span> nextIndex)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = nextIndex + <span class=\"number\">1</span>; i &lt; sql.length(); i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = sql.charAt(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c != <span class=\"string\">&#x27;&#125;&#x27;</span>) &#123;</span><br><span class=\"line\">                argSb.append(c);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> i;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">&quot;sql &#125; &quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> method method</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> args   </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Map&lt;String, Object&gt; <span class=\"title\">buildMethodArgNameMap</span><span class=\"params\">(Method method, Object[] args)</span> </span>&#123;</span><br><span class=\"line\">        Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">6</span>);</span><br><span class=\"line\">        <span class=\"comment\">// Integer id, args 6</span></span><br><span class=\"line\">        Parameter[] parameters = method.getParameters();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; parameters.length; i++) &#123;</span><br><span class=\"line\">            map.put(parameters[i].getName(), args[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Select(&quot;select * from User where id = #&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    List&lt;Test.User&gt; selectUesList(Integer id);</span><br><span class=\"line\">&#125;    </span><br></pre></td></tr></table></figure>\n\n<p>mybatissql<img src=\"https://i.loli.net/2021/03/07/cPamMLRFU4xHXu8.jpg\" alt=\"mybatis_structure.jpg\"></p>\n<p>sqlsqlmybatisxml<code>#&#123;&#125;</code>mybatissqlsqlsql</p>\n","site":{"data":{}},"excerpt":"<p>mybatismybatisspringsqlsql</p>","more":"<!-- toc -->\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// pojo</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> age;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        UserMapper userMapper = (UserMapper) Proxy.newProxyInstance(Test.class.getClassLoader(), <span class=\"keyword\">new</span> Class&lt;?&gt;[]&#123;UserMapper.class&#125;, <span class=\"keyword\">new</span> InvocationHandler() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                Select annotation = method.getAnnotation(Select.class);</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                Map&lt;String, Object&gt; map = buildMethodArgNameMap(method, args);</span><br><span class=\"line\"></span><br><span class=\"line\">                System.out.println(map.toString());</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (annotation != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    String[] value = annotation.value();</span><br><span class=\"line\">                    String s = parseSql(value[<span class=\"number\">0</span>], map);</span><br><span class=\"line\">                    System.out.println(s);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        userMapper.selectUesList(<span class=\"number\">2</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// sql</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">parseSql</span><span class=\"params\">(String sql, Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class=\"line\">        StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length = sql.length();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = sql.charAt(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c == <span class=\"string\">&#x27;#&#x27;</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> nextIndex = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">char</span> nextChar = sql.charAt(nextIndex);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nextChar != <span class=\"string\">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">&quot;sql &#123; &quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                StringBuilder argSb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">                i = parseSqlArg(argSb, sql, nextIndex);</span><br><span class=\"line\">                String argName = argSb.toString();</span><br><span class=\"line\">                Object argValue = map.get(argName);</span><br><span class=\"line\">                sb.append(argValue.toString());</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            sb.append(c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// sql</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * &#123;&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">parseSqlArg</span><span class=\"params\">(StringBuilder argSb, String sql, <span class=\"keyword\">int</span> nextIndex)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = nextIndex + <span class=\"number\">1</span>; i &lt; sql.length(); i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = sql.charAt(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c != <span class=\"string\">&#x27;&#125;&#x27;</span>) &#123;</span><br><span class=\"line\">                argSb.append(c);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> i;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">&quot;sql &#125; &quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> method method</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> args   </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Map&lt;String, Object&gt; <span class=\"title\">buildMethodArgNameMap</span><span class=\"params\">(Method method, Object[] args)</span> </span>&#123;</span><br><span class=\"line\">        Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">6</span>);</span><br><span class=\"line\">        <span class=\"comment\">// Integer id, args 6</span></span><br><span class=\"line\">        Parameter[] parameters = method.getParameters();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; parameters.length; i++) &#123;</span><br><span class=\"line\">            map.put(parameters[i].getName(), args[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Select(&quot;select * from User where id = #&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    List&lt;Test.User&gt; selectUesList(Integer id);</span><br><span class=\"line\">&#125;    </span><br></pre></td></tr></table></figure>\n\n<p>mybatissql<img src=\"https://i.loli.net/2021/03/07/cPamMLRFU4xHXu8.jpg\" alt=\"mybatis_structure.jpg\"></p>\n<p>sqlsqlmybatisxml<code>#&#123;&#125;</code>mybatissqlsqlsql</p>"},{"title":"mq","date":"2020-07-20T13:04:40.000Z","_content":"\nmqmq\n\n<!--more-->\n\n# MQ\n\n\n\n1. ````\n   \n   ``\n\n2. `A`BC\n   \n   `D``A`__AD__`A``A`\n\n## \n\n-   \n\n-   \n\n-   \n\n# \n\n|   | Topic                                                   | Queue                                                              |\n| ----- | ----------------------------------------------------------- | ---------------------------------------------------------------------- |\n|   | -                 |  |\n|   |                                                          | Queuemq                                               |\n|  |                                          |                                                                  |\n|   |  |                        |\n\n# JMS\n\nJavaJava Message ServiceJavaEEAPIiJava\n\nJMSMQ\n\n## MESSAGE\n\nJMS message +  + \n\n### \n\n\n\n- JMSDestination QueueTopic\n\n- JMSDeliveryMode JMS\n\n- JMSExpiration \n\n- JMSPriority 0-45-9\n\n- JMSMessgeID ID\n\n### \n\n5\n\n- TextMessage  \n\n- MapMessage mapkeyStringJava\n\n- BytesMessage \n\n- StreamMessage \n\n- ObjectMessage Java\n\n\n\n### \n\n\n\n```java\nTextMessage tm = session.createTextMessage(\"wa wa\");\ntm.setStringProperty(\"c01\",\"vip\"); // \n\n\nTextMessage tms = (TextMessage) messge;\nSystem.out.println(tms.getStringProperty(\"c01\")); // \n```\n\n# \n\nMQ************\n\n##  PERSISTENT\n\nredisrdbaof\n\n### QUEUE\n\n#### \n\n1.  \n   \n   > messaegeProducer.setDeliveryMode(DeliveryMode.*NON_PRESISTENT*);\n\n2.  \n   \n   > messageProducer.setDelieveryMode(DeliveryMode._PRESISTENT_);\n\n#### \n\nactiveMQMQ\n\n\n\n********\n\n\n\n### TOPIC\n\ntopictopic\n\n1. MQ\n\n2. \n\n3. \n\n##  TRANSACTION\n\nACID\n\n```java\n// session \nSession session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n```\n\n### \n\n- false `send`\n\n- true `send``commit`\n\ntrue\n\n```java\ntry{\n    // ok session.commit;\n}catch (Exception e){\n    // error\n    session.rollback();\n}finally{\n    if(null != session){\n        session.close();\n}\n}\n```\n\n### \n\nsession`true``commit`\n\n##  ACKNOWLEDGE\n\n\n\n#### \n\n```java\n// session \nSession session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n```\n\n- **AUTO_ACKNOWLEDGE**  \n\n-  **CLIENT_ACKNOWLEDGE** \n\n-  **DUPS_OK_ACKNOWLEDGE**\n\n\n\n```java\nTextMessage tm = (TextMessage)messageConsumer.receive(4000L);\nif(null != tm){\n    tm.acknowledge();\n}else{\n    break;\n}\n// ...\n```\n\n### \n\n```java\n// session \nSession session = connection.createSession(true, Session.AUTO_ACKNOWLEDGE);\n```\n\n`commit`\n\n## \n\n****\n\n- **Session****acknowledge**)\n\n- ****\n\n## \n\nJMS Pub/Sub**topic**publishersubscribepublishersubscribe\n\n### \n\nMQ\n\n### \n\nMQIDIDMQMQID \n\n# BROKER\n\n\n\nActiveMQ****ActiveMQMQJava\n\nlinuxMQMQ  springboottomcat.\n\n## \n\nActiveMQbroker\n\n`ActiveMQ`****1. 2. producerbroker\n\nproducerproducerclientbroker100%``\n\n# ACTIVEMQ\n\nQ: 61616tcp\n\nNIO\n\nTCP, NIO, UDP, SSL, VMjava\n\n|      |                   |\n| ------ | ------------------- |\n| TCP    |         |\n| NIO    | TCP |\n| HTP(s) | HTTP(s)           |\n\n## NIO\n\nNIO`activemq.xml`\n\n```xml\n<broker>\n...\n    <transportConnectors>\n        <transportConnector name=\"nio\" uri=\"nio://192.168.111.136\"/>\n    </transportConnectors>\n...\n</broker>\n```\n\n\n\n```java\npublic stati final String ACTIVEMQ_URL = \"nio://192.168.111.136\";\n\n\npublic static void main(String[] args){\n    ActiveMQConnectionFactory af = new ActiveMQConnectionFactory(ACTIVEMQ_URL);\n    ......\n}\n```\n\n### \n\nQ: urinioTCPNIOIO`openwireTCP`NIO\n\n`BIO+TCP``NIO+TCP``NIO+TCP/Mqtt/stomp`\n\nA: `auto`[reference](https://activemq.apache.org/auto)\n\n```xml\n<transportConnector name=\"auto\" uri=\"auto://localhost:5761\"/>\n```\n\n**note:** activeMQ`Network`\n\n# ACTIVEMQ\n\nMQ``MQi\n\nDB`KahaDB`, `LevelDB`, `JDBC`\n\nQ: AMQ\n\n## KahaDB\n\nActiveMQ5.4Redisaof\n\n\n\n```xml\n<persistenceAdapter>\n    <kahaDB directory=\"${activemq.data}/kahadb\"/>\n</persistenceAdpter>\n```\n\n### \n\nreference [here](https:/activemq.apache.org/kahadb)\n\n********\n\nKahadb4lockdb-1.log, db.data, db.free, db.redo, lock. 41\n\n#### db\\<Number\\>.log\n\nNumber1\n\n#### db.data\n\n`BTree`B-TreeB-Tree`db-\\<Number>.log`\n\n#### db.free\n\n`db.data`**ID**. linuxbash`free`\n\n#### db.redo\n\nKahaDBBTree\n\n#### lock\n\nmysqlkahadbbroker\n\n## JDBC\n\nmysql/oraclejdbcJournalkahaDBJDBC\n\n## LevelDB\n\n## JDBC Message store with ActiveMQ Journal\n\n\n\n# Q&A\n\n1. \n\n2. Async Sends\n\n3. \n\n4. \n\n5. ActiveMQ\n\n6. \n\n7. \n\n## \n\nzookeeper + (replicated-leveldb-store)\n\n## \n\n \n\n\n\n```java\nActiveMQConnectionFacotry acf = new ActiveMQConnectionFactory(URL);\n// \nacf.setUseAsyncSend(true);\nActiveMQMessageProducer amp = (ActiveMQMessageProducer)session.createProducer(queue);\n...\nTextMessage message = session.createTextMessage();\n// message\nmessage.setJMSMessageID(UUID.randomUUID().toString());\n\n// send\namp.send(message, new AsyncCallback(){\n    @Override\n    public void onSucces(){\n\n        System.out.println(message.getJMSmessageID+\" succeed\")\n    }\n    @Override\n    public void onException(JMSException exception){\n        // \n        System.out.println(message.getJMSmessageID+\" fail\")\n    }\n})\n```\n\n## \n\n[](http://activemq.apache.org/delay-and-schedule-message-delivery.html)\n\n| Property name          | type   | description |\n| ---------------------- | ------ | ----------- |\n| AMQ\\_SCHEDULED\\_DELAY  | long   |      |\n| AMQ\\_SCHEDULED\\_PERIOD | long   |    |\n| AMQ\\_SCHEDULED\\_REPEAT | int    |       |\n| AMQ\\_SCHEDULED\\_CRON   | String | Cron     |\n\n`activemq.xml`*schedulerSupport**true*Java*ScheduledMessage*\n\n```java\nlong delay = 3 * 1000; //3\nlong period = 4 * 1000;\nint repeat = 5;\n\nTextMessage message = session.createTextMessage();\nmessage.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);\nmessage.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, delay);\nmessage.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, delay);\n\nmessageProducer.send(mesage);\n...\n```\n\n## ActiveMQ\n\n- \n\n- \n\n- Posion ACK\n\nreference [here](activemq.apache.org/redelivery-policy)\n\ncommit6MQDLQDead Letter Queue\n\n## \n\n**note**: MQ\n\n- \n\n- redis**id**\\<id, message\\>K-Vredisredis","source":"_posts/mq.md","raw":"---\ntitle: mq\ndate: 2020-07-20 21:04:40\ncategories: middleware\ntags: activemq\n---\n\nmqmq\n\n<!--more-->\n\n# MQ\n\n\n\n1. ````\n   \n   ``\n\n2. `A`BC\n   \n   `D``A`__AD__`A``A`\n\n## \n\n-   \n\n-   \n\n-   \n\n# \n\n|   | Topic                                                   | Queue                                                              |\n| ----- | ----------------------------------------------------------- | ---------------------------------------------------------------------- |\n|   | -                 |  |\n|   |                                                          | Queuemq                                               |\n|  |                                          |                                                                  |\n|   |  |                        |\n\n# JMS\n\nJavaJava Message ServiceJavaEEAPIiJava\n\nJMSMQ\n\n## MESSAGE\n\nJMS message +  + \n\n### \n\n\n\n- JMSDestination QueueTopic\n\n- JMSDeliveryMode JMS\n\n- JMSExpiration \n\n- JMSPriority 0-45-9\n\n- JMSMessgeID ID\n\n### \n\n5\n\n- TextMessage  \n\n- MapMessage mapkeyStringJava\n\n- BytesMessage \n\n- StreamMessage \n\n- ObjectMessage Java\n\n\n\n### \n\n\n\n```java\nTextMessage tm = session.createTextMessage(\"wa wa\");\ntm.setStringProperty(\"c01\",\"vip\"); // \n\n\nTextMessage tms = (TextMessage) messge;\nSystem.out.println(tms.getStringProperty(\"c01\")); // \n```\n\n# \n\nMQ************\n\n##  PERSISTENT\n\nredisrdbaof\n\n### QUEUE\n\n#### \n\n1.  \n   \n   > messaegeProducer.setDeliveryMode(DeliveryMode.*NON_PRESISTENT*);\n\n2.  \n   \n   > messageProducer.setDelieveryMode(DeliveryMode._PRESISTENT_);\n\n#### \n\nactiveMQMQ\n\n\n\n********\n\n\n\n### TOPIC\n\ntopictopic\n\n1. MQ\n\n2. \n\n3. \n\n##  TRANSACTION\n\nACID\n\n```java\n// session \nSession session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n```\n\n### \n\n- false `send`\n\n- true `send``commit`\n\ntrue\n\n```java\ntry{\n    // ok session.commit;\n}catch (Exception e){\n    // error\n    session.rollback();\n}finally{\n    if(null != session){\n        session.close();\n}\n}\n```\n\n### \n\nsession`true``commit`\n\n##  ACKNOWLEDGE\n\n\n\n#### \n\n```java\n// session \nSession session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n```\n\n- **AUTO_ACKNOWLEDGE**  \n\n-  **CLIENT_ACKNOWLEDGE** \n\n-  **DUPS_OK_ACKNOWLEDGE**\n\n\n\n```java\nTextMessage tm = (TextMessage)messageConsumer.receive(4000L);\nif(null != tm){\n    tm.acknowledge();\n}else{\n    break;\n}\n// ...\n```\n\n### \n\n```java\n// session \nSession session = connection.createSession(true, Session.AUTO_ACKNOWLEDGE);\n```\n\n`commit`\n\n## \n\n****\n\n- **Session****acknowledge**)\n\n- ****\n\n## \n\nJMS Pub/Sub**topic**publishersubscribepublishersubscribe\n\n### \n\nMQ\n\n### \n\nMQIDIDMQMQID \n\n# BROKER\n\n\n\nActiveMQ****ActiveMQMQJava\n\nlinuxMQMQ  springboottomcat.\n\n## \n\nActiveMQbroker\n\n`ActiveMQ`****1. 2. producerbroker\n\nproducerproducerclientbroker100%``\n\n# ACTIVEMQ\n\nQ: 61616tcp\n\nNIO\n\nTCP, NIO, UDP, SSL, VMjava\n\n|      |                   |\n| ------ | ------------------- |\n| TCP    |         |\n| NIO    | TCP |\n| HTP(s) | HTTP(s)           |\n\n## NIO\n\nNIO`activemq.xml`\n\n```xml\n<broker>\n...\n    <transportConnectors>\n        <transportConnector name=\"nio\" uri=\"nio://192.168.111.136\"/>\n    </transportConnectors>\n...\n</broker>\n```\n\n\n\n```java\npublic stati final String ACTIVEMQ_URL = \"nio://192.168.111.136\";\n\n\npublic static void main(String[] args){\n    ActiveMQConnectionFactory af = new ActiveMQConnectionFactory(ACTIVEMQ_URL);\n    ......\n}\n```\n\n### \n\nQ: urinioTCPNIOIO`openwireTCP`NIO\n\n`BIO+TCP``NIO+TCP``NIO+TCP/Mqtt/stomp`\n\nA: `auto`[reference](https://activemq.apache.org/auto)\n\n```xml\n<transportConnector name=\"auto\" uri=\"auto://localhost:5761\"/>\n```\n\n**note:** activeMQ`Network`\n\n# ACTIVEMQ\n\nMQ``MQi\n\nDB`KahaDB`, `LevelDB`, `JDBC`\n\nQ: AMQ\n\n## KahaDB\n\nActiveMQ5.4Redisaof\n\n\n\n```xml\n<persistenceAdapter>\n    <kahaDB directory=\"${activemq.data}/kahadb\"/>\n</persistenceAdpter>\n```\n\n### \n\nreference [here](https:/activemq.apache.org/kahadb)\n\n********\n\nKahadb4lockdb-1.log, db.data, db.free, db.redo, lock. 41\n\n#### db\\<Number\\>.log\n\nNumber1\n\n#### db.data\n\n`BTree`B-TreeB-Tree`db-\\<Number>.log`\n\n#### db.free\n\n`db.data`**ID**. linuxbash`free`\n\n#### db.redo\n\nKahaDBBTree\n\n#### lock\n\nmysqlkahadbbroker\n\n## JDBC\n\nmysql/oraclejdbcJournalkahaDBJDBC\n\n## LevelDB\n\n## JDBC Message store with ActiveMQ Journal\n\n\n\n# Q&A\n\n1. \n\n2. Async Sends\n\n3. \n\n4. \n\n5. ActiveMQ\n\n6. \n\n7. \n\n## \n\nzookeeper + (replicated-leveldb-store)\n\n## \n\n \n\n\n\n```java\nActiveMQConnectionFacotry acf = new ActiveMQConnectionFactory(URL);\n// \nacf.setUseAsyncSend(true);\nActiveMQMessageProducer amp = (ActiveMQMessageProducer)session.createProducer(queue);\n...\nTextMessage message = session.createTextMessage();\n// message\nmessage.setJMSMessageID(UUID.randomUUID().toString());\n\n// send\namp.send(message, new AsyncCallback(){\n    @Override\n    public void onSucces(){\n\n        System.out.println(message.getJMSmessageID+\" succeed\")\n    }\n    @Override\n    public void onException(JMSException exception){\n        // \n        System.out.println(message.getJMSmessageID+\" fail\")\n    }\n})\n```\n\n## \n\n[](http://activemq.apache.org/delay-and-schedule-message-delivery.html)\n\n| Property name          | type   | description |\n| ---------------------- | ------ | ----------- |\n| AMQ\\_SCHEDULED\\_DELAY  | long   |      |\n| AMQ\\_SCHEDULED\\_PERIOD | long   |    |\n| AMQ\\_SCHEDULED\\_REPEAT | int    |       |\n| AMQ\\_SCHEDULED\\_CRON   | String | Cron     |\n\n`activemq.xml`*schedulerSupport**true*Java*ScheduledMessage*\n\n```java\nlong delay = 3 * 1000; //3\nlong period = 4 * 1000;\nint repeat = 5;\n\nTextMessage message = session.createTextMessage();\nmessage.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);\nmessage.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, delay);\nmessage.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, delay);\n\nmessageProducer.send(mesage);\n...\n```\n\n## ActiveMQ\n\n- \n\n- \n\n- Posion ACK\n\nreference [here](activemq.apache.org/redelivery-policy)\n\ncommit6MQDLQDead Letter Queue\n\n## \n\n**note**: MQ\n\n- \n\n- redis**id**\\<id, message\\>K-Vredisredis","slug":"mq","published":1,"updated":"2022-11-24T11:41:59.048Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwl00308py0g8oaa6p1","content":"<p>mqmq</p>\n<span id=\"more\"></span>\n\n<h1 id=\"MQ\"><a href=\"#MQ\" class=\"headerlink\" title=\"MQ\"></a>MQ</h1><p></p>\n<ol>\n<li><p><code></code><code></code></p>\n<p><code></code></p>\n</li>\n<li><p><code>A</code>BC</p>\n<p><code>D</code><code>A</code>__AD__<code>A</code><code>A</code></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p>  </p>\n</li>\n<li><p>  </p>\n</li>\n<li><p>  </p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th></th>\n<th>Topic</th>\n<th>Queue</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td>-</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Queuemq</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h1 id=\"JMS\"><a href=\"#JMS\" class=\"headerlink\" title=\"JMS\"></a>JMS</h1><p>JavaJava Message ServiceJavaEEAPIiJava</p>\n<p>JMSMQ</p>\n<h2 id=\"MESSAGE\"><a href=\"#MESSAGE\" class=\"headerlink\" title=\"MESSAGE\"></a>MESSAGE</h2><p>JMS message +  + </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><p>JMSDestination QueueTopic</p>\n</li>\n<li><p>JMSDeliveryMode JMS</p>\n</li>\n<li><p>JMSExpiration </p>\n</li>\n<li><p>JMSPriority 0-45-9</p>\n</li>\n<li><p>JMSMessgeID ID</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>5</p>\n<ul>\n<li><p>TextMessage  </p>\n</li>\n<li><p>MapMessage mapkeyStringJava</p>\n</li>\n<li><p>BytesMessage </p>\n</li>\n<li><p>StreamMessage </p>\n</li>\n<li><p>ObjectMessage Java</p>\n</li>\n</ul>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TextMessage tm = session.createTextMessage(<span class=\"string\">&quot;wa wa&quot;</span>);</span><br><span class=\"line\">tm.setStringProperty(<span class=\"string\">&quot;c01&quot;</span>,<span class=\"string\">&quot;vip&quot;</span>); <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">TextMessage tms = (TextMessage) messge;</span><br><span class=\"line\">System.out.println(tms.getStringProperty(<span class=\"string\">&quot;c01&quot;</span>)); <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MQ<strong></strong><strong></strong><strong></strong></p>\n<h2 id=\"-PERSISTENT\"><a href=\"#-PERSISTENT\" class=\"headerlink\" title=\" PERSISTENT\"></a> PERSISTENT</h2><p>redisrdbaof</p>\n<h3 id=\"QUEUE\"><a href=\"#QUEUE\" class=\"headerlink\" title=\"QUEUE\"></a>QUEUE</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><p> </p>\n<blockquote>\n<p>messaegeProducer.setDeliveryMode(DeliveryMode.<em>NON_PRESISTENT</em>);</p>\n</blockquote>\n</li>\n<li><p> </p>\n<blockquote>\n<p>messageProducer.setDelieveryMode(DeliveryMode.<em>PRESISTENT</em>);</p>\n</blockquote>\n</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>activeMQMQ</p>\n<p></p>\n<p><strong></strong><strong></strong></p>\n<p></p>\n<h3 id=\"TOPIC\"><a href=\"#TOPIC\" class=\"headerlink\" title=\"TOPIC\"></a>TOPIC</h3><p>topictopic</p>\n<ol>\n<li><p>MQ</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"-TRANSACTION\"><a href=\"#-TRANSACTION\" class=\"headerlink\" title=\" TRANSACTION\"></a> TRANSACTION</h2><p>ACID</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>false <code>send</code></p>\n</li>\n<li><p>true <code>send</code><code>commit</code></p>\n</li>\n</ul>\n<p>true</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ok session.commit;</span></span><br><span class=\"line\">&#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">    <span class=\"comment\">// error</span></span><br><span class=\"line\">    session.rollback();</span><br><span class=\"line\">&#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != session)&#123;</span><br><span class=\"line\">        session.close();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>session<code>true</code><code>commit</code></p>\n<h2 id=\"-ACKNOWLEDGE\"><a href=\"#-ACKNOWLEDGE\" class=\"headerlink\" title=\" ACKNOWLEDGE\"></a> ACKNOWLEDGE</h2><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p><strong>AUTO_ACKNOWLEDGE</strong>  </p>\n</li>\n<li><p> <strong>CLIENT_ACKNOWLEDGE</strong> </p>\n</li>\n<li><p> <strong>DUPS_OK_ACKNOWLEDGE</strong></p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TextMessage tm = (TextMessage)messageConsumer.receive(<span class=\"number\">4000L</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != tm)&#123;</span><br><span class=\"line\">    tm.acknowledge();</span><br><span class=\"line\">&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">true</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<p><code>commit</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<ul>\n<li><p><strong>Session</strong><strong>acknowledge</strong>)</p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>JMS Pub/Sub<strong>topic</strong>publishersubscribepublishersubscribe</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MQ</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MQIDIDMQMQID </p>\n<h1 id=\"BROKER\"><a href=\"#BROKER\" class=\"headerlink\" title=\"BROKER\"></a>BROKER</h1><p></p>\n<p>ActiveMQ<strong></strong>ActiveMQMQJava</p>\n<p>linuxMQMQ  springboottomcat.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ActiveMQbroker</p>\n<p><code>ActiveMQ</code><strong></strong>1. 2. producerbroker</p>\n<p>producerproducerclientbroker100%<code></code></p>\n<h1 id=\"ACTIVEMQ\"><a href=\"#ACTIVEMQ\" class=\"headerlink\" title=\"ACTIVEMQ\"></a>ACTIVEMQ</h1><p>Q: 61616tcp</p>\n<p>NIO</p>\n<p>TCP, NIO, UDP, SSL, VMjava</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>TCP</td>\n<td></td>\n</tr>\n<tr>\n<td>NIO</td>\n<td>TCP</td>\n</tr>\n<tr>\n<td>HTP(s)</td>\n<td>HTTP(s)</td>\n</tr>\n</tbody></table>\n<h2 id=\"NIO\"><a href=\"#NIO\" class=\"headerlink\" title=\"NIO\"></a>NIO</h2><p>NIO<code>activemq.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">broker</span>&gt;</span></span><br><span class=\"line\">...</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">transportConnectors</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">transportConnector</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;nio&quot;</span> <span class=\"attr\">uri</span>=<span class=\"string\">&quot;nio://192.168.111.136&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">transportConnectors</span>&gt;</span></span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">broker</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> stati <span class=\"keyword\">final</span> String ACTIVEMQ_URL = <span class=\"string\">&quot;nio://192.168.111.136&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">    ActiveMQConnectionFactory af = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(ACTIVEMQ_URL);</span><br><span class=\"line\">    ......</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Q: urinioTCPNIOIO<code>openwireTCP</code>NIO</p>\n<p><code>BIO+TCP</code><code>NIO+TCP</code><code>NIO+TCP/Mqtt/stomp</code></p>\n<p>A: <code>auto</code><a class=\"link\"   href=\"https://activemq.apache.org/auto\" >reference<i class=\"fas fa-external-link-alt\"></i></a></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">transportConnector</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;auto&quot;</span> <span class=\"attr\">uri</span>=<span class=\"string\">&quot;auto://localhost:5761&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>note:</strong> activeMQ<code>Network</code></p>\n<h1 id=\"ACTIVEMQ\"><a href=\"#ACTIVEMQ\" class=\"headerlink\" title=\"ACTIVEMQ\"></a>ACTIVEMQ</h1><p>MQ<code></code>MQi</p>\n<p>DB<code>KahaDB</code>, <code>LevelDB</code>, <code>JDBC</code></p>\n<p>Q: AMQ</p>\n<h2 id=\"KahaDB\"><a href=\"#KahaDB\" class=\"headerlink\" title=\"KahaDB\"></a>KahaDB</h2><p>ActiveMQ5.4Redisaof</p>\n<p></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">persistenceAdapter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">kahaDB</span> <span class=\"attr\">directory</span>=<span class=\"string\">&quot;$&#123;activemq.data&#125;/kahadb&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">persistenceAdpter</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>reference <a class=\"link\"   href=\"https://activemq.apache.org/kahadb\" >here<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong></strong><strong></strong></p>\n<p>Kahadb4lockdb-1.log, db.data, db.free, db.redo, lock. 41</p>\n<h4 id=\"db-lt-Number-gt-log\"><a href=\"#db-lt-Number-gt-log\" class=\"headerlink\" title=\"db&lt;Number&gt;.log\"></a>db&lt;Number&gt;.log</h4><p>Number1</p>\n<h4 id=\"db-data\"><a href=\"#db-data\" class=\"headerlink\" title=\"db.data\"></a>db.data</h4><p><code>BTree</code>B-TreeB-Tree<code>db-\\&lt;Number&gt;.log</code></p>\n<h4 id=\"db-free\"><a href=\"#db-free\" class=\"headerlink\" title=\"db.free\"></a>db.free</h4><p><code>db.data</code><strong>ID</strong>. linuxbash<code>free</code></p>\n<h4 id=\"db-redo\"><a href=\"#db-redo\" class=\"headerlink\" title=\"db.redo\"></a>db.redo</h4><p>KahaDBBTree</p>\n<h4 id=\"lock\"><a href=\"#lock\" class=\"headerlink\" title=\"lock\"></a>lock</h4><p>mysqlkahadbbroker</p>\n<h2 id=\"JDBC\"><a href=\"#JDBC\" class=\"headerlink\" title=\"JDBC\"></a>JDBC</h2><p>mysql/oraclejdbcJournalkahaDBJDBC</p>\n<h2 id=\"LevelDB\"><a href=\"#LevelDB\" class=\"headerlink\" title=\"LevelDB\"></a>LevelDB</h2><h2 id=\"JDBC-Message-store-with-ActiveMQ-Journal\"><a href=\"#JDBC-Message-store-with-ActiveMQ-Journal\" class=\"headerlink\" title=\"JDBC Message store with ActiveMQ Journal\"></a>JDBC Message store with ActiveMQ Journal</h2><p></p>\n<h1 id=\"Q-amp-A\"><a href=\"#Q-amp-A\" class=\"headerlink\" title=\"Q&amp;A\"></a>Q&amp;A</h1><ol>\n<li><p></p>\n</li>\n<li><p>Async Sends</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>ActiveMQ</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>zookeeper + (replicated-leveldb-store)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> </p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ActiveMQConnectionFacotry acf = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(URL);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">acf.setUseAsyncSend(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">ActiveMQMessageProducer amp = (ActiveMQMessageProducer)session.createProducer(queue);</span><br><span class=\"line\">...</span><br><span class=\"line\">TextMessage message = session.createTextMessage();</span><br><span class=\"line\"><span class=\"comment\">// message</span></span><br><span class=\"line\">message.setJMSMessageID(UUID.randomUUID().toString());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// send</span></span><br><span class=\"line\">amp.send(message, <span class=\"keyword\">new</span> AsyncCallback()&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSucces</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(message.getJMSmessageID+<span class=\"string\">&quot; succeed&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onException</span><span class=\"params\">(JMSException exception)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        System.out.println(message.getJMSmessageID+<span class=\"string\">&quot; fail&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a class=\"link\"   href=\"http://activemq.apache.org/delay-and-schedule-message-delivery.html\" ><i class=\"fas fa-external-link-alt\"></i></a></p>\n<table>\n<thead>\n<tr>\n<th>Property name</th>\n<th>type</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AMQ_SCHEDULED_DELAY</td>\n<td>long</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_PERIOD</td>\n<td>long</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_REPEAT</td>\n<td>int</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_CRON</td>\n<td>String</td>\n<td>Cron</td>\n</tr>\n</tbody></table>\n<p><code>activemq.xml</code><em>schedulerSupport</em><em>true</em>Java<em>ScheduledMessage</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">long</span> delay = <span class=\"number\">3</span> * <span class=\"number\">1000</span>; <span class=\"comment\">//3</span></span><br><span class=\"line\"><span class=\"keyword\">long</span> period = <span class=\"number\">4</span> * <span class=\"number\">1000</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> repeat = <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">TextMessage message = session.createTextMessage();</span><br><span class=\"line\">message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);</span><br><span class=\"line\">message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, delay);</span><br><span class=\"line\">message.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, delay);</span><br><span class=\"line\"></span><br><span class=\"line\">messageProducer.send(mesage);</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ActiveMQ\"><a href=\"#ActiveMQ\" class=\"headerlink\" title=\"ActiveMQ\"></a>ActiveMQ</h2><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>Posion ACK</p>\n</li>\n</ul>\n<p>reference <a href=\"activemq.apache.org/redelivery-policy\">here</a></p>\n<p>commit6MQDLQDead Letter Queue</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>note</strong>: MQ</p>\n<ul>\n<li><p></p>\n</li>\n<li><p>redis<strong>id</strong>&lt;id, message&gt;K-Vredisredis</p>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>mqmq</p>","more":"<h1 id=\"MQ\"><a href=\"#MQ\" class=\"headerlink\" title=\"MQ\"></a>MQ</h1><p></p>\n<ol>\n<li><p><code></code><code></code></p>\n<p><code></code></p>\n</li>\n<li><p><code>A</code>BC</p>\n<p><code>D</code><code>A</code>__AD__<code>A</code><code>A</code></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p>  </p>\n</li>\n<li><p>  </p>\n</li>\n<li><p>  </p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th></th>\n<th>Topic</th>\n<th>Queue</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td>-</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Queuemq</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h1 id=\"JMS\"><a href=\"#JMS\" class=\"headerlink\" title=\"JMS\"></a>JMS</h1><p>JavaJava Message ServiceJavaEEAPIiJava</p>\n<p>JMSMQ</p>\n<h2 id=\"MESSAGE\"><a href=\"#MESSAGE\" class=\"headerlink\" title=\"MESSAGE\"></a>MESSAGE</h2><p>JMS message +  + </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><p>JMSDestination QueueTopic</p>\n</li>\n<li><p>JMSDeliveryMode JMS</p>\n</li>\n<li><p>JMSExpiration </p>\n</li>\n<li><p>JMSPriority 0-45-9</p>\n</li>\n<li><p>JMSMessgeID ID</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>5</p>\n<ul>\n<li><p>TextMessage  </p>\n</li>\n<li><p>MapMessage mapkeyStringJava</p>\n</li>\n<li><p>BytesMessage </p>\n</li>\n<li><p>StreamMessage </p>\n</li>\n<li><p>ObjectMessage Java</p>\n</li>\n</ul>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TextMessage tm = session.createTextMessage(<span class=\"string\">&quot;wa wa&quot;</span>);</span><br><span class=\"line\">tm.setStringProperty(<span class=\"string\">&quot;c01&quot;</span>,<span class=\"string\">&quot;vip&quot;</span>); <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">TextMessage tms = (TextMessage) messge;</span><br><span class=\"line\">System.out.println(tms.getStringProperty(<span class=\"string\">&quot;c01&quot;</span>)); <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MQ<strong></strong><strong></strong><strong></strong></p>\n<h2 id=\"-PERSISTENT\"><a href=\"#-PERSISTENT\" class=\"headerlink\" title=\" PERSISTENT\"></a> PERSISTENT</h2><p>redisrdbaof</p>\n<h3 id=\"QUEUE\"><a href=\"#QUEUE\" class=\"headerlink\" title=\"QUEUE\"></a>QUEUE</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><p> </p>\n<blockquote>\n<p>messaegeProducer.setDeliveryMode(DeliveryMode.<em>NON_PRESISTENT</em>);</p>\n</blockquote>\n</li>\n<li><p> </p>\n<blockquote>\n<p>messageProducer.setDelieveryMode(DeliveryMode.<em>PRESISTENT</em>);</p>\n</blockquote>\n</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>activeMQMQ</p>\n<p></p>\n<p><strong></strong><strong></strong></p>\n<p></p>\n<h3 id=\"TOPIC\"><a href=\"#TOPIC\" class=\"headerlink\" title=\"TOPIC\"></a>TOPIC</h3><p>topictopic</p>\n<ol>\n<li><p>MQ</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"-TRANSACTION\"><a href=\"#-TRANSACTION\" class=\"headerlink\" title=\" TRANSACTION\"></a> TRANSACTION</h2><p>ACID</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>false <code>send</code></p>\n</li>\n<li><p>true <code>send</code><code>commit</code></p>\n</li>\n</ul>\n<p>true</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ok session.commit;</span></span><br><span class=\"line\">&#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">    <span class=\"comment\">// error</span></span><br><span class=\"line\">    session.rollback();</span><br><span class=\"line\">&#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != session)&#123;</span><br><span class=\"line\">        session.close();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>session<code>true</code><code>commit</code></p>\n<h2 id=\"-ACKNOWLEDGE\"><a href=\"#-ACKNOWLEDGE\" class=\"headerlink\" title=\" ACKNOWLEDGE\"></a> ACKNOWLEDGE</h2><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p><strong>AUTO_ACKNOWLEDGE</strong>  </p>\n</li>\n<li><p> <strong>CLIENT_ACKNOWLEDGE</strong> </p>\n</li>\n<li><p> <strong>DUPS_OK_ACKNOWLEDGE</strong></p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TextMessage tm = (TextMessage)messageConsumer.receive(<span class=\"number\">4000L</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != tm)&#123;</span><br><span class=\"line\">    tm.acknowledge();</span><br><span class=\"line\">&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">true</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<p><code>commit</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<ul>\n<li><p><strong>Session</strong><strong>acknowledge</strong>)</p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>JMS Pub/Sub<strong>topic</strong>publishersubscribepublishersubscribe</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MQ</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MQIDIDMQMQID </p>\n<h1 id=\"BROKER\"><a href=\"#BROKER\" class=\"headerlink\" title=\"BROKER\"></a>BROKER</h1><p></p>\n<p>ActiveMQ<strong></strong>ActiveMQMQJava</p>\n<p>linuxMQMQ  springboottomcat.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ActiveMQbroker</p>\n<p><code>ActiveMQ</code><strong></strong>1. 2. producerbroker</p>\n<p>producerproducerclientbroker100%<code></code></p>\n<h1 id=\"ACTIVEMQ\"><a href=\"#ACTIVEMQ\" class=\"headerlink\" title=\"ACTIVEMQ\"></a>ACTIVEMQ</h1><p>Q: 61616tcp</p>\n<p>NIO</p>\n<p>TCP, NIO, UDP, SSL, VMjava</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>TCP</td>\n<td></td>\n</tr>\n<tr>\n<td>NIO</td>\n<td>TCP</td>\n</tr>\n<tr>\n<td>HTP(s)</td>\n<td>HTTP(s)</td>\n</tr>\n</tbody></table>\n<h2 id=\"NIO\"><a href=\"#NIO\" class=\"headerlink\" title=\"NIO\"></a>NIO</h2><p>NIO<code>activemq.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">broker</span>&gt;</span></span><br><span class=\"line\">...</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">transportConnectors</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">transportConnector</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;nio&quot;</span> <span class=\"attr\">uri</span>=<span class=\"string\">&quot;nio://192.168.111.136&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">transportConnectors</span>&gt;</span></span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">broker</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> stati <span class=\"keyword\">final</span> String ACTIVEMQ_URL = <span class=\"string\">&quot;nio://192.168.111.136&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">    ActiveMQConnectionFactory af = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(ACTIVEMQ_URL);</span><br><span class=\"line\">    ......</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Q: urinioTCPNIOIO<code>openwireTCP</code>NIO</p>\n<p><code>BIO+TCP</code><code>NIO+TCP</code><code>NIO+TCP/Mqtt/stomp</code></p>\n<p>A: <code>auto</code><a class=\"link\"   href=\"https://activemq.apache.org/auto\" >reference<i class=\"fas fa-external-link-alt\"></i></a></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">transportConnector</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;auto&quot;</span> <span class=\"attr\">uri</span>=<span class=\"string\">&quot;auto://localhost:5761&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>note:</strong> activeMQ<code>Network</code></p>\n<h1 id=\"ACTIVEMQ\"><a href=\"#ACTIVEMQ\" class=\"headerlink\" title=\"ACTIVEMQ\"></a>ACTIVEMQ</h1><p>MQ<code></code>MQi</p>\n<p>DB<code>KahaDB</code>, <code>LevelDB</code>, <code>JDBC</code></p>\n<p>Q: AMQ</p>\n<h2 id=\"KahaDB\"><a href=\"#KahaDB\" class=\"headerlink\" title=\"KahaDB\"></a>KahaDB</h2><p>ActiveMQ5.4Redisaof</p>\n<p></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">persistenceAdapter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">kahaDB</span> <span class=\"attr\">directory</span>=<span class=\"string\">&quot;$&#123;activemq.data&#125;/kahadb&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">persistenceAdpter</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>reference <a class=\"link\"   href=\"https://activemq.apache.org/kahadb\" >here<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong></strong><strong></strong></p>\n<p>Kahadb4lockdb-1.log, db.data, db.free, db.redo, lock. 41</p>\n<h4 id=\"db-lt-Number-gt-log\"><a href=\"#db-lt-Number-gt-log\" class=\"headerlink\" title=\"db&lt;Number&gt;.log\"></a>db&lt;Number&gt;.log</h4><p>Number1</p>\n<h4 id=\"db-data\"><a href=\"#db-data\" class=\"headerlink\" title=\"db.data\"></a>db.data</h4><p><code>BTree</code>B-TreeB-Tree<code>db-\\&lt;Number&gt;.log</code></p>\n<h4 id=\"db-free\"><a href=\"#db-free\" class=\"headerlink\" title=\"db.free\"></a>db.free</h4><p><code>db.data</code><strong>ID</strong>. linuxbash<code>free</code></p>\n<h4 id=\"db-redo\"><a href=\"#db-redo\" class=\"headerlink\" title=\"db.redo\"></a>db.redo</h4><p>KahaDBBTree</p>\n<h4 id=\"lock\"><a href=\"#lock\" class=\"headerlink\" title=\"lock\"></a>lock</h4><p>mysqlkahadbbroker</p>\n<h2 id=\"JDBC\"><a href=\"#JDBC\" class=\"headerlink\" title=\"JDBC\"></a>JDBC</h2><p>mysql/oraclejdbcJournalkahaDBJDBC</p>\n<h2 id=\"LevelDB\"><a href=\"#LevelDB\" class=\"headerlink\" title=\"LevelDB\"></a>LevelDB</h2><h2 id=\"JDBC-Message-store-with-ActiveMQ-Journal\"><a href=\"#JDBC-Message-store-with-ActiveMQ-Journal\" class=\"headerlink\" title=\"JDBC Message store with ActiveMQ Journal\"></a>JDBC Message store with ActiveMQ Journal</h2><p></p>\n<h1 id=\"Q-amp-A\"><a href=\"#Q-amp-A\" class=\"headerlink\" title=\"Q&amp;A\"></a>Q&amp;A</h1><ol>\n<li><p></p>\n</li>\n<li><p>Async Sends</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>ActiveMQ</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>zookeeper + (replicated-leveldb-store)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> </p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ActiveMQConnectionFacotry acf = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(URL);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">acf.setUseAsyncSend(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">ActiveMQMessageProducer amp = (ActiveMQMessageProducer)session.createProducer(queue);</span><br><span class=\"line\">...</span><br><span class=\"line\">TextMessage message = session.createTextMessage();</span><br><span class=\"line\"><span class=\"comment\">// message</span></span><br><span class=\"line\">message.setJMSMessageID(UUID.randomUUID().toString());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// send</span></span><br><span class=\"line\">amp.send(message, <span class=\"keyword\">new</span> AsyncCallback()&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSucces</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(message.getJMSmessageID+<span class=\"string\">&quot; succeed&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onException</span><span class=\"params\">(JMSException exception)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        System.out.println(message.getJMSmessageID+<span class=\"string\">&quot; fail&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a class=\"link\"   href=\"http://activemq.apache.org/delay-and-schedule-message-delivery.html\" ><i class=\"fas fa-external-link-alt\"></i></a></p>\n<table>\n<thead>\n<tr>\n<th>Property name</th>\n<th>type</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AMQ_SCHEDULED_DELAY</td>\n<td>long</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_PERIOD</td>\n<td>long</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_REPEAT</td>\n<td>int</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_CRON</td>\n<td>String</td>\n<td>Cron</td>\n</tr>\n</tbody></table>\n<p><code>activemq.xml</code><em>schedulerSupport</em><em>true</em>Java<em>ScheduledMessage</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">long</span> delay = <span class=\"number\">3</span> * <span class=\"number\">1000</span>; <span class=\"comment\">//3</span></span><br><span class=\"line\"><span class=\"keyword\">long</span> period = <span class=\"number\">4</span> * <span class=\"number\">1000</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> repeat = <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">TextMessage message = session.createTextMessage();</span><br><span class=\"line\">message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);</span><br><span class=\"line\">message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, delay);</span><br><span class=\"line\">message.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, delay);</span><br><span class=\"line\"></span><br><span class=\"line\">messageProducer.send(mesage);</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ActiveMQ\"><a href=\"#ActiveMQ\" class=\"headerlink\" title=\"ActiveMQ\"></a>ActiveMQ</h2><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>Posion ACK</p>\n</li>\n</ul>\n<p>reference <a href=\"activemq.apache.org/redelivery-policy\">here</a></p>\n<p>commit6MQDLQDead Letter Queue</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>note</strong>: MQ</p>\n<ul>\n<li><p></p>\n</li>\n<li><p>redis<strong>id</strong>&lt;id, message&gt;K-Vredisredis</p>\n</li>\n</ul>"},{"title":"mybatis_preview","date":"2020-08-05T14:21:19.000Z","_content":"\nMybatisJDBC\n\n<!--more-->\n\n# \n\n```flow\nstart=>start: start\nconfig=>operation: mybatis-config.xml\nbuild=>operation: SqlSessionFactoryBuilder\nfactory=>operation: SqlSessionFactory\nsession=>parallel: SqlSession\nmapper=>operation: Sql Mapper\nend=>end: end\n\nstart->config->build->factory->session\nsession(path1,)->end\nsession(path2,right)->mapper->end\n```\n\n`SqlSessionFactoryBuilder``SqlSessionFactory`****`SqlSessionFactory`**`SqlSession` `SqlSession`session****session****`SqlSession`\n\n## \n\npojo`resultMap`****\n\n`resultType`HashMapkeymap`resultMap``resultType`\n\n## \n\nmybatissql\n\n```xml\n<settings>\n    <setting name=\"logImpl\" value=\"log4j\"/>\n</settings>\n```\n\n## \n\nmybatis`limit``rowBounts`sql\n\n```sql\nselect * from USER limit #{index},#{size}\n```\n\n# \n\n\n\n## \n\nsession`close`\n\n## \n\n`namespace``Cache`\n","source":"_posts/mybatis_preview.md","raw":"---\ntitle: mybatis_preview\ndate: 2020-08-05 22:21:19\ncategories: mybatis\ntags: mybatis\n---\n\nMybatisJDBC\n\n<!--more-->\n\n# \n\n```flow\nstart=>start: start\nconfig=>operation: mybatis-config.xml\nbuild=>operation: SqlSessionFactoryBuilder\nfactory=>operation: SqlSessionFactory\nsession=>parallel: SqlSession\nmapper=>operation: Sql Mapper\nend=>end: end\n\nstart->config->build->factory->session\nsession(path1,)->end\nsession(path2,right)->mapper->end\n```\n\n`SqlSessionFactoryBuilder``SqlSessionFactory`****`SqlSessionFactory`**`SqlSession` `SqlSession`session****session****`SqlSession`\n\n## \n\npojo`resultMap`****\n\n`resultType`HashMapkeymap`resultMap``resultType`\n\n## \n\nmybatissql\n\n```xml\n<settings>\n    <setting name=\"logImpl\" value=\"log4j\"/>\n</settings>\n```\n\n## \n\nmybatis`limit``rowBounts`sql\n\n```sql\nselect * from USER limit #{index},#{size}\n```\n\n# \n\n\n\n## \n\nsession`close`\n\n## \n\n`namespace``Cache`\n","slug":"mybatis_preview","published":1,"updated":"2022-11-24T11:41:52.014Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwl00338py0dkg799n5","content":"<p>MybatisJDBC</p>\n<span id=\"more\"></span>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start=&gt;start: start</span><br><span class=\"line\">config=&gt;operation: mybatis-config.xml</span><br><span class=\"line\">build=&gt;operation: SqlSessionFactoryBuilder</span><br><span class=\"line\">factory=&gt;operation: SqlSessionFactory</span><br><span class=\"line\">session=&gt;parallel: SqlSession</span><br><span class=\"line\">mapper=&gt;operation: Sql Mapper</span><br><span class=\"line\">end=&gt;end: end</span><br><span class=\"line\"></span><br><span class=\"line\">start-&gt;config-&gt;build-&gt;factory-&gt;session</span><br><span class=\"line\">session(path1,)-&gt;end</span><br><span class=\"line\">session(path2,right)-&gt;mapper-&gt;end</span><br></pre></td></tr></table></figure>\n\n<p><code>SqlSessionFactoryBuilder</code><code>SqlSessionFactory</code><strong></strong><code>SqlSessionFactory</code><em></em><code>SqlSession</code> <code>SqlSession</code>session<strong></strong>session<strong></strong><code>SqlSession</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>pojo<code>resultMap</code><strong></strong></p>\n<p><code>resultType</code>HashMapkeymap<code>resultMap</code><code>resultType</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>mybatissql</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">settings</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;logImpl&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;log4j&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>mybatis<code>limit</code><code>rowBounts</code>sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> <span class=\"keyword\">USER</span> limit #&#123;index&#125;,#&#123;size&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>session<code>close</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>namespace</code><code>Cache</code></p>\n","site":{"data":{}},"excerpt":"<p>MybatisJDBC</p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start=&gt;start: start</span><br><span class=\"line\">config=&gt;operation: mybatis-config.xml</span><br><span class=\"line\">build=&gt;operation: SqlSessionFactoryBuilder</span><br><span class=\"line\">factory=&gt;operation: SqlSessionFactory</span><br><span class=\"line\">session=&gt;parallel: SqlSession</span><br><span class=\"line\">mapper=&gt;operation: Sql Mapper</span><br><span class=\"line\">end=&gt;end: end</span><br><span class=\"line\"></span><br><span class=\"line\">start-&gt;config-&gt;build-&gt;factory-&gt;session</span><br><span class=\"line\">session(path1,)-&gt;end</span><br><span class=\"line\">session(path2,right)-&gt;mapper-&gt;end</span><br></pre></td></tr></table></figure>\n\n<p><code>SqlSessionFactoryBuilder</code><code>SqlSessionFactory</code><strong></strong><code>SqlSessionFactory</code><em></em><code>SqlSession</code> <code>SqlSession</code>session<strong></strong>session<strong></strong><code>SqlSession</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>pojo<code>resultMap</code><strong></strong></p>\n<p><code>resultType</code>HashMapkeymap<code>resultMap</code><code>resultType</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>mybatissql</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">settings</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;logImpl&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;log4j&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>mybatis<code>limit</code><code>rowBounts</code>sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> <span class=\"keyword\">USER</span> limit #&#123;index&#125;,#&#123;size&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>session<code>close</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>namespace</code><code>Cache</code></p>"},{"title":"nginx","date":"2019-11-02T14:53:32.000Z","_content":"\n# NIGNX\n\n*Nginx* (engine x) HTTP****webIMAP/POP3/SMTPNginxRambler.ru0.1.02004104\n\nWebIMAP/POP3BSD-like nginx\n\n\n\n- \n- \n- \n- \n\n## \n\nIP\n\n## \n\nInternetInternetnginx\n\n\n\n## \n\n\n\n## \n\n\n\nhtml, css, js\n\njsp, servlet\n\n## \n\n### \n\nnginx\n\n/usr/localnginx/sbin\n\n- nginx\n- \n- \n- nginx\n\n[referenct](https://mp.weixin.qq.com/s/PeNWaCDf_6gp2fCQa0Gvng)\n\n# \n\n1. EPEL\n   \n   ```bash\n   sudo yum install -y epel-release\n   sudo yum -y update\n   ```\n\n2. nginx\n   \n   ```bash\n   sudo yum instll -y nginx\n   ```\n   \n   \n   \n   ``_/usr/share/nginx/html_\n   \n   ``_/etc/nginx/nginx.conf_\n   \n   ``_/etc/nginx/conf.d/_\n\n3. 80443\n   \n   \n   \n   ```bash\n   sudo firewall-cmd --permanent --zone=public --add-service=http\n   sudo firewall-cmd --permanent --zone=public --add-service=https\n   sudo firewall-cmd --reload\n   ```\n\n4. \n   \n   - \n     \n     ```bash\n     systemctl start nginx\n     ```\n   \n   - \n     \n     ```bash\n     systemctl stop nginx\n     ```\n   \n   - \n     \n     ```bash\n     systemctl restart nginx\n     ```\n   \n   - \n     \n     ```bash\n     systemctl status nginx\n     ```\n   \n   - \n     \n     ```bash\n     systemctl enable nginx\n     ```\n     \n     `nginx`\n     \n     ```bash\n     nginx -t\n     ```\n     \n     ```bash\n     nginx -s reload\n     ```\n- \n  \n  ```bash\n  systemctl disbale nginx\n  ```\n5. https\n   \n   1. https\n   \n   2. nginx\n      \n      domain\n      \n      ```bash\n      mkdir -p /etc/nginx/ssl\n      ```\n   \n   acme.sh --install-cert -d domain \\\n      --key-file       /etc/nginx/ssl/domain.key  \\\n      --fullchain-file /etc/nginx/ssl/domain.cer \\\n      --reloadcmd     \"service nginx force-reload\"\n   \n   ```\n   \n   ```\n\n6. nginx\n   \n   **/etc/nginx/nginx.conf**server\n   \n   ```markdown\n   server{\n   ...\n   }\n   ```\n   \n   **/etc/nginx/conf.d****default.conf**\n   \n   ```properties\n   server {\n       listen 80;\n       listen 443 ssl;\n       server_name  domain www.domain;\n       location / {\n            root /usr/share/nginx/html;\n            index  index.html index.htm;\n        }\n   \n       ssl_certificate /etc/nginx/ssl/domain.crt;\n       ssl_certificate_key /etc/nginx/ssl/domain.key;\n       ssl_session_timeout  5m;\n       ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n       ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE;\n       ssl_prefer_server_ciphers  on;\n   \n       error_page 497  https://$host$uri?$args;\n   }\n   ```\n","source":"_posts/nginx.md","raw":"---\n\ntitle: nginx\ndate: 2019-11-02 22:53:32\ncategories: middleware\ntags: network\n\n---\n\n# NIGNX\n\n*Nginx* (engine x) HTTP****webIMAP/POP3/SMTPNginxRambler.ru0.1.02004104\n\nWebIMAP/POP3BSD-like nginx\n\n\n\n- \n- \n- \n- \n\n## \n\nIP\n\n## \n\nInternetInternetnginx\n\n\n\n## \n\n\n\n## \n\n\n\nhtml, css, js\n\njsp, servlet\n\n## \n\n### \n\nnginx\n\n/usr/localnginx/sbin\n\n- nginx\n- \n- \n- nginx\n\n[referenct](https://mp.weixin.qq.com/s/PeNWaCDf_6gp2fCQa0Gvng)\n\n# \n\n1. EPEL\n   \n   ```bash\n   sudo yum install -y epel-release\n   sudo yum -y update\n   ```\n\n2. nginx\n   \n   ```bash\n   sudo yum instll -y nginx\n   ```\n   \n   \n   \n   ``_/usr/share/nginx/html_\n   \n   ``_/etc/nginx/nginx.conf_\n   \n   ``_/etc/nginx/conf.d/_\n\n3. 80443\n   \n   \n   \n   ```bash\n   sudo firewall-cmd --permanent --zone=public --add-service=http\n   sudo firewall-cmd --permanent --zone=public --add-service=https\n   sudo firewall-cmd --reload\n   ```\n\n4. \n   \n   - \n     \n     ```bash\n     systemctl start nginx\n     ```\n   \n   - \n     \n     ```bash\n     systemctl stop nginx\n     ```\n   \n   - \n     \n     ```bash\n     systemctl restart nginx\n     ```\n   \n   - \n     \n     ```bash\n     systemctl status nginx\n     ```\n   \n   - \n     \n     ```bash\n     systemctl enable nginx\n     ```\n     \n     `nginx`\n     \n     ```bash\n     nginx -t\n     ```\n     \n     ```bash\n     nginx -s reload\n     ```\n- \n  \n  ```bash\n  systemctl disbale nginx\n  ```\n5. https\n   \n   1. https\n   \n   2. nginx\n      \n      domain\n      \n      ```bash\n      mkdir -p /etc/nginx/ssl\n      ```\n   \n   acme.sh --install-cert -d domain \\\n      --key-file       /etc/nginx/ssl/domain.key  \\\n      --fullchain-file /etc/nginx/ssl/domain.cer \\\n      --reloadcmd     \"service nginx force-reload\"\n   \n   ```\n   \n   ```\n\n6. nginx\n   \n   **/etc/nginx/nginx.conf**server\n   \n   ```markdown\n   server{\n   ...\n   }\n   ```\n   \n   **/etc/nginx/conf.d****default.conf**\n   \n   ```properties\n   server {\n       listen 80;\n       listen 443 ssl;\n       server_name  domain www.domain;\n       location / {\n            root /usr/share/nginx/html;\n            index  index.html index.htm;\n        }\n   \n       ssl_certificate /etc/nginx/ssl/domain.crt;\n       ssl_certificate_key /etc/nginx/ssl/domain.key;\n       ssl_session_timeout  5m;\n       ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n       ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE;\n       ssl_prefer_server_ciphers  on;\n   \n       error_page 497  https://$host$uri?$args;\n   }\n   ```\n","slug":"nginx","published":1,"updated":"2022-11-24T11:41:22.079Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwl00368py02vmt08xr","content":"<h1 id=\"NIGNX\"><a href=\"#NIGNX\" class=\"headerlink\" title=\"NIGNX\"></a>NIGNX</h1><p><em>Nginx</em> (engine x) HTTP<strong></strong>webIMAP/POP3/SMTPNginxRambler.ru0.1.02004104</p>\n<p>WebIMAP/POP3BSD-like nginx</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>IP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>InternetInternetnginx</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>html, css, js</p>\n<p>jsp, servlet</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nginx</p>\n<p>/usr/localnginx/sbin</p>\n<ul>\n<li>nginx</li>\n<li></li>\n<li></li>\n<li>nginx</li>\n</ul>\n<p><a class=\"link\"   href=\"https://mp.weixin.qq.com/s/PeNWaCDf_6gp2fCQa0Gvng\" >referenct<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li><p>EPEL</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y epel-release</span><br><span class=\"line\">sudo yum -y update</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum instll -y nginx</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code></code><em>/usr/share/nginx/html</em></p>\n<p><code></code><em>/etc/nginx/nginx.conf</em></p>\n<p><code></code><em>/etc/nginx/conf.d/</em></p>\n</li>\n<li><p>80443</p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo firewall-cmd --permanent --zone=public --add-service=http</span><br><span class=\"line\">sudo firewall-cmd --permanent --zone=public --add-service=https</span><br><span class=\"line\">sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl <span class=\"built_in\">enable</span> nginx</span><br></pre></td></tr></table></figure>\n\n<p><code>nginx</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -t</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -s reload</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl disbale nginx</span><br></pre></td></tr></table></figure></li>\n</ul>\n<ol start=\"5\">\n<li><p>https</p>\n<ol>\n<li><p>https</p>\n</li>\n<li><p>nginx</p>\n<p>domain</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/nginx/ssl</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<p>acme.sh install-cert -d domain <br>   key-file       /etc/nginx/ssl/domain.key  <br>   fullchain-file /etc/nginx/ssl/domain.cer <br>   reloadcmd     service nginx force-reload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   </span><br></pre></td></tr></table></figure>\n</li>\n<li><p>nginx</p>\n<p>**/etc/nginx/nginx.conf**server</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server&#123;</span><br><span class=\"line\">...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>**/etc/nginx/conf.d<strong></strong>default.conf**</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server</span> <span class=\"string\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">listen</span> <span class=\"string\">80;</span></span><br><span class=\"line\">    <span class=\"attr\">listen</span> <span class=\"string\">443 ssl;</span></span><br><span class=\"line\">    <span class=\"attr\">server_name</span>  <span class=\"string\">domain www.domain;</span></span><br><span class=\"line\">    <span class=\"attr\">location</span> <span class=\"string\">/ &#123;</span></span><br><span class=\"line\">         <span class=\"attr\">root</span> <span class=\"string\">/usr/share/nginx/html;</span></span><br><span class=\"line\">         <span class=\"attr\">index</span>  <span class=\"string\">index.html index.htm;</span></span><br><span class=\"line\">     <span class=\"attr\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">ssl_certificate</span> <span class=\"string\">/etc/nginx/ssl/domain.crt;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_certificate_key</span> <span class=\"string\">/etc/nginx/ssl/domain.key;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_session_timeout</span>  <span class=\"string\">5m;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_protocols</span> <span class=\"string\">TLSv1 TLSv1.1 TLSv1.2;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_ciphers</span> <span class=\"string\">ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_prefer_server_ciphers</span>  <span class=\"string\">on;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">error_page</span> <span class=\"string\">497  https://$host$uri?$args;</span></span><br><span class=\"line\"><span class=\"attr\">&#125;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"NIGNX\"><a href=\"#NIGNX\" class=\"headerlink\" title=\"NIGNX\"></a>NIGNX</h1><p><em>Nginx</em> (engine x) HTTP<strong></strong>webIMAP/POP3/SMTPNginxRambler.ru0.1.02004104</p>\n<p>WebIMAP/POP3BSD-like nginx</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>IP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>InternetInternetnginx</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>html, css, js</p>\n<p>jsp, servlet</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nginx</p>\n<p>/usr/localnginx/sbin</p>\n<ul>\n<li>nginx</li>\n<li></li>\n<li></li>\n<li>nginx</li>\n</ul>\n<p><a class=\"link\"   href=\"https://mp.weixin.qq.com/s/PeNWaCDf_6gp2fCQa0Gvng\" >referenct<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li><p>EPEL</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y epel-release</span><br><span class=\"line\">sudo yum -y update</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum instll -y nginx</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code></code><em>/usr/share/nginx/html</em></p>\n<p><code></code><em>/etc/nginx/nginx.conf</em></p>\n<p><code></code><em>/etc/nginx/conf.d/</em></p>\n</li>\n<li><p>80443</p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo firewall-cmd --permanent --zone=public --add-service=http</span><br><span class=\"line\">sudo firewall-cmd --permanent --zone=public --add-service=https</span><br><span class=\"line\">sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl <span class=\"built_in\">enable</span> nginx</span><br></pre></td></tr></table></figure>\n\n<p><code>nginx</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -t</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -s reload</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl disbale nginx</span><br></pre></td></tr></table></figure></li>\n</ul>\n<ol start=\"5\">\n<li><p>https</p>\n<ol>\n<li><p>https</p>\n</li>\n<li><p>nginx</p>\n<p>domain</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/nginx/ssl</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<p>acme.sh install-cert -d domain <br>   key-file       /etc/nginx/ssl/domain.key  <br>   fullchain-file /etc/nginx/ssl/domain.cer <br>   reloadcmd     service nginx force-reload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   </span><br></pre></td></tr></table></figure>\n</li>\n<li><p>nginx</p>\n<p>**/etc/nginx/nginx.conf**server</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server&#123;</span><br><span class=\"line\">...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>**/etc/nginx/conf.d<strong></strong>default.conf**</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server</span> <span class=\"string\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">listen</span> <span class=\"string\">80;</span></span><br><span class=\"line\">    <span class=\"attr\">listen</span> <span class=\"string\">443 ssl;</span></span><br><span class=\"line\">    <span class=\"attr\">server_name</span>  <span class=\"string\">domain www.domain;</span></span><br><span class=\"line\">    <span class=\"attr\">location</span> <span class=\"string\">/ &#123;</span></span><br><span class=\"line\">         <span class=\"attr\">root</span> <span class=\"string\">/usr/share/nginx/html;</span></span><br><span class=\"line\">         <span class=\"attr\">index</span>  <span class=\"string\">index.html index.htm;</span></span><br><span class=\"line\">     <span class=\"attr\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">ssl_certificate</span> <span class=\"string\">/etc/nginx/ssl/domain.crt;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_certificate_key</span> <span class=\"string\">/etc/nginx/ssl/domain.key;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_session_timeout</span>  <span class=\"string\">5m;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_protocols</span> <span class=\"string\">TLSv1 TLSv1.1 TLSv1.2;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_ciphers</span> <span class=\"string\">ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_prefer_server_ciphers</span>  <span class=\"string\">on;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">error_page</span> <span class=\"string\">497  https://$host$uri?$args;</span></span><br><span class=\"line\"><span class=\"attr\">&#125;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n"},{"title":"observer","date":"2020-06-12T09:12:38.000Z","_content":"\nMQ\n\n<!--more-->\n\n\n\n# \n\nAPI\n\n```java\npublic class WeatherData(){\n    getTemperature(){};\n    getHumidity(){};\n\n    /**\n    * \n    */\n    measuremetnsChanged(){\n        // our codes go here\n    };\n}\n```\n\n`measuremetnsChanged`\n\n```java\npublic void measuremetnsChanged(){\n    currentConditionsDisplay.update(getTemperature(), getHumiditiy(), getPressure());\n    forecastDisplay.update(getTemperature(), getHumiditiy(), getPressure());\n    ......\n}\n```\n\n# \n\n\n\n\n\n- \n- \n\n\n\n\n\n> +=\n\nsubject\"observer\"\n\n********.\n\nobserver/observer\n\n## \n\n![Screenshot from 2020-06-12 18-03-04.png](https://i.loli.net/2020/06/12/cwTWVXNpIQ5ebGo.png)\n\nsubjectsubjectObserver\n\n```java\npublic CurrentConditionsDisplay(Subject weatherData) {\n    this.weatherData = weatherData;\n    weatherData.registerObserver(this);\n}\n```\n\napijavautil\n\n[](https://github.com/Sebastian-Getts/designPatternsPractice)\n\n## \n\n\n\n# \n\nJavaBeansSwingRMI","source":"_posts/observer.md","raw":"---\ntitle: observer\ndate: 2020-06-12 17:12:38\ncategories: designpatterns\ntags: observer\n---\n\nMQ\n\n<!--more-->\n\n\n\n# \n\nAPI\n\n```java\npublic class WeatherData(){\n    getTemperature(){};\n    getHumidity(){};\n\n    /**\n    * \n    */\n    measuremetnsChanged(){\n        // our codes go here\n    };\n}\n```\n\n`measuremetnsChanged`\n\n```java\npublic void measuremetnsChanged(){\n    currentConditionsDisplay.update(getTemperature(), getHumiditiy(), getPressure());\n    forecastDisplay.update(getTemperature(), getHumiditiy(), getPressure());\n    ......\n}\n```\n\n# \n\n\n\n\n\n- \n- \n\n\n\n\n\n> +=\n\nsubject\"observer\"\n\n********.\n\nobserver/observer\n\n## \n\n![Screenshot from 2020-06-12 18-03-04.png](https://i.loli.net/2020/06/12/cwTWVXNpIQ5ebGo.png)\n\nsubjectsubjectObserver\n\n```java\npublic CurrentConditionsDisplay(Subject weatherData) {\n    this.weatherData = weatherData;\n    weatherData.registerObserver(this);\n}\n```\n\napijavautil\n\n[](https://github.com/Sebastian-Getts/designPatternsPractice)\n\n## \n\n\n\n# \n\nJavaBeansSwingRMI","slug":"observer","published":1,"updated":"2022-12-09T08:55:45.236Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwm00398py0dh4ocibn","content":"<p>MQ</p>\n<span id=\"more\"></span>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> class <span class=\"title\">WeatherData</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    getTemperature()&#123;&#125;;</span><br><span class=\"line\">    getHumidity()&#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    measuremetnsChanged()&#123;</span><br><span class=\"line\">        <span class=\"comment\">// our codes go here</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>measuremetnsChanged</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">measuremetnsChanged</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    currentConditionsDisplay.update(getTemperature(), getHumiditiy(), getPressure());</span><br><span class=\"line\">    forecastDisplay.update(getTemperature(), getHumiditiy(), getPressure());</span><br><span class=\"line\">    ......</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<p></p>\n<blockquote>\n<p>+=</p>\n</blockquote>\n<p>subjectobserver</p>\n<p><strong></strong><strong></strong>.</p>\n<p>observer/observer</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"https://i.loli.net/2020/06/12/cwTWVXNpIQ5ebGo.png\" alt=\"Screenshot from 2020-06-12 18-03-04.png\"></p>\n<p>subjectsubjectObserver</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CurrentConditionsDisplay</span><span class=\"params\">(Subject weatherData)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.weatherData = weatherData;</span><br><span class=\"line\">    weatherData.registerObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>apijavautil</p>\n<p><a href=\"https://github.com/Sebastian-Getts/designPatternsPractice\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>JavaBeansSwingRMI</p>\n","site":{"data":{}},"excerpt":"<p>MQ</p>","more":"<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> class <span class=\"title\">WeatherData</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    getTemperature()&#123;&#125;;</span><br><span class=\"line\">    getHumidity()&#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    measuremetnsChanged()&#123;</span><br><span class=\"line\">        <span class=\"comment\">// our codes go here</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>measuremetnsChanged</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">measuremetnsChanged</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    currentConditionsDisplay.update(getTemperature(), getHumiditiy(), getPressure());</span><br><span class=\"line\">    forecastDisplay.update(getTemperature(), getHumiditiy(), getPressure());</span><br><span class=\"line\">    ......</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<p></p>\n<blockquote>\n<p>+=</p>\n</blockquote>\n<p>subjectobserver</p>\n<p><strong></strong><strong></strong>.</p>\n<p>observer/observer</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"https://i.loli.net/2020/06/12/cwTWVXNpIQ5ebGo.png\" alt=\"Screenshot from 2020-06-12 18-03-04.png\"></p>\n<p>subjectsubjectObserver</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CurrentConditionsDisplay</span><span class=\"params\">(Subject weatherData)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.weatherData = weatherData;</span><br><span class=\"line\">    weatherData.registerObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>apijavautil</p>\n<p><a href=\"https://github.com/Sebastian-Getts/designPatternsPractice\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>JavaBeansSwingRMI</p>"},{"title":"predict the winner","date":"2021-05-14T07:59:32.000Z","_content":"\n[LeetCode]([Predict the Winner - LeetCode](https://leetcode.com/problems/predict-the-winner/))blogdp\n\n<!-- more -->\n\n# \n\n\n\n\n\n1. {152}125\n\n2{1, 5, 233, 7}233\n\n# \n\nij\n\n1. ii+1ji+1i+2jji+1j-1min \n   - score.i + min(score.i+1, score.j-1)j\n   - score.i + min(score.i+2, score.j)i\n2. jij-1ii+1j-1j-1i+1j-2\n   - score.j + min(score.i+1, j-1)i\n   - score.j + min(score.i, score.j-2)j\n\nMath.max()\n\n## \n\n```java\npublic boolean predictWinner(int[] nums){\n    int total = 0;\n    for(int num : nums) total += num;\n    int firstPlayer = helper(nums, 0, nums.length-1);\n\n    return firstPlayer >= total - firstPlayer;\n}\n\nprivate int helper(int[] nums, int i, int j){\n    if(i > j) return 0;\n    if(i == j) return nums[i];\n\n    return Math.max(\n        nums[i] + Math.min(helper(nums, i+1, j-1), helper(nums, i+2, j)),\n        nums[j] + Math.min(helper(nums, i+1, j-1), helper(nums, i, j-2))\n    );\n}\n```\n\n{1,5,2}{1,5}\n\n## \n\n```java\npublic boolean predictWinner(int[] nums){\n    int total = 0;\n    for(int num : nums) total += num;\n    int len = nums.length;\n    int[][] memo = new int[len][len];\n    Arrays.fill(memo, -1);\n    int firstPlayer = helper(nums, 0, len-1, memo);\n\n    return firstPlayer >= total - firstPlayer;\n}\n\nprivate int helper(int[] nums, int i, int j){\n    if(i > j) return 0;\n    if(i == j) return nums[i];\n    if(memo[i][j] != -1) return memo[i][j];\n    int score = Math.max(\n        nums[i] + Math.min(helper(nums, i+1, j-1, memo), helper(nums, i+2, j, memo)),\n        nums[j] + Math.min(helper(nums, i+1, j-1, memo), helper(nums, i, j-2, memo))\n    );\n    memo[i][j] = score;\n\n    return score;\n}\n```\n","source":"_posts/predict-the-winner.md","raw":"---\ntitle: predict the winner\ndate: 2021-05-14 15:59:32\ncategories: leetcode\ntags: dp\n---\n\n[LeetCode]([Predict the Winner - LeetCode](https://leetcode.com/problems/predict-the-winner/))blogdp\n\n<!-- more -->\n\n# \n\n\n\n\n\n1. {152}125\n\n2{1, 5, 233, 7}233\n\n# \n\nij\n\n1. ii+1ji+1i+2jji+1j-1min \n   - score.i + min(score.i+1, score.j-1)j\n   - score.i + min(score.i+2, score.j)i\n2. jij-1ii+1j-1j-1i+1j-2\n   - score.j + min(score.i+1, j-1)i\n   - score.j + min(score.i, score.j-2)j\n\nMath.max()\n\n## \n\n```java\npublic boolean predictWinner(int[] nums){\n    int total = 0;\n    for(int num : nums) total += num;\n    int firstPlayer = helper(nums, 0, nums.length-1);\n\n    return firstPlayer >= total - firstPlayer;\n}\n\nprivate int helper(int[] nums, int i, int j){\n    if(i > j) return 0;\n    if(i == j) return nums[i];\n\n    return Math.max(\n        nums[i] + Math.min(helper(nums, i+1, j-1), helper(nums, i+2, j)),\n        nums[j] + Math.min(helper(nums, i+1, j-1), helper(nums, i, j-2))\n    );\n}\n```\n\n{1,5,2}{1,5}\n\n## \n\n```java\npublic boolean predictWinner(int[] nums){\n    int total = 0;\n    for(int num : nums) total += num;\n    int len = nums.length;\n    int[][] memo = new int[len][len];\n    Arrays.fill(memo, -1);\n    int firstPlayer = helper(nums, 0, len-1, memo);\n\n    return firstPlayer >= total - firstPlayer;\n}\n\nprivate int helper(int[] nums, int i, int j){\n    if(i > j) return 0;\n    if(i == j) return nums[i];\n    if(memo[i][j] != -1) return memo[i][j];\n    int score = Math.max(\n        nums[i] + Math.min(helper(nums, i+1, j-1, memo), helper(nums, i+2, j, memo)),\n        nums[j] + Math.min(helper(nums, i+1, j-1, memo), helper(nums, i, j-2, memo))\n    );\n    memo[i][j] = score;\n\n    return score;\n}\n```\n","slug":"predict-the-winner","published":1,"updated":"2022-12-09T08:55:54.158Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwm003c8py0dafyf2an","content":"<p>[LeetCode](<a class=\"link\"   href=\"https://leetcode.com/problems/predict-the-winner/\" >Predict the Winner - LeetCode<i class=\"fas fa-external-link-alt\"></i></a>)blogdp</p>\n<span id=\"more\"></span>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p>1. {152}125</p>\n<p>2{1, 5, 233, 7}233</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>ij</p>\n<ol>\n<li>ii+1ji+1i+2jji+1j-1min <ul>\n<li>score.i + min(score.i+1, score.j-1)j</li>\n<li>score.i + min(score.i+2, score.j)i</li>\n</ul>\n</li>\n<li>jij-1ii+1j-1j-1i+1j-2<ul>\n<li>score.j + min(score.i+1, j-1)i</li>\n<li>score.j + min(score.i, score.j-2)j</li>\n</ul>\n</li>\n</ol>\n<p>Math.max()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">predictWinner</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> total = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : nums) total += num;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> firstPlayer = helper(nums, <span class=\"number\">0</span>, nums.length-<span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> firstPlayer &gt;= total - firstPlayer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; j) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i == j) <span class=\"keyword\">return</span> nums[i];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> Math.max(</span><br><span class=\"line\">        nums[i] + Math.min(helper(nums, i+<span class=\"number\">1</span>, j-<span class=\"number\">1</span>), helper(nums, i+<span class=\"number\">2</span>, j)),</span><br><span class=\"line\">        nums[j] + Math.min(helper(nums, i+<span class=\"number\">1</span>, j-<span class=\"number\">1</span>), helper(nums, i, j-<span class=\"number\">2</span>))</span><br><span class=\"line\">    );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>{1,5,2}{1,5}</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">predictWinner</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> total = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : nums) total += num;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = nums.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>[][] memo = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[len][len];</span><br><span class=\"line\">    Arrays.fill(memo, -<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> firstPlayer = helper(nums, <span class=\"number\">0</span>, len-<span class=\"number\">1</span>, memo);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> firstPlayer &gt;= total - firstPlayer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; j) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i == j) <span class=\"keyword\">return</span> nums[i];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(memo[i][j] != -<span class=\"number\">1</span>) <span class=\"keyword\">return</span> memo[i][j];</span><br><span class=\"line\">    <span class=\"keyword\">int</span> score = Math.max(</span><br><span class=\"line\">        nums[i] + Math.min(helper(nums, i+<span class=\"number\">1</span>, j-<span class=\"number\">1</span>, memo), helper(nums, i+<span class=\"number\">2</span>, j, memo)),</span><br><span class=\"line\">        nums[j] + Math.min(helper(nums, i+<span class=\"number\">1</span>, j-<span class=\"number\">1</span>, memo), helper(nums, i, j-<span class=\"number\">2</span>, memo))</span><br><span class=\"line\">    );</span><br><span class=\"line\">    memo[i][j] = score;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> score;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>[LeetCode](<a class=\"link\"   href=\"https://leetcode.com/problems/predict-the-winner/\" >Predict the Winner - LeetCode<i class=\"fas fa-external-link-alt\"></i></a>)blogdp</p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p>1. {152}125</p>\n<p>2{1, 5, 233, 7}233</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>ij</p>\n<ol>\n<li>ii+1ji+1i+2jji+1j-1min <ul>\n<li>score.i + min(score.i+1, score.j-1)j</li>\n<li>score.i + min(score.i+2, score.j)i</li>\n</ul>\n</li>\n<li>jij-1ii+1j-1j-1i+1j-2<ul>\n<li>score.j + min(score.i+1, j-1)i</li>\n<li>score.j + min(score.i, score.j-2)j</li>\n</ul>\n</li>\n</ol>\n<p>Math.max()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">predictWinner</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> total = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : nums) total += num;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> firstPlayer = helper(nums, <span class=\"number\">0</span>, nums.length-<span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> firstPlayer &gt;= total - firstPlayer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; j) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i == j) <span class=\"keyword\">return</span> nums[i];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> Math.max(</span><br><span class=\"line\">        nums[i] + Math.min(helper(nums, i+<span class=\"number\">1</span>, j-<span class=\"number\">1</span>), helper(nums, i+<span class=\"number\">2</span>, j)),</span><br><span class=\"line\">        nums[j] + Math.min(helper(nums, i+<span class=\"number\">1</span>, j-<span class=\"number\">1</span>), helper(nums, i, j-<span class=\"number\">2</span>))</span><br><span class=\"line\">    );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>{1,5,2}{1,5}</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">predictWinner</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> total = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> num : nums) total += num;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = nums.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>[][] memo = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[len][len];</span><br><span class=\"line\">    Arrays.fill(memo, -<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> firstPlayer = helper(nums, <span class=\"number\">0</span>, len-<span class=\"number\">1</span>, memo);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> firstPlayer &gt;= total - firstPlayer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; j) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i == j) <span class=\"keyword\">return</span> nums[i];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(memo[i][j] != -<span class=\"number\">1</span>) <span class=\"keyword\">return</span> memo[i][j];</span><br><span class=\"line\">    <span class=\"keyword\">int</span> score = Math.max(</span><br><span class=\"line\">        nums[i] + Math.min(helper(nums, i+<span class=\"number\">1</span>, j-<span class=\"number\">1</span>, memo), helper(nums, i+<span class=\"number\">2</span>, j, memo)),</span><br><span class=\"line\">        nums[j] + Math.min(helper(nums, i+<span class=\"number\">1</span>, j-<span class=\"number\">1</span>, memo), helper(nums, i, j-<span class=\"number\">2</span>, memo))</span><br><span class=\"line\">    );</span><br><span class=\"line\">    memo[i][j] = score;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> score;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"primeNumber","date":"2022-12-18T09:07:24.000Z","_content":"\n********\n\n<!-- more -->\n\n## \n2357911n\n```java\nprivate List<Integer> helper(int n) {\n\tList<Integer> list = new ArrayList<>();\n\tboolean[] primeRec = new boolean[n+1];\n\tfor(int i=2; i<=n; i++) {\n\t\tfor(int j=2; i*j<=n; j++) {\n\t\t\tprimeRec[i*j] = true;\n\t\t}\n\t}\n\tfor(int i=2; i<primeRec.length; i++) {\n\t\tif(!primeRec[i]) list.add(i);\n\t}\n\n\treturn list;\n}\n```\n\n\n## \n90`2, 3, 3, 5`*Pollard Rho*\n1. nk\n2. knk\n3. nkknkn2\n4. nkk2\n```java\nprivate List<Integer> helper(int n) {\n\tList<Integer> list = new ArrayList<>();\n\tList<Integer> primeList = getPrime(n);\n\tint i = 0;\n\tint k = primeList.get(i++);\n\twhile(true) {\n\t\tif(k == n) {\n\t\t\tlist.add(k);\n\t\t\tbreak;\n\t\t}\n\t\tif(n % k == 0) {\n\t\t\tlist.add(k);\n\t\t\tn /= k;\n\t\t} else {\n\t\t\tk = primeList.get(i++);\n\t\t}\n\t}\n\n\treturn list;\n}\n```","source":"_posts/primeNumber.md","raw":"---\ntitle: primeNumber\ndate: 2022-12-18 17:07:24\ncategories: leetcode\ntags: prime\n---\n\n********\n\n<!-- more -->\n\n## \n2357911n\n```java\nprivate List<Integer> helper(int n) {\n\tList<Integer> list = new ArrayList<>();\n\tboolean[] primeRec = new boolean[n+1];\n\tfor(int i=2; i<=n; i++) {\n\t\tfor(int j=2; i*j<=n; j++) {\n\t\t\tprimeRec[i*j] = true;\n\t\t}\n\t}\n\tfor(int i=2; i<primeRec.length; i++) {\n\t\tif(!primeRec[i]) list.add(i);\n\t}\n\n\treturn list;\n}\n```\n\n\n## \n90`2, 3, 3, 5`*Pollard Rho*\n1. nk\n2. knk\n3. nkknkn2\n4. nkk2\n```java\nprivate List<Integer> helper(int n) {\n\tList<Integer> list = new ArrayList<>();\n\tList<Integer> primeList = getPrime(n);\n\tint i = 0;\n\tint k = primeList.get(i++);\n\twhile(true) {\n\t\tif(k == n) {\n\t\t\tlist.add(k);\n\t\t\tbreak;\n\t\t}\n\t\tif(n % k == 0) {\n\t\t\tlist.add(k);\n\t\t\tn /= k;\n\t\t} else {\n\t\t\tk = primeList.get(i++);\n\t\t}\n\t}\n\n\treturn list;\n}\n```","slug":"primeNumber","published":1,"updated":"2022-12-18T09:32:26.777Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwm003e8py02xgza73i","content":"<p><strong></strong><strong></strong></p>\n<span id=\"more\"></span>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>2357911n</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;Integer&gt; <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">\tList&lt;Integer&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">\t<span class=\"keyword\">boolean</span>[] primeRec = <span class=\"keyword\">new</span> <span class=\"keyword\">boolean</span>[n+<span class=\"number\">1</span>];</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">2</span>; i&lt;=n; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">2</span>; i*j&lt;=n; j++) &#123;</span><br><span class=\"line\">\t\t\tprimeRec[i*j] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">2</span>; i&lt;primeRec.length; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!primeRec[i]) list.add(i);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>90<code>2, 3, 3, 5</code><em>Pollard Rho</em></p>\n<ol>\n<li>nk</li>\n<li>knk</li>\n<li>nkknkn2</li>\n<li>nkk2<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;Integer&gt; <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">\tList&lt;Integer&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">\tList&lt;Integer&gt; primeList = getPrime(n);</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> k = primeList.get(i++);</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(k == n) &#123;</span><br><span class=\"line\">\t\t\tlist.add(k);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(n % k == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\tlist.add(k);</span><br><span class=\"line\">\t\t\tn /= k;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tk = primeList.get(i++);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n","site":{"data":{}},"excerpt":"<p><strong></strong><strong></strong></p>","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>2357911n</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;Integer&gt; <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">\tList&lt;Integer&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">\t<span class=\"keyword\">boolean</span>[] primeRec = <span class=\"keyword\">new</span> <span class=\"keyword\">boolean</span>[n+<span class=\"number\">1</span>];</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">2</span>; i&lt;=n; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">2</span>; i*j&lt;=n; j++) &#123;</span><br><span class=\"line\">\t\t\tprimeRec[i*j] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">2</span>; i&lt;primeRec.length; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(!primeRec[i]) list.add(i);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>90<code>2, 3, 3, 5</code><em>Pollard Rho</em></p>\n<ol>\n<li>nk</li>\n<li>knk</li>\n<li>nkknkn2</li>\n<li>nkk2<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;Integer&gt; <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">\tList&lt;Integer&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">\tList&lt;Integer&gt; primeList = getPrime(n);</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> k = primeList.get(i++);</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(k == n) &#123;</span><br><span class=\"line\">\t\t\tlist.add(k);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(n % k == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\tlist.add(k);</span><br><span class=\"line\">\t\t\tn /= k;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tk = primeList.get(i++);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>"},{"title":"redis","date":"2020-06-09T13:54:01.000Z","_content":"\nredisredis[reference](https://github.com/antirez/redis)\n\n<!--more-->\n\n# \n\nredis: ****************nosql\n\n## nosql\n\nnosql\n\n1. \n   - \n   - \n   - \n2.  **memcache**\n3. copy\n\nmysqlMyISAM****Innodb****\n\nmysql10+\n\n### \n\n1. key valuejava\n2. 8/11/\n3. \n4. \n5. \n6. \n7. CAPBASE\n8. Volume, Variety, Veiocity\n\n\n\nMongoDB\n\nMySQL\n\nFastDFS, GFS, HDFS, OSS...\n\nRedisTairMemcache\n\n==== \n\n### \n\nMongoDB\n\n### KV\n\nRedisTair\n\n### \n\nHBase\n\n\n\n### \n\n\n\nNeo4jInfoGrid\n\n# Redis\n\nRemote Dictionary Server. Capi\n\n- rdbaof\n- \n\n## \n\n\n\n```bash\nredis-benchmark -h localhost -p 6379 -100 -n 100000\n```\n\n## \n\n160 \n\n### GEOSPATIAL\n\nGETSET\n\n## springboot\n\n<2.0 jedisBIOjedis pool\n\n>2.0 lettuceNIOnetty\n\n## rdb\n\nrdb\n\nredisrdbrdbredis databse/\n\n```flow\nstart=>start: start\nend=>end: end\ncondition=>condition: rdb\nrdbfile=>inputoutput: dump.rdb\noperation=>operation: go on dealing with\n\nstart->condition\ncondition(yes)->rdbfile->end\ncondition(no)->operation->end\n```\n\n#### \n\n1. save\n2. flushall\n3. redis\n\ndump.rdb\n\n#### rdb\n\n```bash\nconfig get dir\n```\n\n#### \n\n1. \n2. 90srdb60s\n\n#### \n\n1. \n2. fork\n\n## AOF\n\nAppend Only File history\n\n- \n- \n\nredisaofredis\n\naof `redis-check-aof --fix`\n\n### \n\n1. \n2. \n\n### \n\n1. aofrdbrdb\n2. rdbaof\n\n**rdb**\n\n## \n\nredisredis\n\n\n\nreidsredis20G\n\nredis\n\n### \n\n```shell\ninfo replication # \n```\n\n\n\n```shell\nSLAVEOF ip:port # ip:port\n```\n\n****\n\n#### \n\n`info replication`\n\n\n\n-  masterslaver\n- \n\nmaster\n\n### \n\nSentinelRedis2.8\n\nRedisredis\n\n#### \n\n1. \n2. \n\n#### \n\n1. \n2. \n\n## redis\n\n### \n\n```flow\nstart=>start: request\nend=>end: response\ncondition=>condition: redis\nop1=>operation: select in mysql\nstart->condition\ncondition(yes)->end\ncondition(no)->op1->end\n```\n\nredisdaoredis\n\n#### \n\nhash\n\n#### \n\n### \n\n\n\n#### \n\n#### \n\n### \n\n\n\n#### redis\n\n#### \n\n#### \n\n\n","source":"_posts/redis.md","raw":"---\ntitle: redis\ndate: 2020-06-09 21:54:01\ncategories: middleware\ntags: \n- redis\n- nosql\n---\n\nredisredis[reference](https://github.com/antirez/redis)\n\n<!--more-->\n\n# \n\nredis: ****************nosql\n\n## nosql\n\nnosql\n\n1. \n   - \n   - \n   - \n2.  **memcache**\n3. copy\n\nmysqlMyISAM****Innodb****\n\nmysql10+\n\n### \n\n1. key valuejava\n2. 8/11/\n3. \n4. \n5. \n6. \n7. CAPBASE\n8. Volume, Variety, Veiocity\n\n\n\nMongoDB\n\nMySQL\n\nFastDFS, GFS, HDFS, OSS...\n\nRedisTairMemcache\n\n==== \n\n### \n\nMongoDB\n\n### KV\n\nRedisTair\n\n### \n\nHBase\n\n\n\n### \n\n\n\nNeo4jInfoGrid\n\n# Redis\n\nRemote Dictionary Server. Capi\n\n- rdbaof\n- \n\n## \n\n\n\n```bash\nredis-benchmark -h localhost -p 6379 -100 -n 100000\n```\n\n## \n\n160 \n\n### GEOSPATIAL\n\nGETSET\n\n## springboot\n\n<2.0 jedisBIOjedis pool\n\n>2.0 lettuceNIOnetty\n\n## rdb\n\nrdb\n\nredisrdbrdbredis databse/\n\n```flow\nstart=>start: start\nend=>end: end\ncondition=>condition: rdb\nrdbfile=>inputoutput: dump.rdb\noperation=>operation: go on dealing with\n\nstart->condition\ncondition(yes)->rdbfile->end\ncondition(no)->operation->end\n```\n\n#### \n\n1. save\n2. flushall\n3. redis\n\ndump.rdb\n\n#### rdb\n\n```bash\nconfig get dir\n```\n\n#### \n\n1. \n2. 90srdb60s\n\n#### \n\n1. \n2. fork\n\n## AOF\n\nAppend Only File history\n\n- \n- \n\nredisaofredis\n\naof `redis-check-aof --fix`\n\n### \n\n1. \n2. \n\n### \n\n1. aofrdbrdb\n2. rdbaof\n\n**rdb**\n\n## \n\nredisredis\n\n\n\nreidsredis20G\n\nredis\n\n### \n\n```shell\ninfo replication # \n```\n\n\n\n```shell\nSLAVEOF ip:port # ip:port\n```\n\n****\n\n#### \n\n`info replication`\n\n\n\n-  masterslaver\n- \n\nmaster\n\n### \n\nSentinelRedis2.8\n\nRedisredis\n\n#### \n\n1. \n2. \n\n#### \n\n1. \n2. \n\n## redis\n\n### \n\n```flow\nstart=>start: request\nend=>end: response\ncondition=>condition: redis\nop1=>operation: select in mysql\nstart->condition\ncondition(yes)->end\ncondition(no)->op1->end\n```\n\nredisdaoredis\n\n#### \n\nhash\n\n#### \n\n### \n\n\n\n#### \n\n#### \n\n### \n\n\n\n#### redis\n\n#### \n\n#### \n\n\n","slug":"redis","published":1,"updated":"2022-11-24T11:40:29.821Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwm003i8py08buj2qvn","content":"<p>redisredis<a href=\"https://github.com/antirez/redis\">reference</a></p>\n<span id=\"more\"></span>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>redis: <strong></strong><strong></strong><strong></strong><strong></strong>nosql</p>\n<h2 id=\"nosql\"><a href=\"#nosql\" class=\"headerlink\" title=\"nosql\"></a>nosql</h2><p>nosql</p>\n<ol>\n<li><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li> <strong>memcache</strong></li>\n<li>copy</li>\n</ol>\n<p>mysqlMyISAM<strong></strong>Innodb<strong></strong></p>\n<p>mysql10+</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>key valuejava</li>\n<li>8/11/</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>CAPBASE</li>\n<li>Volume, Variety, Veiocity</li>\n</ol>\n<p></p>\n<p>MongoDB</p>\n<p>MySQL</p>\n<p>FastDFS, GFS, HDFS, OSS</p>\n<p>RedisTairMemcache</p>\n<p>==== </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MongoDB</p>\n<h3 id=\"KV\"><a href=\"#KV\" class=\"headerlink\" title=\"KV\"></a>KV</h3><p>RedisTair</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>HBase</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>Neo4jInfoGrid</p>\n<h1 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h1><p>Remote Dictionary Server. Capi</p>\n<ul>\n<li>rdbaof</li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-benchmark -h localhost -p 6379 -100 -n 100000</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>160 </p>\n<h3 id=\"GEOSPATIAL\"><a href=\"#GEOSPATIAL\" class=\"headerlink\" title=\"GEOSPATIAL\"></a>GEOSPATIAL</h3><p>GETSET</p>\n<h2 id=\"springboot\"><a href=\"#springboot\" class=\"headerlink\" title=\"springboot\"></a>springboot</h2><p>&lt;2.0 jedisBIOjedis pool</p>\n<p>&gt;2.0 lettuceNIOnetty</p>\n<h2 id=\"rdb\"><a href=\"#rdb\" class=\"headerlink\" title=\"rdb\"></a>rdb</h2><p>rdb</p>\n<p>redisrdbrdbredis databse/</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start=&gt;start: start</span><br><span class=\"line\">end=&gt;end: end</span><br><span class=\"line\">condition=&gt;condition: rdb</span><br><span class=\"line\">rdbfile=&gt;inputoutput: dump.rdb</span><br><span class=\"line\">operation=&gt;operation: go on dealing with</span><br><span class=\"line\"></span><br><span class=\"line\">start-&gt;condition</span><br><span class=\"line\">condition(yes)-&gt;rdbfile-&gt;end</span><br><span class=\"line\">condition(no)-&gt;operation-&gt;end</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>save</li>\n<li>flushall</li>\n<li>redis</li>\n</ol>\n<p>dump.rdb</p>\n<h4 id=\"rdb\"><a href=\"#rdb\" class=\"headerlink\" title=\"rdb\"></a>rdb</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">config get dir</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>90srdb60s</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>fork</li>\n</ol>\n<h2 id=\"AOF\"><a href=\"#AOF\" class=\"headerlink\" title=\"AOF\"></a>AOF</h2><p>Append Only File history</p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>redisaofredis</p>\n<p>aof <code>redis-check-aof --fix</code></p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>aofrdbrdb</li>\n<li>rdbaof</li>\n</ol>\n<p><strong>rdb</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>redisredis</p>\n<p></p>\n<p>reidsredis20G</p>\n<p>redis</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">info replication # </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SLAVEOF ip:port # ip:port</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code>info replication</code></p>\n<p></p>\n<ul>\n<li> masterslaver</li>\n<li></li>\n</ul>\n<p>master</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SentinelRedis2.8</p>\n<p>Redisredis</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start=&gt;start: request</span><br><span class=\"line\">end=&gt;end: response</span><br><span class=\"line\">condition=&gt;condition: redis</span><br><span class=\"line\">op1=&gt;operation: select in mysql</span><br><span class=\"line\">start-&gt;condition</span><br><span class=\"line\">condition(yes)-&gt;end</span><br><span class=\"line\">condition(no)-&gt;op1-&gt;end</span><br></pre></td></tr></table></figure>\n\n<p>redisdaoredis</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>hash</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h4 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n","site":{"data":{}},"excerpt":"<p>redisredis<a href=\"https://github.com/antirez/redis\">reference</a></p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>redis: <strong></strong><strong></strong><strong></strong><strong></strong>nosql</p>\n<h2 id=\"nosql\"><a href=\"#nosql\" class=\"headerlink\" title=\"nosql\"></a>nosql</h2><p>nosql</p>\n<ol>\n<li><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li> <strong>memcache</strong></li>\n<li>copy</li>\n</ol>\n<p>mysqlMyISAM<strong></strong>Innodb<strong></strong></p>\n<p>mysql10+</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>key valuejava</li>\n<li>8/11/</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>CAPBASE</li>\n<li>Volume, Variety, Veiocity</li>\n</ol>\n<p></p>\n<p>MongoDB</p>\n<p>MySQL</p>\n<p>FastDFS, GFS, HDFS, OSS</p>\n<p>RedisTairMemcache</p>\n<p>==== </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MongoDB</p>\n<h3 id=\"KV\"><a href=\"#KV\" class=\"headerlink\" title=\"KV\"></a>KV</h3><p>RedisTair</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>HBase</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>Neo4jInfoGrid</p>\n<h1 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h1><p>Remote Dictionary Server. Capi</p>\n<ul>\n<li>rdbaof</li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-benchmark -h localhost -p 6379 -100 -n 100000</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>160 </p>\n<h3 id=\"GEOSPATIAL\"><a href=\"#GEOSPATIAL\" class=\"headerlink\" title=\"GEOSPATIAL\"></a>GEOSPATIAL</h3><p>GETSET</p>\n<h2 id=\"springboot\"><a href=\"#springboot\" class=\"headerlink\" title=\"springboot\"></a>springboot</h2><p>&lt;2.0 jedisBIOjedis pool</p>\n<p>&gt;2.0 lettuceNIOnetty</p>\n<h2 id=\"rdb\"><a href=\"#rdb\" class=\"headerlink\" title=\"rdb\"></a>rdb</h2><p>rdb</p>\n<p>redisrdbrdbredis databse/</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start=&gt;start: start</span><br><span class=\"line\">end=&gt;end: end</span><br><span class=\"line\">condition=&gt;condition: rdb</span><br><span class=\"line\">rdbfile=&gt;inputoutput: dump.rdb</span><br><span class=\"line\">operation=&gt;operation: go on dealing with</span><br><span class=\"line\"></span><br><span class=\"line\">start-&gt;condition</span><br><span class=\"line\">condition(yes)-&gt;rdbfile-&gt;end</span><br><span class=\"line\">condition(no)-&gt;operation-&gt;end</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>save</li>\n<li>flushall</li>\n<li>redis</li>\n</ol>\n<p>dump.rdb</p>\n<h4 id=\"rdb\"><a href=\"#rdb\" class=\"headerlink\" title=\"rdb\"></a>rdb</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">config get dir</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>90srdb60s</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>fork</li>\n</ol>\n<h2 id=\"AOF\"><a href=\"#AOF\" class=\"headerlink\" title=\"AOF\"></a>AOF</h2><p>Append Only File history</p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>redisaofredis</p>\n<p>aof <code>redis-check-aof --fix</code></p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>aofrdbrdb</li>\n<li>rdbaof</li>\n</ol>\n<p><strong>rdb</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>redisredis</p>\n<p></p>\n<p>reidsredis20G</p>\n<p>redis</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">info replication # </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SLAVEOF ip:port # ip:port</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code>info replication</code></p>\n<p></p>\n<ul>\n<li> masterslaver</li>\n<li></li>\n</ul>\n<p>master</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SentinelRedis2.8</p>\n<p>Redisredis</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start=&gt;start: request</span><br><span class=\"line\">end=&gt;end: response</span><br><span class=\"line\">condition=&gt;condition: redis</span><br><span class=\"line\">op1=&gt;operation: select in mysql</span><br><span class=\"line\">start-&gt;condition</span><br><span class=\"line\">condition(yes)-&gt;end</span><br><span class=\"line\">condition(no)-&gt;op1-&gt;end</span><br></pre></td></tr></table></figure>\n\n<p>redisdaoredis</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>hash</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h4 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>"},{"title":"search suggestions system","date":"2021-05-31T14:54:11.000Z","_content":"\n5`Trie`Lee\n\n<!-- more -->\n\n# TreeMap\n\nQ: []([Explore - LeetCode](https://leetcode.com/explore/challenge/card/may-leetcoding-challenge-2021/602/week-5-may-29th-may-31st/3762/))\n\nA: treemapAPI`higherKey``ceilingKey`keykeykeykey`lowerKey``floorKey`\n\n```java\npublic List<List<String>> suggestedProducts(String[] products, String searchWord) {\n    List<List<String>> res = new ArrayList<>();\n    TreeMap<String, Integer> map = new TreeMap<>();\n    Arrays.sort(products);\n    List<String> productList = Arrays.asList(products);\n    for(int i= 0; i<products.length; i++){\n        map.put(products[i], i);\n    }\n    String key = \"\";\n    for(char c : searchWord.toCharArray()){\n        key += c;\n        String ceiling = map.ceilingKey(key);\n        // 'z'\n        String floor = map.floorKey(key + \"~\");\n        // \n        if(ceiling == null || floor == null) break;\n        // Mathmap.get(floor)+1\n        res.add(productList.subList(map.get(ceiling), Math.min(map.get(ceiling) + 3, map.get(floor) + 1)));\n    }\n    while(res.size() < searchWord.length()) res.add(new ArrayList<>());\n\n    return res;\n}\n```\n","source":"_posts/search-suggestions-system.md","raw":"---\ntitle: search suggestions system\ndate: 2021-05-31 22:54:11\ncategories: leetcode\ntags: treeMap\n---\n\n5`Trie`Lee\n\n<!-- more -->\n\n# TreeMap\n\nQ: []([Explore - LeetCode](https://leetcode.com/explore/challenge/card/may-leetcoding-challenge-2021/602/week-5-may-29th-may-31st/3762/))\n\nA: treemapAPI`higherKey``ceilingKey`keykeykeykey`lowerKey``floorKey`\n\n```java\npublic List<List<String>> suggestedProducts(String[] products, String searchWord) {\n    List<List<String>> res = new ArrayList<>();\n    TreeMap<String, Integer> map = new TreeMap<>();\n    Arrays.sort(products);\n    List<String> productList = Arrays.asList(products);\n    for(int i= 0; i<products.length; i++){\n        map.put(products[i], i);\n    }\n    String key = \"\";\n    for(char c : searchWord.toCharArray()){\n        key += c;\n        String ceiling = map.ceilingKey(key);\n        // 'z'\n        String floor = map.floorKey(key + \"~\");\n        // \n        if(ceiling == null || floor == null) break;\n        // Mathmap.get(floor)+1\n        res.add(productList.subList(map.get(ceiling), Math.min(map.get(ceiling) + 3, map.get(floor) + 1)));\n    }\n    while(res.size() < searchWord.length()) res.add(new ArrayList<>());\n\n    return res;\n}\n```\n","slug":"search-suggestions-system","published":1,"updated":"2022-12-09T09:00:11.095Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwn003l8py0161y1r0v","content":"<p>5<code>Trie</code>Lee</p>\n<span id=\"more\"></span>\n\n<h1 id=\"TreeMap\"><a href=\"#TreeMap\" class=\"headerlink\" title=\"TreeMap\"></a>TreeMap</h1><p>Q: [](<a class=\"link\"   href=\"https://leetcode.com/explore/challenge/card/may-leetcoding-challenge-2021/602/week-5-may-29th-may-31st/3762/\" >Explore - LeetCode<i class=\"fas fa-external-link-alt\"></i></a>)</p>\n<p>A: treemapAPI<code>higherKey</code><code>ceilingKey</code>keykeykeykey<code>lowerKey</code><code>floorKey</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;String&gt;&gt; suggestedProducts(String[] products, String searchWord) &#123;</span><br><span class=\"line\">    List&lt;List&lt;String&gt;&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    TreeMap&lt;String, Integer&gt; map = <span class=\"keyword\">new</span> TreeMap&lt;&gt;();</span><br><span class=\"line\">    Arrays.sort(products);</span><br><span class=\"line\">    List&lt;String&gt; productList = Arrays.asList(products);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i= <span class=\"number\">0</span>; i&lt;products.length; i++)&#123;</span><br><span class=\"line\">        map.put(products[i], i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    String key = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">char</span> c : searchWord.toCharArray())&#123;</span><br><span class=\"line\">        key += c;</span><br><span class=\"line\">        String ceiling = map.ceilingKey(key);</span><br><span class=\"line\">        <span class=\"comment\">// &#x27;z&#x27;</span></span><br><span class=\"line\">        String floor = map.floorKey(key + <span class=\"string\">&quot;~&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(ceiling == <span class=\"keyword\">null</span> || floor == <span class=\"keyword\">null</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"comment\">// Mathmap.get(floor)+1</span></span><br><span class=\"line\">        res.add(productList.subList(map.get(ceiling), Math.min(map.get(ceiling) + <span class=\"number\">3</span>, map.get(floor) + <span class=\"number\">1</span>)));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(res.size() &lt; searchWord.length()) res.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>5<code>Trie</code>Lee</p>","more":"<h1 id=\"TreeMap\"><a href=\"#TreeMap\" class=\"headerlink\" title=\"TreeMap\"></a>TreeMap</h1><p>Q: [](<a class=\"link\"   href=\"https://leetcode.com/explore/challenge/card/may-leetcoding-challenge-2021/602/week-5-may-29th-may-31st/3762/\" >Explore - LeetCode<i class=\"fas fa-external-link-alt\"></i></a>)</p>\n<p>A: treemapAPI<code>higherKey</code><code>ceilingKey</code>keykeykeykey<code>lowerKey</code><code>floorKey</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;List&lt;String&gt;&gt; suggestedProducts(String[] products, String searchWord) &#123;</span><br><span class=\"line\">    List&lt;List&lt;String&gt;&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    TreeMap&lt;String, Integer&gt; map = <span class=\"keyword\">new</span> TreeMap&lt;&gt;();</span><br><span class=\"line\">    Arrays.sort(products);</span><br><span class=\"line\">    List&lt;String&gt; productList = Arrays.asList(products);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i= <span class=\"number\">0</span>; i&lt;products.length; i++)&#123;</span><br><span class=\"line\">        map.put(products[i], i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    String key = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">char</span> c : searchWord.toCharArray())&#123;</span><br><span class=\"line\">        key += c;</span><br><span class=\"line\">        String ceiling = map.ceilingKey(key);</span><br><span class=\"line\">        <span class=\"comment\">// &#x27;z&#x27;</span></span><br><span class=\"line\">        String floor = map.floorKey(key + <span class=\"string\">&quot;~&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(ceiling == <span class=\"keyword\">null</span> || floor == <span class=\"keyword\">null</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"comment\">// Mathmap.get(floor)+1</span></span><br><span class=\"line\">        res.add(productList.subList(map.get(ceiling), Math.min(map.get(ceiling) + <span class=\"number\">3</span>, map.get(floor) + <span class=\"number\">1</span>)));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(res.size() &lt; searchWord.length()) res.add(<span class=\"keyword\">new</span> ArrayList&lt;&gt;());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"spring_transactional","date":"2022-09-01T03:13:45.000Z","_content":"\nSpring\n\n<!-- more -->\n\n```java\n@Transactional(rollbackFor = Exception.class, propagation = Propagation.REQUIRED)\npublic void testMyTransaction(String s) {\n    // ...\n}\n```\n\n\n\n## \n\n\n\n```java\npublic enum Propagation {\n    REQUIRED(0),\n    SUPPORTS(1),\n    MANDATORY(2),\n    REQUIRES_NEW(3),\n    NOT_SUPPORTED(4),\n    NEVER(5),\n    NESTED(6);\n\n    private final int value;\n\n    private Propagation(int value) {\n        this.value = value;\n    }\n\n    public int value() {\n        return this.value;\n    }\n}\n```\n\n**7**`REQUIRED`\n```java\n// NESTED || REQUIRES_NEW\nA() {\n    // NESTED || REQUIRES_NEW\n    B();\n    // NESTED || REQUIRES_NEW\n    C();\n}\n```\n- `NESTED`BCAA`REQUIRES_NEW`\n- BC`REQUIRES_NEW`\n\n|           |                                                                                                    |\n| ------------- | ---------------------------------------------------------------------------------------------------- |\n| REQUIRED      | Support a current transaction, create a new one if none exists                                       |\n| SUPPORTS      | Support a current transaction, execute non-transactionally if none exists                            |\n| MANDATORY     | Support a current transaction, throw an exception if none exists                                     |\n| REQUIRES_NEW  | Create** a new transaction, and suspend the current transaction if one exists                        |\n| NOT_SUPPORTED | Execute non-transactionally, suspend the current transaction if one exists                           |\n| NEVER         | Execute non-transactionally, throw an exception if a transaction exists                              |\n| NESTED        | Executed within a nested transaction if a current transaction exists, behave like REQUIRED otherwise |\n","source":"_posts/spring-transactional.md","raw":"---\ntitle: spring_transactional\ndate: 2022-09-01 11:13:45\ncategories: springboot\ntags: transaction\n---\n\nSpring\n\n<!-- more -->\n\n```java\n@Transactional(rollbackFor = Exception.class, propagation = Propagation.REQUIRED)\npublic void testMyTransaction(String s) {\n    // ...\n}\n```\n\n\n\n## \n\n\n\n```java\npublic enum Propagation {\n    REQUIRED(0),\n    SUPPORTS(1),\n    MANDATORY(2),\n    REQUIRES_NEW(3),\n    NOT_SUPPORTED(4),\n    NEVER(5),\n    NESTED(6);\n\n    private final int value;\n\n    private Propagation(int value) {\n        this.value = value;\n    }\n\n    public int value() {\n        return this.value;\n    }\n}\n```\n\n**7**`REQUIRED`\n```java\n// NESTED || REQUIRES_NEW\nA() {\n    // NESTED || REQUIRES_NEW\n    B();\n    // NESTED || REQUIRES_NEW\n    C();\n}\n```\n- `NESTED`BCAA`REQUIRES_NEW`\n- BC`REQUIRES_NEW`\n\n|           |                                                                                                    |\n| ------------- | ---------------------------------------------------------------------------------------------------- |\n| REQUIRED      | Support a current transaction, create a new one if none exists                                       |\n| SUPPORTS      | Support a current transaction, execute non-transactionally if none exists                            |\n| MANDATORY     | Support a current transaction, throw an exception if none exists                                     |\n| REQUIRES_NEW  | Create** a new transaction, and suspend the current transaction if one exists                        |\n| NOT_SUPPORTED | Execute non-transactionally, suspend the current transaction if one exists                           |\n| NEVER         | Execute non-transactionally, throw an exception if a transaction exists                              |\n| NESTED        | Executed within a nested transaction if a current transaction exists, behave like REQUIRED otherwise |\n","slug":"spring-transactional","published":1,"updated":"2022-12-09T14:45:51.520Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwn003p8py00ucjf3rg","content":"<p>Spring</p>\n<span id=\"more\"></span>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class, propagation = Propagation.REQUIRED)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testMyTransaction</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">Propagation</span> </span>&#123;</span><br><span class=\"line\">    REQUIRED(<span class=\"number\">0</span>),</span><br><span class=\"line\">    SUPPORTS(<span class=\"number\">1</span>),</span><br><span class=\"line\">    MANDATORY(<span class=\"number\">2</span>),</span><br><span class=\"line\">    REQUIRES_NEW(<span class=\"number\">3</span>),</span><br><span class=\"line\">    NOT_SUPPORTED(<span class=\"number\">4</span>),</span><br><span class=\"line\">    NEVER(<span class=\"number\">5</span>),</span><br><span class=\"line\">    NESTED(<span class=\"number\">6</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Propagation</span><span class=\"params\">(<span class=\"keyword\">int</span> value)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">value</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>7</strong><code>REQUIRED</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// NESTED || REQUIRES_NEW</span></span><br><span class=\"line\">A() &#123;</span><br><span class=\"line\">    <span class=\"comment\">// NESTED || REQUIRES_NEW</span></span><br><span class=\"line\">    B();</span><br><span class=\"line\">    <span class=\"comment\">// NESTED || REQUIRES_NEW</span></span><br><span class=\"line\">    C();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>NESTED</code>BCAA<code>REQUIRES_NEW</code></li>\n<li>BC<code>REQUIRES_NEW</code></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>REQUIRED</td>\n<td>Support a current transaction, create a new one if none exists</td>\n</tr>\n<tr>\n<td>SUPPORTS</td>\n<td>Support a current transaction, execute non-transactionally if none exists</td>\n</tr>\n<tr>\n<td>MANDATORY</td>\n<td>Support a current transaction, throw an exception if none exists</td>\n</tr>\n<tr>\n<td>REQUIRES_NEW</td>\n<td>Create** a new transaction, and suspend the current transaction if one exists</td>\n</tr>\n<tr>\n<td>NOT_SUPPORTED</td>\n<td>Execute non-transactionally, suspend the current transaction if one exists</td>\n</tr>\n<tr>\n<td>NEVER</td>\n<td>Execute non-transactionally, throw an exception if a transaction exists</td>\n</tr>\n<tr>\n<td>NESTED</td>\n<td>Executed within a nested transaction if a current transaction exists, behave like REQUIRED otherwise</td>\n</tr>\n</tbody></table>\n","site":{"data":{}},"excerpt":"<p>Spring</p>","more":"<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class, propagation = Propagation.REQUIRED)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testMyTransaction</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">Propagation</span> </span>&#123;</span><br><span class=\"line\">    REQUIRED(<span class=\"number\">0</span>),</span><br><span class=\"line\">    SUPPORTS(<span class=\"number\">1</span>),</span><br><span class=\"line\">    MANDATORY(<span class=\"number\">2</span>),</span><br><span class=\"line\">    REQUIRES_NEW(<span class=\"number\">3</span>),</span><br><span class=\"line\">    NOT_SUPPORTED(<span class=\"number\">4</span>),</span><br><span class=\"line\">    NEVER(<span class=\"number\">5</span>),</span><br><span class=\"line\">    NESTED(<span class=\"number\">6</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Propagation</span><span class=\"params\">(<span class=\"keyword\">int</span> value)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">value</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>7</strong><code>REQUIRED</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// NESTED || REQUIRES_NEW</span></span><br><span class=\"line\">A() &#123;</span><br><span class=\"line\">    <span class=\"comment\">// NESTED || REQUIRES_NEW</span></span><br><span class=\"line\">    B();</span><br><span class=\"line\">    <span class=\"comment\">// NESTED || REQUIRES_NEW</span></span><br><span class=\"line\">    C();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>NESTED</code>BCAA<code>REQUIRES_NEW</code></li>\n<li>BC<code>REQUIRES_NEW</code></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>REQUIRED</td>\n<td>Support a current transaction, create a new one if none exists</td>\n</tr>\n<tr>\n<td>SUPPORTS</td>\n<td>Support a current transaction, execute non-transactionally if none exists</td>\n</tr>\n<tr>\n<td>MANDATORY</td>\n<td>Support a current transaction, throw an exception if none exists</td>\n</tr>\n<tr>\n<td>REQUIRES_NEW</td>\n<td>Create** a new transaction, and suspend the current transaction if one exists</td>\n</tr>\n<tr>\n<td>NOT_SUPPORTED</td>\n<td>Execute non-transactionally, suspend the current transaction if one exists</td>\n</tr>\n<tr>\n<td>NEVER</td>\n<td>Execute non-transactionally, throw an exception if a transaction exists</td>\n</tr>\n<tr>\n<td>NESTED</td>\n<td>Executed within a nested transaction if a current transaction exists, behave like REQUIRED otherwise</td>\n</tr>\n</tbody></table>"},{"title":"overlapping interval","date":"2023-01-16T04:11:54.000Z","_content":"","source":"_posts/overlapping-interval.md","raw":"---\ntitle: overlapping interval\ndate: 2023-01-16 12:11:54\ntags:\n---\n","slug":"overlapping-interval","published":1,"updated":"2023-01-16T04:11:54.958Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwn003s8py03i35bev1","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"Springboot-servlet","date":"2021-02-28T14:01:17.000Z","_content":"\nSpringBootservlet\n\n<!-- more -->\n\n<!-- toc -->\n\njava webtomcattomcatspringboot\n\n# \n\nspringBootrefresh`onRefresh()`****`SpringApplication`classweb`ServletWebServerApplicationContext`\n\n```java\n@Override\nprotected void onRefresh() {\n    super.onRefresh();\n    try {\n        // web\n        createWebServer();\n    }\n    catch (Throwable ex) {\n        throw new ApplicationContextException(\"Unable to start web server\", ex);\n    }\n}\n```\n\n# \n\n\n\n```java\nprivate void createWebServer() {\n    // volatile\n    WebServer webServer = this.webServer;\n    // servlet\n    ServletContext servletContext = getServletContext();\n    // null\n    if (webServer == null && servletContext == null) {\n        // nullweb\n        ServletWebServerFactory factory = getWebServerFactory();\n        // web\n        this.webServer = factory.getWebServer(getSelfInitializer());\n        getBeanFactory().registerSingleton(\"webServerGracefulShutdown\",\n                                           new WebServerGracefulShutdownLifecycle(this.webServer));\n        getBeanFactory().registerSingleton(\"webServerStartStop\",\n                                           new WebServerStartStopLifecycle(this, this.webServer));\n    }\n    // null\n    else if (servletContext != null) {\n        try {\n            getSelfInitializer().onStartup(servletContext);\n        }\n        catch (ServletException ex) {\n            throw new ApplicationContextException(\"Cannot initialize servlet context\", ex);\n        }\n    }\n    initPropertySources();\n}\n```\n\n## getWebServerFactory\n\nSPI\n\n```java\nprotected ServletWebServerFactory getWebServerFactory() {\n    // Use bean names so that we don't consider the hierarchy\n    String[] beanNames = getBeanFactory().getBeanNamesForType(ServletWebServerFactory.class);\n    if (beanNames.length == 0) {\n        throw new ApplicationContextException(\"Unable to start ServletWebServerApplicationContext due to missing \"\n                                              + \"ServletWebServerFactory bean.\");\n    }\n    if (beanNames.length > 1) {\n        throw new ApplicationContextException(\"Unable to start ServletWebServerApplicationContext due to multiple \"\n                                              + \"ServletWebServerFactory beans : \" + StringUtils.arrayToCommaDelimitedString(beanNames));\n    }\n    return getBeanFactory().getBean(beanNames[0], ServletWebServerFactory.class);\n}\n```\n\n## getSelfInitializer\n\n\n\n```java\nprivate org.springframework.boot.web.servlet.ServletContextInitializer getSelfInitializer() {\n    return this::selfInitialize;\n}\n```\n\n\n\n# getWebServer\n\n```java\npublic WebServer getWebServer(ServletContextInitializer... initializers) {\n    if (this.disableMBeanRegistry) {\n        Registry.disableRegistry();\n    }\n    // tomcat\n    Tomcat tomcat = new Tomcat();\n    File baseDir = (this.baseDirectory != null) ? this.baseDirectory : createTempDir(\"tomcat\");\n    // \n    tomcat.setBaseDir(baseDir.getAbsolutePath());\n    Connector connector = new Connector(this.protocol);\n    connector.setThrowOnFailure(true);\n    tomcat.getService().addConnector(connector);\n    customizeConnector(connector);\n    tomcat.setConnector(connector);\n    tomcat.getHost().setAutoDeploy(false);\n    configureEngine(tomcat.getEngine());\n    for (Connector additionalConnector : this.additionalTomcatConnectors) {\n        tomcat.getService().addConnector(additionalConnector);\n    }\n    // \n    prepareContext(tomcat.getHost(), initializers);\n    // \n    return getTomcatWebServer(tomcat);\n}\n```\n\ntomcattomcat:\n\n```java\nprotected TomcatWebServer getTomcatWebServer(Tomcat tomcat) {\n    // \n    return new TomcatWebServer(tomcat, getPort() >= 0, getShutdown());\n}\n```\n\n```java\npublic TomcatWebServer(Tomcat tomcat, boolean autoStart, Shutdown shutdown) {\n    Assert.notNull(tomcat, \"Tomcat Server must not be null\");\n    this.tomcat = tomcat;\n    this.autoStart = autoStart;\n    this.gracefulShutdown = (shutdown == Shutdown.GRACEFUL) ? new GracefulShutdown(tomcat) : null;\n    // \n    initialize();\n}\n\nprivate void initialize() throws WebServerException {\n    logger.info(\"Tomcat initialized with port(s): \" + getPortsDescription(false));\n    synchronized (this.monitor) {\n        try {\n            addInstanceIdToEngineName();\n\n            Context context = findContext();\n            context.addLifecycleListener((event) -> {\n                if (context.equals(event.getSource()) && Lifecycle.START_EVENT.equals(event.getType())) {\n                    // Remove service connectors so that protocol binding doesn't\n                    // happen when the service is started.\n                    removeServiceConnectors();\n                }\n            });\n\n            // Start the server to trigger initialization listeners\n            this.tomcat.start();\n\n            // We can re-throw failure exception directly in the main thread\n            rethrowDeferredStartupExceptions();\n\n            try {\n                ContextBindings.bindClassLoader(context, context.getNamingToken(), getClass().getClassLoader());\n            }\n            catch (NamingException ex) {\n                // Naming is not enabled. Continue\n            }\n\n            // Unlike Jetty, all Tomcat threads are daemon threads. We create a\n            // blocking non-daemon to stop immediate shutdown\n            startDaemonAwaitThread();\n        }\n        catch (Exception ex) {\n            stopSilently();\n            destroySilently();\n            throw new WebServerException(\"Unable to start embedded Tomcat\", ex);\n        }\n    }\n}\n```\n\n","source":"_posts/springboot-servlet.md","raw":"---\ntitle: Springboot-servlet\ndate: 2021-02-28 22:01:17\ncategories: springboot\ntags: servlet\n---\n\nSpringBootservlet\n\n<!-- more -->\n\n<!-- toc -->\n\njava webtomcattomcatspringboot\n\n# \n\nspringBootrefresh`onRefresh()`****`SpringApplication`classweb`ServletWebServerApplicationContext`\n\n```java\n@Override\nprotected void onRefresh() {\n    super.onRefresh();\n    try {\n        // web\n        createWebServer();\n    }\n    catch (Throwable ex) {\n        throw new ApplicationContextException(\"Unable to start web server\", ex);\n    }\n}\n```\n\n# \n\n\n\n```java\nprivate void createWebServer() {\n    // volatile\n    WebServer webServer = this.webServer;\n    // servlet\n    ServletContext servletContext = getServletContext();\n    // null\n    if (webServer == null && servletContext == null) {\n        // nullweb\n        ServletWebServerFactory factory = getWebServerFactory();\n        // web\n        this.webServer = factory.getWebServer(getSelfInitializer());\n        getBeanFactory().registerSingleton(\"webServerGracefulShutdown\",\n                                           new WebServerGracefulShutdownLifecycle(this.webServer));\n        getBeanFactory().registerSingleton(\"webServerStartStop\",\n                                           new WebServerStartStopLifecycle(this, this.webServer));\n    }\n    // null\n    else if (servletContext != null) {\n        try {\n            getSelfInitializer().onStartup(servletContext);\n        }\n        catch (ServletException ex) {\n            throw new ApplicationContextException(\"Cannot initialize servlet context\", ex);\n        }\n    }\n    initPropertySources();\n}\n```\n\n## getWebServerFactory\n\nSPI\n\n```java\nprotected ServletWebServerFactory getWebServerFactory() {\n    // Use bean names so that we don't consider the hierarchy\n    String[] beanNames = getBeanFactory().getBeanNamesForType(ServletWebServerFactory.class);\n    if (beanNames.length == 0) {\n        throw new ApplicationContextException(\"Unable to start ServletWebServerApplicationContext due to missing \"\n                                              + \"ServletWebServerFactory bean.\");\n    }\n    if (beanNames.length > 1) {\n        throw new ApplicationContextException(\"Unable to start ServletWebServerApplicationContext due to multiple \"\n                                              + \"ServletWebServerFactory beans : \" + StringUtils.arrayToCommaDelimitedString(beanNames));\n    }\n    return getBeanFactory().getBean(beanNames[0], ServletWebServerFactory.class);\n}\n```\n\n## getSelfInitializer\n\n\n\n```java\nprivate org.springframework.boot.web.servlet.ServletContextInitializer getSelfInitializer() {\n    return this::selfInitialize;\n}\n```\n\n\n\n# getWebServer\n\n```java\npublic WebServer getWebServer(ServletContextInitializer... initializers) {\n    if (this.disableMBeanRegistry) {\n        Registry.disableRegistry();\n    }\n    // tomcat\n    Tomcat tomcat = new Tomcat();\n    File baseDir = (this.baseDirectory != null) ? this.baseDirectory : createTempDir(\"tomcat\");\n    // \n    tomcat.setBaseDir(baseDir.getAbsolutePath());\n    Connector connector = new Connector(this.protocol);\n    connector.setThrowOnFailure(true);\n    tomcat.getService().addConnector(connector);\n    customizeConnector(connector);\n    tomcat.setConnector(connector);\n    tomcat.getHost().setAutoDeploy(false);\n    configureEngine(tomcat.getEngine());\n    for (Connector additionalConnector : this.additionalTomcatConnectors) {\n        tomcat.getService().addConnector(additionalConnector);\n    }\n    // \n    prepareContext(tomcat.getHost(), initializers);\n    // \n    return getTomcatWebServer(tomcat);\n}\n```\n\ntomcattomcat:\n\n```java\nprotected TomcatWebServer getTomcatWebServer(Tomcat tomcat) {\n    // \n    return new TomcatWebServer(tomcat, getPort() >= 0, getShutdown());\n}\n```\n\n```java\npublic TomcatWebServer(Tomcat tomcat, boolean autoStart, Shutdown shutdown) {\n    Assert.notNull(tomcat, \"Tomcat Server must not be null\");\n    this.tomcat = tomcat;\n    this.autoStart = autoStart;\n    this.gracefulShutdown = (shutdown == Shutdown.GRACEFUL) ? new GracefulShutdown(tomcat) : null;\n    // \n    initialize();\n}\n\nprivate void initialize() throws WebServerException {\n    logger.info(\"Tomcat initialized with port(s): \" + getPortsDescription(false));\n    synchronized (this.monitor) {\n        try {\n            addInstanceIdToEngineName();\n\n            Context context = findContext();\n            context.addLifecycleListener((event) -> {\n                if (context.equals(event.getSource()) && Lifecycle.START_EVENT.equals(event.getType())) {\n                    // Remove service connectors so that protocol binding doesn't\n                    // happen when the service is started.\n                    removeServiceConnectors();\n                }\n            });\n\n            // Start the server to trigger initialization listeners\n            this.tomcat.start();\n\n            // We can re-throw failure exception directly in the main thread\n            rethrowDeferredStartupExceptions();\n\n            try {\n                ContextBindings.bindClassLoader(context, context.getNamingToken(), getClass().getClassLoader());\n            }\n            catch (NamingException ex) {\n                // Naming is not enabled. Continue\n            }\n\n            // Unlike Jetty, all Tomcat threads are daemon threads. We create a\n            // blocking non-daemon to stop immediate shutdown\n            startDaemonAwaitThread();\n        }\n        catch (Exception ex) {\n            stopSilently();\n            destroySilently();\n            throw new WebServerException(\"Unable to start embedded Tomcat\", ex);\n        }\n    }\n}\n```\n\n","slug":"springboot-servlet","published":1,"updated":"2022-12-09T14:45:22.412Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwn003w8py06vet4n2r","content":"<p>SpringBootservlet</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<p>java webtomcattomcatspringboot</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>springBootrefresh<code>onRefresh()</code><strong></strong><code>SpringApplication</code>classweb<code>ServletWebServerApplicationContext</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onRefresh</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>.onRefresh();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// web</span></span><br><span class=\"line\">        createWebServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start web server&quot;</span>, ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">createWebServer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// volatile</span></span><br><span class=\"line\">    WebServer webServer = <span class=\"keyword\">this</span>.webServer;</span><br><span class=\"line\">    <span class=\"comment\">// servlet</span></span><br><span class=\"line\">    ServletContext servletContext = getServletContext();</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (webServer == <span class=\"keyword\">null</span> &amp;&amp; servletContext == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// nullweb</span></span><br><span class=\"line\">        ServletWebServerFactory factory = getWebServerFactory();</span><br><span class=\"line\">        <span class=\"comment\">// web</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.webServer = factory.getWebServer(getSelfInitializer());</span><br><span class=\"line\">        getBeanFactory().registerSingleton(<span class=\"string\">&quot;webServerGracefulShutdown&quot;</span>,</span><br><span class=\"line\">                                           <span class=\"keyword\">new</span> WebServerGracefulShutdownLifecycle(<span class=\"keyword\">this</span>.webServer));</span><br><span class=\"line\">        getBeanFactory().registerSingleton(<span class=\"string\">&quot;webServerStartStop&quot;</span>,</span><br><span class=\"line\">                                           <span class=\"keyword\">new</span> WebServerStartStopLifecycle(<span class=\"keyword\">this</span>, <span class=\"keyword\">this</span>.webServer));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (servletContext != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            getSelfInitializer().onStartup(servletContext);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (ServletException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Cannot initialize servlet context&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    initPropertySources();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getWebServerFactory\"><a href=\"#getWebServerFactory\" class=\"headerlink\" title=\"getWebServerFactory\"></a>getWebServerFactory</h2><p>SPI</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> ServletWebServerFactory <span class=\"title\">getWebServerFactory</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Use bean names so that we don&#x27;t consider the hierarchy</span></span><br><span class=\"line\">    String[] beanNames = getBeanFactory().getBeanNamesForType(ServletWebServerFactory.class);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanNames.length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start ServletWebServerApplicationContext due to missing &quot;</span></span><br><span class=\"line\">                                              + <span class=\"string\">&quot;ServletWebServerFactory bean.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanNames.length &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start ServletWebServerApplicationContext due to multiple &quot;</span></span><br><span class=\"line\">                                              + <span class=\"string\">&quot;ServletWebServerFactory beans : &quot;</span> + StringUtils.arrayToCommaDelimitedString(beanNames));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> getBeanFactory().getBean(beanNames[<span class=\"number\">0</span>], ServletWebServerFactory.class);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getSelfInitializer\"><a href=\"#getSelfInitializer\" class=\"headerlink\" title=\"getSelfInitializer\"></a>getSelfInitializer</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> org.springframework.boot.web.servlet.<span class=\"function\">ServletContextInitializer <span class=\"title\">getSelfInitializer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>::selfInitialize;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"getWebServer\"><a href=\"#getWebServer\" class=\"headerlink\" title=\"getWebServer\"></a>getWebServer</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> WebServer <span class=\"title\">getWebServer</span><span class=\"params\">(ServletContextInitializer... initializers)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.disableMBeanRegistry) &#123;</span><br><span class=\"line\">        Registry.disableRegistry();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// tomcat</span></span><br><span class=\"line\">    Tomcat tomcat = <span class=\"keyword\">new</span> Tomcat();</span><br><span class=\"line\">    File baseDir = (<span class=\"keyword\">this</span>.baseDirectory != <span class=\"keyword\">null</span>) ? <span class=\"keyword\">this</span>.baseDirectory : createTempDir(<span class=\"string\">&quot;tomcat&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    tomcat.setBaseDir(baseDir.getAbsolutePath());</span><br><span class=\"line\">    Connector connector = <span class=\"keyword\">new</span> Connector(<span class=\"keyword\">this</span>.protocol);</span><br><span class=\"line\">    connector.setThrowOnFailure(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">    tomcat.getService().addConnector(connector);</span><br><span class=\"line\">    customizeConnector(connector);</span><br><span class=\"line\">    tomcat.setConnector(connector);</span><br><span class=\"line\">    tomcat.getHost().setAutoDeploy(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">    configureEngine(tomcat.getEngine());</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Connector additionalConnector : <span class=\"keyword\">this</span>.additionalTomcatConnectors) &#123;</span><br><span class=\"line\">        tomcat.getService().addConnector(additionalConnector);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    prepareContext(tomcat.getHost(), initializers);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> getTomcatWebServer(tomcat);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>tomcattomcat:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> TomcatWebServer <span class=\"title\">getTomcatWebServer</span><span class=\"params\">(Tomcat tomcat)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> TomcatWebServer(tomcat, getPort() &gt;= <span class=\"number\">0</span>, getShutdown());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TomcatWebServer</span><span class=\"params\">(Tomcat tomcat, <span class=\"keyword\">boolean</span> autoStart, Shutdown shutdown)</span> </span>&#123;</span><br><span class=\"line\">    Assert.notNull(tomcat, <span class=\"string\">&quot;Tomcat Server must not be null&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.tomcat = tomcat;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.autoStart = autoStart;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.gracefulShutdown = (shutdown == Shutdown.GRACEFUL) ? <span class=\"keyword\">new</span> GracefulShutdown(tomcat) : <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    initialize();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">initialize</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> WebServerException </span>&#123;</span><br><span class=\"line\">    logger.info(<span class=\"string\">&quot;Tomcat initialized with port(s): &quot;</span> + getPortsDescription(<span class=\"keyword\">false</span>));</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.monitor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            addInstanceIdToEngineName();</span><br><span class=\"line\"></span><br><span class=\"line\">            Context context = findContext();</span><br><span class=\"line\">            context.addLifecycleListener((event) -&gt; &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (context.equals(event.getSource()) &amp;&amp; Lifecycle.START_EVENT.equals(event.getType())) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Remove service connectors so that protocol binding doesn&#x27;t</span></span><br><span class=\"line\">                    <span class=\"comment\">// happen when the service is started.</span></span><br><span class=\"line\">                    removeServiceConnectors();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Start the server to trigger initialization listeners</span></span><br><span class=\"line\">            <span class=\"keyword\">this</span>.tomcat.start();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// We can re-throw failure exception directly in the main thread</span></span><br><span class=\"line\">            rethrowDeferredStartupExceptions();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                ContextBindings.bindClassLoader(context, context.getNamingToken(), getClass().getClassLoader());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (NamingException ex) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Naming is not enabled. Continue</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Unlike Jetty, all Tomcat threads are daemon threads. We create a</span></span><br><span class=\"line\">            <span class=\"comment\">// blocking non-daemon to stop immediate shutdown</span></span><br><span class=\"line\">            startDaemonAwaitThread();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            stopSilently();</span><br><span class=\"line\">            destroySilently();</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> WebServerException(<span class=\"string\">&quot;Unable to start embedded Tomcat&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n","site":{"data":{}},"excerpt":"<p>SpringBootservlet</p>","more":"<!-- toc -->\n\n<p>java webtomcattomcatspringboot</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>springBootrefresh<code>onRefresh()</code><strong></strong><code>SpringApplication</code>classweb<code>ServletWebServerApplicationContext</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onRefresh</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>.onRefresh();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// web</span></span><br><span class=\"line\">        createWebServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start web server&quot;</span>, ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">createWebServer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// volatile</span></span><br><span class=\"line\">    WebServer webServer = <span class=\"keyword\">this</span>.webServer;</span><br><span class=\"line\">    <span class=\"comment\">// servlet</span></span><br><span class=\"line\">    ServletContext servletContext = getServletContext();</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (webServer == <span class=\"keyword\">null</span> &amp;&amp; servletContext == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// nullweb</span></span><br><span class=\"line\">        ServletWebServerFactory factory = getWebServerFactory();</span><br><span class=\"line\">        <span class=\"comment\">// web</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.webServer = factory.getWebServer(getSelfInitializer());</span><br><span class=\"line\">        getBeanFactory().registerSingleton(<span class=\"string\">&quot;webServerGracefulShutdown&quot;</span>,</span><br><span class=\"line\">                                           <span class=\"keyword\">new</span> WebServerGracefulShutdownLifecycle(<span class=\"keyword\">this</span>.webServer));</span><br><span class=\"line\">        getBeanFactory().registerSingleton(<span class=\"string\">&quot;webServerStartStop&quot;</span>,</span><br><span class=\"line\">                                           <span class=\"keyword\">new</span> WebServerStartStopLifecycle(<span class=\"keyword\">this</span>, <span class=\"keyword\">this</span>.webServer));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (servletContext != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            getSelfInitializer().onStartup(servletContext);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (ServletException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Cannot initialize servlet context&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    initPropertySources();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getWebServerFactory\"><a href=\"#getWebServerFactory\" class=\"headerlink\" title=\"getWebServerFactory\"></a>getWebServerFactory</h2><p>SPI</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> ServletWebServerFactory <span class=\"title\">getWebServerFactory</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Use bean names so that we don&#x27;t consider the hierarchy</span></span><br><span class=\"line\">    String[] beanNames = getBeanFactory().getBeanNamesForType(ServletWebServerFactory.class);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanNames.length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start ServletWebServerApplicationContext due to missing &quot;</span></span><br><span class=\"line\">                                              + <span class=\"string\">&quot;ServletWebServerFactory bean.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanNames.length &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start ServletWebServerApplicationContext due to multiple &quot;</span></span><br><span class=\"line\">                                              + <span class=\"string\">&quot;ServletWebServerFactory beans : &quot;</span> + StringUtils.arrayToCommaDelimitedString(beanNames));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> getBeanFactory().getBean(beanNames[<span class=\"number\">0</span>], ServletWebServerFactory.class);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getSelfInitializer\"><a href=\"#getSelfInitializer\" class=\"headerlink\" title=\"getSelfInitializer\"></a>getSelfInitializer</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> org.springframework.boot.web.servlet.<span class=\"function\">ServletContextInitializer <span class=\"title\">getSelfInitializer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>::selfInitialize;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"getWebServer\"><a href=\"#getWebServer\" class=\"headerlink\" title=\"getWebServer\"></a>getWebServer</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> WebServer <span class=\"title\">getWebServer</span><span class=\"params\">(ServletContextInitializer... initializers)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.disableMBeanRegistry) &#123;</span><br><span class=\"line\">        Registry.disableRegistry();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// tomcat</span></span><br><span class=\"line\">    Tomcat tomcat = <span class=\"keyword\">new</span> Tomcat();</span><br><span class=\"line\">    File baseDir = (<span class=\"keyword\">this</span>.baseDirectory != <span class=\"keyword\">null</span>) ? <span class=\"keyword\">this</span>.baseDirectory : createTempDir(<span class=\"string\">&quot;tomcat&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    tomcat.setBaseDir(baseDir.getAbsolutePath());</span><br><span class=\"line\">    Connector connector = <span class=\"keyword\">new</span> Connector(<span class=\"keyword\">this</span>.protocol);</span><br><span class=\"line\">    connector.setThrowOnFailure(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">    tomcat.getService().addConnector(connector);</span><br><span class=\"line\">    customizeConnector(connector);</span><br><span class=\"line\">    tomcat.setConnector(connector);</span><br><span class=\"line\">    tomcat.getHost().setAutoDeploy(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">    configureEngine(tomcat.getEngine());</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Connector additionalConnector : <span class=\"keyword\">this</span>.additionalTomcatConnectors) &#123;</span><br><span class=\"line\">        tomcat.getService().addConnector(additionalConnector);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    prepareContext(tomcat.getHost(), initializers);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> getTomcatWebServer(tomcat);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>tomcattomcat:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> TomcatWebServer <span class=\"title\">getTomcatWebServer</span><span class=\"params\">(Tomcat tomcat)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> TomcatWebServer(tomcat, getPort() &gt;= <span class=\"number\">0</span>, getShutdown());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TomcatWebServer</span><span class=\"params\">(Tomcat tomcat, <span class=\"keyword\">boolean</span> autoStart, Shutdown shutdown)</span> </span>&#123;</span><br><span class=\"line\">    Assert.notNull(tomcat, <span class=\"string\">&quot;Tomcat Server must not be null&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.tomcat = tomcat;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.autoStart = autoStart;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.gracefulShutdown = (shutdown == Shutdown.GRACEFUL) ? <span class=\"keyword\">new</span> GracefulShutdown(tomcat) : <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    initialize();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">initialize</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> WebServerException </span>&#123;</span><br><span class=\"line\">    logger.info(<span class=\"string\">&quot;Tomcat initialized with port(s): &quot;</span> + getPortsDescription(<span class=\"keyword\">false</span>));</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.monitor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            addInstanceIdToEngineName();</span><br><span class=\"line\"></span><br><span class=\"line\">            Context context = findContext();</span><br><span class=\"line\">            context.addLifecycleListener((event) -&gt; &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (context.equals(event.getSource()) &amp;&amp; Lifecycle.START_EVENT.equals(event.getType())) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Remove service connectors so that protocol binding doesn&#x27;t</span></span><br><span class=\"line\">                    <span class=\"comment\">// happen when the service is started.</span></span><br><span class=\"line\">                    removeServiceConnectors();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Start the server to trigger initialization listeners</span></span><br><span class=\"line\">            <span class=\"keyword\">this</span>.tomcat.start();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// We can re-throw failure exception directly in the main thread</span></span><br><span class=\"line\">            rethrowDeferredStartupExceptions();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                ContextBindings.bindClassLoader(context, context.getNamingToken(), getClass().getClassLoader());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (NamingException ex) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Naming is not enabled. Continue</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Unlike Jetty, all Tomcat threads are daemon threads. We create a</span></span><br><span class=\"line\">            <span class=\"comment\">// blocking non-daemon to stop immediate shutdown</span></span><br><span class=\"line\">            startDaemonAwaitThread();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            stopSilently();</span><br><span class=\"line\">            destroySilently();</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> WebServerException(<span class=\"string\">&quot;Unable to start embedded Tomcat&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>"},{"title":"springmvc-argument","date":"2021-04-07T04:20:01.000Z","_content":"\nhandlerMappingrequesthandlerExecutionChainhandlerhandlerMappingadapterhandler\n\n<!-- more -->\n\n<!-- toc -->\n\n# HandlerAdapter\n\n```java\npublic interface HandlerAdapter {\n\n    // handler\n    boolean supports(Object handler);\n\n    // handlermodelAndView\n    @Nullable\n    ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception;\n\n    long getLastModified(HttpServletRequest request, Object handler);\n\n}\n```\n\n*handle*handlermodelAndViewhandlerAdapter\n\n```java\nprotected void initStrategies(ApplicationContext context) {\n    initMultipartResolver(context);\n    initLocaleResolver(context);\n    initThemeResolver(context);\n    initHandlerMappings(context);\n    // handlerAdapter\n    initHandlerAdapters(context);\n    initHandlerExceptionResolvers(context);\n    initRequestToViewNameTranslator(context);\n    initViewResolvers(context);\n    initFlashMapManager(context);\n}\n```\n\n```java\nprivate void initHandlerAdapters(ApplicationContext context) {\n    this.handlerAdapters = null;\n\n    if (this.detectAllHandlerAdapters) {\n        // Find all HandlerAdapters in the ApplicationContext, including ancestor contexts.\n        Map<String, HandlerAdapter> matchingBeans =\n            BeanFactoryUtils.beansOfTypeIncludingAncestors(context, HandlerAdapter.class, true, false);\n        if (!matchingBeans.isEmpty()) {\n            this.handlerAdapters = new ArrayList<>(matchingBeans.values());\n            // We keep HandlerAdapters in sorted order.\n            AnnotationAwareOrderComparator.sort(this.handlerAdapters);\n        }\n    }\n    else {\n        try {\n            HandlerAdapter ha = context.getBean(HANDLER_ADAPTER_BEAN_NAME, HandlerAdapter.class);\n            this.handlerAdapters = Collections.singletonList(ha);\n        }\n        catch (NoSuchBeanDefinitionException ex) {\n            // Ignore, we'll add a default HandlerAdapter later.\n        }\n    }\n\n    // Ensure we have at least some HandlerAdapters, by registering\n    // default HandlerAdapters if no other adapters are found.\n    if (this.handlerAdapters == null) {\n        this.handlerAdapters = getDefaultStrategies(context, HandlerAdapter.class);\n        if (logger.isTraceEnabled()) {\n            logger.trace(\"No HandlerAdapters declared for servlet '\" + getServletName() +\n                         \"': using default strategies from DispatcherServlet.properties\");\n        }\n    }\n}\n```\n\n## \n\nhandlerAdapter\n\n```java\n// \npublic class SimpleControllerHandlerAdapter implements HandlerAdapter {\n\n    @Override\n    public boolean supports(Object handler) {\n        return (handler instanceof Controller);\n    }\n\n    @Override\n    @Nullable\n    public ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)\n        throws Exception {\n\n        // controllerhandlerRequest\n        return ((Controller) handler).handleRequest(request, response);\n    }\n}\n```\n\n```java\npublic class SimpleServletHandlerAdapter implements HandlerAdapter {\n\n    @Override\n    public boolean supports(Object handler) {\n        return (handler instanceof Servlet);\n    }\n\n    @Override\n    @Nullable\n    public ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)\n        throws Exception {\n\n        ((Servlet) handler).service(request, response);\n        return null;\n    }\n}\n```\n\nhandler`RequestMappingHandlerAdapter`_@RequestMapping_HandlerMethod\n\n# \n\ndispatcherServlet*doDispatch*reqeustadapteradapter\n\n```java\n// Determine handler adapter for the current request.\nHandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());\n// Actually invoke the handler.\nmv = ha.handle(processedRequest, response, mappedHandler.getHandler());\n```\n\n*handle*HandlerAdapter**final**:\n\n```java\npublic final ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)\n    throws Exception {\n    // RequestMappingHandlerAdapter\n    return handleInternal(request, response, (HandlerMethod) handler);\n}\n```\n\ninvokeHandlerMethodequest`ServletInvocableHandlerMethod`request`ServletInvocableHandlerMethod`request*invokeAndHandle*\n\n## invokeAndHandle\n\n```java\n// \npublic void invokeAndHandle(ServletWebRequest webRequest, ModelAndViewContainer mavContainer,\n                            Object... providedArgs) throws Exception {\n\n    // \n    Object returnValue = invokeForRequest(webRequest, mavContainer, providedArgs);\n    setResponseStatus(webRequest);\n\n    if (returnValue == null) {\n        if (isRequestNotModified(webRequest) || getResponseStatus() != null || mavContainer.isRequestHandled()) {\n            disableContentCachingIfNecessary(webRequest);\n            mavContainer.setRequestHandled(true);\n            return;\n        }\n    }\n    else if (StringUtils.hasText(getResponseStatusReason())) {\n        mavContainer.setRequestHandled(true);\n        return;\n    }\n\n    mavContainer.setRequestHandled(false);\n    Assert.state(this.returnValueHandlers != null, \"No return value handlers\");\n    try {\n        // \n        this.returnValueHandlers.handleReturnValue(\n            returnValue, getReturnValueType(returnValue), mavContainer, webRequest);\n    }\n    catch (Exception ex) {\n        if (logger.isTraceEnabled()) {\n            logger.trace(formatErrorForReturnValue(returnValue), ex);\n        }\n        throw ex;\n    }\n}\n```\n\n# \n\nhandlerMethodadapter*RequestMappingHandlerAdapter**ServletInvocableHandlerMethod*","source":"_posts/springmvc-argument.md","raw":"---\ntitle: springmvc-argument\ndate: 2021-04-07 12:20:01\ncategories: springmvc\ntags: argument\n---\n\nhandlerMappingrequesthandlerExecutionChainhandlerhandlerMappingadapterhandler\n\n<!-- more -->\n\n<!-- toc -->\n\n# HandlerAdapter\n\n```java\npublic interface HandlerAdapter {\n\n    // handler\n    boolean supports(Object handler);\n\n    // handlermodelAndView\n    @Nullable\n    ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception;\n\n    long getLastModified(HttpServletRequest request, Object handler);\n\n}\n```\n\n*handle*handlermodelAndViewhandlerAdapter\n\n```java\nprotected void initStrategies(ApplicationContext context) {\n    initMultipartResolver(context);\n    initLocaleResolver(context);\n    initThemeResolver(context);\n    initHandlerMappings(context);\n    // handlerAdapter\n    initHandlerAdapters(context);\n    initHandlerExceptionResolvers(context);\n    initRequestToViewNameTranslator(context);\n    initViewResolvers(context);\n    initFlashMapManager(context);\n}\n```\n\n```java\nprivate void initHandlerAdapters(ApplicationContext context) {\n    this.handlerAdapters = null;\n\n    if (this.detectAllHandlerAdapters) {\n        // Find all HandlerAdapters in the ApplicationContext, including ancestor contexts.\n        Map<String, HandlerAdapter> matchingBeans =\n            BeanFactoryUtils.beansOfTypeIncludingAncestors(context, HandlerAdapter.class, true, false);\n        if (!matchingBeans.isEmpty()) {\n            this.handlerAdapters = new ArrayList<>(matchingBeans.values());\n            // We keep HandlerAdapters in sorted order.\n            AnnotationAwareOrderComparator.sort(this.handlerAdapters);\n        }\n    }\n    else {\n        try {\n            HandlerAdapter ha = context.getBean(HANDLER_ADAPTER_BEAN_NAME, HandlerAdapter.class);\n            this.handlerAdapters = Collections.singletonList(ha);\n        }\n        catch (NoSuchBeanDefinitionException ex) {\n            // Ignore, we'll add a default HandlerAdapter later.\n        }\n    }\n\n    // Ensure we have at least some HandlerAdapters, by registering\n    // default HandlerAdapters if no other adapters are found.\n    if (this.handlerAdapters == null) {\n        this.handlerAdapters = getDefaultStrategies(context, HandlerAdapter.class);\n        if (logger.isTraceEnabled()) {\n            logger.trace(\"No HandlerAdapters declared for servlet '\" + getServletName() +\n                         \"': using default strategies from DispatcherServlet.properties\");\n        }\n    }\n}\n```\n\n## \n\nhandlerAdapter\n\n```java\n// \npublic class SimpleControllerHandlerAdapter implements HandlerAdapter {\n\n    @Override\n    public boolean supports(Object handler) {\n        return (handler instanceof Controller);\n    }\n\n    @Override\n    @Nullable\n    public ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)\n        throws Exception {\n\n        // controllerhandlerRequest\n        return ((Controller) handler).handleRequest(request, response);\n    }\n}\n```\n\n```java\npublic class SimpleServletHandlerAdapter implements HandlerAdapter {\n\n    @Override\n    public boolean supports(Object handler) {\n        return (handler instanceof Servlet);\n    }\n\n    @Override\n    @Nullable\n    public ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)\n        throws Exception {\n\n        ((Servlet) handler).service(request, response);\n        return null;\n    }\n}\n```\n\nhandler`RequestMappingHandlerAdapter`_@RequestMapping_HandlerMethod\n\n# \n\ndispatcherServlet*doDispatch*reqeustadapteradapter\n\n```java\n// Determine handler adapter for the current request.\nHandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());\n// Actually invoke the handler.\nmv = ha.handle(processedRequest, response, mappedHandler.getHandler());\n```\n\n*handle*HandlerAdapter**final**:\n\n```java\npublic final ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)\n    throws Exception {\n    // RequestMappingHandlerAdapter\n    return handleInternal(request, response, (HandlerMethod) handler);\n}\n```\n\ninvokeHandlerMethodequest`ServletInvocableHandlerMethod`request`ServletInvocableHandlerMethod`request*invokeAndHandle*\n\n## invokeAndHandle\n\n```java\n// \npublic void invokeAndHandle(ServletWebRequest webRequest, ModelAndViewContainer mavContainer,\n                            Object... providedArgs) throws Exception {\n\n    // \n    Object returnValue = invokeForRequest(webRequest, mavContainer, providedArgs);\n    setResponseStatus(webRequest);\n\n    if (returnValue == null) {\n        if (isRequestNotModified(webRequest) || getResponseStatus() != null || mavContainer.isRequestHandled()) {\n            disableContentCachingIfNecessary(webRequest);\n            mavContainer.setRequestHandled(true);\n            return;\n        }\n    }\n    else if (StringUtils.hasText(getResponseStatusReason())) {\n        mavContainer.setRequestHandled(true);\n        return;\n    }\n\n    mavContainer.setRequestHandled(false);\n    Assert.state(this.returnValueHandlers != null, \"No return value handlers\");\n    try {\n        // \n        this.returnValueHandlers.handleReturnValue(\n            returnValue, getReturnValueType(returnValue), mavContainer, webRequest);\n    }\n    catch (Exception ex) {\n        if (logger.isTraceEnabled()) {\n            logger.trace(formatErrorForReturnValue(returnValue), ex);\n        }\n        throw ex;\n    }\n}\n```\n\n# \n\nhandlerMethodadapter*RequestMappingHandlerAdapter**ServletInvocableHandlerMethod*","slug":"springmvc-argument","published":1,"updated":"2022-12-09T14:39:11.349Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwo003y8py06xd4asp3","content":"<p>handlerMappingrequesthandlerExecutionChainhandlerhandlerMappingadapterhandler</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"HandlerAdapter\"><a href=\"#HandlerAdapter\" class=\"headerlink\" title=\"HandlerAdapter\"></a>HandlerAdapter</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">HandlerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// handler</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">supports</span><span class=\"params\">(Object handler)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// handlermodelAndView</span></span><br><span class=\"line\">    <span class=\"meta\">@Nullable</span></span><br><span class=\"line\">    <span class=\"function\">ModelAndView <span class=\"title\">handle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class=\"keyword\">throws</span> Exception</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">long</span> <span class=\"title\">getLastModified</span><span class=\"params\">(HttpServletRequest request, Object handler)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>handle</em>handlermodelAndViewhandlerAdapter</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">initStrategies</span><span class=\"params\">(ApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    initMultipartResolver(context);</span><br><span class=\"line\">    initLocaleResolver(context);</span><br><span class=\"line\">    initThemeResolver(context);</span><br><span class=\"line\">    initHandlerMappings(context);</span><br><span class=\"line\">    <span class=\"comment\">// handlerAdapter</span></span><br><span class=\"line\">    initHandlerAdapters(context);</span><br><span class=\"line\">    initHandlerExceptionResolvers(context);</span><br><span class=\"line\">    initRequestToViewNameTranslator(context);</span><br><span class=\"line\">    initViewResolvers(context);</span><br><span class=\"line\">    initFlashMapManager(context);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">initHandlerAdapters</span><span class=\"params\">(ApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.handlerAdapters = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.detectAllHandlerAdapters) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Find all HandlerAdapters in the ApplicationContext, including ancestor contexts.</span></span><br><span class=\"line\">        Map&lt;String, HandlerAdapter&gt; matchingBeans =</span><br><span class=\"line\">            BeanFactoryUtils.beansOfTypeIncludingAncestors(context, HandlerAdapter.class, <span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!matchingBeans.isEmpty()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.handlerAdapters = <span class=\"keyword\">new</span> ArrayList&lt;&gt;(matchingBeans.values());</span><br><span class=\"line\">            <span class=\"comment\">// We keep HandlerAdapters in sorted order.</span></span><br><span class=\"line\">            AnnotationAwareOrderComparator.sort(<span class=\"keyword\">this</span>.handlerAdapters);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            HandlerAdapter ha = context.getBean(HANDLER_ADAPTER_BEAN_NAME, HandlerAdapter.class);</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.handlerAdapters = Collections.singletonList(ha);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (NoSuchBeanDefinitionException ex) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Ignore, we&#x27;ll add a default HandlerAdapter later.</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Ensure we have at least some HandlerAdapters, by registering</span></span><br><span class=\"line\">    <span class=\"comment\">// default HandlerAdapters if no other adapters are found.</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.handlerAdapters == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.handlerAdapters = getDefaultStrategies(context, HandlerAdapter.class);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">            logger.trace(<span class=\"string\">&quot;No HandlerAdapters declared for servlet &#x27;&quot;</span> + getServletName() +</span><br><span class=\"line\">                         <span class=\"string\">&quot;&#x27;: using default strategies from DispatcherServlet.properties&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>handlerAdapter</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SimpleControllerHandlerAdapter</span> <span class=\"keyword\">implements</span> <span class=\"title\">HandlerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">supports</span><span class=\"params\">(Object handler)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (handler <span class=\"keyword\">instanceof</span> Controller);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"meta\">@Nullable</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ModelAndView <span class=\"title\">handle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// controllerhandlerRequest</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> ((Controller) handler).handleRequest(request, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SimpleServletHandlerAdapter</span> <span class=\"keyword\">implements</span> <span class=\"title\">HandlerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">supports</span><span class=\"params\">(Object handler)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (handler <span class=\"keyword\">instanceof</span> Servlet);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"meta\">@Nullable</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ModelAndView <span class=\"title\">handle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        ((Servlet) handler).service(request, response);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>handler<code>RequestMappingHandlerAdapter</code>_@RequestMapping_HandlerMethod</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>dispatcherServlet<em>doDispatch</em>reqeustadapteradapter</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Determine handler adapter for the current request.</span></span><br><span class=\"line\">HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());</span><br><span class=\"line\"><span class=\"comment\">// Actually invoke the handler.</span></span><br><span class=\"line\">mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br></pre></td></tr></table></figure>\n\n<p><em>handle</em>HandlerAdapter<strong>final</strong>:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> ModelAndView <span class=\"title\">handle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// RequestMappingHandlerAdapter</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> handleInternal(request, response, (HandlerMethod) handler);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>invokeHandlerMethodequest<code>ServletInvocableHandlerMethod</code>request<code>ServletInvocableHandlerMethod</code>request<em>invokeAndHandle</em></p>\n<h2 id=\"invokeAndHandle\"><a href=\"#invokeAndHandle\" class=\"headerlink\" title=\"invokeAndHandle\"></a>invokeAndHandle</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">invokeAndHandle</span><span class=\"params\">(ServletWebRequest webRequest, ModelAndViewContainer mavContainer,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                            Object... providedArgs)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Object returnValue = invokeForRequest(webRequest, mavContainer, providedArgs);</span><br><span class=\"line\">    setResponseStatus(webRequest);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (returnValue == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (isRequestNotModified(webRequest) || getResponseStatus() != <span class=\"keyword\">null</span> || mavContainer.isRequestHandled()) &#123;</span><br><span class=\"line\">            disableContentCachingIfNecessary(webRequest);</span><br><span class=\"line\">            mavContainer.setRequestHandled(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (StringUtils.hasText(getResponseStatusReason())) &#123;</span><br><span class=\"line\">        mavContainer.setRequestHandled(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    mavContainer.setRequestHandled(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">    Assert.state(<span class=\"keyword\">this</span>.returnValueHandlers != <span class=\"keyword\">null</span>, <span class=\"string\">&quot;No return value handlers&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.returnValueHandlers.handleReturnValue(</span><br><span class=\"line\">            returnValue, getReturnValueType(returnValue), mavContainer, webRequest);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">            logger.trace(formatErrorForReturnValue(returnValue), ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>handlerMethodadapter<em>RequestMappingHandlerAdapter</em><em>ServletInvocableHandlerMethod</em></p>\n","site":{"data":{}},"excerpt":"<p>handlerMappingrequesthandlerExecutionChainhandlerhandlerMappingadapterhandler</p>","more":"<!-- toc -->\n\n<h1 id=\"HandlerAdapter\"><a href=\"#HandlerAdapter\" class=\"headerlink\" title=\"HandlerAdapter\"></a>HandlerAdapter</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">HandlerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// handler</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">supports</span><span class=\"params\">(Object handler)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// handlermodelAndView</span></span><br><span class=\"line\">    <span class=\"meta\">@Nullable</span></span><br><span class=\"line\">    <span class=\"function\">ModelAndView <span class=\"title\">handle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class=\"keyword\">throws</span> Exception</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">long</span> <span class=\"title\">getLastModified</span><span class=\"params\">(HttpServletRequest request, Object handler)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>handle</em>handlermodelAndViewhandlerAdapter</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">initStrategies</span><span class=\"params\">(ApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    initMultipartResolver(context);</span><br><span class=\"line\">    initLocaleResolver(context);</span><br><span class=\"line\">    initThemeResolver(context);</span><br><span class=\"line\">    initHandlerMappings(context);</span><br><span class=\"line\">    <span class=\"comment\">// handlerAdapter</span></span><br><span class=\"line\">    initHandlerAdapters(context);</span><br><span class=\"line\">    initHandlerExceptionResolvers(context);</span><br><span class=\"line\">    initRequestToViewNameTranslator(context);</span><br><span class=\"line\">    initViewResolvers(context);</span><br><span class=\"line\">    initFlashMapManager(context);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">initHandlerAdapters</span><span class=\"params\">(ApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.handlerAdapters = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.detectAllHandlerAdapters) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Find all HandlerAdapters in the ApplicationContext, including ancestor contexts.</span></span><br><span class=\"line\">        Map&lt;String, HandlerAdapter&gt; matchingBeans =</span><br><span class=\"line\">            BeanFactoryUtils.beansOfTypeIncludingAncestors(context, HandlerAdapter.class, <span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!matchingBeans.isEmpty()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.handlerAdapters = <span class=\"keyword\">new</span> ArrayList&lt;&gt;(matchingBeans.values());</span><br><span class=\"line\">            <span class=\"comment\">// We keep HandlerAdapters in sorted order.</span></span><br><span class=\"line\">            AnnotationAwareOrderComparator.sort(<span class=\"keyword\">this</span>.handlerAdapters);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            HandlerAdapter ha = context.getBean(HANDLER_ADAPTER_BEAN_NAME, HandlerAdapter.class);</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.handlerAdapters = Collections.singletonList(ha);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (NoSuchBeanDefinitionException ex) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Ignore, we&#x27;ll add a default HandlerAdapter later.</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Ensure we have at least some HandlerAdapters, by registering</span></span><br><span class=\"line\">    <span class=\"comment\">// default HandlerAdapters if no other adapters are found.</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.handlerAdapters == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.handlerAdapters = getDefaultStrategies(context, HandlerAdapter.class);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">            logger.trace(<span class=\"string\">&quot;No HandlerAdapters declared for servlet &#x27;&quot;</span> + getServletName() +</span><br><span class=\"line\">                         <span class=\"string\">&quot;&#x27;: using default strategies from DispatcherServlet.properties&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>handlerAdapter</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SimpleControllerHandlerAdapter</span> <span class=\"keyword\">implements</span> <span class=\"title\">HandlerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">supports</span><span class=\"params\">(Object handler)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (handler <span class=\"keyword\">instanceof</span> Controller);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"meta\">@Nullable</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ModelAndView <span class=\"title\">handle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// controllerhandlerRequest</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> ((Controller) handler).handleRequest(request, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SimpleServletHandlerAdapter</span> <span class=\"keyword\">implements</span> <span class=\"title\">HandlerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">supports</span><span class=\"params\">(Object handler)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (handler <span class=\"keyword\">instanceof</span> Servlet);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"meta\">@Nullable</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ModelAndView <span class=\"title\">handle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        ((Servlet) handler).service(request, response);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>handler<code>RequestMappingHandlerAdapter</code>_@RequestMapping_HandlerMethod</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>dispatcherServlet<em>doDispatch</em>reqeustadapteradapter</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Determine handler adapter for the current request.</span></span><br><span class=\"line\">HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());</span><br><span class=\"line\"><span class=\"comment\">// Actually invoke the handler.</span></span><br><span class=\"line\">mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br></pre></td></tr></table></figure>\n\n<p><em>handle</em>HandlerAdapter<strong>final</strong>:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> ModelAndView <span class=\"title\">handle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// RequestMappingHandlerAdapter</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> handleInternal(request, response, (HandlerMethod) handler);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>invokeHandlerMethodequest<code>ServletInvocableHandlerMethod</code>request<code>ServletInvocableHandlerMethod</code>request<em>invokeAndHandle</em></p>\n<h2 id=\"invokeAndHandle\"><a href=\"#invokeAndHandle\" class=\"headerlink\" title=\"invokeAndHandle\"></a>invokeAndHandle</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">invokeAndHandle</span><span class=\"params\">(ServletWebRequest webRequest, ModelAndViewContainer mavContainer,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                            Object... providedArgs)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Object returnValue = invokeForRequest(webRequest, mavContainer, providedArgs);</span><br><span class=\"line\">    setResponseStatus(webRequest);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (returnValue == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (isRequestNotModified(webRequest) || getResponseStatus() != <span class=\"keyword\">null</span> || mavContainer.isRequestHandled()) &#123;</span><br><span class=\"line\">            disableContentCachingIfNecessary(webRequest);</span><br><span class=\"line\">            mavContainer.setRequestHandled(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (StringUtils.hasText(getResponseStatusReason())) &#123;</span><br><span class=\"line\">        mavContainer.setRequestHandled(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    mavContainer.setRequestHandled(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">    Assert.state(<span class=\"keyword\">this</span>.returnValueHandlers != <span class=\"keyword\">null</span>, <span class=\"string\">&quot;No return value handlers&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.returnValueHandlers.handleReturnValue(</span><br><span class=\"line\">            returnValue, getReturnValueType(returnValue), mavContainer, webRequest);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">            logger.trace(formatErrorForReturnValue(returnValue), ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>handlerMethodadapter<em>RequestMappingHandlerAdapter</em><em>ServletInvocableHandlerMethod</em></p>"},{"title":"springmvc-dispatch","date":"2021-04-06T08:35:27.000Z","_content":"\n        controllerspringspringmvcspringbootspringmvc\n\n<!-- more -->\n\n<!-- toc -->\n\n# AbstractHandlerMappingMethod\n\n        `AbstractHandlerMapping``InitializingBean`bean*afterPropertiesSet()*web**`HandlerMethod`**\n\nbean\n\n```java\n@Override\npublic void afterPropertiesSet() {\n    initHandlerMethods();\n}\n\n/**\n * Scan beans in the ApplicationContext, detect and register handler methods.\n * @see #getCandidateBeanNames()\n * @see #processCandidateBean\n * @see #handlerMethodsInitialized\n */\nprotected void initHandlerMethods() {\n    for (String beanName : getCandidateBeanNames()) {\n        if (!beanName.startsWith(SCOPED_TARGET_NAME_PREFIX)) {\n            processCandidateBean(beanName);\n        }\n    }\n    handlerMethodsInitialized(getHandlerMethods());\n}\n```\n\nbean*handler method*\n\n```java\nprotected void processCandidateBean(String beanName) {\n   Class<?> beanType = null;\n   try {\n      beanType = obtainApplicationContext().getType(beanName);\n   }\n   catch (Throwable ex) {\n      // An unresolvable bean type, probably from a lazy bean - let's ignore it.\n      if (logger.isTraceEnabled()) {\n         logger.trace(\"Could not resolve type for bean '\" + beanName + \"'\", ex);\n      }\n   }\n    // handlerbean\n   if (beanType != null && isHandler(beanType)) {\n       // hadnler\n      detectHandlerMethods(beanName);\n   }\n}\n\n/**\n * Look for handler methods in the specified handler bean.\n * @param handler either a bean name or an actual handler instance\n * @see #getMappingForMethod\n */\nprotected void detectHandlerMethods(Object handler) {\n   Class<?> handlerType = (handler instanceof String ?\n         obtainApplicationContext().getType((String) handler) : handler.getClass());\n\n   if (handlerType != null) {\n      Class<?> userType = ClassUtils.getUserClass(handlerType);\n       // Method:ReqeustMappingInfo, lambda\n      Map<Method, T> methods = MethodIntrospector.selectMethods(userType,\n            (MethodIntrospector.MetadataLookup<T>) method -> {\n               try {\n                   // RequestMappingInfomapping\n                  return getMappingForMethod(method, userType);\n               }\n               catch (Throwable ex) {\n                  throw new IllegalStateException(\"Invalid mapping on handler class [\" +\n                        userType.getName() + \"]: \" + method, ex);\n               }\n            });\n      if (logger.isTraceEnabled()) {\n         logger.trace(formatMappings(userType, methods));\n      }\n      methods.forEach((method, mapping) -> {\n         Method invocableMethod = AopUtils.selectInvocableMethod(method, userType);\n          // methods\n         registerHandlerMethod(handler, invocableMethod, mapping);\n      });\n   }\n}\n```\n\n```java\n@Override\nprotected boolean isHandler(Class<?> beanType) {\n    // handler@Controller@RequestMapping\n   return (AnnotatedElementUtils.hasAnnotation(beanType, Controller.class) ||\n         AnnotatedElementUtils.hasAnnotation(beanType, RequestMapping.class));\n}\n```\n\n> bean\n\n# HandlerMapping\n\n*getHandler(HttpServletRequest request)*`HandlerExecutionChain`servletwebreqeusturlcontrollerid\n\n```java\npublic final HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception {\n    // requesthandler\n    Object handler = getHandlerInternal(request);\n    if (handler == null) {\n        handler = getDefaultHandler();\n    }\n    if (handler == null) {\n        return null;\n    }\n    // Bean name or resolved handler?\n    if (handler instanceof String) {\n        String handlerName = (String) handler;\n        handler = obtainApplicationContext().getBean(handlerName);\n    }\n\n    // handlerrequestchain\n    HandlerExecutionChain executionChain = getHandlerExecutionChain(handler, request);\n\n    if (logger.isTraceEnabled()) {\n        logger.trace(\"Mapped to \" + handler);\n    }\n    else if (logger.isDebugEnabled() && !request.getDispatcherType().equals(DispatcherType.ASYNC)) {\n        logger.debug(\"Mapped to \" + executionChain.getHandler());\n    }\n\n    if (hasCorsConfigurationSource(handler) || CorsUtils.isPreFlightRequest(request)) {\n        CorsConfiguration config = (this.corsConfigurationSource != null ? this.corsConfigurationSource.getCorsConfiguration(request) : null);\n        CorsConfiguration handlerConfig = getCorsConfiguration(handler, request);\n        config = (config != null ? config.combine(handlerConfig) : handlerConfig);\n        executionChain = getCorsHandlerExecutionChain(request, executionChain, config);\n    }\n\n    return executionChain;\n}\n```\n\n```java\nprotected HandlerExecutionChain getHandlerExecutionChain(Object handler, HttpServletRequest request) {\n    HandlerExecutionChain chain = (handler instanceof HandlerExecutionChain ?\n                                   (HandlerExecutionChain) handler : new HandlerExecutionChain(handler));\n\n    String lookupPath = this.urlPathHelper.getLookupPathForRequest(request, LOOKUP_PATH);\n    for (HandlerInterceptor interceptor : this.adaptedInterceptors) {\n        if (interceptor instanceof MappedInterceptor) {\n            MappedInterceptor mappedInterceptor = (MappedInterceptor) interceptor;\n            if (mappedInterceptor.matches(lookupPath, this.pathMatcher)) {\n                // \n                chain.addInterceptor(mappedInterceptor.getInterceptor());\n            }\n        }\n        else {\n            chain.addInterceptor(interceptor);\n        }\n    }\n    return chain;\n}\n```\n\n# \n\n        springmvcDispatcherServlethandlerMappingHandlerExecutionChainHandlerAdapterHandlerAdapterServletInvocableHandlerMethodServletInvocableHandlerMethodadapterhandlerMethod","source":"_posts/springmvc-dispatch.md","raw":"---\ntitle: springmvc-dispatch\ndate: 2021-04-06 16:35:27\ncategories: springmvc\ntags: dispatch\n---\n\n        controllerspringspringmvcspringbootspringmvc\n\n<!-- more -->\n\n<!-- toc -->\n\n# AbstractHandlerMappingMethod\n\n        `AbstractHandlerMapping``InitializingBean`bean*afterPropertiesSet()*web**`HandlerMethod`**\n\nbean\n\n```java\n@Override\npublic void afterPropertiesSet() {\n    initHandlerMethods();\n}\n\n/**\n * Scan beans in the ApplicationContext, detect and register handler methods.\n * @see #getCandidateBeanNames()\n * @see #processCandidateBean\n * @see #handlerMethodsInitialized\n */\nprotected void initHandlerMethods() {\n    for (String beanName : getCandidateBeanNames()) {\n        if (!beanName.startsWith(SCOPED_TARGET_NAME_PREFIX)) {\n            processCandidateBean(beanName);\n        }\n    }\n    handlerMethodsInitialized(getHandlerMethods());\n}\n```\n\nbean*handler method*\n\n```java\nprotected void processCandidateBean(String beanName) {\n   Class<?> beanType = null;\n   try {\n      beanType = obtainApplicationContext().getType(beanName);\n   }\n   catch (Throwable ex) {\n      // An unresolvable bean type, probably from a lazy bean - let's ignore it.\n      if (logger.isTraceEnabled()) {\n         logger.trace(\"Could not resolve type for bean '\" + beanName + \"'\", ex);\n      }\n   }\n    // handlerbean\n   if (beanType != null && isHandler(beanType)) {\n       // hadnler\n      detectHandlerMethods(beanName);\n   }\n}\n\n/**\n * Look for handler methods in the specified handler bean.\n * @param handler either a bean name or an actual handler instance\n * @see #getMappingForMethod\n */\nprotected void detectHandlerMethods(Object handler) {\n   Class<?> handlerType = (handler instanceof String ?\n         obtainApplicationContext().getType((String) handler) : handler.getClass());\n\n   if (handlerType != null) {\n      Class<?> userType = ClassUtils.getUserClass(handlerType);\n       // Method:ReqeustMappingInfo, lambda\n      Map<Method, T> methods = MethodIntrospector.selectMethods(userType,\n            (MethodIntrospector.MetadataLookup<T>) method -> {\n               try {\n                   // RequestMappingInfomapping\n                  return getMappingForMethod(method, userType);\n               }\n               catch (Throwable ex) {\n                  throw new IllegalStateException(\"Invalid mapping on handler class [\" +\n                        userType.getName() + \"]: \" + method, ex);\n               }\n            });\n      if (logger.isTraceEnabled()) {\n         logger.trace(formatMappings(userType, methods));\n      }\n      methods.forEach((method, mapping) -> {\n         Method invocableMethod = AopUtils.selectInvocableMethod(method, userType);\n          // methods\n         registerHandlerMethod(handler, invocableMethod, mapping);\n      });\n   }\n}\n```\n\n```java\n@Override\nprotected boolean isHandler(Class<?> beanType) {\n    // handler@Controller@RequestMapping\n   return (AnnotatedElementUtils.hasAnnotation(beanType, Controller.class) ||\n         AnnotatedElementUtils.hasAnnotation(beanType, RequestMapping.class));\n}\n```\n\n> bean\n\n# HandlerMapping\n\n*getHandler(HttpServletRequest request)*`HandlerExecutionChain`servletwebreqeusturlcontrollerid\n\n```java\npublic final HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception {\n    // requesthandler\n    Object handler = getHandlerInternal(request);\n    if (handler == null) {\n        handler = getDefaultHandler();\n    }\n    if (handler == null) {\n        return null;\n    }\n    // Bean name or resolved handler?\n    if (handler instanceof String) {\n        String handlerName = (String) handler;\n        handler = obtainApplicationContext().getBean(handlerName);\n    }\n\n    // handlerrequestchain\n    HandlerExecutionChain executionChain = getHandlerExecutionChain(handler, request);\n\n    if (logger.isTraceEnabled()) {\n        logger.trace(\"Mapped to \" + handler);\n    }\n    else if (logger.isDebugEnabled() && !request.getDispatcherType().equals(DispatcherType.ASYNC)) {\n        logger.debug(\"Mapped to \" + executionChain.getHandler());\n    }\n\n    if (hasCorsConfigurationSource(handler) || CorsUtils.isPreFlightRequest(request)) {\n        CorsConfiguration config = (this.corsConfigurationSource != null ? this.corsConfigurationSource.getCorsConfiguration(request) : null);\n        CorsConfiguration handlerConfig = getCorsConfiguration(handler, request);\n        config = (config != null ? config.combine(handlerConfig) : handlerConfig);\n        executionChain = getCorsHandlerExecutionChain(request, executionChain, config);\n    }\n\n    return executionChain;\n}\n```\n\n```java\nprotected HandlerExecutionChain getHandlerExecutionChain(Object handler, HttpServletRequest request) {\n    HandlerExecutionChain chain = (handler instanceof HandlerExecutionChain ?\n                                   (HandlerExecutionChain) handler : new HandlerExecutionChain(handler));\n\n    String lookupPath = this.urlPathHelper.getLookupPathForRequest(request, LOOKUP_PATH);\n    for (HandlerInterceptor interceptor : this.adaptedInterceptors) {\n        if (interceptor instanceof MappedInterceptor) {\n            MappedInterceptor mappedInterceptor = (MappedInterceptor) interceptor;\n            if (mappedInterceptor.matches(lookupPath, this.pathMatcher)) {\n                // \n                chain.addInterceptor(mappedInterceptor.getInterceptor());\n            }\n        }\n        else {\n            chain.addInterceptor(interceptor);\n        }\n    }\n    return chain;\n}\n```\n\n# \n\n        springmvcDispatcherServlethandlerMappingHandlerExecutionChainHandlerAdapterHandlerAdapterServletInvocableHandlerMethodServletInvocableHandlerMethodadapterhandlerMethod","slug":"springmvc-dispatch","published":1,"updated":"2022-12-09T14:37:34.243Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwo00428py04c7j42c9","content":"<p>        controllerspringspringmvcspringbootspringmvc</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"AbstractHandlerMappingMethod\"><a href=\"#AbstractHandlerMappingMethod\" class=\"headerlink\" title=\"AbstractHandlerMappingMethod\"></a>AbstractHandlerMappingMethod</h1><p>        <code>AbstractHandlerMapping</code><code>InitializingBean</code>bean<em>afterPropertiesSet()<em>web</em></em><code>HandlerMethod</code>**</p>\n<p>bean</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterPropertiesSet</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    initHandlerMethods();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Scan beans in the ApplicationContext, detect and register handler methods.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #getCandidateBeanNames()</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #processCandidateBean</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #handlerMethodsInitialized</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">initHandlerMethods</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String beanName : getCandidateBeanNames()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!beanName.startsWith(SCOPED_TARGET_NAME_PREFIX)) &#123;</span><br><span class=\"line\">            processCandidateBean(beanName);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    handlerMethodsInitialized(getHandlerMethods());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>bean<em>handler method</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">processCandidateBean</span><span class=\"params\">(String beanName)</span> </span>&#123;</span><br><span class=\"line\">   Class&lt;?&gt; beanType = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">   <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      beanType = obtainApplicationContext().getType(beanName);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// An unresolvable bean type, probably from a lazy bean - let&#x27;s ignore it.</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">         logger.trace(<span class=\"string\">&quot;Could not resolve type for bean &#x27;&quot;</span> + beanName + <span class=\"string\">&quot;&#x27;&quot;</span>, ex);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">    <span class=\"comment\">// handlerbean</span></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (beanType != <span class=\"keyword\">null</span> &amp;&amp; isHandler(beanType)) &#123;</span><br><span class=\"line\">       <span class=\"comment\">// hadnler</span></span><br><span class=\"line\">      detectHandlerMethods(beanName);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Look for handler methods in the specified handler bean.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> handler either a bean name or an actual handler instance</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #getMappingForMethod</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">detectHandlerMethods</span><span class=\"params\">(Object handler)</span> </span>&#123;</span><br><span class=\"line\">   Class&lt;?&gt; handlerType = (handler <span class=\"keyword\">instanceof</span> String ?</span><br><span class=\"line\">         obtainApplicationContext().getType((String) handler) : handler.getClass());</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (handlerType != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      Class&lt;?&gt; userType = ClassUtils.getUserClass(handlerType);</span><br><span class=\"line\">       <span class=\"comment\">// Method:ReqeustMappingInfo, lambda</span></span><br><span class=\"line\">      Map&lt;Method, T&gt; methods = MethodIntrospector.selectMethods(userType,</span><br><span class=\"line\">            (MethodIntrospector.MetadataLookup&lt;T&gt;) method -&gt; &#123;</span><br><span class=\"line\">               <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                   <span class=\"comment\">// RequestMappingInfomapping</span></span><br><span class=\"line\">                  <span class=\"keyword\">return</span> getMappingForMethod(method, userType);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(<span class=\"string\">&quot;Invalid mapping on handler class [&quot;</span> +</span><br><span class=\"line\">                        userType.getName() + <span class=\"string\">&quot;]: &quot;</span> + method, ex);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">         logger.trace(formatMappings(userType, methods));</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      methods.forEach((method, mapping) -&gt; &#123;</span><br><span class=\"line\">         Method invocableMethod = AopUtils.selectInvocableMethod(method, userType);</span><br><span class=\"line\">          <span class=\"comment\">// methods</span></span><br><span class=\"line\">         registerHandlerMethod(handler, invocableMethod, mapping);</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isHandler</span><span class=\"params\">(Class&lt;?&gt; beanType)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// handler@Controller@RequestMapping</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> (AnnotatedElementUtils.hasAnnotation(beanType, Controller.class) ||</span><br><span class=\"line\">         AnnotatedElementUtils.hasAnnotation(beanType, RequestMapping.class));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>bean</p>\n</blockquote>\n<h1 id=\"HandlerMapping\"><a href=\"#HandlerMapping\" class=\"headerlink\" title=\"HandlerMapping\"></a>HandlerMapping</h1><p>*getHandler(HttpServletRequest request)*<code>HandlerExecutionChain</code>servletwebreqeusturlcontrollerid</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> HandlerExecutionChain <span class=\"title\">getHandler</span><span class=\"params\">(HttpServletRequest request)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// requesthandler</span></span><br><span class=\"line\">    Object handler = getHandlerInternal(request);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (handler == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        handler = getDefaultHandler();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (handler == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Bean name or resolved handler?</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (handler <span class=\"keyword\">instanceof</span> String) &#123;</span><br><span class=\"line\">        String handlerName = (String) handler;</span><br><span class=\"line\">        handler = obtainApplicationContext().getBean(handlerName);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// handlerrequestchain</span></span><br><span class=\"line\">    HandlerExecutionChain executionChain = getHandlerExecutionChain(handler, request);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">        logger.trace(<span class=\"string\">&quot;Mapped to &quot;</span> + handler);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (logger.isDebugEnabled() &amp;&amp; !request.getDispatcherType().equals(DispatcherType.ASYNC)) &#123;</span><br><span class=\"line\">        logger.debug(<span class=\"string\">&quot;Mapped to &quot;</span> + executionChain.getHandler());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (hasCorsConfigurationSource(handler) || CorsUtils.isPreFlightRequest(request)) &#123;</span><br><span class=\"line\">        CorsConfiguration config = (<span class=\"keyword\">this</span>.corsConfigurationSource != <span class=\"keyword\">null</span> ? <span class=\"keyword\">this</span>.corsConfigurationSource.getCorsConfiguration(request) : <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        CorsConfiguration handlerConfig = getCorsConfiguration(handler, request);</span><br><span class=\"line\">        config = (config != <span class=\"keyword\">null</span> ? config.combine(handlerConfig) : handlerConfig);</span><br><span class=\"line\">        executionChain = getCorsHandlerExecutionChain(request, executionChain, config);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> executionChain;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> HandlerExecutionChain <span class=\"title\">getHandlerExecutionChain</span><span class=\"params\">(Object handler, HttpServletRequest request)</span> </span>&#123;</span><br><span class=\"line\">    HandlerExecutionChain chain = (handler <span class=\"keyword\">instanceof</span> HandlerExecutionChain ?</span><br><span class=\"line\">                                   (HandlerExecutionChain) handler : <span class=\"keyword\">new</span> HandlerExecutionChain(handler));</span><br><span class=\"line\"></span><br><span class=\"line\">    String lookupPath = <span class=\"keyword\">this</span>.urlPathHelper.getLookupPathForRequest(request, LOOKUP_PATH);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (HandlerInterceptor interceptor : <span class=\"keyword\">this</span>.adaptedInterceptors) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (interceptor <span class=\"keyword\">instanceof</span> MappedInterceptor) &#123;</span><br><span class=\"line\">            MappedInterceptor mappedInterceptor = (MappedInterceptor) interceptor;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (mappedInterceptor.matches(lookupPath, <span class=\"keyword\">this</span>.pathMatcher)) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                chain.addInterceptor(mappedInterceptor.getInterceptor());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            chain.addInterceptor(interceptor);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> chain;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        springmvcDispatcherServlethandlerMappingHandlerExecutionChainHandlerAdapterHandlerAdapterServletInvocableHandlerMethodServletInvocableHandlerMethodadapterhandlerMethod</p>\n","site":{"data":{}},"excerpt":"<p>        controllerspringspringmvcspringbootspringmvc</p>","more":"<!-- toc -->\n\n<h1 id=\"AbstractHandlerMappingMethod\"><a href=\"#AbstractHandlerMappingMethod\" class=\"headerlink\" title=\"AbstractHandlerMappingMethod\"></a>AbstractHandlerMappingMethod</h1><p>        <code>AbstractHandlerMapping</code><code>InitializingBean</code>bean<em>afterPropertiesSet()<em>web</em></em><code>HandlerMethod</code>**</p>\n<p>bean</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterPropertiesSet</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    initHandlerMethods();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Scan beans in the ApplicationContext, detect and register handler methods.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #getCandidateBeanNames()</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #processCandidateBean</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #handlerMethodsInitialized</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">initHandlerMethods</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String beanName : getCandidateBeanNames()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!beanName.startsWith(SCOPED_TARGET_NAME_PREFIX)) &#123;</span><br><span class=\"line\">            processCandidateBean(beanName);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    handlerMethodsInitialized(getHandlerMethods());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>bean<em>handler method</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">processCandidateBean</span><span class=\"params\">(String beanName)</span> </span>&#123;</span><br><span class=\"line\">   Class&lt;?&gt; beanType = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">   <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      beanType = obtainApplicationContext().getType(beanName);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// An unresolvable bean type, probably from a lazy bean - let&#x27;s ignore it.</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">         logger.trace(<span class=\"string\">&quot;Could not resolve type for bean &#x27;&quot;</span> + beanName + <span class=\"string\">&quot;&#x27;&quot;</span>, ex);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">    <span class=\"comment\">// handlerbean</span></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (beanType != <span class=\"keyword\">null</span> &amp;&amp; isHandler(beanType)) &#123;</span><br><span class=\"line\">       <span class=\"comment\">// hadnler</span></span><br><span class=\"line\">      detectHandlerMethods(beanName);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Look for handler methods in the specified handler bean.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> handler either a bean name or an actual handler instance</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #getMappingForMethod</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">detectHandlerMethods</span><span class=\"params\">(Object handler)</span> </span>&#123;</span><br><span class=\"line\">   Class&lt;?&gt; handlerType = (handler <span class=\"keyword\">instanceof</span> String ?</span><br><span class=\"line\">         obtainApplicationContext().getType((String) handler) : handler.getClass());</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (handlerType != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      Class&lt;?&gt; userType = ClassUtils.getUserClass(handlerType);</span><br><span class=\"line\">       <span class=\"comment\">// Method:ReqeustMappingInfo, lambda</span></span><br><span class=\"line\">      Map&lt;Method, T&gt; methods = MethodIntrospector.selectMethods(userType,</span><br><span class=\"line\">            (MethodIntrospector.MetadataLookup&lt;T&gt;) method -&gt; &#123;</span><br><span class=\"line\">               <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                   <span class=\"comment\">// RequestMappingInfomapping</span></span><br><span class=\"line\">                  <span class=\"keyword\">return</span> getMappingForMethod(method, userType);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(<span class=\"string\">&quot;Invalid mapping on handler class [&quot;</span> +</span><br><span class=\"line\">                        userType.getName() + <span class=\"string\">&quot;]: &quot;</span> + method, ex);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">         logger.trace(formatMappings(userType, methods));</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      methods.forEach((method, mapping) -&gt; &#123;</span><br><span class=\"line\">         Method invocableMethod = AopUtils.selectInvocableMethod(method, userType);</span><br><span class=\"line\">          <span class=\"comment\">// methods</span></span><br><span class=\"line\">         registerHandlerMethod(handler, invocableMethod, mapping);</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isHandler</span><span class=\"params\">(Class&lt;?&gt; beanType)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// handler@Controller@RequestMapping</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> (AnnotatedElementUtils.hasAnnotation(beanType, Controller.class) ||</span><br><span class=\"line\">         AnnotatedElementUtils.hasAnnotation(beanType, RequestMapping.class));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>bean</p>\n</blockquote>\n<h1 id=\"HandlerMapping\"><a href=\"#HandlerMapping\" class=\"headerlink\" title=\"HandlerMapping\"></a>HandlerMapping</h1><p>*getHandler(HttpServletRequest request)*<code>HandlerExecutionChain</code>servletwebreqeusturlcontrollerid</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> HandlerExecutionChain <span class=\"title\">getHandler</span><span class=\"params\">(HttpServletRequest request)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// requesthandler</span></span><br><span class=\"line\">    Object handler = getHandlerInternal(request);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (handler == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        handler = getDefaultHandler();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (handler == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Bean name or resolved handler?</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (handler <span class=\"keyword\">instanceof</span> String) &#123;</span><br><span class=\"line\">        String handlerName = (String) handler;</span><br><span class=\"line\">        handler = obtainApplicationContext().getBean(handlerName);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// handlerrequestchain</span></span><br><span class=\"line\">    HandlerExecutionChain executionChain = getHandlerExecutionChain(handler, request);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class=\"line\">        logger.trace(<span class=\"string\">&quot;Mapped to &quot;</span> + handler);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (logger.isDebugEnabled() &amp;&amp; !request.getDispatcherType().equals(DispatcherType.ASYNC)) &#123;</span><br><span class=\"line\">        logger.debug(<span class=\"string\">&quot;Mapped to &quot;</span> + executionChain.getHandler());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (hasCorsConfigurationSource(handler) || CorsUtils.isPreFlightRequest(request)) &#123;</span><br><span class=\"line\">        CorsConfiguration config = (<span class=\"keyword\">this</span>.corsConfigurationSource != <span class=\"keyword\">null</span> ? <span class=\"keyword\">this</span>.corsConfigurationSource.getCorsConfiguration(request) : <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        CorsConfiguration handlerConfig = getCorsConfiguration(handler, request);</span><br><span class=\"line\">        config = (config != <span class=\"keyword\">null</span> ? config.combine(handlerConfig) : handlerConfig);</span><br><span class=\"line\">        executionChain = getCorsHandlerExecutionChain(request, executionChain, config);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> executionChain;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> HandlerExecutionChain <span class=\"title\">getHandlerExecutionChain</span><span class=\"params\">(Object handler, HttpServletRequest request)</span> </span>&#123;</span><br><span class=\"line\">    HandlerExecutionChain chain = (handler <span class=\"keyword\">instanceof</span> HandlerExecutionChain ?</span><br><span class=\"line\">                                   (HandlerExecutionChain) handler : <span class=\"keyword\">new</span> HandlerExecutionChain(handler));</span><br><span class=\"line\"></span><br><span class=\"line\">    String lookupPath = <span class=\"keyword\">this</span>.urlPathHelper.getLookupPathForRequest(request, LOOKUP_PATH);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (HandlerInterceptor interceptor : <span class=\"keyword\">this</span>.adaptedInterceptors) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (interceptor <span class=\"keyword\">instanceof</span> MappedInterceptor) &#123;</span><br><span class=\"line\">            MappedInterceptor mappedInterceptor = (MappedInterceptor) interceptor;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (mappedInterceptor.matches(lookupPath, <span class=\"keyword\">this</span>.pathMatcher)) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                chain.addInterceptor(mappedInterceptor.getInterceptor());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            chain.addInterceptor(interceptor);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> chain;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        springmvcDispatcherServlethandlerMappingHandlerExecutionChainHandlerAdapterHandlerAdapterServletInvocableHandlerMethodServletInvocableHandlerMethodadapterhandlerMethod</p>"},{"title":"subarray","date":"2021-02-27T05:45:38.000Z","_content":"\ntitlesubarray`map` + `preSum`\n\n<!-- more -->\n\n<!--toc-->\n\n# [Subarray Sum Equals K](https://leetcode.com/problems/subarray-sum-equals-k/)\n\nGiven an array of integers `nums` and an integer `k`, return *the total number of continuous subarrays whose sum equals to `k`*.\n\n\n\n```java\npublic int subarraySum(int[] nums, int k){\n    int res = 0;\n    for(int lo = 0, hi = 0, sum = 0; hi < nums.length; hi++){\n        sum += nums[i];\n        whlie(lo < nums.length && sum > k){\n            sum -= nums[lo++];\n        }\n        if(sum == k) res++;\n    }\n\n    return res;\n}\n```\n\nAC**Constraints**\n\n- `1 <= nums.length <= 2 * 104`\n- `-1000 <= nums[i] <= 1000`\n- `-107 <= k <= 107`\n\n`sum-= nums[lo++]`OK\n\n## map + preSum\n\n        `map``preSum`\n\n1,2,3,4,5,665P5152P23`P5 - P2`12\\[2, 3\\]maptarget`Px - Py = target (x > y)``Px - target = Py`map*Map\\<Integer, Integer\\>*****\n\n```java\npublic int subarraySum(int[] nums, int k){\n    if(nums.length == 0) return 0;\n    Map<Integer, Integer> map new HashMap<>();\n    int sum = 0, result = 0;\n    for(int cur : nums){\n        sum += cur; // preSum\n        if(sum == k) result++; //map map.put(0, 1)\n        result += map.getOrDefault(sum - k, 0);\n        map.put(sum, map.getOrDefault(sum, 0) + 1);\n    }\n\n    return result;\n}\n```\n\nmap`sum(i, j) = sum(0, j) - sum(0, i)`\n\n# [Minimum Operations to Reduce X to Zero](https://leetcode.com/problems/minimum-operations-to-reduce-x-to-zero)\n\nYou are given an integer array `nums` and an integer `x`. In one operation, you can either remove the leftmost or the rightmost element from the array `nums` and subtract its value from `x`. Note that this **modifies** the array for future operations.\n\nReturn *the **minimum number** of operations to reduce* `x` *to **exactly*** `0` *if it's possible**, otherwise, return* `-1`.\n\n**Constraints:**\n\n- `1 <= nums.length <= 105`\n- `1 <= nums[i] <= 104`\n- `1 <= x <= 109`\n\n        1,2,3,4,561515-6=996\n\n1\n\n```java\npublic int minOperations(int[] nums, int x){\n    int target = Arrays.stream(nums).sum() - x;\n    int size = -1, n = nums.length;\n    for(int lo = 0, hi = 0, sum = 0; hi < n; hi++){\n        sum += nums[hi];\n        while(lo < n && sum > target){\n            sum -= nums[lo++];\n        }\n        if(sum == target) size = Math.max(size, hi - lo + 1);\n    }\n    return size < 0 ? -1 : n - size;\n}\n```\n\n\n\n```java\npublic int minOperations(int[] nums, int x) {\n    int target = Arrays.stream(nums).sum() - x;\n    if(target == 0) return nums.length;\n    Map<Integer, Integer> map = new HashMap<>();\n    map.put(0, -1);//  i - map.value\n    int sum = 0, res = 0;\n    for(int i=0; i<nums.length; i++){\n        int num = nums[i];\n        sum += num;\n        if(map.containsKey(sum - target)){\n            res = Math.max(res, i - map.get(sum - target));\n        }\n        map.put(sum, i);\n    }\n\n    return res == 0 ? -1 : nums.length - res;\n}\n```\n","source":"_posts/subarray.md","raw":"---\ntitle: subarray\ndate: 2021-02-27 13:45:38\ncategories: leetcode\ntags: \n- double pointers\n- preSum\n---\n\ntitlesubarray`map` + `preSum`\n\n<!-- more -->\n\n<!--toc-->\n\n# [Subarray Sum Equals K](https://leetcode.com/problems/subarray-sum-equals-k/)\n\nGiven an array of integers `nums` and an integer `k`, return *the total number of continuous subarrays whose sum equals to `k`*.\n\n\n\n```java\npublic int subarraySum(int[] nums, int k){\n    int res = 0;\n    for(int lo = 0, hi = 0, sum = 0; hi < nums.length; hi++){\n        sum += nums[i];\n        whlie(lo < nums.length && sum > k){\n            sum -= nums[lo++];\n        }\n        if(sum == k) res++;\n    }\n\n    return res;\n}\n```\n\nAC**Constraints**\n\n- `1 <= nums.length <= 2 * 104`\n- `-1000 <= nums[i] <= 1000`\n- `-107 <= k <= 107`\n\n`sum-= nums[lo++]`OK\n\n## map + preSum\n\n        `map``preSum`\n\n1,2,3,4,5,665P5152P23`P5 - P2`12\\[2, 3\\]maptarget`Px - Py = target (x > y)``Px - target = Py`map*Map\\<Integer, Integer\\>*****\n\n```java\npublic int subarraySum(int[] nums, int k){\n    if(nums.length == 0) return 0;\n    Map<Integer, Integer> map new HashMap<>();\n    int sum = 0, result = 0;\n    for(int cur : nums){\n        sum += cur; // preSum\n        if(sum == k) result++; //map map.put(0, 1)\n        result += map.getOrDefault(sum - k, 0);\n        map.put(sum, map.getOrDefault(sum, 0) + 1);\n    }\n\n    return result;\n}\n```\n\nmap`sum(i, j) = sum(0, j) - sum(0, i)`\n\n# [Minimum Operations to Reduce X to Zero](https://leetcode.com/problems/minimum-operations-to-reduce-x-to-zero)\n\nYou are given an integer array `nums` and an integer `x`. In one operation, you can either remove the leftmost or the rightmost element from the array `nums` and subtract its value from `x`. Note that this **modifies** the array for future operations.\n\nReturn *the **minimum number** of operations to reduce* `x` *to **exactly*** `0` *if it's possible**, otherwise, return* `-1`.\n\n**Constraints:**\n\n- `1 <= nums.length <= 105`\n- `1 <= nums[i] <= 104`\n- `1 <= x <= 109`\n\n        1,2,3,4,561515-6=996\n\n1\n\n```java\npublic int minOperations(int[] nums, int x){\n    int target = Arrays.stream(nums).sum() - x;\n    int size = -1, n = nums.length;\n    for(int lo = 0, hi = 0, sum = 0; hi < n; hi++){\n        sum += nums[hi];\n        while(lo < n && sum > target){\n            sum -= nums[lo++];\n        }\n        if(sum == target) size = Math.max(size, hi - lo + 1);\n    }\n    return size < 0 ? -1 : n - size;\n}\n```\n\n\n\n```java\npublic int minOperations(int[] nums, int x) {\n    int target = Arrays.stream(nums).sum() - x;\n    if(target == 0) return nums.length;\n    Map<Integer, Integer> map = new HashMap<>();\n    map.put(0, -1);//  i - map.value\n    int sum = 0, res = 0;\n    for(int i=0; i<nums.length; i++){\n        int num = nums[i];\n        sum += num;\n        if(map.containsKey(sum - target)){\n            res = Math.max(res, i - map.get(sum - target));\n        }\n        map.put(sum, i);\n    }\n\n    return res == 0 ? -1 : nums.length - res;\n}\n```\n","slug":"subarray","published":1,"updated":"2022-12-09T14:32:40.853Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwo00448py07f5p74fe","content":"<p>titlesubarray<code>map</code> + <code>preSum</code></p>\n<span id=\"more\"></span>\n\n<!--toc-->\n\n<h1 id=\"Subarray-Sum-Equals-K\"><a href=\"#Subarray-Sum-Equals-K\" class=\"headerlink\" title=\"Subarray Sum Equals K\"></a><a class=\"link\"   href=\"https://leetcode.com/problems/subarray-sum-equals-k/\" >Subarray Sum Equals K<i class=\"fas fa-external-link-alt\"></i></a></h1><p>Given an array of integers <code>nums</code> and an integer <code>k</code>, return <em>the total number of continuous subarrays whose sum equals to <code>k</code></em>.</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">subarraySum</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> lo = <span class=\"number\">0</span>, hi = <span class=\"number\">0</span>, sum = <span class=\"number\">0</span>; hi &lt; nums.length; hi++)&#123;</span><br><span class=\"line\">        sum += nums[i];</span><br><span class=\"line\">        whlie(lo &lt; nums.length &amp;&amp; sum &gt; k)&#123;</span><br><span class=\"line\">            sum -= nums[lo++];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == k) res++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AC<strong>Constraints</strong></p>\n<ul>\n<li><code>1 &lt;= nums.length &lt;= 2 * 104</code></li>\n<li><code>-1000 &lt;= nums[i] &lt;= 1000</code></li>\n<li><code>-107 &lt;= k &lt;= 107</code></li>\n</ul>\n<p><code>sum-= nums[lo++]</code>OK</p>\n<h2 id=\"map-preSum\"><a href=\"#map-preSum\" class=\"headerlink\" title=\"map + preSum\"></a>map + preSum</h2><p>        <code>map</code><code>preSum</code></p>\n<p>1,2,3,4,5,665P5152P23<code>P5 - P2</code>12[2, 3]maptarget<code>Px - Py = target (x &gt; y)</code><code>Px - target = Py</code>map<em>Map&lt;Integer, Integer&gt;<em></em></em><em></em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">subarraySum</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(nums.length == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    Map&lt;Integer, Integer&gt; map <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>, result = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> cur : nums)&#123;</span><br><span class=\"line\">        sum += cur; <span class=\"comment\">// preSum</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == k) result++; <span class=\"comment\">//map map.put(0, 1)</span></span><br><span class=\"line\">        result += map.getOrDefault(sum - k, <span class=\"number\">0</span>);</span><br><span class=\"line\">        map.put(sum, map.getOrDefault(sum, <span class=\"number\">0</span>) + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>map<code>sum(i, j) = sum(0, j) - sum(0, i)</code></p>\n<h1 id=\"Minimum-Operations-to-Reduce-X-to-Zero\"><a href=\"#Minimum-Operations-to-Reduce-X-to-Zero\" class=\"headerlink\" title=\"Minimum Operations to Reduce X to Zero\"></a><a class=\"link\"   href=\"https://leetcode.com/problems/minimum-operations-to-reduce-x-to-zero\" >Minimum Operations to Reduce X to Zero<i class=\"fas fa-external-link-alt\"></i></a></h1><p>You are given an integer array <code>nums</code> and an integer <code>x</code>. In one operation, you can either remove the leftmost or the rightmost element from the array <code>nums</code> and subtract its value from <code>x</code>. Note that this <strong>modifies</strong> the array for future operations.</p>\n<p>Return <em>the <strong>minimum number</strong> of operations to reduce</em> <code>x</code> <em>to <strong>exactly</strong></em> <code>0</code> <em>if its possible**, otherwise, return</em> <code>-1</code>.</p>\n<p><strong>Constraints:</strong></p>\n<ul>\n<li><code>1 &lt;= nums.length &lt;= 105</code></li>\n<li><code>1 &lt;= nums[i] &lt;= 104</code></li>\n<li><code>1 &lt;= x &lt;= 109</code></li>\n</ul>\n<p>        1,2,3,4,561515-6=996</p>\n<p>1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> target = Arrays.stream(nums).sum() - x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> size = -<span class=\"number\">1</span>, n = nums.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> lo = <span class=\"number\">0</span>, hi = <span class=\"number\">0</span>, sum = <span class=\"number\">0</span>; hi &lt; n; hi++)&#123;</span><br><span class=\"line\">        sum += nums[hi];</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(lo &lt; n &amp;&amp; sum &gt; target)&#123;</span><br><span class=\"line\">            sum -= nums[lo++];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == target) size = Math.max(size, hi - lo + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> size &lt; <span class=\"number\">0</span> ? -<span class=\"number\">1</span> : n - size;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> target = Arrays.stream(nums).sum() - x;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> nums.length;</span><br><span class=\"line\">    Map&lt;Integer, Integer&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    map.put(<span class=\"number\">0</span>, -<span class=\"number\">1</span>);<span class=\"comment\">//  i - map.value</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>, res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;nums.length; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> num = nums[i];</span><br><span class=\"line\">        sum += num;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(map.containsKey(sum - target))&#123;</span><br><span class=\"line\">            res = Math.max(res, i - map.get(sum - target));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        map.put(sum, i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res == <span class=\"number\">0</span> ? -<span class=\"number\">1</span> : nums.length - res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>titlesubarray<code>map</code> + <code>preSum</code></p>","more":"<!--toc-->\n\n<h1 id=\"Subarray-Sum-Equals-K\"><a href=\"#Subarray-Sum-Equals-K\" class=\"headerlink\" title=\"Subarray Sum Equals K\"></a><a class=\"link\"   href=\"https://leetcode.com/problems/subarray-sum-equals-k/\" >Subarray Sum Equals K<i class=\"fas fa-external-link-alt\"></i></a></h1><p>Given an array of integers <code>nums</code> and an integer <code>k</code>, return <em>the total number of continuous subarrays whose sum equals to <code>k</code></em>.</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">subarraySum</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> lo = <span class=\"number\">0</span>, hi = <span class=\"number\">0</span>, sum = <span class=\"number\">0</span>; hi &lt; nums.length; hi++)&#123;</span><br><span class=\"line\">        sum += nums[i];</span><br><span class=\"line\">        whlie(lo &lt; nums.length &amp;&amp; sum &gt; k)&#123;</span><br><span class=\"line\">            sum -= nums[lo++];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == k) res++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AC<strong>Constraints</strong></p>\n<ul>\n<li><code>1 &lt;= nums.length &lt;= 2 * 104</code></li>\n<li><code>-1000 &lt;= nums[i] &lt;= 1000</code></li>\n<li><code>-107 &lt;= k &lt;= 107</code></li>\n</ul>\n<p><code>sum-= nums[lo++]</code>OK</p>\n<h2 id=\"map-preSum\"><a href=\"#map-preSum\" class=\"headerlink\" title=\"map + preSum\"></a>map + preSum</h2><p>        <code>map</code><code>preSum</code></p>\n<p>1,2,3,4,5,665P5152P23<code>P5 - P2</code>12[2, 3]maptarget<code>Px - Py = target (x &gt; y)</code><code>Px - target = Py</code>map<em>Map&lt;Integer, Integer&gt;<em></em></em><em></em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">subarraySum</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(nums.length == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    Map&lt;Integer, Integer&gt; map <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>, result = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> cur : nums)&#123;</span><br><span class=\"line\">        sum += cur; <span class=\"comment\">// preSum</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == k) result++; <span class=\"comment\">//map map.put(0, 1)</span></span><br><span class=\"line\">        result += map.getOrDefault(sum - k, <span class=\"number\">0</span>);</span><br><span class=\"line\">        map.put(sum, map.getOrDefault(sum, <span class=\"number\">0</span>) + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>map<code>sum(i, j) = sum(0, j) - sum(0, i)</code></p>\n<h1 id=\"Minimum-Operations-to-Reduce-X-to-Zero\"><a href=\"#Minimum-Operations-to-Reduce-X-to-Zero\" class=\"headerlink\" title=\"Minimum Operations to Reduce X to Zero\"></a><a class=\"link\"   href=\"https://leetcode.com/problems/minimum-operations-to-reduce-x-to-zero\" >Minimum Operations to Reduce X to Zero<i class=\"fas fa-external-link-alt\"></i></a></h1><p>You are given an integer array <code>nums</code> and an integer <code>x</code>. In one operation, you can either remove the leftmost or the rightmost element from the array <code>nums</code> and subtract its value from <code>x</code>. Note that this <strong>modifies</strong> the array for future operations.</p>\n<p>Return <em>the <strong>minimum number</strong> of operations to reduce</em> <code>x</code> <em>to <strong>exactly</strong></em> <code>0</code> <em>if its possible**, otherwise, return</em> <code>-1</code>.</p>\n<p><strong>Constraints:</strong></p>\n<ul>\n<li><code>1 &lt;= nums.length &lt;= 105</code></li>\n<li><code>1 &lt;= nums[i] &lt;= 104</code></li>\n<li><code>1 &lt;= x &lt;= 109</code></li>\n</ul>\n<p>        1,2,3,4,561515-6=996</p>\n<p>1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> target = Arrays.stream(nums).sum() - x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> size = -<span class=\"number\">1</span>, n = nums.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> lo = <span class=\"number\">0</span>, hi = <span class=\"number\">0</span>, sum = <span class=\"number\">0</span>; hi &lt; n; hi++)&#123;</span><br><span class=\"line\">        sum += nums[hi];</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(lo &lt; n &amp;&amp; sum &gt; target)&#123;</span><br><span class=\"line\">            sum -= nums[lo++];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == target) size = Math.max(size, hi - lo + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> size &lt; <span class=\"number\">0</span> ? -<span class=\"number\">1</span> : n - size;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> target = Arrays.stream(nums).sum() - x;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> nums.length;</span><br><span class=\"line\">    Map&lt;Integer, Integer&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    map.put(<span class=\"number\">0</span>, -<span class=\"number\">1</span>);<span class=\"comment\">//  i - map.value</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>, res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;nums.length; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> num = nums[i];</span><br><span class=\"line\">        sum += num;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(map.containsKey(sum - target))&#123;</span><br><span class=\"line\">            res = Math.max(res, i - map.get(sum - target));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        map.put(sum, i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res == <span class=\"number\">0</span> ? -<span class=\"number\">1</span> : nums.length - res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"uml","date":"2020-01-12T15:14:16.000Z","_content":"\nThe **Unified Modeling Language(UML)** is a general-purpose, developmental, modeling language in the field of software engineering that is intended to provide a standard way to visualize the design of a system.\n\n<!-- more -->\n\n# \n\nUML(Class Relationships)\n\n[reference1](https://www.visual-paradigm.com/cn/guide/), [reference2](https://support.typora.io/Draw-Diagrams-With-Markdown/)\n\n## Class Relationships\n\nA class may be involved in one or more relationships with other classes.\n\n## Inheritance(or Generalization)\n\n- Represents an \"is-a\" relationship\n- An abstract class name is shown *in italics*\n- SubClass1 and SubClass2 are specializations of Super Class\n- **A solid line with a hollow arrowhead that point <u>from the child to the parent class</u>**\n\n```mermaid\nclassDiagram\nClass <|-- SubClass1\nClass <|-- SubClass2 \n```\n\n---\n\n## Simple Association\n\n- A structural link between two peer classes\n- There is an association between Class1 and Class2\n- **A solid line connecting two classes**\n\n```mermaid\nclassDiagram\nClass1 .. Class2\n```\n\n---\n\n## Aggregation\n\nA special type of association. It represents a \"part of\" relationship.\n\n- Class2 is part of Class1.\n- Many instances(denoted by the *) of Class2 can be associated with Class1\n- Objects of Class1 and Class2 have separate lifetimes\n- **A solid line with an unfilled diamond at the association end connected to the class of composite**\n\n```mermaid\nclassDiagram\nClass1 o-- Class2\n```\n\n---\n\n## Composition\n\nA special type of aggregation **where parts are destroyed when the whole is destroyed.**\n\n- Objects of Class2 live and die with Class1\n- Class2 cannot stand by itself\n- **A solid line with a filled diamond at the association connected to the class of composite**\n\n```mermaid\nclassDiagram\nClass1 *-- Class2\n```\n\n---\n\n## Dependency\n\n- Exists between two classes if the changes to the definition of one may cause changes to the other (but not the other way around)\n- Class1 depends on Class2\n- A dashed line with an open arrow\n\n```mermaid\nclassDiagram\nClass1 ..> Class2\n```\n","source":"_posts/uml.md","raw":"---\ntitle: uml\ndate: 2020-01-12 23:14:16\ncategories: Utils\ntags: utils\n---\n\nThe **Unified Modeling Language(UML)** is a general-purpose, developmental, modeling language in the field of software engineering that is intended to provide a standard way to visualize the design of a system.\n\n<!-- more -->\n\n# \n\nUML(Class Relationships)\n\n[reference1](https://www.visual-paradigm.com/cn/guide/), [reference2](https://support.typora.io/Draw-Diagrams-With-Markdown/)\n\n## Class Relationships\n\nA class may be involved in one or more relationships with other classes.\n\n## Inheritance(or Generalization)\n\n- Represents an \"is-a\" relationship\n- An abstract class name is shown *in italics*\n- SubClass1 and SubClass2 are specializations of Super Class\n- **A solid line with a hollow arrowhead that point <u>from the child to the parent class</u>**\n\n```mermaid\nclassDiagram\nClass <|-- SubClass1\nClass <|-- SubClass2 \n```\n\n---\n\n## Simple Association\n\n- A structural link between two peer classes\n- There is an association between Class1 and Class2\n- **A solid line connecting two classes**\n\n```mermaid\nclassDiagram\nClass1 .. Class2\n```\n\n---\n\n## Aggregation\n\nA special type of association. It represents a \"part of\" relationship.\n\n- Class2 is part of Class1.\n- Many instances(denoted by the *) of Class2 can be associated with Class1\n- Objects of Class1 and Class2 have separate lifetimes\n- **A solid line with an unfilled diamond at the association end connected to the class of composite**\n\n```mermaid\nclassDiagram\nClass1 o-- Class2\n```\n\n---\n\n## Composition\n\nA special type of aggregation **where parts are destroyed when the whole is destroyed.**\n\n- Objects of Class2 live and die with Class1\n- Class2 cannot stand by itself\n- **A solid line with a filled diamond at the association connected to the class of composite**\n\n```mermaid\nclassDiagram\nClass1 *-- Class2\n```\n\n---\n\n## Dependency\n\n- Exists between two classes if the changes to the definition of one may cause changes to the other (but not the other way around)\n- Class1 depends on Class2\n- A dashed line with an open arrow\n\n```mermaid\nclassDiagram\nClass1 ..> Class2\n```\n","slug":"uml","published":1,"updated":"2022-11-24T11:56:25.610Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrwp00488py017c74r2w","content":"<p>The <strong>Unified Modeling Language(UML)</strong> is a general-purpose, developmental, modeling language in the field of software engineering that is intended to provide a standard way to visualize the design of a system.</p>\n<span id=\"more\"></span>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>UML(Class Relationships)</p>\n<p><a class=\"link\"   href=\"https://www.visual-paradigm.com/cn/guide/\" >reference1<i class=\"fas fa-external-link-alt\"></i></a>, <a class=\"link\"   href=\"https://support.typora.io/Draw-Diagrams-With-Markdown/\" >reference2<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h2 id=\"Class-Relationships\"><a href=\"#Class-Relationships\" class=\"headerlink\" title=\"Class Relationships\"></a>Class Relationships</h2><p>A class may be involved in one or more relationships with other classes.</p>\n<h2 id=\"Inheritance-or-Generalization\"><a href=\"#Inheritance-or-Generalization\" class=\"headerlink\" title=\"Inheritance(or Generalization)\"></a>Inheritance(or Generalization)</h2><ul>\n<li>Represents an is-a relationship</li>\n<li>An abstract class name is shown <em>in italics</em></li>\n<li>SubClass1 and SubClass2 are specializations of Super Class</li>\n<li><strong>A solid line with a hollow arrowhead that point <u>from the child to the parent class</u></strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class &lt;|-- SubClass1</span><br><span class=\"line\">Class &lt;|-- SubClass2 </span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Simple-Association\"><a href=\"#Simple-Association\" class=\"headerlink\" title=\"Simple Association\"></a>Simple Association</h2><ul>\n<li>A structural link between two peer classes</li>\n<li>There is an association between Class1 and Class2</li>\n<li><strong>A solid line connecting two classes</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 .. Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Aggregation\"><a href=\"#Aggregation\" class=\"headerlink\" title=\"Aggregation\"></a>Aggregation</h2><p>A special type of association. It represents a part of relationship.</p>\n<ul>\n<li>Class2 is part of Class1.</li>\n<li>Many instances(denoted by the *) of Class2 can be associated with Class1</li>\n<li>Objects of Class1 and Class2 have separate lifetimes</li>\n<li><strong>A solid line with an unfilled diamond at the association end connected to the class of composite</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 o-- Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Composition\"><a href=\"#Composition\" class=\"headerlink\" title=\"Composition\"></a>Composition</h2><p>A special type of aggregation <strong>where parts are destroyed when the whole is destroyed.</strong></p>\n<ul>\n<li>Objects of Class2 live and die with Class1</li>\n<li>Class2 cannot stand by itself</li>\n<li><strong>A solid line with a filled diamond at the association connected to the class of composite</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 *-- Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Dependency\"><a href=\"#Dependency\" class=\"headerlink\" title=\"Dependency\"></a>Dependency</h2><ul>\n<li>Exists between two classes if the changes to the definition of one may cause changes to the other (but not the other way around)</li>\n<li>Class1 depends on Class2</li>\n<li>A dashed line with an open arrow</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 ..&gt; Class2</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>The <strong>Unified Modeling Language(UML)</strong> is a general-purpose, developmental, modeling language in the field of software engineering that is intended to provide a standard way to visualize the design of a system.</p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>UML(Class Relationships)</p>\n<p><a class=\"link\"   href=\"https://www.visual-paradigm.com/cn/guide/\" >reference1<i class=\"fas fa-external-link-alt\"></i></a>, <a class=\"link\"   href=\"https://support.typora.io/Draw-Diagrams-With-Markdown/\" >reference2<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h2 id=\"Class-Relationships\"><a href=\"#Class-Relationships\" class=\"headerlink\" title=\"Class Relationships\"></a>Class Relationships</h2><p>A class may be involved in one or more relationships with other classes.</p>\n<h2 id=\"Inheritance-or-Generalization\"><a href=\"#Inheritance-or-Generalization\" class=\"headerlink\" title=\"Inheritance(or Generalization)\"></a>Inheritance(or Generalization)</h2><ul>\n<li>Represents an is-a relationship</li>\n<li>An abstract class name is shown <em>in italics</em></li>\n<li>SubClass1 and SubClass2 are specializations of Super Class</li>\n<li><strong>A solid line with a hollow arrowhead that point <u>from the child to the parent class</u></strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class &lt;|-- SubClass1</span><br><span class=\"line\">Class &lt;|-- SubClass2 </span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Simple-Association\"><a href=\"#Simple-Association\" class=\"headerlink\" title=\"Simple Association\"></a>Simple Association</h2><ul>\n<li>A structural link between two peer classes</li>\n<li>There is an association between Class1 and Class2</li>\n<li><strong>A solid line connecting two classes</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 .. Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Aggregation\"><a href=\"#Aggregation\" class=\"headerlink\" title=\"Aggregation\"></a>Aggregation</h2><p>A special type of association. It represents a part of relationship.</p>\n<ul>\n<li>Class2 is part of Class1.</li>\n<li>Many instances(denoted by the *) of Class2 can be associated with Class1</li>\n<li>Objects of Class1 and Class2 have separate lifetimes</li>\n<li><strong>A solid line with an unfilled diamond at the association end connected to the class of composite</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 o-- Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Composition\"><a href=\"#Composition\" class=\"headerlink\" title=\"Composition\"></a>Composition</h2><p>A special type of aggregation <strong>where parts are destroyed when the whole is destroyed.</strong></p>\n<ul>\n<li>Objects of Class2 live and die with Class1</li>\n<li>Class2 cannot stand by itself</li>\n<li><strong>A solid line with a filled diamond at the association connected to the class of composite</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 *-- Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Dependency\"><a href=\"#Dependency\" class=\"headerlink\" title=\"Dependency\"></a>Dependency</h2><ul>\n<li>Exists between two classes if the changes to the definition of one may cause changes to the other (but not the other way around)</li>\n<li>Class1 depends on Class2</li>\n<li>A dashed line with an open arrow</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 ..&gt; Class2</span><br></pre></td></tr></table></figure>"},{"title":"springmvc-dispatcherservlet","date":"2021-04-06T05:59:49.000Z","_content":"\nspringmvc springioc `DispatcherServlet`springboot\n\n<!-- more -->\n\n<!-- toc -->\n\n# HttpServletBean\n\n```properties\n-- HttpServlet\n    -- HttpServletBean\n        -- FrameworkServlet\n            -- DispatcherServlet\n```\n\n`HttpServlet`javaxhttpservletspringmvcbean`EnvironmentCapable``EnvironmentAware`spring\n\n```java\npublic interface EnvironmentCapable{\n    Environment getEnvironment();\n}\n\npublic interface EnvironmentAware extends Aware{\n    void setEnvironment(Environment environment);\n```\n\n`HttpServletBean`*init()*\n\n```java\npublic final void init() throws ServletException {\n\n   // Set bean properties from init parameters.\n   PropertyValues pvs = new ServletConfigPropertyValues(getServletConfig(), this.requiredProperties);\n   if (!pvs.isEmpty()) {\n      try {\n          // beanWrapperservletBean\n         BeanWrapper bw = PropertyAccessorFactory.forBeanPropertyAccess(this);\n         ResourceLoader resourceLoader = new ServletContextResourceLoader(getServletContext());\n         bw.registerCustomEditor(Resource.class, new ResourceEditor(resourceLoader, getEnvironment()));\n         initBeanWrapper(bw);\n         bw.setPropertyValues(pvs, true);\n      }\n      catch (BeansException ex) {\n         if (logger.isErrorEnabled()) {\n            logger.error(\"Failed to set bean properties on servlet '\" + getServletName() + \"'\", ex);\n         }\n         throw ex;\n      }\n   }\n\n    // \n   // Let subclasses do whatever initialization they like.\n   initServletBean();\n}\n```\n\n# FrameworkServlet\n\nspring\n\n- servletweb\n- \n\n`HttpServletBean`*initServletBean()*\n\n```java\nprotected final void initServletBean() throws ServletException {\n    // log...\n   try {\n       // WebApplicationContext\n      this.webApplicationContext = initWebApplicationContext();\n       // \n      initFrameworkServlet();\n   }\n   catch (ServletException | RuntimeException ex) {\n      logger.error(\"Context initialization failed\", ex);\n      throw ex;\n   }\n   // log...\n}\n```\n\n```java\nprotected WebApplicationContext initWebApplicationContext() {\n   WebApplicationContext rootContext =\n         WebApplicationContextUtils.getWebApplicationContext(getServletContext());\n   WebApplicationContext wac = null;\n\n   if (this.webApplicationContext != null) {\n      // A context instance was injected at construction time -> use it\n      wac = this.webApplicationContext;\n      if (wac instanceof ConfigurableWebApplicationContext) {\n         ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) wac;\n         if (!cwac.isActive()) {\n            // The context has not yet been refreshed -> provide services such as\n            // setting the parent context, setting the application context id, etc\n            if (cwac.getParent() == null) {\n               // The context instance was injected without an explicit parent -> set\n               // the root application context (if any; may be null) as the parent\n               cwac.setParent(rootContext);\n            }\n            configureAndRefreshWebApplicationContext(cwac);\n         }\n      }\n   }\n   if (wac == null) {\n      // No context instance was injected at construction time -> see if one\n      // has been registered in the servlet context. If one exists, it is assumed\n      // that the parent context (if any) has already been set and that the\n      // user has performed any initialization such as setting the context id\n      wac = findWebApplicationContext();\n   }\n   if (wac == null) {\n      // No context instance is defined for this servlet -> create a local one\n      wac = createWebApplicationContext(rootContext);\n   }\n\n   if (!this.refreshEventReceived) {\n      // Either the context is not a ConfigurableApplicationContext with refresh\n      // support or the context injected at construction time had already been\n      // refreshed -> trigger initial onRefresh manually here.\n      synchronized (this.onRefreshMonitor) {\n         // \n         onRefresh(wac);\n      }\n   }\n\n   if (this.publishContext) {\n      // Publish the context as a servlet context attribute.\n      String attrName = getServletContextAttributeName();\n      getServletContext().setAttribute(attrName, wac);\n   }\n\n   return wac;\n}\n```\n\nwebApplicationContext\n\n- servlet\n- \n\n# DispatcherServlet\n\n`initFrameworkdServlet()``onRefresh()`\n\n```java\n    @Override\n    protected void onRefresh(ApplicationContext context) {\n        initStrategies(context);\n    }\n\n    /**\n     * Initialize the strategy objects that this servlet uses.\n     * <p>May be overridden in subclasses in order to initialize further strategy objects.\n     */\n    protected void initStrategies(ApplicationContext context) {\n        initMultipartResolver(context);\n        initLocaleResolver(context);\n        initThemeResolver(context);\n        initHandlerMappings(context);\n        initHandlerAdapters(context);\n        initHandlerExceptionResolvers(context);\n        initRequestToViewNameTranslator(context);\n        initViewResolvers(context);\n        initFlashMapManager(context);\n    }\n```\n\n*HandlerMapping**HandlerExceptionResolvers*\n\n`HttpServletBean``HttpServlet`Bean`FrameworkServlet`spring\n\n## \n\n`HttpSrevlet`POSTGET`HttpServletBean`bean`FrameworkServlet`*service()*\n\n```java\nprotected void service(HttpServletRequest request, HttpServletResponse response)\n      throws ServletException, IOException {\n\n   HttpMethod httpMethod = HttpMethod.resolve(request.getMethod());\n    // PATHCHnull\n   if (httpMethod == HttpMethod.PATCH || httpMethod == null) {\n      processRequest(request, response);\n   }\n   else {\n      super.service(request, response);\n   }\n}\n```\n\n```java\nprotected final void processRequest(HttpServletRequest request, HttpServletResponse response)\n    throws ServletException, IOException {\n\n    long startTime = System.currentTimeMillis();\n    Throwable failureCause = null;\n\n    // \n    LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext();\n    LocaleContext localeContext = buildLocaleContext(request);\n\n    RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes();\n    ServletRequestAttributes requestAttributes = buildRequestAttributes(request, response, previousAttributes);\n\n    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);\n    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), new RequestBindingInterceptor());\n\n    initContextHolders(request, localeContext, requestAttributes);\n\n    try {\n        // Dispatcherservlet\n        doService(request, response);\n    }\n    catch (ServletException | IOException ex) {\n        failureCause = ex;\n        throw ex;\n    }\n    catch (Throwable ex) {\n        failureCause = ex;\n        throw new NestedServletException(\"Request processing failed\", ex);\n    }\n\n    finally {\n        resetContextHolders(request, previousLocaleContext, previousAttributes);\n        if (requestAttributes != null) {\n            requestAttributes.requestCompleted();\n        }\n        logResult(request, response, failureCause, asyncManager);\n        publishRequestHandledEvent(request, response, startTime, failureCause);\n    }\n}\n```\n\n```java\nprotected void doService(HttpServletRequest request, HttpServletResponse response) throws Exception {\n    logRequest(request);\n\n    // Keep a snapshot of the request attributes in case of an include,\n    // to be able to restore the original attributes after the include.\n    Map<String, Object> attributesSnapshot = null;\n    // include\n    if (WebUtils.isIncludeRequest(request)) {\n        attributesSnapshot = new HashMap<>();\n        Enumeration<?> attrNames = request.getAttributeNames();\n        while (attrNames.hasMoreElements()) {\n            String attrName = (String) attrNames.nextElement();\n            if (this.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) {\n                attributesSnapshot.put(attrName, request.getAttribute(attrName));\n            }\n        }\n    }\n\n    // Make framework objects available to handlers and view objects.\n    request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext());\n    request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, this.localeResolver);\n    request.setAttribute(THEME_RESOLVER_ATTRIBUTE, this.themeResolver);\n    request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource());\n\n    if (this.flashMapManager != null) {\n        FlashMap inputFlashMap = this.flashMapManager.retrieveAndUpdate(request, response);\n        if (inputFlashMap != null) {\n            request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap));\n        }\n        request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, new FlashMap());\n        request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, this.flashMapManager);\n    }\n\n    try {\n        // \n        doDispatch(request, response);\n    }\n    finally {\n        if (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) {\n            // Restore the original attribute snapshot, in case of an include.\n            if (attributesSnapshot != null) {\n                restoreAttributesAfterInclude(request, attributesSnapshot);\n            }\n        }\n    }\n}\n```\n\n`FrameworkServlet``DispatcherServlet`PATCHnull`DispatcherServlet`*doDispatcherf()**processRequest()*process`FrameworkServlet`*doPost()**doGet()*`FrameworkServlet``HttpServlet`\n\n```java\nprotected final void doGet(HttpServletRequest request, HttpServletResponse response)\n    throws ServletException, IOException {\n\n    processRequest(request, response);\n}\n\n/**\n * Delegate POST requests to {@link #processRequest}.\n * @see #doService\n */\n@Override\nprotected final void doPost(HttpServletRequest request, HttpServletResponse response)\n    throws ServletException, IOException {\n\n    processRequest(request, response);\n```\n\n# \n\nDispatcherServletspringcontroller*doDispatch(request, response)*","source":"_posts/springmvc-dispatcherservlet.md","raw":"---\ntitle: springmvc-dispatcherservlet\ndate: 2021-04-06 13:59:49\ncategories: springmvc\ntags: dispatcherservlet\n---\n\nspringmvc springioc `DispatcherServlet`springboot\n\n<!-- more -->\n\n<!-- toc -->\n\n# HttpServletBean\n\n```properties\n-- HttpServlet\n    -- HttpServletBean\n        -- FrameworkServlet\n            -- DispatcherServlet\n```\n\n`HttpServlet`javaxhttpservletspringmvcbean`EnvironmentCapable``EnvironmentAware`spring\n\n```java\npublic interface EnvironmentCapable{\n    Environment getEnvironment();\n}\n\npublic interface EnvironmentAware extends Aware{\n    void setEnvironment(Environment environment);\n```\n\n`HttpServletBean`*init()*\n\n```java\npublic final void init() throws ServletException {\n\n   // Set bean properties from init parameters.\n   PropertyValues pvs = new ServletConfigPropertyValues(getServletConfig(), this.requiredProperties);\n   if (!pvs.isEmpty()) {\n      try {\n          // beanWrapperservletBean\n         BeanWrapper bw = PropertyAccessorFactory.forBeanPropertyAccess(this);\n         ResourceLoader resourceLoader = new ServletContextResourceLoader(getServletContext());\n         bw.registerCustomEditor(Resource.class, new ResourceEditor(resourceLoader, getEnvironment()));\n         initBeanWrapper(bw);\n         bw.setPropertyValues(pvs, true);\n      }\n      catch (BeansException ex) {\n         if (logger.isErrorEnabled()) {\n            logger.error(\"Failed to set bean properties on servlet '\" + getServletName() + \"'\", ex);\n         }\n         throw ex;\n      }\n   }\n\n    // \n   // Let subclasses do whatever initialization they like.\n   initServletBean();\n}\n```\n\n# FrameworkServlet\n\nspring\n\n- servletweb\n- \n\n`HttpServletBean`*initServletBean()*\n\n```java\nprotected final void initServletBean() throws ServletException {\n    // log...\n   try {\n       // WebApplicationContext\n      this.webApplicationContext = initWebApplicationContext();\n       // \n      initFrameworkServlet();\n   }\n   catch (ServletException | RuntimeException ex) {\n      logger.error(\"Context initialization failed\", ex);\n      throw ex;\n   }\n   // log...\n}\n```\n\n```java\nprotected WebApplicationContext initWebApplicationContext() {\n   WebApplicationContext rootContext =\n         WebApplicationContextUtils.getWebApplicationContext(getServletContext());\n   WebApplicationContext wac = null;\n\n   if (this.webApplicationContext != null) {\n      // A context instance was injected at construction time -> use it\n      wac = this.webApplicationContext;\n      if (wac instanceof ConfigurableWebApplicationContext) {\n         ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) wac;\n         if (!cwac.isActive()) {\n            // The context has not yet been refreshed -> provide services such as\n            // setting the parent context, setting the application context id, etc\n            if (cwac.getParent() == null) {\n               // The context instance was injected without an explicit parent -> set\n               // the root application context (if any; may be null) as the parent\n               cwac.setParent(rootContext);\n            }\n            configureAndRefreshWebApplicationContext(cwac);\n         }\n      }\n   }\n   if (wac == null) {\n      // No context instance was injected at construction time -> see if one\n      // has been registered in the servlet context. If one exists, it is assumed\n      // that the parent context (if any) has already been set and that the\n      // user has performed any initialization such as setting the context id\n      wac = findWebApplicationContext();\n   }\n   if (wac == null) {\n      // No context instance is defined for this servlet -> create a local one\n      wac = createWebApplicationContext(rootContext);\n   }\n\n   if (!this.refreshEventReceived) {\n      // Either the context is not a ConfigurableApplicationContext with refresh\n      // support or the context injected at construction time had already been\n      // refreshed -> trigger initial onRefresh manually here.\n      synchronized (this.onRefreshMonitor) {\n         // \n         onRefresh(wac);\n      }\n   }\n\n   if (this.publishContext) {\n      // Publish the context as a servlet context attribute.\n      String attrName = getServletContextAttributeName();\n      getServletContext().setAttribute(attrName, wac);\n   }\n\n   return wac;\n}\n```\n\nwebApplicationContext\n\n- servlet\n- \n\n# DispatcherServlet\n\n`initFrameworkdServlet()``onRefresh()`\n\n```java\n    @Override\n    protected void onRefresh(ApplicationContext context) {\n        initStrategies(context);\n    }\n\n    /**\n     * Initialize the strategy objects that this servlet uses.\n     * <p>May be overridden in subclasses in order to initialize further strategy objects.\n     */\n    protected void initStrategies(ApplicationContext context) {\n        initMultipartResolver(context);\n        initLocaleResolver(context);\n        initThemeResolver(context);\n        initHandlerMappings(context);\n        initHandlerAdapters(context);\n        initHandlerExceptionResolvers(context);\n        initRequestToViewNameTranslator(context);\n        initViewResolvers(context);\n        initFlashMapManager(context);\n    }\n```\n\n*HandlerMapping**HandlerExceptionResolvers*\n\n`HttpServletBean``HttpServlet`Bean`FrameworkServlet`spring\n\n## \n\n`HttpSrevlet`POSTGET`HttpServletBean`bean`FrameworkServlet`*service()*\n\n```java\nprotected void service(HttpServletRequest request, HttpServletResponse response)\n      throws ServletException, IOException {\n\n   HttpMethod httpMethod = HttpMethod.resolve(request.getMethod());\n    // PATHCHnull\n   if (httpMethod == HttpMethod.PATCH || httpMethod == null) {\n      processRequest(request, response);\n   }\n   else {\n      super.service(request, response);\n   }\n}\n```\n\n```java\nprotected final void processRequest(HttpServletRequest request, HttpServletResponse response)\n    throws ServletException, IOException {\n\n    long startTime = System.currentTimeMillis();\n    Throwable failureCause = null;\n\n    // \n    LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext();\n    LocaleContext localeContext = buildLocaleContext(request);\n\n    RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes();\n    ServletRequestAttributes requestAttributes = buildRequestAttributes(request, response, previousAttributes);\n\n    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);\n    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), new RequestBindingInterceptor());\n\n    initContextHolders(request, localeContext, requestAttributes);\n\n    try {\n        // Dispatcherservlet\n        doService(request, response);\n    }\n    catch (ServletException | IOException ex) {\n        failureCause = ex;\n        throw ex;\n    }\n    catch (Throwable ex) {\n        failureCause = ex;\n        throw new NestedServletException(\"Request processing failed\", ex);\n    }\n\n    finally {\n        resetContextHolders(request, previousLocaleContext, previousAttributes);\n        if (requestAttributes != null) {\n            requestAttributes.requestCompleted();\n        }\n        logResult(request, response, failureCause, asyncManager);\n        publishRequestHandledEvent(request, response, startTime, failureCause);\n    }\n}\n```\n\n```java\nprotected void doService(HttpServletRequest request, HttpServletResponse response) throws Exception {\n    logRequest(request);\n\n    // Keep a snapshot of the request attributes in case of an include,\n    // to be able to restore the original attributes after the include.\n    Map<String, Object> attributesSnapshot = null;\n    // include\n    if (WebUtils.isIncludeRequest(request)) {\n        attributesSnapshot = new HashMap<>();\n        Enumeration<?> attrNames = request.getAttributeNames();\n        while (attrNames.hasMoreElements()) {\n            String attrName = (String) attrNames.nextElement();\n            if (this.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) {\n                attributesSnapshot.put(attrName, request.getAttribute(attrName));\n            }\n        }\n    }\n\n    // Make framework objects available to handlers and view objects.\n    request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext());\n    request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, this.localeResolver);\n    request.setAttribute(THEME_RESOLVER_ATTRIBUTE, this.themeResolver);\n    request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource());\n\n    if (this.flashMapManager != null) {\n        FlashMap inputFlashMap = this.flashMapManager.retrieveAndUpdate(request, response);\n        if (inputFlashMap != null) {\n            request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap));\n        }\n        request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, new FlashMap());\n        request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, this.flashMapManager);\n    }\n\n    try {\n        // \n        doDispatch(request, response);\n    }\n    finally {\n        if (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) {\n            // Restore the original attribute snapshot, in case of an include.\n            if (attributesSnapshot != null) {\n                restoreAttributesAfterInclude(request, attributesSnapshot);\n            }\n        }\n    }\n}\n```\n\n`FrameworkServlet``DispatcherServlet`PATCHnull`DispatcherServlet`*doDispatcherf()**processRequest()*process`FrameworkServlet`*doPost()**doGet()*`FrameworkServlet``HttpServlet`\n\n```java\nprotected final void doGet(HttpServletRequest request, HttpServletResponse response)\n    throws ServletException, IOException {\n\n    processRequest(request, response);\n}\n\n/**\n * Delegate POST requests to {@link #processRequest}.\n * @see #doService\n */\n@Override\nprotected final void doPost(HttpServletRequest request, HttpServletResponse response)\n    throws ServletException, IOException {\n\n    processRequest(request, response);\n```\n\n# \n\nDispatcherServletspringcontroller*doDispatch(request, response)*","slug":"springmvc-dispatcherservlet","published":1,"updated":"2022-12-09T14:33:24.218Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrws006d8py03te11dhy","content":"<p>springmvc springioc <code>DispatcherServlet</code>springboot</p>\n<span id=\"more\"></span>\n\n<!-- toc -->\n\n<h1 id=\"HttpServletBean\"><a href=\"#HttpServletBean\" class=\"headerlink\" title=\"HttpServletBean\"></a>HttpServletBean</h1><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">--</span> <span class=\"string\">HttpServlet</span></span><br><span class=\"line\">    <span class=\"meta\">--</span> <span class=\"string\">HttpServletBean</span></span><br><span class=\"line\">        <span class=\"meta\">--</span> <span class=\"string\">FrameworkServlet</span></span><br><span class=\"line\">            <span class=\"meta\">--</span> <span class=\"string\">DispatcherServlet</span></span><br></pre></td></tr></table></figure>\n\n<p><code>HttpServlet</code>javaxhttpservletspringmvcbean<code>EnvironmentCapable</code><code>EnvironmentAware</code>spring</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">EnvironmentCapable</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\">Environment <span class=\"title\">getEnvironment</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">EnvironmentAware</span> <span class=\"keyword\">extends</span> <span class=\"title\">Aware</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setEnvironment</span><span class=\"params\">(Environment environment)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><code>HttpServletBean</code>*init()*</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> ServletException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\">// Set bean properties from init parameters.</span></span><br><span class=\"line\">   PropertyValues pvs = <span class=\"keyword\">new</span> ServletConfigPropertyValues(getServletConfig(), <span class=\"keyword\">this</span>.requiredProperties);</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!pvs.isEmpty()) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">          <span class=\"comment\">// beanWrapperservletBean</span></span><br><span class=\"line\">         BeanWrapper bw = PropertyAccessorFactory.forBeanPropertyAccess(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">         ResourceLoader resourceLoader = <span class=\"keyword\">new</span> ServletContextResourceLoader(getServletContext());</span><br><span class=\"line\">         bw.registerCustomEditor(Resource.class, <span class=\"keyword\">new</span> ResourceEditor(resourceLoader, getEnvironment()));</span><br><span class=\"line\">         initBeanWrapper(bw);</span><br><span class=\"line\">         bw.setPropertyValues(pvs, <span class=\"keyword\">true</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">catch</span> (BeansException ex) &#123;</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (logger.isErrorEnabled()) &#123;</span><br><span class=\"line\">            logger.error(<span class=\"string\">&quot;Failed to set bean properties on servlet &#x27;&quot;</span> + getServletName() + <span class=\"string\">&quot;&#x27;&quot;</span>, ex);</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">         <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">   <span class=\"comment\">// Let subclasses do whatever initialization they like.</span></span><br><span class=\"line\">   initServletBean();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"FrameworkServlet\"><a href=\"#FrameworkServlet\" class=\"headerlink\" title=\"FrameworkServlet\"></a>FrameworkServlet</h1><p>spring</p>\n<ul>\n<li>servletweb</li>\n<li></li>\n</ul>\n<p><code>HttpServletBean</code>*initServletBean()*</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">initServletBean</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> ServletException </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// log...</span></span><br><span class=\"line\">   <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">       <span class=\"comment\">// WebApplicationContext</span></span><br><span class=\"line\">      <span class=\"keyword\">this</span>.webApplicationContext = initWebApplicationContext();</span><br><span class=\"line\">       <span class=\"comment\">// </span></span><br><span class=\"line\">      initFrameworkServlet();</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">catch</span> (ServletException | RuntimeException ex) &#123;</span><br><span class=\"line\">      logger.error(<span class=\"string\">&quot;Context initialization failed&quot;</span>, ex);</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"comment\">// log...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> WebApplicationContext <span class=\"title\">initWebApplicationContext</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">   WebApplicationContext rootContext =</span><br><span class=\"line\">         WebApplicationContextUtils.getWebApplicationContext(getServletContext());</span><br><span class=\"line\">   WebApplicationContext wac = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.webApplicationContext != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// A context instance was injected at construction time -&gt; use it</span></span><br><span class=\"line\">      wac = <span class=\"keyword\">this</span>.webApplicationContext;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (wac <span class=\"keyword\">instanceof</span> ConfigurableWebApplicationContext) &#123;</span><br><span class=\"line\">         ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) wac;</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (!cwac.isActive()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// The context has not yet been refreshed -&gt; provide services such as</span></span><br><span class=\"line\">            <span class=\"comment\">// setting the parent context, setting the application context id, etc</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (cwac.getParent() == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">               <span class=\"comment\">// The context instance was injected without an explicit parent -&gt; set</span></span><br><span class=\"line\">               <span class=\"comment\">// the root application context (if any; may be null) as the parent</span></span><br><span class=\"line\">               cwac.setParent(rootContext);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            configureAndRefreshWebApplicationContext(cwac);</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (wac == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// No context instance was injected at construction time -&gt; see if one</span></span><br><span class=\"line\">      <span class=\"comment\">// has been registered in the servlet context. If one exists, it is assumed</span></span><br><span class=\"line\">      <span class=\"comment\">// that the parent context (if any) has already been set and that the</span></span><br><span class=\"line\">      <span class=\"comment\">// user has performed any initialization such as setting the context id</span></span><br><span class=\"line\">      wac = findWebApplicationContext();</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (wac == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// No context instance is defined for this servlet -&gt; create a local one</span></span><br><span class=\"line\">      wac = createWebApplicationContext(rootContext);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.refreshEventReceived) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// Either the context is not a ConfigurableApplicationContext with refresh</span></span><br><span class=\"line\">      <span class=\"comment\">// support or the context injected at construction time had already been</span></span><br><span class=\"line\">      <span class=\"comment\">// refreshed -&gt; trigger initial onRefresh manually here.</span></span><br><span class=\"line\">      <span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.onRefreshMonitor) &#123;</span><br><span class=\"line\">         <span class=\"comment\">// </span></span><br><span class=\"line\">         onRefresh(wac);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.publishContext) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// Publish the context as a servlet context attribute.</span></span><br><span class=\"line\">      String attrName = getServletContextAttributeName();</span><br><span class=\"line\">      getServletContext().setAttribute(attrName, wac);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">return</span> wac;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>webApplicationContext</p>\n<ul>\n<li>servlet</li>\n<li></li>\n</ul>\n<h1 id=\"DispatcherServlet\"><a href=\"#DispatcherServlet\" class=\"headerlink\" title=\"DispatcherServlet\"></a>DispatcherServlet</h1><p><code>initFrameworkdServlet()</code><code>onRefresh()</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onRefresh</span><span class=\"params\">(ApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    initStrategies(context);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Initialize the strategy objects that this servlet uses.</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;May be overridden in subclasses in order to initialize further strategy objects.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">initStrategies</span><span class=\"params\">(ApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    initMultipartResolver(context);</span><br><span class=\"line\">    initLocaleResolver(context);</span><br><span class=\"line\">    initThemeResolver(context);</span><br><span class=\"line\">    initHandlerMappings(context);</span><br><span class=\"line\">    initHandlerAdapters(context);</span><br><span class=\"line\">    initHandlerExceptionResolvers(context);</span><br><span class=\"line\">    initRequestToViewNameTranslator(context);</span><br><span class=\"line\">    initViewResolvers(context);</span><br><span class=\"line\">    initFlashMapManager(context);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>HandlerMapping</em><em>HandlerExceptionResolvers</em></p>\n<p><code>HttpServletBean</code><code>HttpServlet</code>Bean<code>FrameworkServlet</code>spring</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>HttpSrevlet</code>POSTGET<code>HttpServletBean</code>bean<code>FrameworkServlet</code>*service()*</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">service</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">      <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">   HttpMethod httpMethod = HttpMethod.resolve(request.getMethod());</span><br><span class=\"line\">    <span class=\"comment\">// PATHCHnull</span></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (httpMethod == HttpMethod.PATCH || httpMethod == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      processRequest(request, response);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">super</span>.service(request, response);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">processRequest</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">long</span> startTime = System.currentTimeMillis();</span><br><span class=\"line\">    Throwable failureCause = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext();</span><br><span class=\"line\">    LocaleContext localeContext = buildLocaleContext(request);</span><br><span class=\"line\"></span><br><span class=\"line\">    RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes();</span><br><span class=\"line\">    ServletRequestAttributes requestAttributes = buildRequestAttributes(request, response, previousAttributes);</span><br><span class=\"line\"></span><br><span class=\"line\">    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);</span><br><span class=\"line\">    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), <span class=\"keyword\">new</span> RequestBindingInterceptor());</span><br><span class=\"line\"></span><br><span class=\"line\">    initContextHolders(request, localeContext, requestAttributes);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Dispatcherservlet</span></span><br><span class=\"line\">        doService(request, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (ServletException | IOException ex) &#123;</span><br><span class=\"line\">        failureCause = ex;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        failureCause = ex;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NestedServletException(<span class=\"string\">&quot;Request processing failed&quot;</span>, ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        resetContextHolders(request, previousLocaleContext, previousAttributes);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (requestAttributes != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            requestAttributes.requestCompleted();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        logResult(request, response, failureCause, asyncManager);</span><br><span class=\"line\">        publishRequestHandledEvent(request, response, startTime, failureCause);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doService</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    logRequest(request);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Keep a snapshot of the request attributes in case of an include,</span></span><br><span class=\"line\">    <span class=\"comment\">// to be able to restore the original attributes after the include.</span></span><br><span class=\"line\">    Map&lt;String, Object&gt; attributesSnapshot = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// include</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (WebUtils.isIncludeRequest(request)) &#123;</span><br><span class=\"line\">        attributesSnapshot = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">        Enumeration&lt;?&gt; attrNames = request.getAttributeNames();</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (attrNames.hasMoreElements()) &#123;</span><br><span class=\"line\">            String attrName = (String) attrNames.nextElement();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) &#123;</span><br><span class=\"line\">                attributesSnapshot.put(attrName, request.getAttribute(attrName));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Make framework objects available to handlers and view objects.</span></span><br><span class=\"line\">    request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext());</span><br><span class=\"line\">    request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, <span class=\"keyword\">this</span>.localeResolver);</span><br><span class=\"line\">    request.setAttribute(THEME_RESOLVER_ATTRIBUTE, <span class=\"keyword\">this</span>.themeResolver);</span><br><span class=\"line\">    request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.flashMapManager != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        FlashMap inputFlashMap = <span class=\"keyword\">this</span>.flashMapManager.retrieveAndUpdate(request, response);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (inputFlashMap != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, <span class=\"keyword\">new</span> FlashMap());</span><br><span class=\"line\">        request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, <span class=\"keyword\">this</span>.flashMapManager);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        doDispatch(request, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Restore the original attribute snapshot, in case of an include.</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (attributesSnapshot != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                restoreAttributesAfterInclude(request, attributesSnapshot);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>FrameworkServlet</code><code>DispatcherServlet</code>PATCHnull<code>DispatcherServlet</code>*doDispatcherf()<em></em>processRequest()<em>process<code>FrameworkServlet</code></em>doPost()<em></em>doGet()*<code>FrameworkServlet</code><code>HttpServlet</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">doGet</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    processRequest(request, response);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Delegate POST requests to &#123;<span class=\"doctag\">@link</span> #processRequest&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #doService</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">doPost</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    processRequest(request, response);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>DispatcherServletspringcontroller*doDispatch(request, response)*</p>\n","site":{"data":{}},"excerpt":"<p>springmvc springioc <code>DispatcherServlet</code>springboot</p>","more":"<!-- toc -->\n\n<h1 id=\"HttpServletBean\"><a href=\"#HttpServletBean\" class=\"headerlink\" title=\"HttpServletBean\"></a>HttpServletBean</h1><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">--</span> <span class=\"string\">HttpServlet</span></span><br><span class=\"line\">    <span class=\"meta\">--</span> <span class=\"string\">HttpServletBean</span></span><br><span class=\"line\">        <span class=\"meta\">--</span> <span class=\"string\">FrameworkServlet</span></span><br><span class=\"line\">            <span class=\"meta\">--</span> <span class=\"string\">DispatcherServlet</span></span><br></pre></td></tr></table></figure>\n\n<p><code>HttpServlet</code>javaxhttpservletspringmvcbean<code>EnvironmentCapable</code><code>EnvironmentAware</code>spring</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">EnvironmentCapable</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\">Environment <span class=\"title\">getEnvironment</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">EnvironmentAware</span> <span class=\"keyword\">extends</span> <span class=\"title\">Aware</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setEnvironment</span><span class=\"params\">(Environment environment)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><code>HttpServletBean</code>*init()*</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> ServletException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\">// Set bean properties from init parameters.</span></span><br><span class=\"line\">   PropertyValues pvs = <span class=\"keyword\">new</span> ServletConfigPropertyValues(getServletConfig(), <span class=\"keyword\">this</span>.requiredProperties);</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!pvs.isEmpty()) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">          <span class=\"comment\">// beanWrapperservletBean</span></span><br><span class=\"line\">         BeanWrapper bw = PropertyAccessorFactory.forBeanPropertyAccess(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">         ResourceLoader resourceLoader = <span class=\"keyword\">new</span> ServletContextResourceLoader(getServletContext());</span><br><span class=\"line\">         bw.registerCustomEditor(Resource.class, <span class=\"keyword\">new</span> ResourceEditor(resourceLoader, getEnvironment()));</span><br><span class=\"line\">         initBeanWrapper(bw);</span><br><span class=\"line\">         bw.setPropertyValues(pvs, <span class=\"keyword\">true</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">catch</span> (BeansException ex) &#123;</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (logger.isErrorEnabled()) &#123;</span><br><span class=\"line\">            logger.error(<span class=\"string\">&quot;Failed to set bean properties on servlet &#x27;&quot;</span> + getServletName() + <span class=\"string\">&quot;&#x27;&quot;</span>, ex);</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">         <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">   <span class=\"comment\">// Let subclasses do whatever initialization they like.</span></span><br><span class=\"line\">   initServletBean();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"FrameworkServlet\"><a href=\"#FrameworkServlet\" class=\"headerlink\" title=\"FrameworkServlet\"></a>FrameworkServlet</h1><p>spring</p>\n<ul>\n<li>servletweb</li>\n<li></li>\n</ul>\n<p><code>HttpServletBean</code>*initServletBean()*</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">initServletBean</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> ServletException </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// log...</span></span><br><span class=\"line\">   <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">       <span class=\"comment\">// WebApplicationContext</span></span><br><span class=\"line\">      <span class=\"keyword\">this</span>.webApplicationContext = initWebApplicationContext();</span><br><span class=\"line\">       <span class=\"comment\">// </span></span><br><span class=\"line\">      initFrameworkServlet();</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">catch</span> (ServletException | RuntimeException ex) &#123;</span><br><span class=\"line\">      logger.error(<span class=\"string\">&quot;Context initialization failed&quot;</span>, ex);</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"comment\">// log...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> WebApplicationContext <span class=\"title\">initWebApplicationContext</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">   WebApplicationContext rootContext =</span><br><span class=\"line\">         WebApplicationContextUtils.getWebApplicationContext(getServletContext());</span><br><span class=\"line\">   WebApplicationContext wac = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.webApplicationContext != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// A context instance was injected at construction time -&gt; use it</span></span><br><span class=\"line\">      wac = <span class=\"keyword\">this</span>.webApplicationContext;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (wac <span class=\"keyword\">instanceof</span> ConfigurableWebApplicationContext) &#123;</span><br><span class=\"line\">         ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) wac;</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (!cwac.isActive()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// The context has not yet been refreshed -&gt; provide services such as</span></span><br><span class=\"line\">            <span class=\"comment\">// setting the parent context, setting the application context id, etc</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (cwac.getParent() == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">               <span class=\"comment\">// The context instance was injected without an explicit parent -&gt; set</span></span><br><span class=\"line\">               <span class=\"comment\">// the root application context (if any; may be null) as the parent</span></span><br><span class=\"line\">               cwac.setParent(rootContext);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            configureAndRefreshWebApplicationContext(cwac);</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (wac == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// No context instance was injected at construction time -&gt; see if one</span></span><br><span class=\"line\">      <span class=\"comment\">// has been registered in the servlet context. If one exists, it is assumed</span></span><br><span class=\"line\">      <span class=\"comment\">// that the parent context (if any) has already been set and that the</span></span><br><span class=\"line\">      <span class=\"comment\">// user has performed any initialization such as setting the context id</span></span><br><span class=\"line\">      wac = findWebApplicationContext();</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (wac == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// No context instance is defined for this servlet -&gt; create a local one</span></span><br><span class=\"line\">      wac = createWebApplicationContext(rootContext);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.refreshEventReceived) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// Either the context is not a ConfigurableApplicationContext with refresh</span></span><br><span class=\"line\">      <span class=\"comment\">// support or the context injected at construction time had already been</span></span><br><span class=\"line\">      <span class=\"comment\">// refreshed -&gt; trigger initial onRefresh manually here.</span></span><br><span class=\"line\">      <span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.onRefreshMonitor) &#123;</span><br><span class=\"line\">         <span class=\"comment\">// </span></span><br><span class=\"line\">         onRefresh(wac);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.publishContext) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// Publish the context as a servlet context attribute.</span></span><br><span class=\"line\">      String attrName = getServletContextAttributeName();</span><br><span class=\"line\">      getServletContext().setAttribute(attrName, wac);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">return</span> wac;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>webApplicationContext</p>\n<ul>\n<li>servlet</li>\n<li></li>\n</ul>\n<h1 id=\"DispatcherServlet\"><a href=\"#DispatcherServlet\" class=\"headerlink\" title=\"DispatcherServlet\"></a>DispatcherServlet</h1><p><code>initFrameworkdServlet()</code><code>onRefresh()</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onRefresh</span><span class=\"params\">(ApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    initStrategies(context);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Initialize the strategy objects that this servlet uses.</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;May be overridden in subclasses in order to initialize further strategy objects.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">initStrategies</span><span class=\"params\">(ApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    initMultipartResolver(context);</span><br><span class=\"line\">    initLocaleResolver(context);</span><br><span class=\"line\">    initThemeResolver(context);</span><br><span class=\"line\">    initHandlerMappings(context);</span><br><span class=\"line\">    initHandlerAdapters(context);</span><br><span class=\"line\">    initHandlerExceptionResolvers(context);</span><br><span class=\"line\">    initRequestToViewNameTranslator(context);</span><br><span class=\"line\">    initViewResolvers(context);</span><br><span class=\"line\">    initFlashMapManager(context);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>HandlerMapping</em><em>HandlerExceptionResolvers</em></p>\n<p><code>HttpServletBean</code><code>HttpServlet</code>Bean<code>FrameworkServlet</code>spring</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>HttpSrevlet</code>POSTGET<code>HttpServletBean</code>bean<code>FrameworkServlet</code>*service()*</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">service</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">      <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">   HttpMethod httpMethod = HttpMethod.resolve(request.getMethod());</span><br><span class=\"line\">    <span class=\"comment\">// PATHCHnull</span></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (httpMethod == HttpMethod.PATCH || httpMethod == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      processRequest(request, response);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">super</span>.service(request, response);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">processRequest</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">long</span> startTime = System.currentTimeMillis();</span><br><span class=\"line\">    Throwable failureCause = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext();</span><br><span class=\"line\">    LocaleContext localeContext = buildLocaleContext(request);</span><br><span class=\"line\"></span><br><span class=\"line\">    RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes();</span><br><span class=\"line\">    ServletRequestAttributes requestAttributes = buildRequestAttributes(request, response, previousAttributes);</span><br><span class=\"line\"></span><br><span class=\"line\">    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);</span><br><span class=\"line\">    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), <span class=\"keyword\">new</span> RequestBindingInterceptor());</span><br><span class=\"line\"></span><br><span class=\"line\">    initContextHolders(request, localeContext, requestAttributes);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Dispatcherservlet</span></span><br><span class=\"line\">        doService(request, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (ServletException | IOException ex) &#123;</span><br><span class=\"line\">        failureCause = ex;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> ex;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        failureCause = ex;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NestedServletException(<span class=\"string\">&quot;Request processing failed&quot;</span>, ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        resetContextHolders(request, previousLocaleContext, previousAttributes);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (requestAttributes != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            requestAttributes.requestCompleted();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        logResult(request, response, failureCause, asyncManager);</span><br><span class=\"line\">        publishRequestHandledEvent(request, response, startTime, failureCause);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">doService</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    logRequest(request);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Keep a snapshot of the request attributes in case of an include,</span></span><br><span class=\"line\">    <span class=\"comment\">// to be able to restore the original attributes after the include.</span></span><br><span class=\"line\">    Map&lt;String, Object&gt; attributesSnapshot = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// include</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (WebUtils.isIncludeRequest(request)) &#123;</span><br><span class=\"line\">        attributesSnapshot = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">        Enumeration&lt;?&gt; attrNames = request.getAttributeNames();</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (attrNames.hasMoreElements()) &#123;</span><br><span class=\"line\">            String attrName = (String) attrNames.nextElement();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) &#123;</span><br><span class=\"line\">                attributesSnapshot.put(attrName, request.getAttribute(attrName));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Make framework objects available to handlers and view objects.</span></span><br><span class=\"line\">    request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext());</span><br><span class=\"line\">    request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, <span class=\"keyword\">this</span>.localeResolver);</span><br><span class=\"line\">    request.setAttribute(THEME_RESOLVER_ATTRIBUTE, <span class=\"keyword\">this</span>.themeResolver);</span><br><span class=\"line\">    request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.flashMapManager != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        FlashMap inputFlashMap = <span class=\"keyword\">this</span>.flashMapManager.retrieveAndUpdate(request, response);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (inputFlashMap != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, <span class=\"keyword\">new</span> FlashMap());</span><br><span class=\"line\">        request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, <span class=\"keyword\">this</span>.flashMapManager);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        doDispatch(request, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Restore the original attribute snapshot, in case of an include.</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (attributesSnapshot != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                restoreAttributesAfterInclude(request, attributesSnapshot);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>FrameworkServlet</code><code>DispatcherServlet</code>PATCHnull<code>DispatcherServlet</code>*doDispatcherf()<em></em>processRequest()<em>process<code>FrameworkServlet</code></em>doPost()<em></em>doGet()*<code>FrameworkServlet</code><code>HttpServlet</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">doGet</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    processRequest(request, response);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Delegate POST requests to &#123;<span class=\"doctag\">@link</span> #processRequest&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #doService</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">doPost</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> ServletException, IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    processRequest(request, response);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>DispatcherServletspringcontroller*doDispatch(request, response)*</p>"},{"title":"volatile","date":"2020-07-20T13:23:51.000Z","_content":"\nJava`being stored in main memory`volatileCPUvolatileCPU\n\n<!--more-->\n\n# Visibility problems\n\n`volatile`CPUCPUCPUCPU\n\n`volatile`JavaCPUCPU\n\n```java\npublic class ShareObject{\n    public int counter = 0;\n}\n```\n\n112\n\ncounter`volatile`CPUcounterCPUJVMVisibility problem****\n\n# Visibility Guarantee\n\n`volatile`counter`volatile``volatile`\n\n```java\npublic class ShareObject{\n    // volatile\n    public volatile int counter = 0 ;\n}\n```\n\n1212`volatile`\n\n## Full Visibility Guarantee\n\n`volatile``volatile`\n\n- A`volatile`B`volatile`AB`volatile`\n\n- A`volatile`A\n\n\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n\n    // daysvolatile\n    public void update(int years, int months, int days){\n        this.years = year;\n        this.months = months;\n        this.days = days;    \n    }\n}\n```\n\nFull Visibility Guaranteedaysmonthsyears\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n\n    public int totalDays(){\n        int total = this.days;\n        total += months * 30;\n        total += years * 365;\n        return total;   \n    }\n\n    public void update(int years, int months, int days){\n        this.years = years;\n        this.months = months;\n        this.days = days;\n}\n}\n```\n\n*totalDays()*`days``total` ,`days``volatile``days`monthsyears`volatile``volatile`****`volatile`\n\n# Instruction Reordering\n\nJVMCPU\n\n```java\nint a = 1;\nint b = 2;\na++;\nb++;\n```\n\n\n\n```java\nint a  = 1;\na++;\nint b = 2;\nb++\n```\n\n`volatile`\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n\n    public void update(int years, int months, int days){\n        this.years = years;\n        this.months = months;\n        this.days = days;\n    }\n}\n```\n\nJVM\n\n```java\n    public void update(int years, int months, int days){\n        // days\n        this.days = days;\n        this.years = years;\n        this.months = months;\n    }\n```\n\ndaysmonthsyears\n\n## Volatile Happens-Before Guarantee\n\n`volatile`\n\n- /`volatile`\n- /`volatile`\n\n# Volatile is Not Always Enough\n\ncountercounter``**syncronized**`lock`\n","source":"_posts/volatile.md","raw":"---\ntitle: volatile\ndate: 2020-07-20 21:23:51\ncategories: jvm\ntags: volatile\n---\n\nJava`being stored in main memory`volatileCPUvolatileCPU\n\n<!--more-->\n\n# Visibility problems\n\n`volatile`CPUCPUCPUCPU\n\n`volatile`JavaCPUCPU\n\n```java\npublic class ShareObject{\n    public int counter = 0;\n}\n```\n\n112\n\ncounter`volatile`CPUcounterCPUJVMVisibility problem****\n\n# Visibility Guarantee\n\n`volatile`counter`volatile``volatile`\n\n```java\npublic class ShareObject{\n    // volatile\n    public volatile int counter = 0 ;\n}\n```\n\n1212`volatile`\n\n## Full Visibility Guarantee\n\n`volatile``volatile`\n\n- A`volatile`B`volatile`AB`volatile`\n\n- A`volatile`A\n\n\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n\n    // daysvolatile\n    public void update(int years, int months, int days){\n        this.years = year;\n        this.months = months;\n        this.days = days;    \n    }\n}\n```\n\nFull Visibility Guaranteedaysmonthsyears\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n\n    public int totalDays(){\n        int total = this.days;\n        total += months * 30;\n        total += years * 365;\n        return total;   \n    }\n\n    public void update(int years, int months, int days){\n        this.years = years;\n        this.months = months;\n        this.days = days;\n}\n}\n```\n\n*totalDays()*`days``total` ,`days``volatile``days`monthsyears`volatile``volatile`****`volatile`\n\n# Instruction Reordering\n\nJVMCPU\n\n```java\nint a = 1;\nint b = 2;\na++;\nb++;\n```\n\n\n\n```java\nint a  = 1;\na++;\nint b = 2;\nb++\n```\n\n`volatile`\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n\n    public void update(int years, int months, int days){\n        this.years = years;\n        this.months = months;\n        this.days = days;\n    }\n}\n```\n\nJVM\n\n```java\n    public void update(int years, int months, int days){\n        // days\n        this.days = days;\n        this.years = years;\n        this.months = months;\n    }\n```\n\ndaysmonthsyears\n\n## Volatile Happens-Before Guarantee\n\n`volatile`\n\n- /`volatile`\n- /`volatile`\n\n# Volatile is Not Always Enough\n\ncountercounter``**syncronized**`lock`\n","slug":"volatile","published":1,"updated":"2022-12-09T14:32:06.893Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clf3oyrws006e8py03q8q06lw","content":"<p>Java<code>being stored in main memory</code>volatileCPUvolatileCPU</p>\n<span id=\"more\"></span>\n\n<h1 id=\"Visibility-problems\"><a href=\"#Visibility-problems\" class=\"headerlink\" title=\"Visibility problems\"></a>Visibility problems</h1><p><code>volatile</code>CPUCPUCPUCPU</p>\n<p><code>volatile</code>JavaCPUCPU</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShareObject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>112</p>\n<p>counter<code>volatile</code>CPUcounterCPUJVMVisibility problem<strong></strong></p>\n<h1 id=\"Visibility-Guarantee\"><a href=\"#Visibility-Guarantee\" class=\"headerlink\" title=\"Visibility Guarantee\"></a>Visibility Guarantee</h1><p><code>volatile</code>counter<code>volatile</code><code>volatile</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShareObject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// volatile</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span> ;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>1212<code>volatile</code></p>\n<h2 id=\"Full-Visibility-Guarantee\"><a href=\"#Full-Visibility-Guarantee\" class=\"headerlink\" title=\"Full Visibility Guarantee\"></a>Full Visibility Guarantee</h2><p><code>volatile</code><code>volatile</code></p>\n<ul>\n<li><p>A<code>volatile</code>B<code>volatile</code>AB<code>volatile</code></p>\n</li>\n<li><p>A<code>volatile</code>A</p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// daysvolatile</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = year;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;    </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Full Visibility Guaranteedaysmonthsyears</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">totalDays</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> total = <span class=\"keyword\">this</span>.days;</span><br><span class=\"line\">        total += months * <span class=\"number\">30</span>;</span><br><span class=\"line\">        total += years * <span class=\"number\">365</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> total;   </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>totalDays()<em><code>days</code><code>total</code> ,<code>days</code><code>volatile</code><code>days</code>monthsyears<code>volatile</code><code>volatile</code></em></em>**<code>volatile</code></p>\n<h1 id=\"Instruction-Reordering\"><a href=\"#Instruction-Reordering\" class=\"headerlink\" title=\"Instruction Reordering\"></a>Instruction Reordering</h1><p>JVMCPU</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">2</span>;</span><br><span class=\"line\">a++;</span><br><span class=\"line\">b++;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a  = <span class=\"number\">1</span>;</span><br><span class=\"line\">a++;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">2</span>;</span><br><span class=\"line\">b++</span><br></pre></td></tr></table></figure>\n\n<p><code>volatile</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JVM</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// days</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>daysmonthsyears</p>\n<h2 id=\"Volatile-Happens-Before-Guarantee\"><a href=\"#Volatile-Happens-Before-Guarantee\" class=\"headerlink\" title=\"Volatile Happens-Before Guarantee\"></a>Volatile Happens-Before Guarantee</h2><p><code>volatile</code></p>\n<ul>\n<li>/<code>volatile</code></li>\n<li>/<code>volatile</code></li>\n</ul>\n<h1 id=\"Volatile-is-Not-Always-Enough\"><a href=\"#Volatile-is-Not-Always-Enough\" class=\"headerlink\" title=\"Volatile is Not Always Enough\"></a>Volatile is Not Always Enough</h1><p>countercounter<code></code><strong>syncronized</strong><code>lock</code></p>\n","site":{"data":{}},"excerpt":"<p>Java<code>being stored in main memory</code>volatileCPUvolatileCPU</p>","more":"<h1 id=\"Visibility-problems\"><a href=\"#Visibility-problems\" class=\"headerlink\" title=\"Visibility problems\"></a>Visibility problems</h1><p><code>volatile</code>CPUCPUCPUCPU</p>\n<p><code>volatile</code>JavaCPUCPU</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShareObject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>112</p>\n<p>counter<code>volatile</code>CPUcounterCPUJVMVisibility problem<strong></strong></p>\n<h1 id=\"Visibility-Guarantee\"><a href=\"#Visibility-Guarantee\" class=\"headerlink\" title=\"Visibility Guarantee\"></a>Visibility Guarantee</h1><p><code>volatile</code>counter<code>volatile</code><code>volatile</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShareObject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// volatile</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span> ;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>1212<code>volatile</code></p>\n<h2 id=\"Full-Visibility-Guarantee\"><a href=\"#Full-Visibility-Guarantee\" class=\"headerlink\" title=\"Full Visibility Guarantee\"></a>Full Visibility Guarantee</h2><p><code>volatile</code><code>volatile</code></p>\n<ul>\n<li><p>A<code>volatile</code>B<code>volatile</code>AB<code>volatile</code></p>\n</li>\n<li><p>A<code>volatile</code>A</p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// daysvolatile</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = year;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;    </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Full Visibility Guaranteedaysmonthsyears</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">totalDays</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> total = <span class=\"keyword\">this</span>.days;</span><br><span class=\"line\">        total += months * <span class=\"number\">30</span>;</span><br><span class=\"line\">        total += years * <span class=\"number\">365</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> total;   </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>totalDays()<em><code>days</code><code>total</code> ,<code>days</code><code>volatile</code><code>days</code>monthsyears<code>volatile</code><code>volatile</code></em></em>**<code>volatile</code></p>\n<h1 id=\"Instruction-Reordering\"><a href=\"#Instruction-Reordering\" class=\"headerlink\" title=\"Instruction Reordering\"></a>Instruction Reordering</h1><p>JVMCPU</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">2</span>;</span><br><span class=\"line\">a++;</span><br><span class=\"line\">b++;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a  = <span class=\"number\">1</span>;</span><br><span class=\"line\">a++;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">2</span>;</span><br><span class=\"line\">b++</span><br></pre></td></tr></table></figure>\n\n<p><code>volatile</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JVM</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// days</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>daysmonthsyears</p>\n<h2 id=\"Volatile-Happens-Before-Guarantee\"><a href=\"#Volatile-Happens-Before-Guarantee\" class=\"headerlink\" title=\"Volatile Happens-Before Guarantee\"></a>Volatile Happens-Before Guarantee</h2><p><code>volatile</code></p>\n<ul>\n<li>/<code>volatile</code></li>\n<li>/<code>volatile</code></li>\n</ul>\n<h1 id=\"Volatile-is-Not-Always-Enough\"><a href=\"#Volatile-is-Not-Always-Enough\" class=\"headerlink\" title=\"Volatile is Not Always Enough\"></a>Volatile is Not Always Enough</h1><p>countercounter<code></code><strong>syncronized</strong><code>lock</code></p>"}],"PostAsset":[],"PostCategory":[{"post_id":"clf3oyrw900098py08t2y1d1o","category_id":"clf3oyrw700048py09wvqaqj3","_id":"clf3oyrwc000k8py0esractaf"},{"post_id":"clf3oyrw500018py01z0u1fiv","category_id":"clf3oyrw700048py09wvqaqj3","_id":"clf3oyrwd000p8py0gapdgmyx"},{"post_id":"clf3oyrw600038py05nmt9ofs","category_id":"clf3oyrw700048py09wvqaqj3","_id":"clf3oyrwd000s8py0dky54iix"},{"post_id":"clf3oyrw800078py0fqev9bci","category_id":"clf3oyrw700048py09wvqaqj3","_id":"clf3oyrwe000x8py0dmm1d2fd"},{"post_id":"clf3oyrw9000b8py00c7k54ga","category_id":"clf3oyrwd000r8py0fsah9r27","_id":"clf3oyrwf00138py06w5oev4b"},{"post_id":"clf3oyrwe00108py0e1dxbws3","category_id":"clf3oyrwe000y8py0fuc81vdt","_id":"clf3oyrwf00198py04wz2fdf0"},{"post_id":"clf3oyrwb000g8py07hemg24e","category_id":"clf3oyrwe000y8py0fuc81vdt","_id":"clf3oyrwg001d8py096cw8zy9"},{"post_id":"clf3oyrwf00168py01j7i78xr","category_id":"clf3oyrwf00148py0ex8eca36","_id":"clf3oyrwg001g8py01uq37i1j"},{"post_id":"clf3oyrwc000j8py0hdyh65fc","category_id":"clf3oyrwf00148py0ex8eca36","_id":"clf3oyrwg001i8py0207fffg4"},{"post_id":"clf3oyrwf00188py090q6cufh","category_id":"clf3oyrwe000y8py0fuc81vdt","_id":"clf3oyrwg001n8py05s3hcec7"},{"post_id":"clf3oyrwf001c8py0cjhq7x1d","category_id":"clf3oyrwd000r8py0fsah9r27","_id":"clf3oyrwh001p8py0efn79vdu"},{"post_id":"clf3oyrwc000o8py04dcn8r3n","category_id":"clf3oyrwf001a8py02q29ez7s","_id":"clf3oyrwh001t8py03i3e1nc9"},{"post_id":"clf3oyrwd000q8py0balf5ohw","category_id":"clf3oyrwg001j8py0eo258jvg","_id":"clf3oyrwh001x8py077jfcumz"},{"post_id":"clf3oyrwd000v8py06gbi88h3","category_id":"clf3oyrwg001j8py0eo258jvg","_id":"clf3oyrwi00238py0f9ax4r9h"},{"post_id":"clf3oyrwh001v8py01yzcfljg","category_id":"clf3oyrwf00148py0ex8eca36","_id":"clf3oyrwi00268py0ere5evss"},{"post_id":"clf3oyrwi001z8py02kfle5tw","category_id":"clf3oyrwe000y8py0fuc81vdt","_id":"clf3oyrwj002a8py01wh331nk"},{"post_id":"clf3oyrwe000w8py010p4f0mh","category_id":"clf3oyrwg001j8py0eo258jvg","_id":"clf3oyrwj002d8py06sp7g9y5"},{"post_id":"clf3oyrwe00128py06fv0emnb","category_id":"clf3oyrwf00148py0ex8eca36","_id":"clf3oyrwj002g8py0aypaewbs"},{"post_id":"clf3oyrwg001f8py0gfh3etkj","category_id":"clf3oyrwj00298py0g3usgop0","_id":"clf3oyrwk002m8py03b3y46hz"},{"post_id":"clf3oyrwj002i8py05ygk16cw","category_id":"clf3oyrwe000y8py0fuc81vdt","_id":"clf3oyrwk002t8py0fhdzd9kt"},{"post_id":"clf3oyrwg001m8py03uff66z3","category_id":"clf3oyrwj002h8py0as97c6c5","_id":"clf3oyrwl002x8py0e8xqfjj9"},{"post_id":"clf3oyrwk002p8py09g7i3puh","category_id":"clf3oyrwf00148py0ex8eca36","_id":"clf3oyrwl00318py0eb284yxn"},{"post_id":"clf3oyrwg001o8py06rga587o","category_id":"clf3oyrwj002h8py0as97c6c5","_id":"clf3oyrwl00348py0eh5qh0le"},{"post_id":"clf3oyrwh001s8py0bjnjcqxk","category_id":"clf3oyrwk002v8py01uophh2l","_id":"clf3oyrwm003a8py080x63p4v"},{"post_id":"clf3oyrwi00218py081lr1k8x","category_id":"clf3oyrwl00358py0h45xdody","_id":"clf3oyrwm003h8py0f03g3r5g"},{"post_id":"clf3oyrwm00398py0dh4ocibn","category_id":"clf3oyrwj00298py0g3usgop0","_id":"clf3oyrwn003j8py05umq3yaz"},{"post_id":"clf3oyrwm003c8py0dafyf2an","category_id":"clf3oyrwe000y8py0fuc81vdt","_id":"clf3oyrwn003m8py0dmb46r1s"},{"post_id":"clf3oyrwi00258py0865v1mjj","category_id":"clf3oyrwl00358py0h45xdody","_id":"clf3oyrwn003q8py01rbu84ue"},{"post_id":"clf3oyrwm003e8py02xgza73i","category_id":"clf3oyrwe000y8py0fuc81vdt","_id":"clf3oyrwn003t8py00ioa0yp5"},{"post_id":"clf3oyrwi00288py0hzj1bfgk","category_id":"clf3oyrwm003g8py09owdflp9","_id":"clf3oyrwo003x8py0fepd2ipg"},{"post_id":"clf3oyrwn003l8py0161y1r0v","category_id":"clf3oyrwe000y8py0fuc81vdt","_id":"clf3oyrwo00408py039v7h0hy"},{"post_id":"clf3oyrwn003p8py00ucjf3rg","category_id":"clf3oyrwg001j8py0eo258jvg","_id":"clf3oyrwo00438py042px93tb"},{"post_id":"clf3oyrwj002b8py05uaq47o9","category_id":"clf3oyrwl00358py0h45xdody","_id":"clf3oyrwo00458py01ezib0xt"},{"post_id":"clf3oyrwn003w8py06vet4n2r","category_id":"clf3oyrwg001j8py0eo258jvg","_id":"clf3oyrwp004a8py07ygr7dxo"},{"post_id":"clf3oyrwj002f8py0d7cla3km","category_id":"clf3oyrwl00358py0h45xdody","_id":"clf3oyrwp004c8py01e8a23x4"},{"post_id":"clf3oyrwk002l8py0ap025j4o","category_id":"clf3oyrwo00418py0aoyz4vaq","_id":"clf3oyrwp004f8py034za7a5x"},{"post_id":"clf3oyrwo00448py07f5p74fe","category_id":"clf3oyrwe000y8py0fuc81vdt","_id":"clf3oyrwp004h8py0b3839qck"},{"post_id":"clf3oyrwk002s8py001bj4e4s","category_id":"clf3oyrwo00478py060ef47wu","_id":"clf3oyrwp004k8py0d1dz4pg3"},{"post_id":"clf3oyrwk002w8py0d6rd5ign","category_id":"clf3oyrwp004e8py0gzjh6gpf","_id":"clf3oyrwp004m8py02rbz9agk"},{"post_id":"clf3oyrwl00308py0g8oaa6p1","category_id":"clf3oyrwp004j8py0ftbn1yf0","_id":"clf3oyrwp004q8py0hwht7ia2"},{"post_id":"clf3oyrwl00338py0dkg799n5","category_id":"clf3oyrwp004e8py0gzjh6gpf","_id":"clf3oyrwq004u8py0ec6760ru"},{"post_id":"clf3oyrwl00368py02vmt08xr","category_id":"clf3oyrwp004j8py0ftbn1yf0","_id":"clf3oyrwq004z8py0gdp2blkv"},{"post_id":"clf3oyrwm003i8py08buj2qvn","category_id":"clf3oyrwp004j8py0ftbn1yf0","_id":"clf3oyrwq00528py083apg7bw"},{"post_id":"clf3oyrwo003y8py06xd4asp3","category_id":"clf3oyrwq004y8py06kn8dihc","_id":"clf3oyrwq00578py015542d9y"},{"post_id":"clf3oyrwo00428py04c7j42c9","category_id":"clf3oyrwq004y8py06kn8dihc","_id":"clf3oyrwq005a8py06lowa9vk"},{"post_id":"clf3oyrwp00488py017c74r2w","category_id":"clf3oyrwq00568py0aax7ewqw","_id":"clf3oyrwq005d8py07n3t8b1w"},{"post_id":"clf3oyrws006d8py03te11dhy","category_id":"clf3oyrwq004y8py06kn8dihc","_id":"clf3oyrwt006g8py02wgdapa2"},{"post_id":"clf3oyrws006e8py03q8q06lw","category_id":"clf3oyrwl00358py0h45xdody","_id":"clf3oyrwt006h8py0apuodlnu"}],"PostTag":[{"post_id":"clf3oyrw900098py08t2y1d1o","tag_id":"clf3oyrw800058py08qbb7al3","_id":"clf3oyrwb000e8py0h3ph7ssv"},{"post_id":"clf3oyrw500018py01z0u1fiv","tag_id":"clf3oyrw800058py08qbb7al3","_id":"clf3oyrwb000h8py022ozctal"},{"post_id":"clf3oyrw600038py05nmt9ofs","tag_id":"clf3oyrw800058py08qbb7al3","_id":"clf3oyrwc000n8py013ma0oij"},{"post_id":"clf3oyrw800078py0fqev9bci","tag_id":"clf3oyrw800058py08qbb7al3","_id":"clf3oyrwd000u8py07fhvfeku"},{"post_id":"clf3oyrw9000b8py00c7k54ga","tag_id":"clf3oyrwd000t8py079mt9nqw","_id":"clf3oyrwe00118py0g2jv96p2"},{"post_id":"clf3oyrwb000g8py07hemg24e","tag_id":"clf3oyrwe000z8py06idch74g","_id":"clf3oyrwf00178py02qd14nlh"},{"post_id":"clf3oyrwc000j8py0hdyh65fc","tag_id":"clf3oyrwf00158py017na11wr","_id":"clf3oyrwg001e8py0b54nb6fq"},{"post_id":"clf3oyrwc000o8py04dcn8r3n","tag_id":"clf3oyrwf001b8py01bpd2m1u","_id":"clf3oyrwg001l8py0456efh8q"},{"post_id":"clf3oyrwd000q8py0balf5ohw","tag_id":"clf3oyrwg001k8py0ho9r6xwz","_id":"clf3oyrwh001u8py0892w34w0"},{"post_id":"clf3oyrwd000v8py06gbi88h3","tag_id":"clf3oyrwh001r8py059r94zsr","_id":"clf3oyrwi00208py0hitl7ft4"},{"post_id":"clf3oyrwe000w8py010p4f0mh","tag_id":"clf3oyrwh001y8py0f0y6clnj","_id":"clf3oyrwi00278py08zu8dmle"},{"post_id":"clf3oyrwe00108py0e1dxbws3","tag_id":"clf3oyrwi00248py00sxu976d","_id":"clf3oyrwj002e8py0544ggl1x"},{"post_id":"clf3oyrwj002f8py0d7cla3km","tag_id":"clf3oyrw800058py08qbb7al3","_id":"clf3oyrwk002k8py04hgc8ncv"},{"post_id":"clf3oyrwe00128py06fv0emnb","tag_id":"clf3oyrwj002c8py04vifb70j","_id":"clf3oyrwk002n8py01itu7i2a"},{"post_id":"clf3oyrwj002i8py05ygk16cw","tag_id":"clf3oyrw800058py08qbb7al3","_id":"clf3oyrwk002r8py0159nhebe"},{"post_id":"clf3oyrwf00168py01j7i78xr","tag_id":"clf3oyrwj002j8py0gxo7h259","_id":"clf3oyrwk002u8py06cx7fq8s"},{"post_id":"clf3oyrwk002p8py09g7i3puh","tag_id":"clf3oyrwf00158py017na11wr","_id":"clf3oyrwl002y8py05c8ugq2f"},{"post_id":"clf3oyrwf00188py090q6cufh","tag_id":"clf3oyrwk002q8py03q0kerv7","_id":"clf3oyrwl00328py07m6e1lmk"},{"post_id":"clf3oyrwf001c8py0cjhq7x1d","tag_id":"clf3oyrwl002z8py07b0o7x3n","_id":"clf3oyrwm00388py09oy62i96"},{"post_id":"clf3oyrwg001f8py0gfh3etkj","tag_id":"clf3oyrwl00378py03kmq2it6","_id":"clf3oyrwm003f8py0g5ws906f"},{"post_id":"clf3oyrwg001m8py03uff66z3","tag_id":"clf3oyrwm003d8py04lppchav","_id":"clf3oyrwn003n8py0hreee9kh"},{"post_id":"clf3oyrwg001o8py06rga587o","tag_id":"clf3oyrwn003k8py0aa3q2axr","_id":"clf3oyrwn003v8py0d7q74c52"},{"post_id":"clf3oyrwh001s8py0bjnjcqxk","tag_id":"clf3oyrwn003r8py05f2qcpnf","_id":"clf3oyrwp00498py0ayfz4yyv"},{"post_id":"clf3oyrwh001s8py0bjnjcqxk","tag_id":"clf3oyrwo003z8py08zmvdkm3","_id":"clf3oyrwp004b8py07986e7zo"},{"post_id":"clf3oyrwh001v8py01yzcfljg","tag_id":"clf3oyrwo00468py0e3xq4hav","_id":"clf3oyrwp004g8py09l0h3z22"},{"post_id":"clf3oyrwi001z8py02kfle5tw","tag_id":"clf3oyrwp004d8py02kkh8s8m","_id":"clf3oyrwq004r8py0h53shpz0"},{"post_id":"clf3oyrwi001z8py02kfle5tw","tag_id":"clf3oyrwp004i8py077rqbvbl","_id":"clf3oyrwq004s8py0daa59xaw"},{"post_id":"clf3oyrwi001z8py02kfle5tw","tag_id":"clf3oyrwp004l8py0dvlh8xdb","_id":"clf3oyrwq004w8py00t5b17p9"},{"post_id":"clf3oyrwi00218py081lr1k8x","tag_id":"clf3oyrwp004o8py0a4auhe9a","_id":"clf3oyrwq004x8py082frhx3y"},{"post_id":"clf3oyrwi00258py0865v1mjj","tag_id":"clf3oyrwq004v8py01abe5h9v","_id":"clf3oyrwq00518py0ge4ec000"},{"post_id":"clf3oyrwi00288py0hzj1bfgk","tag_id":"clf3oyrwq00508py0fk1h1vp8","_id":"clf3oyrwq00558py04zy24mon"},{"post_id":"clf3oyrwj002b8py05uaq47o9","tag_id":"clf3oyrwq00548py04ur6grie","_id":"clf3oyrwq00598py06o3mdsw3"},{"post_id":"clf3oyrwk002l8py0ap025j4o","tag_id":"clf3oyrwq00588py0glhk1wk8","_id":"clf3oyrwq005c8py00khb4jfr"},{"post_id":"clf3oyrwk002s8py001bj4e4s","tag_id":"clf3oyrwq005b8py06enx0uzz","_id":"clf3oyrwq005f8py066y41fwf"},{"post_id":"clf3oyrwk002w8py0d6rd5ign","tag_id":"clf3oyrwq005b8py06enx0uzz","_id":"clf3oyrwq005h8py0h6510p1t"},{"post_id":"clf3oyrwl00308py0g8oaa6p1","tag_id":"clf3oyrwq005g8py034t0bbgc","_id":"clf3oyrwr005j8py0aqofaag5"},{"post_id":"clf3oyrwl00338py0dkg799n5","tag_id":"clf3oyrwq005b8py06enx0uzz","_id":"clf3oyrwr005l8py0hy3g185y"},{"post_id":"clf3oyrwl00368py02vmt08xr","tag_id":"clf3oyrwr005k8py07uvqb4dd","_id":"clf3oyrwr005n8py0cz299es7"},{"post_id":"clf3oyrwm00398py0dh4ocibn","tag_id":"clf3oyrwr005m8py0318b1hhn","_id":"clf3oyrwr005p8py05zv964iv"},{"post_id":"clf3oyrwm003c8py0dafyf2an","tag_id":"clf3oyrwp004i8py077rqbvbl","_id":"clf3oyrwr005r8py0de0z47cw"},{"post_id":"clf3oyrwm003e8py02xgza73i","tag_id":"clf3oyrwr005q8py030y11mm6","_id":"clf3oyrwr005t8py0heorbr4d"},{"post_id":"clf3oyrwm003i8py08buj2qvn","tag_id":"clf3oyrwr005s8py0f5o60gz3","_id":"clf3oyrwr005w8py09zfmed21"},{"post_id":"clf3oyrwm003i8py08buj2qvn","tag_id":"clf3oyrwr005u8py0h72xdbz0","_id":"clf3oyrwr005x8py0agwbegxm"},{"post_id":"clf3oyrwn003l8py0161y1r0v","tag_id":"clf3oyrwr005v8py0c5k6e2ok","_id":"clf3oyrwr005z8py05fov3vhj"},{"post_id":"clf3oyrwn003p8py00ucjf3rg","tag_id":"clf3oyrwr005y8py09ab93nhu","_id":"clf3oyrwr00618py0adks261r"},{"post_id":"clf3oyrwn003w8py06vet4n2r","tag_id":"clf3oyrwr00608py0gf5reol3","_id":"clf3oyrwr00638py07j0w7bqb"},{"post_id":"clf3oyrwo003y8py06xd4asp3","tag_id":"clf3oyrwr00628py0f09r8axb","_id":"clf3oyrwr00658py0aoe94yvk"},{"post_id":"clf3oyrwo00428py04c7j42c9","tag_id":"clf3oyrwr00648py08wi8dwst","_id":"clf3oyrws00678py0bkqegzdb"},{"post_id":"clf3oyrwo00448py07f5p74fe","tag_id":"clf3oyrws00668py05fqogu8i","_id":"clf3oyrws006a8py02tyg3w4i"},{"post_id":"clf3oyrwo00448py07f5p74fe","tag_id":"clf3oyrws00688py0aynahar6","_id":"clf3oyrws006b8py0a4po9wb9"},{"post_id":"clf3oyrwp00488py017c74r2w","tag_id":"clf3oyrwq00588py0glhk1wk8","_id":"clf3oyrws006c8py0frpa4ii9"},{"post_id":"clf3oyrws006d8py03te11dhy","tag_id":"clf3oyrwt006f8py0811ffsx5","_id":"clf3oyrwt006j8py01pj80p7b"},{"post_id":"clf3oyrws006e8py03q8q06lw","tag_id":"clf3oyrwt006i8py01g374xcb","_id":"clf3oyrwt006k8py0ghq70nav"}],"Tag":[{"name":"summary","_id":"clf3oyrw800058py08qbb7al3"},{"name":"service-discovery","_id":"clf3oyrwd000t8py079mt9nqw"},{"name":"combination","_id":"clf3oyrwe000z8py06idch74g"},{"name":"lock","_id":"clf3oyrwf00158py017na11wr"},{"name":"autoconfiguration","_id":"clf3oyrwf001b8py01bpd2m1u"},{"name":"environment","_id":"clf3oyrwg001k8py0ho9r6xwz"},{"name":"startup","_id":"clf3oyrwh001r8py059r94zsr"},{"name":"refresh","_id":"clf3oyrwh001y8py0f0y6clnj"},{"name":"standard","_id":"clf3oyrwi00248py00sxu976d"},{"name":"arraylist","_id":"clf3oyrwj002c8py04vifb70j"},{"name":"bitwise","_id":"clf3oyrwj002j8py0gxo7h259"},{"name":"binary_search_tree","_id":"clf3oyrwk002q8py03q0kerv7"},{"name":"gateway","_id":"clf3oyrwl002z8py07b0o7x3n"},{"name":"decorating","_id":"clf3oyrwl00378py03kmq2it6"},{"name":"hashmap","_id":"clf3oyrwm003d8py04lppchav"},{"name":"heap","_id":"clf3oyrwn003k8py0aa3q2axr"},{"name":"http","_id":"clf3oyrwn003r8py05f2qcpnf"},{"name":"https","_id":"clf3oyrwo003z8py08zmvdkm3"},{"name":"framework","_id":"clf3oyrwo00468py0e3xq4hav"},{"name":"greedy","_id":"clf3oyrwp004d8py02kkh8s8m"},{"name":"dp","_id":"clf3oyrwp004i8py077rqbvbl"},{"name":"stratey","_id":"clf3oyrwp004l8py0dvlh8xdb"},{"name":"GC","_id":"clf3oyrwp004o8py0a4auhe9a"},{"name":"classloader","_id":"clf3oyrwq004v8py01abe5h9v"},{"name":"junit5","_id":"clf3oyrwq00508py0fk1h1vp8"},{"name":"memory","_id":"clf3oyrwq00548py04ur6grie"},{"name":"utils","_id":"clf3oyrwq00588py0glhk1wk8"},{"name":"mybatis","_id":"clf3oyrwq005b8py06enx0uzz"},{"name":"activemq","_id":"clf3oyrwq005g8py034t0bbgc"},{"name":"network","_id":"clf3oyrwr005k8py07uvqb4dd"},{"name":"observer","_id":"clf3oyrwr005m8py0318b1hhn"},{"name":"prime","_id":"clf3oyrwr005q8py030y11mm6"},{"name":"redis","_id":"clf3oyrwr005s8py0f5o60gz3"},{"name":"nosql","_id":"clf3oyrwr005u8py0h72xdbz0"},{"name":"treeMap","_id":"clf3oyrwr005v8py0c5k6e2ok"},{"name":"transaction","_id":"clf3oyrwr005y8py09ab93nhu"},{"name":"servlet","_id":"clf3oyrwr00608py0gf5reol3"},{"name":"argument","_id":"clf3oyrwr00628py0f09r8axb"},{"name":"dispatch","_id":"clf3oyrwr00648py08wi8dwst"},{"name":"double pointers","_id":"clf3oyrws00668py05fqogu8i"},{"name":"preSum","_id":"clf3oyrws00688py0aynahar6"},{"name":"dispatcherservlet","_id":"clf3oyrwt006f8py0811ffsx5"},{"name":"volatile","_id":"clf3oyrwt006i8py01g374xcb"}]}}