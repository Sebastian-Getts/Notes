{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/tranquilpeak/source/assets/css/gitalk.css","path":"assets/css/gitalk.css","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/css/all.css","path":"assets/css/all.css","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/css/gitment.css","path":"assets/css/gitment.css","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/css/jquery.fancybox.css","path":"assets/css/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/css/style-xsmpikcbczzhpff1zqybzgesjqcgmkdkx9b5ntr0bkmk6wqucpktuaodiuvy.min.css","path":"assets/css/style-xsmpikcbczzhpff1zqybzgesjqcgmkdkx9b5ntr0bkmk6wqucpktuaodiuvy.min.css","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/css/style.css","path":"assets/css/style.css","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/css/thumbs.css","path":"assets/css/thumbs.css","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/css/tranquilpeak.css","path":"assets/css/tranquilpeak.css","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.eot","path":"assets/fonts/fa-brands-400.eot","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.svg","path":"assets/fonts/fa-brands-400.svg","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.ttf","path":"assets/fonts/fa-brands-400.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.woff","path":"assets/fonts/fa-brands-400.woff","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.woff2","path":"assets/fonts/fa-brands-400.woff2","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.eot","path":"assets/fonts/fa-regular-400.eot","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.svg","path":"assets/fonts/fa-regular-400.svg","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.ttf","path":"assets/fonts/fa-regular-400.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.woff","path":"assets/fonts/fa-regular-400.woff","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.woff2","path":"assets/fonts/fa-regular-400.woff2","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.eot","path":"assets/fonts/fa-solid-900.eot","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.svg","path":"assets/fonts/fa-solid-900.svg","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.ttf","path":"assets/fonts/fa-solid-900.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.woff","path":"assets/fonts/fa-solid-900.woff","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.woff2","path":"assets/fonts/fa-solid-900.woff2","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather-bold-italic.ttf","path":"assets/fonts/merriweather-bold-italic.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather-bold.ttf","path":"assets/fonts/merriweather-bold.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather-light-italic.ttf","path":"assets/fonts/merriweather-light-italic.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather-light.ttf","path":"assets/fonts/merriweather-light.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather.ttf","path":"assets/fonts/merriweather.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/open-sans-bold.ttf","path":"assets/fonts/open-sans-bold.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/fonts/open-sans.ttf","path":"assets/fonts/open-sans.ttf","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/images/avatar.png","path":"assets/images/avatar.png","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/images/cover-v1.2.0.jpg","path":"assets/images/cover-v1.2.0.jpg","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/images/cover.jpg","path":"assets/images/cover.jpg","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/images/logo-algolia-nebula-blue-full.svg","path":"assets/images/logo-algolia-nebula-blue-full.svg","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/algoliasearch.js","path":"assets/js/algoliasearch.js","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/gitalk.js","path":"assets/js/gitalk.js","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/gitment.js","path":"assets/js/gitment.js","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/jquery.fancybox.js","path":"assets/js/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/jquery.js","path":"assets/js/jquery.js","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/moment-with-locales.js","path":"assets/js/moment-with-locales.js","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/script-jsoeqoqa2ajw9nwj0xf5gmftvb2jhopk3sxu8iodabvev2jdlmr0zsitv3jm.min.js","path":"assets/js/script-jsoeqoqa2ajw9nwj0xf5gmftvb2jhopk3sxu8iodabvev2jdlmr0zsitv3jm.min.js","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/script.js","path":"assets/js/script.js","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/thumbs.js","path":"assets/js/thumbs.js","modified":1,"renderable":1},{"_id":"themes/tranquilpeak/source/assets/js/tranquilpeak.js","path":"assets/js/tranquilpeak.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/_posts/2020-end.md","hash":"cd9d0d511e27515685c37ea1a249f8c606fe8888","modified":1614405584586},{"_id":"source/_posts/Spring-Security-AutoConfiguration.md","hash":"14d9ad71bb0b36627e8914f10a2150a307c7e887","modified":1616512559311},{"_id":"source/_posts/binary-search-tre.md","hash":"3646de1d1af4fe0be97eb6e020037f1d44de460d","modified":1614959386597},{"_id":"source/_posts/SpringBoot-startup.md","hash":"97c48ae12de074a609da926ad8431651aa9ad6c0","modified":1613536017895},{"_id":"source/_posts/bitwise.md","hash":"e432378421cad9c100e07bd267360fcbf4e415e0","modified":1604820016381},{"_id":"source/_posts/contest201.md","hash":"bd260341d42c02016a549ee95cbfa97d50c3f513","modified":1604820016385},{"_id":"source/_posts/contest200.md","hash":"c68b5064a92a3fcbd3f84c348dea4bfbdc684ebb","modified":1604820016385},{"_id":"source/_posts/contest202.md","hash":"ff7d44f03dd7681bb0b3d8cf862af07a4a29a40f","modified":1604820016385},{"_id":"source/_posts/contest203.md","hash":"506cdc75078718c8bf5643df8416f5e9dce1b812","modified":1604820016385},{"_id":"source/_posts/heap.md","hash":"712bd551b9ec195eacc671ba92e05fd20a592322","modified":1604820016385},{"_id":"source/_posts/hashmap.md","hash":"8a724a0f8f48897c5561d0485de33d3ec76ce0b9","modified":1608038748842},{"_id":"source/_posts/decorating.md","hash":"12c546c129e1b38f89c7d28f03044fd377f55e47","modified":1616568253967},{"_id":"source/_posts/https.md","hash":"14a02c81c40ec171d0129f5ed75c6207df3e30ce","modified":1604820016385},{"_id":"source/_posts/java-collection-framework.md","hash":"0a52e07f02965bf5339d81767c402adcd5c389fc","modified":1615040336499},{"_id":"source/_posts/SpringBoot-environment.md","hash":"9deec8cc3107afa9d6710501504a7d2fcd3d1b52","modified":1613567556286},{"_id":"source/_posts/SpringBoot-refresh.md","hash":"1ce8dad48c033049bb5e7a24dfc8bb453b1ff53e","modified":1613547972104},{"_id":"source/_posts/jvm.md","hash":"4439ba1ea8ce8e50902e9200e18e28e3e1d6b0e8","modified":1616514034973},{"_id":"source/_posts/mq.md","hash":"cba47c0da597e997b680bd69c9d1880f4e613c4e","modified":1604820016385},{"_id":"source/_posts/lock.md","hash":"c8c80b88f63bfb80eded1cc7505718b07651a0c1","modified":1604820016385},{"_id":"source/_posts/mybatis-autoconfiguration.md","hash":"9d3fffb10c86a004bb7bc7d92b07823407094f0c","modified":1616422553417},{"_id":"source/_posts/mybatis-sql-resolution.md","hash":"3235b26577fa7ec318b0cd9349e7ff4f853e104b","modified":1616512534075},{"_id":"source/_posts/kafka.md","hash":"63c58e790291526a93f022e539758f76a9a83c3a","modified":1604820016385},{"_id":"source/_posts/observer.md","hash":"490d5864c09f76ff42ddf243a6aa9d75932ae044","modified":1604820016385},{"_id":"source/_posts/nginx.md","hash":"43adb94f931736a928d1b2c80bc1b8513d244168","modified":1604820016385},{"_id":"source/_posts/redis.md","hash":"bdc31bde46b4e469d2ef9bcdbc25db0a146fd6d0","modified":1604820016385},{"_id":"source/_posts/uml.md","hash":"3486af2f10efacb5f68dd533568a78f042bfe992","modified":1604820016385},{"_id":"source/_posts/volatile.md","hash":"bfc35bbc8dea0ae74acd0e5d95e9ffcd0a27b0f8","modified":1604820016385},{"_id":"source/all-archives/index.md","hash":"fa34028baad36af6c9feb24ef61cc0f3b3c51746","modified":1604820016385},{"_id":"source/_posts/mybatis_preview.md","hash":"a1b8ac96382b277e100108039ed17346fbcaebd2","modified":1615115067952},{"_id":"source/about/index.md","hash":"1e566d57b2401c7787da33404bdcc9e97247d0f5","modified":1609423171091},{"_id":"source/_posts/subarray.md","hash":"65fd8c2bad3d17a7033f15a5365662a115eaf898","modified":1614411351857},{"_id":"source/_posts/springboot-servlet.md","hash":"c4904ec3449d3c6e71250ef260b825f4b197b0a0","modified":1614700114523},{"_id":"source/all-tags/index.md","hash":"9328f34da1aa2d20dadfdf895d6356720a484353","modified":1604820016385},{"_id":"source/tags/index.md","hash":"9c3e184d51c00399c9ab869d6345d6231025afa5","modified":1604820016385},{"_id":"source/all-categories/index.md","hash":"5ba8c7b70cc60dc7bf0cefeb22b4d9b86d1aa2e0","modified":1604820016385},{"_id":"source/categories/index.md","hash":"5ed5ee833af50b986e1a543ace747994814a7cb0","modified":1604820016385},{"_id":"source/top/index.md","hash":"9f7492a48015822ab20b5c3ca8356d15760667bb","modified":1604820016385},{"_id":"source/_posts/jvm-concurrency.md","hash":"b519a6b75f918944e4ba4ed7fef53508279ea0b7","modified":1616513551607},{"_id":"source/_posts/jvm-classloader.md","hash":"cd00eeefa2df7a7c8cd46ca697b5d8a1333b3090","modified":1616515723178},{"_id":"source/_posts/jvm-memory-manage.md","hash":"3f7226ec73b1b959ce5b6c7464be0acc56e78382","modified":1616688720978},{"_id":"themes/tranquilpeak/.gitignore","hash":"19e27dd778896662e6d604b69411d2dc3cf5fec6","modified":1599420980000},{"_id":"themes/tranquilpeak/DOCUMENTATION.md","hash":"daaa36cff0cf7aeb7682372d6697a55d6a0f2f5b","modified":1599420980000},{"_id":"themes/tranquilpeak/.eslintignore","hash":"1f78f00553adf9ee374b343191ed809b0f8ba073","modified":1599420980000},{"_id":"themes/tranquilpeak/.eslintrc","hash":"ea1da9c0b0863a612ace47bd336cff95497bd878","modified":1599420980000},{"_id":"themes/tranquilpeak/README.md","hash":"c18f2fea9ceeec6efa85d892df67a191d6c84ec5","modified":1599420980000},{"_id":"themes/tranquilpeak/LICENSE","hash":"7a3b30ddb56760b35a6b7cd210aeb271cd292b60","modified":1599420980000},{"_id":"themes/tranquilpeak/Gruntfile.js","hash":"b2b078651cf8c5dcde2e847169ce242ad3319ca3","modified":1599420980000},{"_id":"themes/tranquilpeak/_config.yml","hash":"f53e629d54a936d8ff8710af7e0cd2abe775a161","modified":1609694380775},{"_id":"themes/tranquilpeak/package.json","hash":"e7ae06164db660858af35a2183417a518b081a80","modified":1599420980000},{"_id":"themes/tranquilpeak/renovate.json","hash":"f902d35646d7a6a637f727b02cd832c4339a4ca9","modified":1599420980000},{"_id":"themes/tranquilpeak/.github/ISSUE_TEMPLATE.md","hash":"ec6bf3eb708f8eb62736ede6d2080f6610849802","modified":1599420980000},{"_id":"themes/tranquilpeak/.github/CONTRIBUTING.md","hash":"8873700e439b6fc8aa4804b70a90fd81bf310d6c","modified":1599420980000},{"_id":"themes/tranquilpeak/.github/PULL_REQUEST_TEMPLATE.md","hash":"03cdb93ca72cd6a19043ea4bb1ec4f5b7479a0a9","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/de-DE.yml","hash":"c9a7514af3c5c58023f8d3ed9503be4253146015","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/es.yml","hash":"b5f37df87377d985339a21f343bf54db46926f1a","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/fa.yml","hash":"ec86c6fd655ed0c6df017c17f62b784b916d3a4a","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/fr-FR.yml","hash":"c644bb587a5360bb70a12c2d83f8d5973fb0055c","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/it-IT.yml","hash":"a5655d08a311f3292df5805ea2d6d72fd68726ca","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/.eslintrc.json","hash":"4cd7451f0bc15440bc8147912c63a11acd0e280f","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/ja.yml","hash":"3c6f7cda21ac91abc9f728e3093b1e98b42d5295","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/ko.yml","hash":"b56376775c5bc7f8f1d1b356340597cc61aae392","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/en.yml","hash":"a125cd554f890ba414c41a0b03375cfb4cb5622b","modified":1609694691672},{"_id":"themes/tranquilpeak/languages/ru.yml","hash":"262f781591cf2dd1584411ed4a780369d4d2e30a","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/zh-tw.yml","hash":"f04e0e91edacb8f6cae7308007bd5e5158e6c77e","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/zh-cn.yml","hash":"fea995175f5aeb58f8a958b00556bc2336d37a07","modified":1599420980000},{"_id":"themes/tranquilpeak/languages/pt-br.yml","hash":"e2edf45fae5a5290a3dc2111ef38d5cd40d43771","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/archive.ejs","hash":"0df1edf4ed40b316715ef1949b09aa9c98d22359","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/all-categories.ejs","hash":"c2257b8265a9a328e69c92f4a88cb2cdd99c047a","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/all-tags.ejs","hash":"aabb765f51a8d7582a5bafdbc8876b46ff1e6ea1","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/all-archives.ejs","hash":"28a4e97d1cfe4730dbcc8fde27b079320b5eec35","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/index.ejs","hash":"36e89b37f520533bef85fb32b714214257fad1d0","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/layout.ejs","hash":"29c1291c7ca3f5da7bee6385b7f716d179199933","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/category.ejs","hash":"67902c418e299399133fe2a7ebc39cadd17de861","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/page.ejs","hash":"ae761feddc98f4d3260e7591ed9fc91d9a49d0ab","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/filters/excerpt.js","hash":"5e0e473d46f8c7aac988ebf0b25ab2eab0af73bb","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/filters/thumbnail_image_url.js","hash":"0ad2d9304c991e2989708bdbfa6a59030ee691d3","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/helpers/absolute_url.js","hash":"0d520a946b6f0abbac60529017ed3133265aac60","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/helpers/generate_sharing_link.js","hash":"89069677e8acddef5fba0d3093f5f73fde4fa485","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/helpers/is_remote_url.js","hash":"471237ea295bcc9a392a5bb6738ef4c6ab673afb","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/helpers/json_ld.js","hash":"4cd07766ed9436f0c4cb8a9ae22644272918b837","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/tag.ejs","hash":"72bff1ae241fbe2ddca0537e8ed77c791a7d1766","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/tags/fancybox.js","hash":"55ce02f9ef084f43932eb9b0f10db1d5e9c3a250","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/post.ejs","hash":"ae761feddc98f4d3260e7591ed9fc91d9a49d0ab","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/helpers/resolve_asset_url.js","hash":"c813e9daaed374b386b91876923f10c0cf1d624c","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/tags/tabbed_codeblock.js","hash":"7dccd36bdd85c96eb7af125b30d634f44125700c","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/tags/alert.js","hash":"5b86358dd53c9b0d44c385ec12cf9e76383e229a","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/tags/image.js","hash":"ab6b04db8fe2ad21ec52dac5e1c3ee76400c6a79","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/tags/video.js","hash":"497d64fd454cc6fd5c26a42cb8e38db90b83cf4f","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/tags/highlight_text.js","hash":"8e093f21e9a4b10c19be6f300dc90bcc39685ec9","modified":1599420980000},{"_id":"themes/tranquilpeak/scripts/tags/wide_image.js","hash":"d3596c62694548a3a684e8dfeb5372038ef6f450","modified":1599420980000},{"_id":"themes/tranquilpeak/.github/workflows/nodejs.yml","hash":"595c32bcb8ba72cd0737c6009f24dabda12af834","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/pipeline.js","hash":"75b65cbd6d6ae471739ba80c9f792f602a0769d4","modified":1599420980000},{"_id":"themes/tranquilpeak/.github/ISSUE_TEMPLATE/feature-request---improvement.md","hash":"7d53b0c0d65dd28da17ff9d948e842883cab467f","modified":1599420980000},{"_id":"themes/tranquilpeak/.github/ISSUE_TEMPLATE/question.md","hash":"443c4f27268d39e89390edb7dcffda407a070fd7","modified":1599420980000},{"_id":"themes/tranquilpeak/.github/ISSUE_TEMPLATE/bug-report.md","hash":"b9a9ffe556f1fca39009403f87bb8c8e840dc369","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/about.ejs","hash":"c92588fcb4435e19b8c7e10fe24484aa6639060e","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/archive-post.ejs","hash":"e19455749c5c1bf773214d965f173613dd8f30f6","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/archive.ejs","hash":"bdd73d1f70bd91533863943f940f8193d44e0fdd","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/baidu-analytics.ejs","hash":"736eca2ecf6fdeea032d47c02c51688f006cafb4","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/cover.ejs","hash":"18b9a620fca9b648fd59467a66b3f4fdbba42613","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/google-analytics.ejs","hash":"b756aa731678a37d22c97c7dc30767331b08d109","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/header.ejs","hash":"94bde50d2911814ae08c4a9c681657cc3392c05b","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/head.ejs","hash":"52459d08c7d6b172124fa1ea09bd7414419fc779","modified":1607953738996},{"_id":"themes/tranquilpeak/layout/_partial/index.ejs","hash":"34d9260021e4b8b4bf232c2786d8e90e0db5bd20","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/footer.ejs","hash":"67962257d9e3cb6a4d56e3f0263f192ba9a413dd","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/pagination.ejs","hash":"89d3be71ff2f5a847850d50e117896056f0ca1a6","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/script.ejs","hash":"30f080e514007a8411b30373592d257407fe7aaf","modified":1607953738996},{"_id":"themes/tranquilpeak/layout/_partial/search.ejs","hash":"0fd5f75117912cd1e6e7e6094079bccdc79c0000","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/sidebar.ejs","hash":"39fb0c9f214cc36f4f96cbcacc832e542d723881","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_fonts/merriweather-bold-italic.ttf","hash":"c1b8593dc9ddbf1a1a6268d31e08c4041448ed76","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_fonts/merriweather-bold.ttf","hash":"e6d0ffb2d0348d9e22de97e57214b7db795e9513","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post.ejs","hash":"cdccf8f0ea1c01997fafdabb7cf044d3939cbb6c","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_fonts/merriweather-light-italic.ttf","hash":"c3835119c62e78a21cfb33e2de6686fb4a5929a0","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_fonts/merriweather-light.ttf","hash":"69bd3f15962cf91348a133d3d38571a5c67eca65","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_fonts/open-sans-bold.ttf","hash":"3823779db9f51a34658809ce66bdd6ed1145ed8e","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_fonts/open-sans.ttf","hash":"618b78a8f6ffe7e1998eab67268859e2ab54be8e","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_fonts/merriweather.ttf","hash":"d392237948e74246a2fb0d0d886498776a185e54","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/about.js","hash":"ce68bcc929192dfca6e699fe8e528990cd2d9590","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_images/avatar.png","hash":"fae7a4bc08bad88136de5f66c9abe97954741234","modified":1609693880725},{"_id":"themes/tranquilpeak/source/_js/.eslintrc.json","hash":"27d4e7223eee3eca7eb717bea2d28d35714eccbc","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_images/logo-algolia-nebula-blue-full.svg","hash":"d5e4426b6bd2d8b8c3f477f83d348d8f3b3ec1ca","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/archives-filter.js","hash":"8b8998b0e67c745a20450001c0739f6977b63309","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/categories-filter.js","hash":"a5f3c4b9bbef1c8ec881eb39551060ca95bfbb33","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/codeblock-resizer.js","hash":"391c2c9135579ea50c2060e0612e7105e06a8ff7","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/header.js","hash":"58ca619f851ebff35724c07dca7f1ed25e9cd5f2","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/fancybox.js","hash":"659aaad375ecff9748a5d3b0ff1378a549236513","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/image-gallery.js","hash":"90efc47246af69b7e17fab6e0bd1578043fcc2b0","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/post-bottom-bar.js","hash":"64f78c44d29d3559d5e14e436b8cfe1d24b8c965","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/share-options.js","hash":"c2046697540786721ff7c4754774f94fcaf32696","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/search-modal.js","hash":"7ea9ab668bc3118c28e6212516f366ef764d3550","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/sidebar.js","hash":"18dc623dd237c519bb79ce93283a5446cc11a487","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/smartresize.js","hash":"7342a21f94d7bb0525ccbd917d43a6824d7ae63e","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/tabbed-codeblocks.js","hash":"1282e11aacb036c8c9310cac49b75d7e2200125c","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_js/tags-filter.js","hash":"d33625df51d7b9788eeea338626f04387c96f053","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/tranquilpeak.scss","hash":"e69c62b19ece4ab35d992e163b47f2a8374d7611","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/register/build.js","hash":"f64c77127a2d4bfdbb9866fcf368913334f44603","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/register/buildProd.js","hash":"450ff77a1bf631d1799206d218c6468592a59862","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/register/compileAssets.js","hash":"a65122ba0d1a1b6044e3b635a644882577b628ba","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/register/default.js","hash":"80174db9b8a729980770e639e70999ce5a816b78","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/register/eslint.js","hash":"718cd8a80d060e2587b84e0e20ceaa39c2cc9411","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/register/linkAssets.js","hash":"079cd274cb29f9984eb7150d88f61819d2ef6235","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/register/linkAssetsProd.js","hash":"37f2fab80f25757be3e34b40bc5a26a82f088491","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/register/syncAssets.js","hash":"0813093c3e252a58371db53e914183a97e3186a1","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/replace.js","hash":"984ba7ed966c16b1fadf47c62f76e99940d4b12d","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/sails-linker.js","hash":"c1103119ec7d1f04cfbb1cda83b40d11e8f2d218","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/copy.js","hash":"4b9a4e724c65ec71cfec36b387a2625fc0f1074c","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/concat.js","hash":"0c2c4dbbfac52f20a3035a2f8cd1c24f1759b17e","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/sass.js","hash":"84ba6be74f99c502543b7f77a105ce16931fd38e","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/sync.js","hash":"fbc09d0ed201993bc1918223b8f8ad5b68f50490","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/cssmin.js","hash":"352185864437728c9c19169f4fec6fc3308e8b6d","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/actions.ejs","hash":"419223bff6146c46d4e993e4aa2e3636b051edc8","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/category.ejs","hash":"d4b26aa8c66aa8dbfae7a4aafed874745efb2f8e","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/disqus.ejs","hash":"9e0d238ed918e3138d5a9bb23a90408669e19169","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/duoshuo.ejs","hash":"992368f8863f34d1dccf90c0cabc33d5dcdbe92a","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/uglify.js","hash":"57c7341a004b61539f5b3f02bd772f40494b8306","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/watch.js","hash":"933eecd8a2506c627dbb9a1137305a16dd2d9f9a","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/gitalk.ejs","hash":"8c91c60ffeab780a8a628145c572456187142101","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/gallery.ejs","hash":"71b4ad77ab08c0980bf85b85c98a90c7de2be107","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/gitment.ejs","hash":"1dcfdca4d20bab5a43bda44cf37df506ab3a0fb7","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/header-cover.ejs","hash":"4d3a73d0c6f26769f778d02a559e5055ef1ee0ca","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/meta.ejs","hash":"f13cb5089b0d5898c9606519d1c872725a63a5f9","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/header.ejs","hash":"19c5f0d680db08fe2880f41de3a085ef0298a386","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/share-options.ejs","hash":"896158d62beba2ecb7d6af6e0f01f8f1ea23e706","modified":1599420980000},{"_id":"themes/tranquilpeak/layout/_partial/post/tag.ejs","hash":"2a52f38fa359f8ec8ae776e44e92c48795e31272","modified":1599420980000},{"_id":"themes/tranquilpeak/tasks/config/clean.js","hash":"ea70743eb4ed0d9ead68d6fc8b65b9f936229a00","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_archive.scss","hash":"cfdf53475d228643d5c5e62689b3c6a593e4ccce","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_alert.scss","hash":"1e6bf40de34a341dd0228357e288153b9292977c","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/base/_base.scss","hash":"f0a46b090a0a4dd21edfd89095761895c5278ecb","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_box.scss","hash":"eebaacf55234fdaa156edb7dc4d9a4f382eaf4d4","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_button.scss","hash":"ea9bd41800fe04860f7e892c17010588b2563a06","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_form.scss","hash":"368187e0c5f1a57d8c423f2ec23e897ee94a1a27","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_caption.scss","hash":"dad2683f5f3235b335eebcbda3db59a1cfbb2283","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_fancybox.scss","hash":"e162e2ecafc2be70238a9885fd57a9a7ad642757","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_figure.scss","hash":"9828521c34d91f04813db23e174708f510fe30bf","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_icon.scss","hash":"60dc972bcd81b4f95ab2c067ca910a5bf324d907","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_highlight-text.scss","hash":"7a7a8a78f75d6c43a46fd020e2d44546e716751b","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_hide.scss","hash":"c2f5ed51086b9ea5d94ff548bdc4653ea5cd7912","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_code.scss","hash":"0a14fe197c221a4d4d91ee9d41541ce7969043ca","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_link.scss","hash":"7460155ebf7ce0d3e9acd090b6b99673127fd0be","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_media.scss","hash":"84aa03c01b741bbeb31c6b48122930f30ad40de3","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_main-content.scss","hash":"90c46c87289a8b3cf7c14d36900f5ced9db36c25","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_image-gallery.scss","hash":"95ee5be04c523bf914596042574780ee527e6b38","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_markdown.scss","hash":"ba6d7e8f84b3b6dfef339f28b5c6ae372ead674f","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_modal.scss","hash":"bc56f823cd67b2ed65b5cf2c3e1851fa3e82f0f9","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_pagination.scss","hash":"809b9330a0e2d79c9285c1a452d61648248c8b70","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_post-actions.scss","hash":"1cc3ba46b1752043207bb820f4f886b0f982e445","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_post.scss","hash":"0457c281b7893f8fde8a0590e4c1ff2ffb4bc1a6","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_post-header-cover.scss","hash":"c4bf950602ccb3fbdad54938979651a7b488236e","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_postShorten.scss","hash":"9a2fdf8021c71d09fcd6ef5bc269055d78290fdb","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_pullquote.scss","hash":"86bc35ba358d1340debc459a344f5f6d34acaa42","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_tag.scss","hash":"ddd1c2ce17f0116655bdacda598e7f1d6fd18262","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_share-options-bar.scss","hash":"f6289a7cce6efe039614c77085945923c32d9673","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_text.scss","hash":"7b38858248da2f73cf64c5949fd475a8e0a246ae","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_video.scss","hash":"f9727fd300d73e8844abf0e2575c45e6c7769333","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/layouts/_blog.scss","hash":"2450e07594a5e5186170fb5b5b157cc340808a9a","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/components/_tooltip.scss","hash":"f33ad3e677761af1ceb42d337691b8b354ff70bd","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/layouts/_bottom-bar.scss","hash":"c7816c7ebc253d46466355860ead6669a3707ac6","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/layouts/_footer.scss","hash":"645161942c66e6afbd666b4755337a6a6261e5e0","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/layouts/_about.scss","hash":"4a1c4cca6623449602208256dee6422173daf1ef","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/layouts/_cover.scss","hash":"03a951c9b35dd4e35456caa36950e6d6bef77ac3","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/layouts/_header.scss","hash":"d840a4be850cb258167ee1081e1b288dc64b3d2c","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/pages/_search.scss","hash":"5f7cde0b68156ea802c3caf6cd673cab948b09d9","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/layouts/_main.scss","hash":"ee4648502b355db51fc6cb7b05375003331f2f6e","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/_fonts.scss","hash":"4da4074668be0e0abe756aa537a406d14da7ceff","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/layouts/_sidebar.scss","hash":"facaff0ca816a4ace67c7689e4286e88eb1010c2","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/css/gitment.css","hash":"7fbb18b73b44ed11193739c55fce53a6f173cf68","modified":1607953729145},{"_id":"themes/tranquilpeak/source/_css/utils/_variables.scss","hash":"fc62fcffcdb16fb823c3cb170bbcf34493f0467f","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/css/gitalk.css","hash":"fe5406a41cf222f39919630efd9012d08b7414aa","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/css/jquery.fancybox.css","hash":"00ce8430edb0a4ca35e08a9813e039d3a4b7868c","modified":1607953729388},{"_id":"themes/tranquilpeak/source/assets/css/thumbs.css","hash":"133acf84f948218219d3f23eb466fe54aceda97d","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.eot","hash":"3306178c90d9df939d2a5eabf533ba3650fbe80e","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.ttf","hash":"517a3b41c1e01b65898b5f1074434d43a361a54f","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.woff","hash":"da17a9f1dcae379c8ba20f1089059c202216cba7","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.woff2","hash":"5e4d45052f43e55aaad7f14d13280215e39aa45b","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather-bold-italic.ttf","hash":"c1b8593dc9ddbf1a1a6268d31e08c4041448ed76","modified":1607953729364},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather-bold.ttf","hash":"e6d0ffb2d0348d9e22de97e57214b7db795e9513","modified":1607953729364},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather-light.ttf","hash":"69bd3f15962cf91348a133d3d38571a5c67eca65","modified":1607953729380},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather-light-italic.ttf","hash":"c3835119c62e78a21cfb33e2de6686fb4a5929a0","modified":1607953729364},{"_id":"themes/tranquilpeak/source/_css/themes/_hljs-custom.scss","hash":"a0ffab53db35bbd4881aeb077400cba55551f3bd","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/fonts/merriweather.ttf","hash":"d392237948e74246a2fb0d0d886498776a185e54","modified":1607953729380},{"_id":"themes/tranquilpeak/source/assets/fonts/open-sans-bold.ttf","hash":"3823779db9f51a34658809ce66bdd6ed1145ed8e","modified":1607953729380},{"_id":"themes/tranquilpeak/source/assets/fonts/open-sans.ttf","hash":"618b78a8f6ffe7e1998eab67268859e2ab54be8e","modified":1607953729380},{"_id":"themes/tranquilpeak/source/_css/themes/_hljs-tranquilpeak.scss","hash":"3c1e0d8b6e2f37820d00572878d060080c5a6fe7","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/images/avatar.png","hash":"fae7a4bc08bad88136de5f66c9abe97954741234","modified":1609693880725},{"_id":"themes/tranquilpeak/source/assets/images/logo-algolia-nebula-blue-full.svg","hash":"d5e4426b6bd2d8b8c3f477f83d348d8f3b3ec1ca","modified":1607953729364},{"_id":"themes/tranquilpeak/source/assets/js/thumbs.js","hash":"ee9a65e280178b9525441b751ad7c0e6eb887022","modified":499162500000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_button.scss","hash":"70c64560144d7d6015bbedeca0531258f9bafa07","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_bottom-bar.scss","hash":"ab28b4d66f021e44d7a46a76157c6a2b5fd23496","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_category.scss","hash":"8cfc45772365e537949a4cd20cfa2a79e1a75dc8","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/js/tranquilpeak.js","hash":"ed9d93b9de4037c97c8699b7b9b985ec48c1b25d","modified":1607953729416},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_header.scss","hash":"52de2cb5f49a3b5748557fe2d25791ce52457d62","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_form.scss","hash":"14026f13b54ef9f2cd7109cf1bca43040816e542","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_main.scss","hash":"0ad55a6191d0a533917845006ceae329353c0b90","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_opacity.scss","hash":"cfc9905b6df3b5100a30b5c47fd331068f238f97","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_share-options-bar.scss","hash":"06f84bceb82df4d3bda64144f6fe4ad8e3e45f89","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_post-header-cover.scss","hash":"ecd9078372d8bd1b7f4979bae3251e8efb345a9b","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_prefix.scss","hash":"5e04cd54ba375f69c97b62b7d4e535118ec78177","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/css/all.css","hash":"9e798ebfbdf41ffcd68b02a5af2a9d997ddd6d12","modified":1607953729392},{"_id":"themes/tranquilpeak/source/assets/css/tranquilpeak.css","hash":"a6c317a8f3222d738f6cad9273729f8a915eb918","modified":1607953729412},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.woff","hash":"fddb95d7a0f48d2bf90a5ee3095e8264dca18053","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.woff2","hash":"62584b9868428fd75af3fc5ee2f9918dda428be5","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.woff2","hash":"6290834672aba86d5b6c1c73b30b57c9c53996f7","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.woff","hash":"f13e252f8a51a5279fd21e26ada0bd2f55bcefd8","modified":499162500000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_sidebar.scss","hash":"6c3dc034c3d5fdf7f0c4c39a6913f5bae4fc4767","modified":1599420980000},{"_id":"themes/tranquilpeak/source/_css/utils/mixins/_tag.scss","hash":"c8a87e586e27f999ffa46f273f78a812f1cf2f0a","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.eot","hash":"40c8f2a0dc154160fde50e0c27f694f12c7b1636","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.ttf","hash":"29f59b4eecc72052d9110a5d4030a10ad9bf73d7","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-regular-400.svg","hash":"51afca56e309df6fdc56b53fa6a7d3ce64826490","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/js/jquery.fancybox.js","hash":"048f1f8464eba59ccc706250693bc2ab060098a9","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/js/gitment.js","hash":"376446d9c5930576016f97dd63e5e6616c94d8d4","modified":1607953729145},{"_id":"themes/tranquilpeak/source/assets/js/script-jsoeqoqa2ajw9nwj0xf5gmftvb2jhopk3sxu8iodabvev2jdlmr0zsitv3jm.min.js","hash":"5f7046b160a695d9cac75b4eace17a2f70d7c365","modified":1607953738972},{"_id":"themes/tranquilpeak/package-lock.json","hash":"da9b5df3e93b6e72d4c0c9e8f1839de886ab1e77","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/css/style.css","hash":"cdef36fb7aba6b5157a5d7389275b5d94c39d886","modified":1607953729440},{"_id":"themes/tranquilpeak/source/assets/css/style-xsmpikcbczzhpff1zqybzgesjqcgmkdkx9b5ntr0bkmk6wqucpktuaodiuvy.min.css","hash":"5373bff083c63d4e6f97f9fcf9c53cd76553770c","modified":1607953731375},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.ttf","hash":"874c650701d0cbfb8f1de48a496dabed3bbf22e6","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/js/algoliasearch.js","hash":"6948fcdf071e4983e784e8c458cf201536f77792","modified":499162500000},{"_id":"themes/tranquilpeak/source/_images/cover.jpg","hash":"df915f5b3eeed6bad93a183f65e5c6f536e551fe","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.eot","hash":"96a5637429426764ea9b28bf4d1eb55ae10de57e","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/images/cover.jpg","hash":"df915f5b3eeed6bad93a183f65e5c6f536e551fe","modified":1607953729360},{"_id":"themes/tranquilpeak/source/assets/js/jquery.js","hash":"ad16c4a132ad2a03b4951185fed46d55397b5e88","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/images/cover-v1.2.0.jpg","hash":"a98b9bf4d6be3af0156c0b6e781f067e343a682d","modified":1607953729356},{"_id":"themes/tranquilpeak/source/_images/cover-v1.2.0.jpg","hash":"a98b9bf4d6be3af0156c0b6e781f067e343a682d","modified":1599420980000},{"_id":"themes/tranquilpeak/source/assets/js/script.js","hash":"a7d90b628cd71bc7a40ffab53f2bfeb73bb352da","modified":1607953729472},{"_id":"themes/tranquilpeak/source/assets/js/gitalk.js","hash":"c7a382307a7fdc77ba4c4f5a440bd14483741ff1","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/js/moment-with-locales.js","hash":"d39047f5013a835e3db43fa17b78bf625712825d","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-solid-900.svg","hash":"5501fb62e20a89bdd89bf3fa147ca4dbcd2fc67f","modified":499162500000},{"_id":"themes/tranquilpeak/source/assets/fonts/fa-brands-400.svg","hash":"99dff0739882276ad6c434d73228efc7971b0a66","modified":499162500000},{"_id":"public/about/index.html","hash":"055ba52fd9ae1a4043e2e2ad07ab30b118d82f8f","modified":1617596584243},{"_id":"public/categories/index.html","hash":"1691cea1e17a6eacb6368a504b93cb5f62b18d34","modified":1617596584243},{"_id":"public/tags/index.html","hash":"6fa9a59bdb62d9a820ca351dc586aa3a8681547d","modified":1617596584243},{"_id":"public/top/index.html","hash":"cf2e35bbfa1693a54eccdf9e54948d1690391d8a","modified":1617596584243},{"_id":"public/archives/2019/12/index.html","hash":"67458c7107677f88478873620662814fe1d82ee7","modified":1617596584243},{"_id":"public/archives/2020/01/index.html","hash":"15f4ed74cad6c84a5f2aba31ce482a021bd45f36","modified":1617596584243},{"_id":"public/archives/2020/03/index.html","hash":"270f970d83e324adc1db933a8878ca1c0c85ddb8","modified":1617596584243},{"_id":"public/archives/2020/05/index.html","hash":"2afdc2b0b5669b24c7cbca8f436e46fb986cc131","modified":1617596584243},{"_id":"public/archives/2020/06/index.html","hash":"223703bd2ee4082fa67b6eea1c4448e873ecc8a9","modified":1617596584243},{"_id":"public/archives/2020/07/index.html","hash":"e03c6eae154238c071635a7b9d1419d5035799dd","modified":1617596584243},{"_id":"public/archives/2021/page/2/index.html","hash":"dff6f3c0d837d8c06145b63cd01e99f458e6d1a1","modified":1617596584243},{"_id":"public/archives/2021/01/index.html","hash":"e5e91fca5d86a74660f43b0aecf92adb7c45069e","modified":1617596584243},{"_id":"public/categories/framework/index.html","hash":"dacdd9de54fd53e12649c2a472d2707f91317899","modified":1617596584243},{"_id":"public/categories/Leetcode/index.html","hash":"a2dd66979ca1658090998746224b3497ae36fce3","modified":1617596584243},{"_id":"public/categories/Java/index.html","hash":"dea558419a5ba222a3c7e8a2d5ef05f96c92cf4b","modified":1617596584243},{"_id":"public/categories/DesignPatterns/index.html","hash":"60a5791521f6008dc82e81333c41c7fc970653d4","modified":1617596584243},{"_id":"public/categories/springboot/index.html","hash":"af62160293ab6ec855099f616c11742116d3dc67","modified":1617596584243},{"_id":"public/categories/JVM/index.html","hash":"87d40ed98da4fdb1417dd831c8f27a3c5635c28e","modified":1617596584243},{"_id":"public/categories/MiddleWare/index.html","hash":"c2ada3e25974eaa1c1c2a0ad9dc51c8474afd480","modified":1617596584243},{"_id":"public/categories/DB/index.html","hash":"92e9cd54218ed82479d4f61207c53c7b4a2fb482","modified":1617596584243},{"_id":"public/categories/Utils/index.html","hash":"276eb93fd5dddc34ab8bf5bd68cec059865e2258","modified":1617596584243},{"_id":"public/tags/summary/index.html","hash":"f03c98cea4a938f5004e48cd9fa950c0193dec7d","modified":1617596584243},{"_id":"public/tags/spring-security/index.html","hash":"5994bdbc58eae2de68b4b46e70bf23873e3d5ed9","modified":1617596584243},{"_id":"public/tags/bst/index.html","hash":"50b73ed84fc5c07ec57a859d077958cfa0cbabf8","modified":1617596584243},{"_id":"public/tags/bitwise/index.html","hash":"180a64ded43b2c38b393092c21dfcfd08f45f3ef","modified":1617596584243},{"_id":"public/tags/algorithm/index.html","hash":"0e344e62f33746830a74b0e5f04caf6ac0a887ba","modified":1617596584243},{"_id":"public/tags/LeetCode/index.html","hash":"2dce6a70692d79194eebd7911568bd5438f1f61f","modified":1617596584243},{"_id":"public/tags/design-patterns/index.html","hash":"6bf2efd1f448454c4cf8f16e6dce1d330156359a","modified":1617596584243},{"_id":"public/tags/hashmap-data-structure/index.html","hash":"6481ede781d99594d2ded40b1373b3cfca037885","modified":1617596584243},{"_id":"public/tags/datastructure/index.html","hash":"ce2398566057bd9fca9e279ed2281526c6ff3902","modified":1617596584243},{"_id":"public/tags/http/index.html","hash":"8f87f3400a065765d52b09f96159835273ffb303","modified":1617596584243},{"_id":"public/tags/https/index.html","hash":"e6a814e17883999e39a3d52a47614fd46fee675d","modified":1617596584243},{"_id":"public/tags/source/index.html","hash":"a3de3a6766b305918e20c2895ec79397847f2d21","modified":1617596584243},{"_id":"public/tags/kafka/index.html","hash":"2b2f7cd0a3ff00423bb8b9e336331e239c30b871","modified":1617596584243},{"_id":"public/tags/lock/index.html","hash":"2d4b46484f210abc5f2d8a7e8710295253cd4aea","modified":1617596584243},{"_id":"public/tags/mybatis/index.html","hash":"6419806ae0d0e544cc25ff7d122c6479bf4f6df8","modified":1617596584243},{"_id":"public/tags/redis/index.html","hash":"6ce7472295570946c7b1d05fd5abb838689e330f","modified":1617596584243},{"_id":"public/tags/nosql/index.html","hash":"652f4353c939ca9ee4e1792be4c595ee72260e54","modified":1617596584243},{"_id":"public/tags/double-poiters/index.html","hash":"34a3557f8642b759fdf149c917f9b306ebfb531a","modified":1617596584243},{"_id":"public/tags/map-preSum/index.html","hash":"0d0abb45a22ec5221e5b4a7bfdd1338a52b228cb","modified":1617596584243},{"_id":"public/tags/utils/index.html","hash":"dedee965b1cca19e1f64cbaae7f601b5f4fb429b","modified":1617596584243},{"_id":"public/tags/classloader/index.html","hash":"78be7df284e01f0c9a965c6f57005d396a8d18ab","modified":1617596584243},{"_id":"public/tags/memory/index.html","hash":"27e42538c44ed14fd7467f14d5c0d52c597d7c4d","modified":1617596584243},{"_id":"public/tags/activemq/index.html","hash":"0832fe3b064290532d4979abcae73b2045eda7de","modified":1617596584243},{"_id":"public/all-archives/index.html","hash":"99af3093a57351c01eed98e3731224206857a256","modified":1617596584243},{"_id":"public/all-categories/index.html","hash":"ccf882f267076f1864a7cb32ee4a46638cf9f355","modified":1617596584243},{"_id":"public/all-tags/index.html","hash":"76bac447a39f2bb9bd2be3e6c6956d249f9c9d0c","modified":1617596584243},{"_id":"public/2021/03/23/jvm-memory-manage/index.html","hash":"387bddcf1469292669409e534f4f7a85cf6e0c4b","modified":1617596584243},{"_id":"public/2021/03/23/jvm-concurrency/index.html","hash":"d2c3c77e0a11ffd93d553dff6e5785248fb1ddcd","modified":1617596584243},{"_id":"public/2021/03/23/jvm-classloader/index.html","hash":"c153137aa2b864d0ab65dfed0f463eab700e0012","modified":1617596584243},{"_id":"public/2021/03/22/Spring-Security-AutoConfiguration/index.html","hash":"7e346cdf422121fb7168ca7598ff1009c3b5bdf4","modified":1617596584243},{"_id":"public/2021/03/09/mybatis-autoconfiguration/index.html","hash":"1c544bbd814e44a43ee6f0005e40fddcfd60c348","modified":1617596584243},{"_id":"public/2021/03/07/mybatis-sql-resolution/index.html","hash":"276aaea625eb9923274fefb272ffac6dc4cea72f","modified":1617596584243},{"_id":"public/2021/03/06/java-collection-framework/index.html","hash":"71b3d61920caf0cf75ded16772a6392fe999dd1c","modified":1617596584243},{"_id":"public/2021/02/28/springboot-servlet/index.html","hash":"907c5222aff61e2032164eaace91dadb484aebcb","modified":1617596584243},{"_id":"public/2021/02/27/binary-search-tre/index.html","hash":"7fa0a21a36b10c9f6f4cfd34eb6381de7b1363fa","modified":1617596584243},{"_id":"public/2021/02/27/subarray/index.html","hash":"8cb0a9d9fd1d79ad8d7199c5f8773be5e776e6e1","modified":1617596584243},{"_id":"public/2021/02/15/SpringBoot-refresh/index.html","hash":"5685fe3971f56b0b8c47cc2c9f07e17d856ca405","modified":1617596584243},{"_id":"public/2021/02/15/SpringBoot-environment/index.html","hash":"6c6013edba21e6b86dcdba9ab0254937e2add19a","modified":1617596584243},{"_id":"public/2021/02/15/SpringBoot-startup/index.html","hash":"c52a510a72e49995b967dc5c67d272d31d66bbab","modified":1617596584243},{"_id":"public/2021/01/03/2020-end/index.html","hash":"ac3bfc050a59e0ec53bdc75f53c7e02521c0c6e3","modified":1617596584243},{"_id":"public/2020/08/23/contest203/index.html","hash":"03cd469dd54c2a05aa3664b6447bd0cfafa35924","modified":1617596584243},{"_id":"public/2020/08/20/hashmap/index.html","hash":"8aafbf699cebb802fcb3aa0311c2b5fc627ee098","modified":1617596584243},{"_id":"public/2020/08/16/contest202/index.html","hash":"9cdd4280310346363cf995334a7ba0b9e7254d36","modified":1617596584243},{"_id":"public/2020/08/09/contest201/index.html","hash":"aef8860e0ac30fed185b9f1e7d37189e869fd6dd","modified":1617596584243},{"_id":"public/2020/08/05/mybatis_preview/index.html","hash":"0491be544085c23f94682b06cf1a6e13cdf51070","modified":1617596584243},{"_id":"public/2020/08/02/contest200/index.html","hash":"2707a371e000374b8f0f7a71056d5699a8d5abe4","modified":1617596584243},{"_id":"public/2020/07/20/lock/index.html","hash":"69bc09f4a6de972ad47449e7ca85fd2a0c8f9811","modified":1617596584243},{"_id":"public/2020/07/20/volatile/index.html","hash":"38ad0340606657f5b58e7fefa02cb36e89eb1335","modified":1617596584243},{"_id":"public/2020/07/20/mq/index.html","hash":"2b4f47a75323ea5fddb7076e126fe523a71a1e1f","modified":1617596584243},{"_id":"public/2020/06/12/decorating/index.html","hash":"5208edc732520f07449d4b4f204f6f1cdd4fd56b","modified":1617596584243},{"_id":"public/2020/06/12/observer/index.html","hash":"e313ed89264eaaff2ab4ec4b21e25ef528998368","modified":1617596584243},{"_id":"public/2020/06/09/redis/index.html","hash":"a1cfeb8351ac3fd5d53f4c9d1aa65f6aee7a080c","modified":1617596584243},{"_id":"public/2020/06/06/heap/index.html","hash":"d8049b1334ddb45bd265d8a3502a2abde0f3930a","modified":1617596584243},{"_id":"public/2020/06/01/bitwise/index.html","hash":"931ed14b6e88fb40db6e3bd297d4053c3a50ed5a","modified":1617596584243},{"_id":"public/2020/05/24/jvm/index.html","hash":"146180466a127cb46ec398cda0c8c1c38814bd4a","modified":1617596584243},{"_id":"public/2020/03/14/https/index.html","hash":"e2195096128d35742462d34c17f241087b07997a","modified":1617596584243},{"_id":"public/2020/01/12/uml/index.html","hash":"b56e74fb85c8efaa6995586249b313532a870e28","modified":1617596584243},{"_id":"public/2019/12/03/kafka/index.html","hash":"d0084f6037dbb6ad5344bb2484b06b0152429a3f","modified":1617596584243},{"_id":"public/2019/11/02/nginx/index.html","hash":"ab07185d56b4ff185a96f18d5e9469bb6c7a26f6","modified":1617596584243},{"_id":"public/archives/index.html","hash":"7e8cede2be6811dcd39af9d0ad821789eda79b64","modified":1617596584243},{"_id":"public/archives/page/2/index.html","hash":"f1bc9010b7828e2cb92e8a8303e860167ba54b0b","modified":1617596584243},{"_id":"public/archives/page/3/index.html","hash":"e75d6c492e7288306853937ea630894d898d21b8","modified":1617596584243},{"_id":"public/archives/page/4/index.html","hash":"06c6a38132f94a3d0140fbd4f352679840176754","modified":1617596584243},{"_id":"public/archives/2019/index.html","hash":"e9be115ecbc685cf1e86af47c0721439ce4b3b33","modified":1617596584243},{"_id":"public/archives/2019/11/index.html","hash":"18a0afb05a408b5b4b4481817f10b06a1a697601","modified":1617596584243},{"_id":"public/archives/2020/index.html","hash":"cc8f6a1cf1fc20a4da5df60eafc208811b3c2ff3","modified":1617596584243},{"_id":"public/archives/2020/page/2/index.html","hash":"9e0354190d6d25c835268694bcd6ca8912b030c1","modified":1617596584243},{"_id":"public/archives/2020/08/index.html","hash":"d7cce4d8ec9c01cf3082190070c95233a95ea052","modified":1617596584243},{"_id":"public/archives/2021/index.html","hash":"1a0eae29b63fce85086ea80c78ffc5a8ba65ec01","modified":1617596584243},{"_id":"public/archives/2021/02/index.html","hash":"5bc90c3b3d5a60ba274d1622336b2db053f4fcc9","modified":1617596584243},{"_id":"public/archives/2021/03/index.html","hash":"9e0b93e6451946365064f6668a11981ab533c654","modified":1617596584243},{"_id":"public/categories/Network/index.html","hash":"efbe74e96f456e1608aad146f31bfe00d82cb28f","modified":1617596584243},{"_id":"public/categories/jdk/index.html","hash":"9431f85cf2911b4f1c93b4372966c8e495185a69","modified":1617596584243},{"_id":"public/index.html","hash":"a5f42c908bbe2d09cb464e55cf906912dc33a034","modified":1617596584243},{"_id":"public/page/2/index.html","hash":"298cd2d7248cbc7f6500125a59c6aa5bbee2047f","modified":1617596584243},{"_id":"public/page/3/index.html","hash":"381b91e888fce0b632dd4aab23c314dd0f91a736","modified":1617596584243},{"_id":"public/page/4/index.html","hash":"2a2ff60a3ecb5c1cafd47417afb2d504b21f83fc","modified":1617596584243},{"_id":"public/tags/framework/index.html","hash":"5c7a5207dfe7ac4305533c386532b05624a47c6f","modified":1617596584243},{"_id":"public/tags/network/index.html","hash":"01da345350aefd799225ef7eb2287ca20fdcb8ca","modified":1617596584243},{"_id":"public/assets/fonts/fa-regular-400.eot","hash":"3306178c90d9df939d2a5eabf533ba3650fbe80e","modified":1617596584243},{"_id":"public/assets/fonts/fa-regular-400.ttf","hash":"517a3b41c1e01b65898b5f1074434d43a361a54f","modified":1617596584243},{"_id":"public/assets/fonts/fa-regular-400.woff2","hash":"5e4d45052f43e55aaad7f14d13280215e39aa45b","modified":1617596584243},{"_id":"public/assets/fonts/fa-regular-400.woff","hash":"da17a9f1dcae379c8ba20f1089059c202216cba7","modified":1617596584243},{"_id":"public/assets/fonts/merriweather-bold-italic.ttf","hash":"c1b8593dc9ddbf1a1a6268d31e08c4041448ed76","modified":1617596584243},{"_id":"public/assets/fonts/merriweather-bold.ttf","hash":"e6d0ffb2d0348d9e22de97e57214b7db795e9513","modified":1617596584243},{"_id":"public/assets/fonts/merriweather-light-italic.ttf","hash":"c3835119c62e78a21cfb33e2de6686fb4a5929a0","modified":1617596584243},{"_id":"public/assets/fonts/merriweather-light.ttf","hash":"69bd3f15962cf91348a133d3d38571a5c67eca65","modified":1617596584243},{"_id":"public/assets/fonts/merriweather.ttf","hash":"d392237948e74246a2fb0d0d886498776a185e54","modified":1617596584243},{"_id":"public/assets/fonts/open-sans-bold.ttf","hash":"3823779db9f51a34658809ce66bdd6ed1145ed8e","modified":1617596584243},{"_id":"public/assets/fonts/open-sans.ttf","hash":"618b78a8f6ffe7e1998eab67268859e2ab54be8e","modified":1617596584243},{"_id":"public/assets/images/avatar.png","hash":"fae7a4bc08bad88136de5f66c9abe97954741234","modified":1617596584243},{"_id":"public/assets/images/logo-algolia-nebula-blue-full.svg","hash":"d5e4426b6bd2d8b8c3f477f83d348d8f3b3ec1ca","modified":1617596584243},{"_id":"public/assets/fonts/fa-brands-400.woff","hash":"fddb95d7a0f48d2bf90a5ee3095e8264dca18053","modified":1617596584243},{"_id":"public/assets/fonts/fa-brands-400.woff2","hash":"62584b9868428fd75af3fc5ee2f9918dda428be5","modified":1617596584243},{"_id":"public/assets/fonts/fa-solid-900.woff","hash":"f13e252f8a51a5279fd21e26ada0bd2f55bcefd8","modified":1617596584243},{"_id":"public/assets/fonts/fa-solid-900.woff2","hash":"6290834672aba86d5b6c1c73b30b57c9c53996f7","modified":1617596584243},{"_id":"public/assets/fonts/fa-brands-400.eot","hash":"40c8f2a0dc154160fde50e0c27f694f12c7b1636","modified":1617596584243},{"_id":"public/assets/fonts/fa-brands-400.ttf","hash":"29f59b4eecc72052d9110a5d4030a10ad9bf73d7","modified":1617596584243},{"_id":"public/assets/fonts/fa-regular-400.svg","hash":"51afca56e309df6fdc56b53fa6a7d3ce64826490","modified":1617596584243},{"_id":"public/assets/css/thumbs.css","hash":"3673ba1f616738f588fe887863846a958343b970","modified":1617596584243},{"_id":"public/assets/js/thumbs.js","hash":"1dacca749bad458211a886d3bcbbeb4600aaceac","modified":1617596584243},{"_id":"public/assets/fonts/fa-solid-900.eot","hash":"96a5637429426764ea9b28bf4d1eb55ae10de57e","modified":1617596584243},{"_id":"public/assets/css/gitalk.css","hash":"fe5406a41cf222f39919630efd9012d08b7414aa","modified":1617596584243},{"_id":"public/assets/css/gitment.css","hash":"7fbb18b73b44ed11193739c55fce53a6f173cf68","modified":1617596584243},{"_id":"public/assets/css/jquery.fancybox.css","hash":"e43435fb9eaa918f5b8e35c9e110124b8bd13751","modified":1617596584243},{"_id":"public/assets/fonts/fa-solid-900.ttf","hash":"874c650701d0cbfb8f1de48a496dabed3bbf22e6","modified":1617596584243},{"_id":"public/assets/images/cover.jpg","hash":"df915f5b3eeed6bad93a183f65e5c6f536e551fe","modified":1617596584243},{"_id":"public/assets/js/tranquilpeak.js","hash":"ed9d93b9de4037c97c8699b7b9b985ec48c1b25d","modified":1617596584243},{"_id":"public/assets/css/all.css","hash":"9e798ebfbdf41ffcd68b02a5af2a9d997ddd6d12","modified":1617596584243},{"_id":"public/assets/images/cover-v1.2.0.jpg","hash":"a98b9bf4d6be3af0156c0b6e781f067e343a682d","modified":1617596584243},{"_id":"public/assets/css/tranquilpeak.css","hash":"a6c317a8f3222d738f6cad9273729f8a915eb918","modified":1617596584243},{"_id":"public/assets/js/gitment.js","hash":"376446d9c5930576016f97dd63e5e6616c94d8d4","modified":1617596584243},{"_id":"public/assets/js/jquery.fancybox.js","hash":"27f034e5db8c32e268e2959b9a7c1258d36e4510","modified":1617596584243},{"_id":"public/assets/js/script-jsoeqoqa2ajw9nwj0xf5gmftvb2jhopk3sxu8iodabvev2jdlmr0zsitv3jm.min.js","hash":"5f7046b160a695d9cac75b4eace17a2f70d7c365","modified":1617596584243},{"_id":"public/assets/css/style-xsmpikcbczzhpff1zqybzgesjqcgmkdkx9b5ntr0bkmk6wqucpktuaodiuvy.min.css","hash":"5373bff083c63d4e6f97f9fcf9c53cd76553770c","modified":1617596584243},{"_id":"public/assets/fonts/fa-brands-400.svg","hash":"99dff0739882276ad6c434d73228efc7971b0a66","modified":1617596584243},{"_id":"public/assets/js/algoliasearch.js","hash":"6948fcdf071e4983e784e8c458cf201536f77792","modified":1617596584243},{"_id":"public/assets/css/style.css","hash":"7c2eb380692c74e85bc36d9c9b4c248249283d47","modified":1617596584243},{"_id":"public/assets/fonts/fa-solid-900.svg","hash":"5501fb62e20a89bdd89bf3fa147ca4dbcd2fc67f","modified":1617596584243},{"_id":"public/assets/js/jquery.js","hash":"ad16c4a132ad2a03b4951185fed46d55397b5e88","modified":1617596584243},{"_id":"public/assets/js/gitalk.js","hash":"869bb1868a939f57810799bd42cbcea251c72a7c","modified":1617596584243},{"_id":"public/assets/js/script.js","hash":"a3510d7a8965b5e51b66aa76c210a1afd44c00f0","modified":1617596584243},{"_id":"public/assets/js/moment-with-locales.js","hash":"d39047f5013a835e3db43fa17b78bf625712825d","modified":1617596584243}],"Category":[{"name":"framework","_id":"ckn438q6w0007w5ihfov39dki"},{"name":"Leetcode","_id":"ckn438q72000gw5ih4fz680oe"},{"name":"Java","_id":"ckn438q77000nw5ihe8o31505"},{"name":"DesignPatterns","_id":"ckn438q7i0015w5ih7i3w3bry"},{"name":"Network","_id":"ckn438q7m001dw5ih88ir7jkg"},{"name":"jdk","_id":"ckn438q7p001mw5ih7xcsbosh"},{"name":"springboot","_id":"ckn438q7y001sw5ih0sg45v3l"},{"name":"JVM","_id":"ckn438q880026w5ih6eyq98uq"},{"name":"MiddleWare","_id":"ckn438q8b002dw5ih57sx7km6"},{"name":"DB","_id":"ckn438q8f002mw5ihg5u9d8op"},{"name":"Utils","_id":"ckn438q8h002rw5ihb64d1w7t"}],"Data":[],"Page":[{"title":"all-archives","layout":"all-archives","date":"2020-08-16T04:51:57.000Z","_content":"","source":"all-archives/index.md","raw":"---\ntitle: all-archives\nlayout: all-archives\ndate: 2020-08-16 12:51:57\n---\n","updated":"2020-11-08T07:20:16.385Z","path":"all-archives/index.html","comments":1,"_id":"ckn438q6i0000w5ihgf0oh54x","content":"","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":""},{"title":"about","date":"2019-11-02T16:17:30.000Z","type":"about","_content":"\n- 2019\n- \n- Java","source":"about/index.md","raw":"---\ntitle: about\ndate: 2019-11-03 00:17:30\ntype: about\n---\n\n- 2019\n- \n- Java","updated":"2020-12-31T13:59:31.091Z","path":"about/index.html","comments":1,"layout":"page","_id":"ckn438q6p0002w5ih5txc3rbk","content":"<ul>\n<li>2019</li>\n<li></li>\n<li>Java</li>\n</ul>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":"<ul>\n<li>2019</li>\n<li></li>\n<li>Java</li>\n</ul>\n"},{"title":"all-categories","layout":"all-categories","date":"2020-08-16T04:51:22.000Z","_content":"","source":"all-categories/index.md","raw":"---\ntitle: all-categories\nlayout: all-categories\ndate: 2020-08-16 12:51:22\n---\n","updated":"2020-11-08T07:20:16.385Z","path":"all-categories/index.html","comments":1,"_id":"ckn438q6u0005w5ihg26qandf","content":"","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":""},{"title":"categories","date":"2019-11-01T07:35:36.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2019-11-01 15:35:36\ntype: categories\n---\n","updated":"2020-11-08T07:20:16.385Z","path":"categories/index.html","comments":1,"layout":"page","_id":"ckn438q6x0008w5ih0qi91zrx","content":"","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":""},{"title":"tags","date":"2019-11-01T07:08:49.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2019-11-01 15:08:49\ntype: tags\n---","updated":"2020-11-08T07:20:16.385Z","path":"tags/index.html","comments":1,"layout":"page","_id":"ckn438q6y000aw5ihbt9ph6tk","content":"","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":""},{"title":"all-tags","layout":"all-tags","date":"2020-08-16T04:51:43.000Z","_content":"","source":"all-tags/index.md","raw":"---\ntitle: all-tags\nlayout: all-tags\ndate: 2020-08-16 12:51:43\n---\n","updated":"2020-11-08T07:20:16.385Z","path":"all-tags/index.html","comments":1,"_id":"ckn438q71000ew5ih42de6665","content":"","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":""},{"title":"top","date":"2019-11-01T13:50:25.000Z","_content":"<div id=\"post-rank\"></div>\n\n<script src=\"//cdn.jsdelivr.net/npm/leancloud-storage@3.10.0/dist/av-min.js\"></script>\n<script>\n  var APP_ID = ******;  //LeanCloudAppID\n  var APP_KEY = ******;  //LeanCloudAppKey\n  AV.init({\n    appId: APP_ID,\n    appKey: APP_KEY\n  });\n\n  var query = new AV.Query('Counter');//\n  query.descending('time'); //\n  query.limit(10);  //10\n  query.find().then( response => {\n    var content = response.reduce( (accum, {attributes}) => {\n      accum += `<p><div class=\"prefix\"> ${attributes.time} </div><div><a href=\"${attributes.url}\">${attributes.title}</a></div></p>`\n      return accum;\n    },\"\")\n    document.querySelector(\"#post-rank\").innerHTML = content;\n  })\n  .catch( error => {\n    console.log(error);\n  });\n</script>\n\n<style type=\"text/css\">\n  #post-rank {\n    text-align: center;\n  }\n  #post-rank .prefix {\n    color: #ff4d4f;\n  }\n</style>","source":"top/index.md","raw":"---\ntitle: top\ndate: 2019-11-01 21:50:25\n---\n<div id=\"post-rank\"></div>\n\n<script src=\"//cdn.jsdelivr.net/npm/leancloud-storage@3.10.0/dist/av-min.js\"></script>\n<script>\n  var APP_ID = ******;  //LeanCloudAppID\n  var APP_KEY = ******;  //LeanCloudAppKey\n  AV.init({\n    appId: APP_ID,\n    appKey: APP_KEY\n  });\n\n  var query = new AV.Query('Counter');//\n  query.descending('time'); //\n  query.limit(10);  //10\n  query.find().then( response => {\n    var content = response.reduce( (accum, {attributes}) => {\n      accum += `<p><div class=\"prefix\"> ${attributes.time} </div><div><a href=\"${attributes.url}\">${attributes.title}</a></div></p>`\n      return accum;\n    },\"\")\n    document.querySelector(\"#post-rank\").innerHTML = content;\n  })\n  .catch( error => {\n    console.log(error);\n  });\n</script>\n\n<style type=\"text/css\">\n  #post-rank {\n    text-align: center;\n  }\n  #post-rank .prefix {\n    color: #ff4d4f;\n  }\n</style>","updated":"2020-11-08T07:20:16.385Z","path":"top/index.html","comments":1,"layout":"page","_id":"ckn438q73000hw5ihejx6ckp5","content":"<div id=\"post-rank\"></div>\n\n<script src=\"//cdn.jsdelivr.net/npm/leancloud-storage@3.10.0/dist/av-min.js\"></script>\n<script>\n  var APP_ID = ******;  //LeanCloudAppID\n  var APP_KEY = ******;  //LeanCloudAppKey\n  AV.init({\n    appId: APP_ID,\n    appKey: APP_KEY\n  });\n\n  var query = new AV.Query('Counter');//\n  query.descending('time'); //\n  query.limit(10);  //10\n  query.find().then( response => {\n    var content = response.reduce( (accum, {attributes}) => {\n      accum += `<p><div class=\"prefix\"> ${attributes.time} </div><div><a href=\"${attributes.url}\">${attributes.title}</a></div></p>`\n      return accum;\n    },\"\")\n    document.querySelector(\"#post-rank\").innerHTML = content;\n  })\n  .catch( error => {\n    console.log(error);\n  });\n</script>\n\n<style type=\"text/css\">\n  #post-rank {\n    text-align: center;\n  }\n  #post-rank .prefix {\n    color: #ff4d4f;\n  }\n</style>","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":"<div id=\"post-rank\"></div>\n\n<script src=\"//cdn.jsdelivr.net/npm/leancloud-storage@3.10.0/dist/av-min.js\"></script>\n<script>\n  var APP_ID = ******;  //LeanCloudAppID\n  var APP_KEY = ******;  //LeanCloudAppKey\n  AV.init({\n    appId: APP_ID,\n    appKey: APP_KEY\n  });\n\n  var query = new AV.Query('Counter');//\n  query.descending('time'); //\n  query.limit(10);  //10\n  query.find().then( response => {\n    var content = response.reduce( (accum, {attributes}) => {\n      accum += `<p><div class=\"prefix\"> ${attributes.time} </div><div><a href=\"${attributes.url}\">${attributes.title}</a></div></p>`\n      return accum;\n    },\"\")\n    document.querySelector(\"#post-rank\").innerHTML = content;\n  })\n  .catch( error => {\n    console.log(error);\n  });\n</script>\n\n<style type=\"text/css\">\n  #post-rank {\n    text-align: center;\n  }\n  #post-rank .prefix {\n    color: #ff4d4f;\n  }\n</style>"}],"Post":[{"title":"2020_end","date":"2021-01-03T13:35:35.000Z","_content":"\n2020\n\n<!-- more -->\n\n\n\n<!--toc-->\n\n## \n\n### 19\n\n201920206202011Java\n\nGithub\n\n- Java\n- SpringBootSpringCloud\n\n\n\n- Java-\n- Java-\n\n### 20\n\nJavalambdaSpringAOP\n\n\n\n- \n  - Javascript, cssflowbox\n- Leetcode\n\nHeadFirst:\n\n- HeadFirst Servlet JSP\n- HeadFirst Java\n- HeadFirst DesignPattern\n\n## \n\nESESSpring Security\n\n\n\n- ElasticSearch\n- Spring Security\n\nJVMJavaSpringBootMyBatisSpringCloud\n\n- Java\n- Java8lambda\n\n\n\n## \n\n- [ ] ****\n- [ ] **pull request** 00.\n- [ ] ****demo\n- [ ] JavaLeetcode**Python****C++**or****\n- [ ] **408**fight\n- [ ] ****\n- [ ] ********demo\n- [ ] Java179","source":"_posts/2020-end.md","raw":"---\ntitle: 2020_end\ndate: 2021-01-03 21:35:35\ntags: summary\n---\n\n2020\n\n<!-- more -->\n\n\n\n<!--toc-->\n\n## \n\n### 19\n\n201920206202011Java\n\nGithub\n\n- Java\n- SpringBootSpringCloud\n\n\n\n- Java-\n- Java-\n\n### 20\n\nJavalambdaSpringAOP\n\n\n\n- \n  - Javascript, cssflowbox\n- Leetcode\n\nHeadFirst:\n\n- HeadFirst Servlet JSP\n- HeadFirst Java\n- HeadFirst DesignPattern\n\n## \n\nESESSpring Security\n\n\n\n- ElasticSearch\n- Spring Security\n\nJVMJavaSpringBootMyBatisSpringCloud\n\n- Java\n- Java8lambda\n\n\n\n## \n\n- [ ] ****\n- [ ] **pull request** 00.\n- [ ] ****demo\n- [ ] JavaLeetcode**Python****C++**or****\n- [ ] **408**fight\n- [ ] ****\n- [ ] ********demo\n- [ ] Java179","slug":"2020-end","published":1,"updated":"2021-02-27T05:59:44.586Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q6m0001w5ih4jvxamag","content":"<p>2020</p>\n<a id=\"more\"></a>\n\n<p></p>\n<!--toc-->\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"19\"><a href=\"#19\" class=\"headerlink\" title=\"19\"></a>19</h3><p>201920206202011Java</p>\n<p>Github</p>\n<ul>\n<li>Java</li>\n<li>SpringBootSpringCloud</li>\n</ul>\n<p></p>\n<ul>\n<li>Java-</li>\n<li>Java-</li>\n</ul>\n<h3 id=\"20\"><a href=\"#20\" class=\"headerlink\" title=\"20\"></a>20</h3><p>JavalambdaSpringAOP</p>\n<p></p>\n<ul>\n<li><ul>\n<li>Javascript, cssflowbox</li>\n</ul>\n</li>\n<li>Leetcode</li>\n</ul>\n<p>HeadFirst:</p>\n<ul>\n<li>HeadFirst Servlet JSP</li>\n<li>HeadFirst Java</li>\n<li>HeadFirst DesignPattern</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ESESSpring Security</p>\n<p></p>\n<ul>\n<li>ElasticSearch</li>\n<li>Spring Security</li>\n</ul>\n<p>JVMJavaSpringBootMyBatisSpringCloud</p>\n<ul>\n<li>Java</li>\n<li>Java8lambda</li>\n</ul>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong></li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong>pull request</strong> 00.</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong>demo</li>\n<li><input disabled=\"\" type=\"checkbox\"> JavaLeetcode<strong>Python</strong><strong>C++**or</strong>**</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong>408</strong>fight</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong></li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong><strong></strong>demo</li>\n<li><input disabled=\"\" type=\"checkbox\"> Java179</li>\n</ul>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>2020</p>","more":"<p></p>\n<!--toc-->\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"19\"><a href=\"#19\" class=\"headerlink\" title=\"19\"></a>19</h3><p>201920206202011Java</p>\n<p>Github</p>\n<ul>\n<li>Java</li>\n<li>SpringBootSpringCloud</li>\n</ul>\n<p></p>\n<ul>\n<li>Java-</li>\n<li>Java-</li>\n</ul>\n<h3 id=\"20\"><a href=\"#20\" class=\"headerlink\" title=\"20\"></a>20</h3><p>JavalambdaSpringAOP</p>\n<p></p>\n<ul>\n<li><ul>\n<li>Javascript, cssflowbox</li>\n</ul>\n</li>\n<li>Leetcode</li>\n</ul>\n<p>HeadFirst:</p>\n<ul>\n<li>HeadFirst Servlet JSP</li>\n<li>HeadFirst Java</li>\n<li>HeadFirst DesignPattern</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ESESSpring Security</p>\n<p></p>\n<ul>\n<li>ElasticSearch</li>\n<li>Spring Security</li>\n</ul>\n<p>JVMJavaSpringBootMyBatisSpringCloud</p>\n<ul>\n<li>Java</li>\n<li>Java8lambda</li>\n</ul>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong></li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong>pull request</strong> 00.</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong>demo</li>\n<li><input disabled=\"\" type=\"checkbox\"> JavaLeetcode<strong>Python</strong><strong>C++**or</strong>**</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong>408</strong>fight</li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong></li>\n<li><input disabled=\"\" type=\"checkbox\"> <strong></strong><strong></strong>demo</li>\n<li><input disabled=\"\" type=\"checkbox\"> Java179</li>\n</ul>"},{"title":"Spring Security AutoConfiguration","date":"2021-03-22T14:18:10.000Z","_content":"\n\t\t*Spring Security*SpringBootjar*@EnableWebSecurity*\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n\t\tSpringBootxml*@Configuration**@EnableWebSecurity*\n\n```java\n@Retention(value = java.lang.annotation.RetentionPolicy.RUNTIME)\n@Target(value = { java.lang.annotation.ElementType.TYPE })\n@Documented\n@Import({ WebSecurityConfiguration.class,\n\t\tSpringWebMvcImportSelector.class,\n\t\tOAuth2ImportSelector.class })\n@EnableGlobalAuthentication\n@Configuration\npublic @interface EnableWebSecurity {\n\n\t/**\n\t * Controls debugging support for Spring Security. Default is false.\n\t * @return if true, enables debug support with Spring Security\n\t */\n\tboolean debug() default false;\n}\n```\n\n*@Import(...)*class*Selector*Spring*@Import(...)*Selector*WebSecurityConfiguration*\n\n\n\n>Add this annotation to an @Configuration class to have the Spring Security configuration defined in any WebSecurityConfigurer or more likely by extending the WebSecurityConfigurerAdapter base class and overriding individual methods\n\n\n\n```java\n@EnableWebSecurity\n@Configuration\npublic class MyWebSecurityConfiguration extends WebSecurityConfigurerAdapter {\n    \n    @Override\n    public void confugre(HttpSecurity httpSecurity){\n        // ....\n    }\n}\n```\n\n\n\n# \n\nSpring SecuritySpringSpringIoCbean\n\n> Uses a WebSecurity to create the FilterChainProxy that performs the web based security for Spring Security. It then exports the necessary beans. Customizations can be made to WebSecurity by extending WebSecurityConfigurerAdapter and exposing it as a Configuration or implementing WebSecurityConfigurer and exposing it as a Configuration. This configuration is imported when using EnableWebSecurity.\n\nweb\n\n## setFilterChainProxySecurityConfigurer\n\n```java\n@Autowired(required = false)\npublic void setFilterChainProxySecurityConfigurer(\n    // \n    ObjectPostProcessor<Object> objectPostProcessor,\n    // \n    @Value(\"#{@autowiredWebSecurityConfigurersIgnoreParents.getWebSecurityConfigurers()}\") List<SecurityConfigurer<Filter, WebSecurity>> webSecurityConfigurers)\n    throws Exception {\n    webSecurity = objectPostProcessor\n        .postProcess(new WebSecurity(objectPostProcessor));\n    if (debugEnabled != null) {\n        webSecurity.debug(debugEnabled);\n    }\n    \n    webSecurityConfigurers.sort(AnnotationAwareOrderComparator.INSTANCE);\n\n    Integer previousOrder = null;\n    Object previousConfig = null;\n    for (SecurityConfigurer<Filter, WebSecurity> config : webSecurityConfigurers) {\n        Integer order = AnnotationAwareOrderComparator.lookupOrder(config);\n        if (previousOrder != null && previousOrder.equals(order)) {\n            throw new IllegalStateException(\n                \"@Order on WebSecurityConfigurers must be unique. Order of \"\n                + order + \" was already used on \" + previousConfig + \", so it cannot be used on \"\n                + config + \" too.\");\n        }\n        previousOrder = order;\n        previousConfig = config;\n    }\n    for (SecurityConfigurer<Filter, WebSecurity> webSecurityConfigurer : webSecurityConfigurers) {\n        // webSecurityConfigureswebSecurityapply\n        webSecurity.apply(webSecurityConfigurer);\n    }\n    // confugures\n    this.webSecurityConfigurers = webSecurityConfigurers;\n}\n```\n\n\n\n### getWebSecurityConfigurers\n\n`AutowiredWebSecurityConfigurersIgnoreParents`*getWebSecurityConfigurers*configures\n\n```java\npublic List<SecurityConfigurer<Filter, WebSecurity>> getWebSecurityConfigurers() {\n   List<SecurityConfigurer<Filter, WebSecurity>> webSecurityConfigurers = new ArrayList<>();\n   Map<String, WebSecurityConfigurer> beansOfType = beanFactory\n         .getBeansOfType(WebSecurityConfigurer.class);\n   for (Entry<String, WebSecurityConfigurer> entry : beansOfType.entrySet()) {\n      webSecurityConfigurers.add(entry.getValue());\n   }\n   return webSecurityConfigurers;\n}\n```\n\n\n\n### apply\n\napplywebSecurityconfigureswebSecurity\n\n```java\nprivate <C extends SecurityConfigurer<O, B>> void add(C configurer) {\n    // ...\n    synchronized (configurers) {\n        // ...\n        List<SecurityConfigurer<O, B>> configs = allowConfigurersOfSameType ? this.configurers\n            .get(clazz) : null;\n        if (configs == null) {\n            configs = new ArrayList<>(1);\n        }\n        configs.add(configurer);\n        // private final LinkedHashMap<Class<? extends SecurityConfigurer<O, B>>, List<SecurityConfigurer<O, B>>> configurers = new LinkedHashMap<>();\n        this.configurers.put(clazz, configs);\n        // ...\n    }\n}\n```\n\n***WebSecurityConfigurer*\n\n```java\npublic abstract class WebSecurityConfigurerAdapter implements WebSecurityConfigurer<WebSecurity> {\n    // ...\n}\n```\n\nconfigurer*getWebSecurityConfigurers*webSecurity\n\n\n\n## springSecurityFilterChain\n\n\n\n```java\n// \tpublic static final String DEFAULT_FILTER_NAME = \"springSecurityFilterChain\";\n@Bean(name = AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME)\npublic Filter springSecurityFilterChain() throws Exception {\n    //  true\n    boolean hasConfigurers = webSecurityConfigurers != null\n        && !webSecurityConfigurers.isEmpty();\n    if (!hasConfigurers) {\n        // \n        WebSecurityConfigurerAdapter adapter = objectObjectPostProcessor\n            .postProcess(new WebSecurityConfigurerAdapter() {\n            });\n        // apply\n        webSecurity.apply(adapter);\n    }\n    //  build\n    return webSecurity.build();\n}\n```\n\ndemoconfigurehttpSecuritybuild\n\n```java\nprivate AtomicBoolean building = new AtomicBoolean();\n\npublic final O build() throws Exception {\n    // buildCAS\n    if (this.building.compareAndSet(false, true)) {\n        this.object = doBuild();\n        return this.object;\n    }\n    throw new AlreadyBuiltException(\"This object has already been built\");\n}\n```\n\n*doBuild()*SpringBootrefresh\n\n### init\n\nconfigurerWebSecurityAdapterinit\n\n```java\npublic void init(final WebSecurity web) throws Exception {\n    // httpSecurity\n    final HttpSecurity http = getHttp();\n    // webwebSecurityhttpSecurity\n    web.addSecurityFilterChainBuilder(http).postBuildAction(() -> {\n        FilterSecurityInterceptor securityInterceptor = http\n            .getSharedObject(FilterSecurityInterceptor.class);\n        web.securityInterceptor(securityInterceptor);\n    });\n}\n```\n\n#### getHttp\n\n```java\nprotected final HttpSecurity getHttp() throws Exception {\n   if (http != null) {\n      return http;\n   }\n\n   AuthenticationEventPublisher eventPublisher = getAuthenticationEventPublisher();\n   localConfigureAuthenticationBldr.authenticationEventPublisher(eventPublisher);\n\n   AuthenticationManager authenticationManager = authenticationManager();\n   authenticationBuilder.parentAuthenticationManager(authenticationManager);\n   Map<Class<?>, Object> sharedObjects = createSharedObjects();\n\n    // \n   http = new HttpSecurity(objectPostProcessor, authenticationBuilder,\n         sharedObjects);\n    //  \n   if (!disableDefaults) {\n      // @formatter:off\n      http\n         .csrf().and()\n         .addFilter(new WebAsyncManagerIntegrationFilter())\n         .exceptionHandling().and()\n         .headers().and()\n         .sessionManagement().and()\n         .securityContext().and()\n         .requestCache().and()\n         .anonymous().and()\n         .servletApi().and()\n         .apply(new DefaultLoginPageConfigurer<>()).and()\n         .logout();\n      // @formatter:on\n      ClassLoader classLoader = this.context.getClassLoader();\n      List<AbstractHttpConfigurer> defaultHttpConfigurers =\n            SpringFactoriesLoader.loadFactories(AbstractHttpConfigurer.class, classLoader);\n\n      for (AbstractHttpConfigurer configurer : defaultHttpConfigurers) {\n         http.apply(configurer);\n      }\n   }\n    // httpSecurity\n   configure(http);\n   return http;\n}\n```\n\nhttpSecurity*configure*demo*@EnableSpringSecurity**configure*httpSecurity\n\n\n\n# \n\nSpringSecurity","source":"_posts/Spring-Security-AutoConfiguration.md","raw":"---\ntitle: Spring Security AutoConfiguration\ndate: 2021-03-22 22:18:10\ncategories: framework\ntags: spring security\n---\n\n\t\t*Spring Security*SpringBootjar*@EnableWebSecurity*\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n\t\tSpringBootxml*@Configuration**@EnableWebSecurity*\n\n```java\n@Retention(value = java.lang.annotation.RetentionPolicy.RUNTIME)\n@Target(value = { java.lang.annotation.ElementType.TYPE })\n@Documented\n@Import({ WebSecurityConfiguration.class,\n\t\tSpringWebMvcImportSelector.class,\n\t\tOAuth2ImportSelector.class })\n@EnableGlobalAuthentication\n@Configuration\npublic @interface EnableWebSecurity {\n\n\t/**\n\t * Controls debugging support for Spring Security. Default is false.\n\t * @return if true, enables debug support with Spring Security\n\t */\n\tboolean debug() default false;\n}\n```\n\n*@Import(...)*class*Selector*Spring*@Import(...)*Selector*WebSecurityConfiguration*\n\n\n\n>Add this annotation to an @Configuration class to have the Spring Security configuration defined in any WebSecurityConfigurer or more likely by extending the WebSecurityConfigurerAdapter base class and overriding individual methods\n\n\n\n```java\n@EnableWebSecurity\n@Configuration\npublic class MyWebSecurityConfiguration extends WebSecurityConfigurerAdapter {\n    \n    @Override\n    public void confugre(HttpSecurity httpSecurity){\n        // ....\n    }\n}\n```\n\n\n\n# \n\nSpring SecuritySpringSpringIoCbean\n\n> Uses a WebSecurity to create the FilterChainProxy that performs the web based security for Spring Security. It then exports the necessary beans. Customizations can be made to WebSecurity by extending WebSecurityConfigurerAdapter and exposing it as a Configuration or implementing WebSecurityConfigurer and exposing it as a Configuration. This configuration is imported when using EnableWebSecurity.\n\nweb\n\n## setFilterChainProxySecurityConfigurer\n\n```java\n@Autowired(required = false)\npublic void setFilterChainProxySecurityConfigurer(\n    // \n    ObjectPostProcessor<Object> objectPostProcessor,\n    // \n    @Value(\"#{@autowiredWebSecurityConfigurersIgnoreParents.getWebSecurityConfigurers()}\") List<SecurityConfigurer<Filter, WebSecurity>> webSecurityConfigurers)\n    throws Exception {\n    webSecurity = objectPostProcessor\n        .postProcess(new WebSecurity(objectPostProcessor));\n    if (debugEnabled != null) {\n        webSecurity.debug(debugEnabled);\n    }\n    \n    webSecurityConfigurers.sort(AnnotationAwareOrderComparator.INSTANCE);\n\n    Integer previousOrder = null;\n    Object previousConfig = null;\n    for (SecurityConfigurer<Filter, WebSecurity> config : webSecurityConfigurers) {\n        Integer order = AnnotationAwareOrderComparator.lookupOrder(config);\n        if (previousOrder != null && previousOrder.equals(order)) {\n            throw new IllegalStateException(\n                \"@Order on WebSecurityConfigurers must be unique. Order of \"\n                + order + \" was already used on \" + previousConfig + \", so it cannot be used on \"\n                + config + \" too.\");\n        }\n        previousOrder = order;\n        previousConfig = config;\n    }\n    for (SecurityConfigurer<Filter, WebSecurity> webSecurityConfigurer : webSecurityConfigurers) {\n        // webSecurityConfigureswebSecurityapply\n        webSecurity.apply(webSecurityConfigurer);\n    }\n    // confugures\n    this.webSecurityConfigurers = webSecurityConfigurers;\n}\n```\n\n\n\n### getWebSecurityConfigurers\n\n`AutowiredWebSecurityConfigurersIgnoreParents`*getWebSecurityConfigurers*configures\n\n```java\npublic List<SecurityConfigurer<Filter, WebSecurity>> getWebSecurityConfigurers() {\n   List<SecurityConfigurer<Filter, WebSecurity>> webSecurityConfigurers = new ArrayList<>();\n   Map<String, WebSecurityConfigurer> beansOfType = beanFactory\n         .getBeansOfType(WebSecurityConfigurer.class);\n   for (Entry<String, WebSecurityConfigurer> entry : beansOfType.entrySet()) {\n      webSecurityConfigurers.add(entry.getValue());\n   }\n   return webSecurityConfigurers;\n}\n```\n\n\n\n### apply\n\napplywebSecurityconfigureswebSecurity\n\n```java\nprivate <C extends SecurityConfigurer<O, B>> void add(C configurer) {\n    // ...\n    synchronized (configurers) {\n        // ...\n        List<SecurityConfigurer<O, B>> configs = allowConfigurersOfSameType ? this.configurers\n            .get(clazz) : null;\n        if (configs == null) {\n            configs = new ArrayList<>(1);\n        }\n        configs.add(configurer);\n        // private final LinkedHashMap<Class<? extends SecurityConfigurer<O, B>>, List<SecurityConfigurer<O, B>>> configurers = new LinkedHashMap<>();\n        this.configurers.put(clazz, configs);\n        // ...\n    }\n}\n```\n\n***WebSecurityConfigurer*\n\n```java\npublic abstract class WebSecurityConfigurerAdapter implements WebSecurityConfigurer<WebSecurity> {\n    // ...\n}\n```\n\nconfigurer*getWebSecurityConfigurers*webSecurity\n\n\n\n## springSecurityFilterChain\n\n\n\n```java\n// \tpublic static final String DEFAULT_FILTER_NAME = \"springSecurityFilterChain\";\n@Bean(name = AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME)\npublic Filter springSecurityFilterChain() throws Exception {\n    //  true\n    boolean hasConfigurers = webSecurityConfigurers != null\n        && !webSecurityConfigurers.isEmpty();\n    if (!hasConfigurers) {\n        // \n        WebSecurityConfigurerAdapter adapter = objectObjectPostProcessor\n            .postProcess(new WebSecurityConfigurerAdapter() {\n            });\n        // apply\n        webSecurity.apply(adapter);\n    }\n    //  build\n    return webSecurity.build();\n}\n```\n\ndemoconfigurehttpSecuritybuild\n\n```java\nprivate AtomicBoolean building = new AtomicBoolean();\n\npublic final O build() throws Exception {\n    // buildCAS\n    if (this.building.compareAndSet(false, true)) {\n        this.object = doBuild();\n        return this.object;\n    }\n    throw new AlreadyBuiltException(\"This object has already been built\");\n}\n```\n\n*doBuild()*SpringBootrefresh\n\n### init\n\nconfigurerWebSecurityAdapterinit\n\n```java\npublic void init(final WebSecurity web) throws Exception {\n    // httpSecurity\n    final HttpSecurity http = getHttp();\n    // webwebSecurityhttpSecurity\n    web.addSecurityFilterChainBuilder(http).postBuildAction(() -> {\n        FilterSecurityInterceptor securityInterceptor = http\n            .getSharedObject(FilterSecurityInterceptor.class);\n        web.securityInterceptor(securityInterceptor);\n    });\n}\n```\n\n#### getHttp\n\n```java\nprotected final HttpSecurity getHttp() throws Exception {\n   if (http != null) {\n      return http;\n   }\n\n   AuthenticationEventPublisher eventPublisher = getAuthenticationEventPublisher();\n   localConfigureAuthenticationBldr.authenticationEventPublisher(eventPublisher);\n\n   AuthenticationManager authenticationManager = authenticationManager();\n   authenticationBuilder.parentAuthenticationManager(authenticationManager);\n   Map<Class<?>, Object> sharedObjects = createSharedObjects();\n\n    // \n   http = new HttpSecurity(objectPostProcessor, authenticationBuilder,\n         sharedObjects);\n    //  \n   if (!disableDefaults) {\n      // @formatter:off\n      http\n         .csrf().and()\n         .addFilter(new WebAsyncManagerIntegrationFilter())\n         .exceptionHandling().and()\n         .headers().and()\n         .sessionManagement().and()\n         .securityContext().and()\n         .requestCache().and()\n         .anonymous().and()\n         .servletApi().and()\n         .apply(new DefaultLoginPageConfigurer<>()).and()\n         .logout();\n      // @formatter:on\n      ClassLoader classLoader = this.context.getClassLoader();\n      List<AbstractHttpConfigurer> defaultHttpConfigurers =\n            SpringFactoriesLoader.loadFactories(AbstractHttpConfigurer.class, classLoader);\n\n      for (AbstractHttpConfigurer configurer : defaultHttpConfigurers) {\n         http.apply(configurer);\n      }\n   }\n    // httpSecurity\n   configure(http);\n   return http;\n}\n```\n\nhttpSecurity*configure*demo*@EnableSpringSecurity**configure*httpSecurity\n\n\n\n# \n\nSpringSecurity","slug":"Spring-Security-AutoConfiguration","published":1,"updated":"2021-03-23T15:15:59.311Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q6q0003w5ih0fh0ht7b","content":"<p>        <em>Spring Security</em>SpringBootjar*@EnableWebSecurity*</p>\n<a id=\"more\"></a>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        SpringBootxml*@Configuration<em></em>@EnableWebSecurity*</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention(value = java.lang.annotation.RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Target(value = &#123; java.lang.annotation.ElementType.TYPE &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Import(&#123; WebSecurityConfiguration.class,</span></span><br><span class=\"line\"><span class=\"meta\">\t\tSpringWebMvcImportSelector.class,</span></span><br><span class=\"line\"><span class=\"meta\">\t\tOAuth2ImportSelector.class &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@EnableGlobalAuthentication</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> EnableWebSecurity &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Controls debugging support for Spring Security. Default is false.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> if true, enables debug support with Spring Security</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">debug</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"keyword\">false</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>*@Import()<em>class</em>Selector<em>Spring</em>@Import()<em>Selector</em>WebSecurityConfiguration*</p>\n<p></p>\n<blockquote>\n<p>Add this annotation to an @Configuration class to have the Spring Security configuration defined in any WebSecurityConfigurer or more likely by extending the WebSecurityConfigurerAdapter base class and overriding individual methods</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableWebSecurity</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyWebSecurityConfiguration</span> <span class=\"keyword\">extends</span> <span class=\"title\">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">confugre</span><span class=\"params\">(HttpSecurity httpSecurity)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ....</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring SecuritySpringSpringIoCbean</p>\n<blockquote>\n<p>Uses a WebSecurity to create the FilterChainProxy that performs the web based security for Spring Security. It then exports the necessary beans. Customizations can be made to WebSecurity by extending WebSecurityConfigurerAdapter and exposing it as a Configuration or implementing WebSecurityConfigurer and exposing it as a Configuration. This configuration is imported when using EnableWebSecurity.</p>\n</blockquote>\n<p>web</p>\n<h2 id=\"setFilterChainProxySecurityConfigurer\"><a href=\"#setFilterChainProxySecurityConfigurer\" class=\"headerlink\" title=\"setFilterChainProxySecurityConfigurer\"></a>setFilterChainProxySecurityConfigurer</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired(required = false)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setFilterChainProxySecurityConfigurer</span><span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    // </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    ObjectPostProcessor&lt;Object&gt; objectPostProcessor,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    // </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    <span class=\"meta\">@Value(&quot;#&#123;@autowiredWebSecurityConfigurersIgnoreParents.getWebSecurityConfigurers()&#125;&quot;)</span> List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; webSecurityConfigurers)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    webSecurity = objectPostProcessor</span><br><span class=\"line\">        .postProcess(<span class=\"keyword\">new</span> WebSecurity(objectPostProcessor));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (debugEnabled != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        webSecurity.debug(debugEnabled);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    webSecurityConfigurers.sort(AnnotationAwareOrderComparator.INSTANCE);</span><br><span class=\"line\"></span><br><span class=\"line\">    Integer previousOrder = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Object previousConfig = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (SecurityConfigurer&lt;Filter, WebSecurity&gt; config : webSecurityConfigurers) &#123;</span><br><span class=\"line\">        Integer order = AnnotationAwareOrderComparator.lookupOrder(config);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (previousOrder != <span class=\"keyword\">null</span> &amp;&amp; previousOrder.equals(order)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(</span><br><span class=\"line\">                <span class=\"string\">&quot;@Order on WebSecurityConfigurers must be unique. Order of &quot;</span></span><br><span class=\"line\">                + order + <span class=\"string\">&quot; was already used on &quot;</span> + previousConfig + <span class=\"string\">&quot;, so it cannot be used on &quot;</span></span><br><span class=\"line\">                + config + <span class=\"string\">&quot; too.&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        previousOrder = order;</span><br><span class=\"line\">        previousConfig = config;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (SecurityConfigurer&lt;Filter, WebSecurity&gt; webSecurityConfigurer : webSecurityConfigurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// webSecurityConfigureswebSecurityapply</span></span><br><span class=\"line\">        webSecurity.apply(webSecurityConfigurer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// confugures</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.webSecurityConfigurers = webSecurityConfigurers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"getWebSecurityConfigurers\"><a href=\"#getWebSecurityConfigurers\" class=\"headerlink\" title=\"getWebSecurityConfigurers\"></a>getWebSecurityConfigurers</h3><p><code>AutowiredWebSecurityConfigurersIgnoreParents</code><em>getWebSecurityConfigurers</em>configures</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; getWebSecurityConfigurers() &#123;</span><br><span class=\"line\">   List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; webSecurityConfigurers = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">   Map&lt;String, WebSecurityConfigurer&gt; beansOfType = beanFactory</span><br><span class=\"line\">         .getBeansOfType(WebSecurityConfigurer.class);</span><br><span class=\"line\">   <span class=\"keyword\">for</span> (Entry&lt;String, WebSecurityConfigurer&gt; entry : beansOfType.entrySet()) &#123;</span><br><span class=\"line\">      webSecurityConfigurers.add(entry.getValue());</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">return</span> webSecurityConfigurers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"apply\"><a href=\"#apply\" class=\"headerlink\" title=\"apply\"></a>apply</h3><p>applywebSecurityconfigureswebSecurity</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> &lt;C extends SecurityConfigurer&lt;O, B&gt;&gt; <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(C configurer)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (configurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">        List&lt;SecurityConfigurer&lt;O, B&gt;&gt; configs = allowConfigurersOfSameType ? <span class=\"keyword\">this</span>.configurers</span><br><span class=\"line\">            .get(clazz) : <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (configs == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            configs = <span class=\"keyword\">new</span> ArrayList&lt;&gt;(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        configs.add(configurer);</span><br><span class=\"line\">        <span class=\"comment\">// private final LinkedHashMap&lt;Class&lt;? extends SecurityConfigurer&lt;O, B&gt;&gt;, List&lt;SecurityConfigurer&lt;O, B&gt;&gt;&gt; configurers = new LinkedHashMap&lt;&gt;();</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.configurers.put(clazz, configs);</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em></em><em>WebSecurityConfigurer</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WebSecurityConfigurerAdapter</span> <span class=\"keyword\">implements</span> <span class=\"title\">WebSecurityConfigurer</span>&lt;<span class=\"title\">WebSecurity</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>configurer<em>getWebSecurityConfigurers</em>webSecurity</p>\n<h2 id=\"springSecurityFilterChain\"><a href=\"#springSecurityFilterChain\" class=\"headerlink\" title=\"springSecurityFilterChain\"></a>springSecurityFilterChain</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// \tpublic static final String DEFAULT_FILTER_NAME = &quot;springSecurityFilterChain&quot;;</span></span><br><span class=\"line\"><span class=\"meta\">@Bean(name = AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Filter <span class=\"title\">springSecurityFilterChain</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//  true</span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> hasConfigurers = webSecurityConfigurers != <span class=\"keyword\">null</span></span><br><span class=\"line\">        &amp;&amp; !webSecurityConfigurers.isEmpty();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!hasConfigurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        WebSecurityConfigurerAdapter adapter = objectObjectPostProcessor</span><br><span class=\"line\">            .postProcess(<span class=\"keyword\">new</span> WebSecurityConfigurerAdapter() &#123;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        <span class=\"comment\">// apply</span></span><br><span class=\"line\">        webSecurity.apply(adapter);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  build</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> webSecurity.build();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>democonfigurehttpSecuritybuild</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> AtomicBoolean building = <span class=\"keyword\">new</span> AtomicBoolean();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> O <span class=\"title\">build</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// buildCAS</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.building.compareAndSet(<span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.object = doBuild();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.object;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> AlreadyBuiltException(<span class=\"string\">&quot;This object has already been built&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>*doBuild()*SpringBootrefresh</p>\n<h3 id=\"init\"><a href=\"#init\" class=\"headerlink\" title=\"init\"></a>init</h3><p>configurerWebSecurityAdapterinit</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"keyword\">final</span> WebSecurity web)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// httpSecurity</span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> HttpSecurity http = getHttp();</span><br><span class=\"line\">    <span class=\"comment\">// webwebSecurityhttpSecurity</span></span><br><span class=\"line\">    web.addSecurityFilterChainBuilder(http).postBuildAction(() -&gt; &#123;</span><br><span class=\"line\">        FilterSecurityInterceptor securityInterceptor = http</span><br><span class=\"line\">            .getSharedObject(FilterSecurityInterceptor.class);</span><br><span class=\"line\">        web.securityInterceptor(securityInterceptor);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getHttp\"><a href=\"#getHttp\" class=\"headerlink\" title=\"getHttp\"></a>getHttp</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> HttpSecurity <span class=\"title\">getHttp</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (http != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> http;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   AuthenticationEventPublisher eventPublisher = getAuthenticationEventPublisher();</span><br><span class=\"line\">   localConfigureAuthenticationBldr.authenticationEventPublisher(eventPublisher);</span><br><span class=\"line\"></span><br><span class=\"line\">   AuthenticationManager authenticationManager = authenticationManager();</span><br><span class=\"line\">   authenticationBuilder.parentAuthenticationManager(authenticationManager);</span><br><span class=\"line\">   Map&lt;Class&lt;?&gt;, Object&gt; sharedObjects = createSharedObjects();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">   http = <span class=\"keyword\">new</span> HttpSecurity(objectPostProcessor, authenticationBuilder,</span><br><span class=\"line\">         sharedObjects);</span><br><span class=\"line\">    <span class=\"comment\">//  </span></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!disableDefaults) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// @formatter:off</span></span><br><span class=\"line\">      http</span><br><span class=\"line\">         .csrf().and()</span><br><span class=\"line\">         .addFilter(<span class=\"keyword\">new</span> WebAsyncManagerIntegrationFilter())</span><br><span class=\"line\">         .exceptionHandling().and()</span><br><span class=\"line\">         .headers().and()</span><br><span class=\"line\">         .sessionManagement().and()</span><br><span class=\"line\">         .securityContext().and()</span><br><span class=\"line\">         .requestCache().and()</span><br><span class=\"line\">         .anonymous().and()</span><br><span class=\"line\">         .servletApi().and()</span><br><span class=\"line\">         .apply(<span class=\"keyword\">new</span> DefaultLoginPageConfigurer&lt;&gt;()).and()</span><br><span class=\"line\">         .logout();</span><br><span class=\"line\">      <span class=\"comment\">// @formatter:on</span></span><br><span class=\"line\">      ClassLoader classLoader = <span class=\"keyword\">this</span>.context.getClassLoader();</span><br><span class=\"line\">      List&lt;AbstractHttpConfigurer&gt; defaultHttpConfigurers =</span><br><span class=\"line\">            SpringFactoriesLoader.loadFactories(AbstractHttpConfigurer.class, classLoader);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">for</span> (AbstractHttpConfigurer configurer : defaultHttpConfigurers) &#123;</span><br><span class=\"line\">         http.apply(configurer);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">    <span class=\"comment\">// httpSecurity</span></span><br><span class=\"line\">   configure(http);</span><br><span class=\"line\">   <span class=\"keyword\">return</span> http;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>httpSecurity<em>configure</em>demo*@EnableSpringSecurity<em></em>configure*httpSecurity</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringSecurity</p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>        <em>Spring Security</em>SpringBootjar*@EnableWebSecurity*</p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        SpringBootxml*@Configuration<em></em>@EnableWebSecurity*</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention(value = java.lang.annotation.RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Target(value = &#123; java.lang.annotation.ElementType.TYPE &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Import(&#123; WebSecurityConfiguration.class,</span></span><br><span class=\"line\"><span class=\"meta\">\t\tSpringWebMvcImportSelector.class,</span></span><br><span class=\"line\"><span class=\"meta\">\t\tOAuth2ImportSelector.class &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@EnableGlobalAuthentication</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> EnableWebSecurity &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Controls debugging support for Spring Security. Default is false.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> if true, enables debug support with Spring Security</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">debug</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"keyword\">false</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>*@Import()<em>class</em>Selector<em>Spring</em>@Import()<em>Selector</em>WebSecurityConfiguration*</p>\n<p></p>\n<blockquote>\n<p>Add this annotation to an @Configuration class to have the Spring Security configuration defined in any WebSecurityConfigurer or more likely by extending the WebSecurityConfigurerAdapter base class and overriding individual methods</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableWebSecurity</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyWebSecurityConfiguration</span> <span class=\"keyword\">extends</span> <span class=\"title\">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">confugre</span><span class=\"params\">(HttpSecurity httpSecurity)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ....</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring SecuritySpringSpringIoCbean</p>\n<blockquote>\n<p>Uses a WebSecurity to create the FilterChainProxy that performs the web based security for Spring Security. It then exports the necessary beans. Customizations can be made to WebSecurity by extending WebSecurityConfigurerAdapter and exposing it as a Configuration or implementing WebSecurityConfigurer and exposing it as a Configuration. This configuration is imported when using EnableWebSecurity.</p>\n</blockquote>\n<p>web</p>\n<h2 id=\"setFilterChainProxySecurityConfigurer\"><a href=\"#setFilterChainProxySecurityConfigurer\" class=\"headerlink\" title=\"setFilterChainProxySecurityConfigurer\"></a>setFilterChainProxySecurityConfigurer</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired(required = false)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setFilterChainProxySecurityConfigurer</span><span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    // </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    ObjectPostProcessor&lt;Object&gt; objectPostProcessor,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    // </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    <span class=\"meta\">@Value(&quot;#&#123;@autowiredWebSecurityConfigurersIgnoreParents.getWebSecurityConfigurers()&#125;&quot;)</span> List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; webSecurityConfigurers)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    webSecurity = objectPostProcessor</span><br><span class=\"line\">        .postProcess(<span class=\"keyword\">new</span> WebSecurity(objectPostProcessor));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (debugEnabled != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        webSecurity.debug(debugEnabled);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    webSecurityConfigurers.sort(AnnotationAwareOrderComparator.INSTANCE);</span><br><span class=\"line\"></span><br><span class=\"line\">    Integer previousOrder = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Object previousConfig = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (SecurityConfigurer&lt;Filter, WebSecurity&gt; config : webSecurityConfigurers) &#123;</span><br><span class=\"line\">        Integer order = AnnotationAwareOrderComparator.lookupOrder(config);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (previousOrder != <span class=\"keyword\">null</span> &amp;&amp; previousOrder.equals(order)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(</span><br><span class=\"line\">                <span class=\"string\">&quot;@Order on WebSecurityConfigurers must be unique. Order of &quot;</span></span><br><span class=\"line\">                + order + <span class=\"string\">&quot; was already used on &quot;</span> + previousConfig + <span class=\"string\">&quot;, so it cannot be used on &quot;</span></span><br><span class=\"line\">                + config + <span class=\"string\">&quot; too.&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        previousOrder = order;</span><br><span class=\"line\">        previousConfig = config;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (SecurityConfigurer&lt;Filter, WebSecurity&gt; webSecurityConfigurer : webSecurityConfigurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// webSecurityConfigureswebSecurityapply</span></span><br><span class=\"line\">        webSecurity.apply(webSecurityConfigurer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// confugures</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.webSecurityConfigurers = webSecurityConfigurers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"getWebSecurityConfigurers\"><a href=\"#getWebSecurityConfigurers\" class=\"headerlink\" title=\"getWebSecurityConfigurers\"></a>getWebSecurityConfigurers</h3><p><code>AutowiredWebSecurityConfigurersIgnoreParents</code><em>getWebSecurityConfigurers</em>configures</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; getWebSecurityConfigurers() &#123;</span><br><span class=\"line\">   List&lt;SecurityConfigurer&lt;Filter, WebSecurity&gt;&gt; webSecurityConfigurers = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">   Map&lt;String, WebSecurityConfigurer&gt; beansOfType = beanFactory</span><br><span class=\"line\">         .getBeansOfType(WebSecurityConfigurer.class);</span><br><span class=\"line\">   <span class=\"keyword\">for</span> (Entry&lt;String, WebSecurityConfigurer&gt; entry : beansOfType.entrySet()) &#123;</span><br><span class=\"line\">      webSecurityConfigurers.add(entry.getValue());</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">return</span> webSecurityConfigurers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"apply\"><a href=\"#apply\" class=\"headerlink\" title=\"apply\"></a>apply</h3><p>applywebSecurityconfigureswebSecurity</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> &lt;C extends SecurityConfigurer&lt;O, B&gt;&gt; <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(C configurer)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (configurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">        List&lt;SecurityConfigurer&lt;O, B&gt;&gt; configs = allowConfigurersOfSameType ? <span class=\"keyword\">this</span>.configurers</span><br><span class=\"line\">            .get(clazz) : <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (configs == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            configs = <span class=\"keyword\">new</span> ArrayList&lt;&gt;(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        configs.add(configurer);</span><br><span class=\"line\">        <span class=\"comment\">// private final LinkedHashMap&lt;Class&lt;? extends SecurityConfigurer&lt;O, B&gt;&gt;, List&lt;SecurityConfigurer&lt;O, B&gt;&gt;&gt; configurers = new LinkedHashMap&lt;&gt;();</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.configurers.put(clazz, configs);</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em></em><em>WebSecurityConfigurer</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WebSecurityConfigurerAdapter</span> <span class=\"keyword\">implements</span> <span class=\"title\">WebSecurityConfigurer</span>&lt;<span class=\"title\">WebSecurity</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>configurer<em>getWebSecurityConfigurers</em>webSecurity</p>\n<h2 id=\"springSecurityFilterChain\"><a href=\"#springSecurityFilterChain\" class=\"headerlink\" title=\"springSecurityFilterChain\"></a>springSecurityFilterChain</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// \tpublic static final String DEFAULT_FILTER_NAME = &quot;springSecurityFilterChain&quot;;</span></span><br><span class=\"line\"><span class=\"meta\">@Bean(name = AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Filter <span class=\"title\">springSecurityFilterChain</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//  true</span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> hasConfigurers = webSecurityConfigurers != <span class=\"keyword\">null</span></span><br><span class=\"line\">        &amp;&amp; !webSecurityConfigurers.isEmpty();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!hasConfigurers) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        WebSecurityConfigurerAdapter adapter = objectObjectPostProcessor</span><br><span class=\"line\">            .postProcess(<span class=\"keyword\">new</span> WebSecurityConfigurerAdapter() &#123;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        <span class=\"comment\">// apply</span></span><br><span class=\"line\">        webSecurity.apply(adapter);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//  build</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> webSecurity.build();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>democonfigurehttpSecuritybuild</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> AtomicBoolean building = <span class=\"keyword\">new</span> AtomicBoolean();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> O <span class=\"title\">build</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// buildCAS</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.building.compareAndSet(<span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.object = doBuild();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.object;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> AlreadyBuiltException(<span class=\"string\">&quot;This object has already been built&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>*doBuild()*SpringBootrefresh</p>\n<h3 id=\"init\"><a href=\"#init\" class=\"headerlink\" title=\"init\"></a>init</h3><p>configurerWebSecurityAdapterinit</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"keyword\">final</span> WebSecurity web)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// httpSecurity</span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> HttpSecurity http = getHttp();</span><br><span class=\"line\">    <span class=\"comment\">// webwebSecurityhttpSecurity</span></span><br><span class=\"line\">    web.addSecurityFilterChainBuilder(http).postBuildAction(() -&gt; &#123;</span><br><span class=\"line\">        FilterSecurityInterceptor securityInterceptor = http</span><br><span class=\"line\">            .getSharedObject(FilterSecurityInterceptor.class);</span><br><span class=\"line\">        web.securityInterceptor(securityInterceptor);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getHttp\"><a href=\"#getHttp\" class=\"headerlink\" title=\"getHttp\"></a>getHttp</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> HttpSecurity <span class=\"title\">getHttp</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (http != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> http;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   AuthenticationEventPublisher eventPublisher = getAuthenticationEventPublisher();</span><br><span class=\"line\">   localConfigureAuthenticationBldr.authenticationEventPublisher(eventPublisher);</span><br><span class=\"line\"></span><br><span class=\"line\">   AuthenticationManager authenticationManager = authenticationManager();</span><br><span class=\"line\">   authenticationBuilder.parentAuthenticationManager(authenticationManager);</span><br><span class=\"line\">   Map&lt;Class&lt;?&gt;, Object&gt; sharedObjects = createSharedObjects();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">   http = <span class=\"keyword\">new</span> HttpSecurity(objectPostProcessor, authenticationBuilder,</span><br><span class=\"line\">         sharedObjects);</span><br><span class=\"line\">    <span class=\"comment\">//  </span></span><br><span class=\"line\">   <span class=\"keyword\">if</span> (!disableDefaults) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// @formatter:off</span></span><br><span class=\"line\">      http</span><br><span class=\"line\">         .csrf().and()</span><br><span class=\"line\">         .addFilter(<span class=\"keyword\">new</span> WebAsyncManagerIntegrationFilter())</span><br><span class=\"line\">         .exceptionHandling().and()</span><br><span class=\"line\">         .headers().and()</span><br><span class=\"line\">         .sessionManagement().and()</span><br><span class=\"line\">         .securityContext().and()</span><br><span class=\"line\">         .requestCache().and()</span><br><span class=\"line\">         .anonymous().and()</span><br><span class=\"line\">         .servletApi().and()</span><br><span class=\"line\">         .apply(<span class=\"keyword\">new</span> DefaultLoginPageConfigurer&lt;&gt;()).and()</span><br><span class=\"line\">         .logout();</span><br><span class=\"line\">      <span class=\"comment\">// @formatter:on</span></span><br><span class=\"line\">      ClassLoader classLoader = <span class=\"keyword\">this</span>.context.getClassLoader();</span><br><span class=\"line\">      List&lt;AbstractHttpConfigurer&gt; defaultHttpConfigurers =</span><br><span class=\"line\">            SpringFactoriesLoader.loadFactories(AbstractHttpConfigurer.class, classLoader);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">for</span> (AbstractHttpConfigurer configurer : defaultHttpConfigurers) &#123;</span><br><span class=\"line\">         http.apply(configurer);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">    <span class=\"comment\">// httpSecurity</span></span><br><span class=\"line\">   configure(http);</span><br><span class=\"line\">   <span class=\"keyword\">return</span> http;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>httpSecurity<em>configure</em>demo*@EnableSpringSecurity<em></em>configure*httpSecurity</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringSecurity</p>"},{"title":"binary search tree","date":"2021-02-27T07:58:06.000Z","_content":"\n\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n\n\n```java\npublic List<Integer> getValuesFromBST(TreeNode root){\n    TreeNode p = root;\n    List<Integer> list = new ArrayList<>();\n    Deque<TreeNode> deque = new ArrayDeque<>();\n    whlie(p != null || deque.isEmpty()){\n        while(p != null){\n            deque.offerLast(p);\n            p = p.left;\n        }\n        p = deque.pollLast();\n        list.add(p.val); // u can do anything here\n        p = p.right;\n    }\n    \n    return list;\n}\n```\n\nNBST\n\n# \n\n\n\n```java\npublic boolean isBSTValid(TreeNode root){\n    TreeNode p = root;\n    TreeNode pre = null; // \n    Deque<TreeNode> deque = new ArrayDeque<>();\n    whlie(p != null || deque.isEmpty()){\n        while(p.left != null){\n            deque.offerLast(p);\n            p = p.left;\n        }\n        p = deque.pollLast();\n        if(pre != null && p.val <= pre.val){ // \n            return false;\n        }\n        pre = p;\n        p = p.right;\n    }\n\n    return true;\n}\n```\n\n\n\n# \n\nBSTBST*[Score of Parentheses](https://leetcode.com/problems/score-of-parentheses/)*","source":"_posts/binary-search-tre.md","raw":"---\ntitle: binary search tree\ndate: 2021-02-27 15:58:06\ncategories: Leetcode\ntags: bst\n---\n\n\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\n\n\n```java\npublic List<Integer> getValuesFromBST(TreeNode root){\n    TreeNode p = root;\n    List<Integer> list = new ArrayList<>();\n    Deque<TreeNode> deque = new ArrayDeque<>();\n    whlie(p != null || deque.isEmpty()){\n        while(p != null){\n            deque.offerLast(p);\n            p = p.left;\n        }\n        p = deque.pollLast();\n        list.add(p.val); // u can do anything here\n        p = p.right;\n    }\n    \n    return list;\n}\n```\n\nNBST\n\n# \n\n\n\n```java\npublic boolean isBSTValid(TreeNode root){\n    TreeNode p = root;\n    TreeNode pre = null; // \n    Deque<TreeNode> deque = new ArrayDeque<>();\n    whlie(p != null || deque.isEmpty()){\n        while(p.left != null){\n            deque.offerLast(p);\n            p = p.left;\n        }\n        p = deque.pollLast();\n        if(pre != null && p.val <= pre.val){ // \n            return false;\n        }\n        pre = p;\n        p = p.right;\n    }\n\n    return true;\n}\n```\n\n\n\n# \n\nBSTBST*[Score of Parentheses](https://leetcode.com/problems/score-of-parentheses/)*","slug":"binary-search-tre","published":1,"updated":"2021-03-05T15:49:46.597Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q6v0006w5ih90kr1epz","content":"<p></p>\n<a id=\"more\"></a>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">getValuesFromBST</span><span class=\"params\">(TreeNode root)</span></span>&#123;</span><br><span class=\"line\">    TreeNode p = root;</span><br><span class=\"line\">    List&lt;Integer&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    Deque&lt;TreeNode&gt; deque = <span class=\"keyword\">new</span> ArrayDeque&lt;&gt;();</span><br><span class=\"line\">    whlie(p != <span class=\"keyword\">null</span> || deque.isEmpty())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(p != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            deque.offerLast(p);</span><br><span class=\"line\">            p = p.left;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        p = deque.pollLast();</span><br><span class=\"line\">        list.add(p.val); <span class=\"comment\">// u can do anything here</span></span><br><span class=\"line\">        p = p.right;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>NBST</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isBSTValid</span><span class=\"params\">(TreeNode root)</span></span>&#123;</span><br><span class=\"line\">    TreeNode p = root;</span><br><span class=\"line\">    TreeNode pre = <span class=\"keyword\">null</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">    Deque&lt;TreeNode&gt; deque = <span class=\"keyword\">new</span> ArrayDeque&lt;&gt;();</span><br><span class=\"line\">    whlie(p != <span class=\"keyword\">null</span> || deque.isEmpty())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(p.left != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            deque.offerLast(p);</span><br><span class=\"line\">            p = p.left;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        p = deque.pollLast();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pre != <span class=\"keyword\">null</span> &amp;&amp; p.val &lt;= pre.val)&#123; <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pre = p;</span><br><span class=\"line\">        p = p.right;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>BSTBST*<a href=\"https://leetcode.com/problems/score-of-parentheses/\">Score of Parentheses</a>*</p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p></p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">getValuesFromBST</span><span class=\"params\">(TreeNode root)</span></span>&#123;</span><br><span class=\"line\">    TreeNode p = root;</span><br><span class=\"line\">    List&lt;Integer&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    Deque&lt;TreeNode&gt; deque = <span class=\"keyword\">new</span> ArrayDeque&lt;&gt;();</span><br><span class=\"line\">    whlie(p != <span class=\"keyword\">null</span> || deque.isEmpty())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(p != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            deque.offerLast(p);</span><br><span class=\"line\">            p = p.left;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        p = deque.pollLast();</span><br><span class=\"line\">        list.add(p.val); <span class=\"comment\">// u can do anything here</span></span><br><span class=\"line\">        p = p.right;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>NBST</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isBSTValid</span><span class=\"params\">(TreeNode root)</span></span>&#123;</span><br><span class=\"line\">    TreeNode p = root;</span><br><span class=\"line\">    TreeNode pre = <span class=\"keyword\">null</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">    Deque&lt;TreeNode&gt; deque = <span class=\"keyword\">new</span> ArrayDeque&lt;&gt;();</span><br><span class=\"line\">    whlie(p != <span class=\"keyword\">null</span> || deque.isEmpty())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(p.left != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            deque.offerLast(p);</span><br><span class=\"line\">            p = p.left;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        p = deque.pollLast();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pre != <span class=\"keyword\">null</span> &amp;&amp; p.val &lt;= pre.val)&#123; <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pre = p;</span><br><span class=\"line\">        p = p.right;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>BSTBST*<a href=\"https://leetcode.com/problems/score-of-parentheses/\">Score of Parentheses</a>*</p>"},{"title":"bitwise","date":"2020-06-01T13:11:25.000Z","_content":"\nIntroduction of Java bitwise and operation.\n\n<!-- more -->\n\n# \n\n|  |          |               |\n| ------ | ------------ | ----------------- |\n| &      |            | 1 & 1 = 1 (only)  |\n| \\|     |            | 0 \\| 0 = 0 (only) |\n| ^      |          | 1 ^ 0 = 1         |\n| ~      |            | ~ 1 = 0           |\n| <<     |          | 0   |\n| >>     |  |     |\n| >>>    |  | 0   |\n\nbyte, short, int, long=|=<<=>>>=\n\n\n\n## \n\n```java\nint a = -1;\n// 11111111111111111111111111111111111(321)\nSystem.out.println(Integer.toBinaryString(a));\n// -1\nSystem.out.printlnl(a>>1);\n// 1111111111111111111111111111111111(321)\nSystem.out.println(Integer.toBinaryString(a>>1));\n// 2147483647\nSystem.out.println(a>>>1);\n// 0111111111111111111111111111111111(311)\nSystem.out.prinlnt(Integer.toBinaryString(a>>>1));\n```\n\n### \n\n#### a>>1\n\n10000000000000000000000000000001\n\n1111111111111111111111111111111111110\n\n1111111111111111111111111111111111111\n\n111111111111111111111111111111111111111\n\n10000000000000000000000000000000\n\n10000000000000000000000000000001  -1.\n\n#### a>>>1\n\n\n\n0111111111111111111111111111111111110\n\n\n\n# \n\n## HashMap\n\n```java\nstatic final int hash(Object key) {\n        int h;\n        return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n    }\n```\n\njdk1.8hashmaphash`^`, `|`, `<<`, `<<<`\n\n## \n\n```java\n2 & 1; // 0\n8 & 1; // 0\n7 & 1; // 1\n```\n\n10001\n\n81000\n\n70111\n\n1,0.\n\n## \n\n```markdown\n2 ^ 2 ^ 1 = 1\n4 ^ 2 ^ 1 ^ 1 ^ 2 = 4\n```\n\n****`^``0`****\n\n## etc\n\n\n\n","source":"_posts/bitwise.md","raw":"---\ntitle: bitwise\ndate: 2020-06-01 21:11:25\ncategories: Java\ntags: bitwise\n---\n\nIntroduction of Java bitwise and operation.\n\n<!-- more -->\n\n# \n\n|  |          |               |\n| ------ | ------------ | ----------------- |\n| &      |            | 1 & 1 = 1 (only)  |\n| \\|     |            | 0 \\| 0 = 0 (only) |\n| ^      |          | 1 ^ 0 = 1         |\n| ~      |            | ~ 1 = 0           |\n| <<     |          | 0   |\n| >>     |  |     |\n| >>>    |  | 0   |\n\nbyte, short, int, long=|=<<=>>>=\n\n\n\n## \n\n```java\nint a = -1;\n// 11111111111111111111111111111111111(321)\nSystem.out.println(Integer.toBinaryString(a));\n// -1\nSystem.out.printlnl(a>>1);\n// 1111111111111111111111111111111111(321)\nSystem.out.println(Integer.toBinaryString(a>>1));\n// 2147483647\nSystem.out.println(a>>>1);\n// 0111111111111111111111111111111111(311)\nSystem.out.prinlnt(Integer.toBinaryString(a>>>1));\n```\n\n### \n\n#### a>>1\n\n10000000000000000000000000000001\n\n1111111111111111111111111111111111110\n\n1111111111111111111111111111111111111\n\n111111111111111111111111111111111111111\n\n10000000000000000000000000000000\n\n10000000000000000000000000000001  -1.\n\n#### a>>>1\n\n\n\n0111111111111111111111111111111111110\n\n\n\n# \n\n## HashMap\n\n```java\nstatic final int hash(Object key) {\n        int h;\n        return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n    }\n```\n\njdk1.8hashmaphash`^`, `|`, `<<`, `<<<`\n\n## \n\n```java\n2 & 1; // 0\n8 & 1; // 0\n7 & 1; // 1\n```\n\n10001\n\n81000\n\n70111\n\n1,0.\n\n## \n\n```markdown\n2 ^ 2 ^ 1 = 1\n4 ^ 2 ^ 1 ^ 1 ^ 2 = 4\n```\n\n****`^``0`****\n\n## etc\n\n\n\n","slug":"bitwise","published":1,"updated":"2020-11-08T07:20:16.381Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q6x0009w5ihdile7yi8","content":"<p>Introduction of Java bitwise and operation.</p>\n<a id=\"more\"></a>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&amp;</td>\n<td></td>\n<td>1 &amp; 1 = 1 (only)</td>\n</tr>\n<tr>\n<td>|</td>\n<td></td>\n<td>0 | 0 = 0 (only)</td>\n</tr>\n<tr>\n<td>^</td>\n<td></td>\n<td>1 ^ 0 = 1</td>\n</tr>\n<tr>\n<td>~</td>\n<td></td>\n<td>~ 1 = 0</td>\n</tr>\n<tr>\n<td>&lt;&lt;</td>\n<td></td>\n<td>0</td>\n</tr>\n<tr>\n<td>&gt;&gt;</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>&gt;&gt;&gt;</td>\n<td></td>\n<td>0</td>\n</tr>\n</tbody></table>\n<p>byte, short, int, long=|=&lt;&lt;=&gt;&gt;&gt;=</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"comment\">// 11111111111111111111111111111111111(321)</span></span><br><span class=\"line\">System.out.println(Integer.toBinaryString(a));</span><br><span class=\"line\"><span class=\"comment\">// -1</span></span><br><span class=\"line\">System.out.printlnl(a&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">// 1111111111111111111111111111111111(321)</span></span><br><span class=\"line\">System.out.println(Integer.toBinaryString(a&gt;&gt;<span class=\"number\">1</span>));</span><br><span class=\"line\"><span class=\"comment\">// 2147483647</span></span><br><span class=\"line\">System.out.println(a&gt;&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">// 0111111111111111111111111111111111(311)</span></span><br><span class=\"line\">System.out.prinlnt(Integer.toBinaryString(a&gt;&gt;&gt;<span class=\"number\">1</span>));</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"a-gt-gt-1\"><a href=\"#a-gt-gt-1\" class=\"headerlink\" title=\"a&gt;&gt;1\"></a>a&gt;&gt;1</h4><p>10000000000000000000000000000001</p>\n<p>1111111111111111111111111111111111110</p>\n<p>1111111111111111111111111111111111111</p>\n<p>111111111111111111111111111111111111111</p>\n<p>10000000000000000000000000000000</p>\n<p>10000000000000000000000000000001  -1.</p>\n<h4 id=\"a-gt-gt-gt-1\"><a href=\"#a-gt-gt-gt-1\" class=\"headerlink\" title=\"a&gt;&gt;&gt;1\"></a>a&gt;&gt;&gt;1</h4><p></p>\n<p>0111111111111111111111111111111111110</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"HashMap\"><a href=\"#HashMap\" class=\"headerlink\" title=\"HashMap\"></a>HashMap</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">hash</span><span class=\"params\">(Object key)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> h;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (key == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>jdk1.8hashmaphash<code>^</code>, <code>|</code>, <code>&lt;&lt;</code>, <code>&lt;&lt;&lt;</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"number\">8</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"number\">7</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n\n<p>10001</p>\n<p>81000</p>\n<p>70111</p>\n<p>1,0.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2 ^ 2 ^ 1 = 1</span><br><span class=\"line\">4 ^ 2 ^ 1 ^ 1 ^ 2 = 4</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong><code>^</code><code>0</code><strong></strong></p>\n<h2 id=\"etc\"><a href=\"#etc\" class=\"headerlink\" title=\"etc\"></a>etc</h2><p></p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>Introduction of Java bitwise and operation.</p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&amp;</td>\n<td></td>\n<td>1 &amp; 1 = 1 (only)</td>\n</tr>\n<tr>\n<td>|</td>\n<td></td>\n<td>0 | 0 = 0 (only)</td>\n</tr>\n<tr>\n<td>^</td>\n<td></td>\n<td>1 ^ 0 = 1</td>\n</tr>\n<tr>\n<td>~</td>\n<td></td>\n<td>~ 1 = 0</td>\n</tr>\n<tr>\n<td>&lt;&lt;</td>\n<td></td>\n<td>0</td>\n</tr>\n<tr>\n<td>&gt;&gt;</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>&gt;&gt;&gt;</td>\n<td></td>\n<td>0</td>\n</tr>\n</tbody></table>\n<p>byte, short, int, long=|=&lt;&lt;=&gt;&gt;&gt;=</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"comment\">// 11111111111111111111111111111111111(321)</span></span><br><span class=\"line\">System.out.println(Integer.toBinaryString(a));</span><br><span class=\"line\"><span class=\"comment\">// -1</span></span><br><span class=\"line\">System.out.printlnl(a&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">// 1111111111111111111111111111111111(321)</span></span><br><span class=\"line\">System.out.println(Integer.toBinaryString(a&gt;&gt;<span class=\"number\">1</span>));</span><br><span class=\"line\"><span class=\"comment\">// 2147483647</span></span><br><span class=\"line\">System.out.println(a&gt;&gt;&gt;<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">// 0111111111111111111111111111111111(311)</span></span><br><span class=\"line\">System.out.prinlnt(Integer.toBinaryString(a&gt;&gt;&gt;<span class=\"number\">1</span>));</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"a-gt-gt-1\"><a href=\"#a-gt-gt-1\" class=\"headerlink\" title=\"a&gt;&gt;1\"></a>a&gt;&gt;1</h4><p>10000000000000000000000000000001</p>\n<p>1111111111111111111111111111111111110</p>\n<p>1111111111111111111111111111111111111</p>\n<p>111111111111111111111111111111111111111</p>\n<p>10000000000000000000000000000000</p>\n<p>10000000000000000000000000000001  -1.</p>\n<h4 id=\"a-gt-gt-gt-1\"><a href=\"#a-gt-gt-gt-1\" class=\"headerlink\" title=\"a&gt;&gt;&gt;1\"></a>a&gt;&gt;&gt;1</h4><p></p>\n<p>0111111111111111111111111111111111110</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"HashMap\"><a href=\"#HashMap\" class=\"headerlink\" title=\"HashMap\"></a>HashMap</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">hash</span><span class=\"params\">(Object key)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> h;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (key == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>jdk1.8hashmaphash<code>^</code>, <code>|</code>, <code>&lt;&lt;</code>, <code>&lt;&lt;&lt;</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"number\">8</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 0</span></span><br><span class=\"line\"><span class=\"number\">7</span> &amp; <span class=\"number\">1</span>; <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n\n<p>10001</p>\n<p>81000</p>\n<p>70111</p>\n<p>1,0.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2 ^ 2 ^ 1 = 1</span><br><span class=\"line\">4 ^ 2 ^ 1 ^ 1 ^ 2 = 4</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong><code>^</code><code>0</code><strong></strong></p>\n<h2 id=\"etc\"><a href=\"#etc\" class=\"headerlink\" title=\"etc\"></a>etc</h2><p></p>"},{"title":"contest200","date":"2020-08-02T04:56:29.000Z","_content":"\nRecord Leetcode contest 200.\n\n<!--more-->\n\n# Q1\n\npassed.\n\n# Q2\n\nFind the winner of an Array Game.\n\nGiven an integer array `arr` of **distinct** integers and an integer `k`.\n\nA game will be played between the first two elements of the array (i.e. `arr[0]` and `arr[1]`). In each round of the game, we compare `arr[0]` with `arr[1]`, the larger integer wins and remains at position `0` and the smaller integer moves to the end of the array. The game ends when an integer wins `k` consecutive rounds.\n\nReturn *the integer which will win the game*.\n\nIt is **guaranteed** that there will be a winner of the game.\n\n**Example 1:**\n\n```markdown\nInput: arr = [2,1,3,5,4,6,7], k = 2\nOutput: 5\nExplanation: Let's see the rounds of the game:\nRound |       arr       | winner | win_count\n  1   | [2,1,3,5,4,6,7] | 2      | 1\n  2   | [2,3,5,4,6,7,1] | 3      | 1\n  3   | [3,5,4,6,7,1,2] | 5      | 1\n  4   | [5,4,6,7,1,2,3] | 5      | 2\nSo we can see that 4 rounds will be played and 5 is the winner because it wins 2 consecutive games.\n```\n\n**Example 2:**\n\n```markdown\nInput: arr = [3,2,1], k = 10\nOutput: 3\nExplanation: 3 will win the first 10 rounds consecutively.\n```\n\n**Example 3:**\n\n```markdown\nInput: arr = [1,9,8,2,3,7,6,4,5], k = 7\nOutput: 9\n```\n\n**Example 4:**\n\n```markdown\nInput: arr = [1,11,22,33,44,55,66,77,88,99], k = 1000000000\nOutput: 99\n```\n\n## My Solution\n\n____**k**:joy:\n\n\n\n```java\npublic int getWinner(int[] arr, int k) {\n    int res = -1;\n    int zero = k-1;\n    int solution = 0;\n    while(k>0){\n        int currMax = Math.max(arr[0],arr[1]);\n        int currMin = Math.min(arr[0], arr[1]);\n        helper(currMax, currMin, arr);\n        if(res == -1){\n            // initial, no compare\n            res = currMax;\n        }else{\n            if(currMax == res){\n                k--;\n                solution = currMax;\n            }else{\n                k = zero;\n                res = currMax;\n            }\n        }\n    }\n    return solution;\n}\n\nprivate void helper(int max, int min, int[] arr){\n    arr[0] = max;\n    for (int i = 1; i < arr.length - 1; i++) {\n        arr[i] = arr[i + 1];\n    }\n    arr[arr.length-1] = min;\n}\n```\n\n`Time Limited`\n\n## Niubility Solution\n\n```java\npublic int getWinner(int[] arr, int k) {\n    // \n    int n = arr.length;\n    // k\n    k = Math.min(k, n);\n    int A = arr[0];\n    // \n    int rep = 0;\n    // iterate\n    for(int i = 1;;i++){\n        // i%n forin\n        int B = arr[i%n];\n        if(A >= B){\n            rep++;\n        }else{\n            A = B;\n            rep = 1;\n        }\n        // repk\n        if(rep == k){\n            return A;\n        }\n    }\n}\n```\n\n**** \n\n1. 460\n2. `Math.min(k, n)`k`10000000`,`8`,`8` \n\ni\n\ni.e. arr = [2,1,3,5,4,6,7], k = 2","source":"_posts/contest200.md","raw":"---\ntitle: contest200\ndate: 2020-08-02 12:56:29\ncategories: Leetcode\ntags: algorithm\n---\n\nRecord Leetcode contest 200.\n\n<!--more-->\n\n# Q1\n\npassed.\n\n# Q2\n\nFind the winner of an Array Game.\n\nGiven an integer array `arr` of **distinct** integers and an integer `k`.\n\nA game will be played between the first two elements of the array (i.e. `arr[0]` and `arr[1]`). In each round of the game, we compare `arr[0]` with `arr[1]`, the larger integer wins and remains at position `0` and the smaller integer moves to the end of the array. The game ends when an integer wins `k` consecutive rounds.\n\nReturn *the integer which will win the game*.\n\nIt is **guaranteed** that there will be a winner of the game.\n\n**Example 1:**\n\n```markdown\nInput: arr = [2,1,3,5,4,6,7], k = 2\nOutput: 5\nExplanation: Let's see the rounds of the game:\nRound |       arr       | winner | win_count\n  1   | [2,1,3,5,4,6,7] | 2      | 1\n  2   | [2,3,5,4,6,7,1] | 3      | 1\n  3   | [3,5,4,6,7,1,2] | 5      | 1\n  4   | [5,4,6,7,1,2,3] | 5      | 2\nSo we can see that 4 rounds will be played and 5 is the winner because it wins 2 consecutive games.\n```\n\n**Example 2:**\n\n```markdown\nInput: arr = [3,2,1], k = 10\nOutput: 3\nExplanation: 3 will win the first 10 rounds consecutively.\n```\n\n**Example 3:**\n\n```markdown\nInput: arr = [1,9,8,2,3,7,6,4,5], k = 7\nOutput: 9\n```\n\n**Example 4:**\n\n```markdown\nInput: arr = [1,11,22,33,44,55,66,77,88,99], k = 1000000000\nOutput: 99\n```\n\n## My Solution\n\n____**k**:joy:\n\n\n\n```java\npublic int getWinner(int[] arr, int k) {\n    int res = -1;\n    int zero = k-1;\n    int solution = 0;\n    while(k>0){\n        int currMax = Math.max(arr[0],arr[1]);\n        int currMin = Math.min(arr[0], arr[1]);\n        helper(currMax, currMin, arr);\n        if(res == -1){\n            // initial, no compare\n            res = currMax;\n        }else{\n            if(currMax == res){\n                k--;\n                solution = currMax;\n            }else{\n                k = zero;\n                res = currMax;\n            }\n        }\n    }\n    return solution;\n}\n\nprivate void helper(int max, int min, int[] arr){\n    arr[0] = max;\n    for (int i = 1; i < arr.length - 1; i++) {\n        arr[i] = arr[i + 1];\n    }\n    arr[arr.length-1] = min;\n}\n```\n\n`Time Limited`\n\n## Niubility Solution\n\n```java\npublic int getWinner(int[] arr, int k) {\n    // \n    int n = arr.length;\n    // k\n    k = Math.min(k, n);\n    int A = arr[0];\n    // \n    int rep = 0;\n    // iterate\n    for(int i = 1;;i++){\n        // i%n forin\n        int B = arr[i%n];\n        if(A >= B){\n            rep++;\n        }else{\n            A = B;\n            rep = 1;\n        }\n        // repk\n        if(rep == k){\n            return A;\n        }\n    }\n}\n```\n\n**** \n\n1. 460\n2. `Math.min(k, n)`k`10000000`,`8`,`8` \n\ni\n\ni.e. arr = [2,1,3,5,4,6,7], k = 2","slug":"contest200","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q6z000bw5iheq0k9nyw","content":"<p>Record Leetcode contest 200.</p>\n<a id=\"more\"></a>\n\n<h1 id=\"Q1\"><a href=\"#Q1\" class=\"headerlink\" title=\"Q1\"></a>Q1</h1><p>passed.</p>\n<h1 id=\"Q2\"><a href=\"#Q2\" class=\"headerlink\" title=\"Q2\"></a>Q2</h1><p>Find the winner of an Array Game.</p>\n<p>Given an integer array <code>arr</code> of <strong>distinct</strong> integers and an integer <code>k</code>.</p>\n<p>A game will be played between the first two elements of the array (i.e. <code>arr[0]</code> and <code>arr[1]</code>). In each round of the game, we compare <code>arr[0]</code> with <code>arr[1]</code>, the larger integer wins and remains at position <code>0</code> and the smaller integer moves to the end of the array. The game ends when an integer wins <code>k</code> consecutive rounds.</p>\n<p>Return <em>the integer which will win the game</em>.</p>\n<p>It is <strong>guaranteed</strong> that there will be a winner of the game.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr = [2,1,3,5,4,6,7], k = 2</span><br><span class=\"line\">Output: 5</span><br><span class=\"line\">Explanation: Let&#x27;s see the rounds of the game:</span><br><span class=\"line\">Round |       arr       | winner | win<span class=\"emphasis\">_count</span></span><br><span class=\"line\"><span class=\"emphasis\">  1   | [2,1,3,5,4,6,7] | 2      | 1</span></span><br><span class=\"line\"><span class=\"emphasis\">  2   | [2,3,5,4,6,7,1] | 3      | 1</span></span><br><span class=\"line\"><span class=\"emphasis\">  3   | [3,5,4,6,7,1,2] | 5      | 1</span></span><br><span class=\"line\"><span class=\"emphasis\">  4   | [5,4,6,7,1,2,3] | 5      | 2</span></span><br><span class=\"line\"><span class=\"emphasis\">So we can see that 4 rounds will be played and 5 is the winner because it wins 2 consecutive games.</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr = [3,2,1], k = 10</span><br><span class=\"line\">Output: 3</span><br><span class=\"line\">Explanation: 3 will win the first 10 rounds consecutively.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr = [1,9,8,2,3,7,6,4,5], k = 7</span><br><span class=\"line\">Output: 9</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 4:</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr = [1,11,22,33,44,55,66,77,88,99], k = 1000000000</span><br><span class=\"line\">Output: 99</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"My-Solution\"><a href=\"#My-Solution\" class=\"headerlink\" title=\"My Solution\"></a>My Solution</h2><p>____<strong>k</strong>:joy:</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getWinner</span><span class=\"params\">(<span class=\"keyword\">int</span>[] arr, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = -<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> zero = k-<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> solution = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(k&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> currMax = Math.max(arr[<span class=\"number\">0</span>],arr[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> currMin = Math.min(arr[<span class=\"number\">0</span>], arr[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        helper(currMax, currMin, arr);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(res == -<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">// initial, no compare</span></span><br><span class=\"line\">            res = currMax;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(currMax == res)&#123;</span><br><span class=\"line\">                k--;</span><br><span class=\"line\">                solution = currMax;</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                k = zero;</span><br><span class=\"line\">                res = currMax;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> solution;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span> max, <span class=\"keyword\">int</span> min, <span class=\"keyword\">int</span>[] arr)</span></span>&#123;</span><br><span class=\"line\">    arr[<span class=\"number\">0</span>] = max;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; arr.length - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">        arr[i] = arr[i + <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    arr[arr.length-<span class=\"number\">1</span>] = min;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>Time Limited</code></p>\n<h2 id=\"Niubility-Solution\"><a href=\"#Niubility-Solution\" class=\"headerlink\" title=\"Niubility Solution\"></a>Niubility Solution</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getWinner</span><span class=\"params\">(<span class=\"keyword\">int</span>[] arr, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = arr.length;</span><br><span class=\"line\">    <span class=\"comment\">// k</span></span><br><span class=\"line\">    k = Math.min(k, n);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> A = arr[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> rep = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">// iterate</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>;;i++)&#123;</span><br><span class=\"line\">        <span class=\"comment\">// i%n forin</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> B = arr[i%n];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(A &gt;= B)&#123;</span><br><span class=\"line\">            rep++;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            A = B;</span><br><span class=\"line\">            rep = <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// repk</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(rep == k)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> A;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong> </p>\n<ol>\n<li>460</li>\n<li><code>Math.min(k, n)</code>k<code>10000000</code>,<code>8</code>,<code>8</code> </li>\n</ol>\n<p>i</p>\n<p>i.e. arr = [2,1,3,5,4,6,7], k = 2</p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>Record Leetcode contest 200.</p>","more":"<h1 id=\"Q1\"><a href=\"#Q1\" class=\"headerlink\" title=\"Q1\"></a>Q1</h1><p>passed.</p>\n<h1 id=\"Q2\"><a href=\"#Q2\" class=\"headerlink\" title=\"Q2\"></a>Q2</h1><p>Find the winner of an Array Game.</p>\n<p>Given an integer array <code>arr</code> of <strong>distinct</strong> integers and an integer <code>k</code>.</p>\n<p>A game will be played between the first two elements of the array (i.e. <code>arr[0]</code> and <code>arr[1]</code>). In each round of the game, we compare <code>arr[0]</code> with <code>arr[1]</code>, the larger integer wins and remains at position <code>0</code> and the smaller integer moves to the end of the array. The game ends when an integer wins <code>k</code> consecutive rounds.</p>\n<p>Return <em>the integer which will win the game</em>.</p>\n<p>It is <strong>guaranteed</strong> that there will be a winner of the game.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr = [2,1,3,5,4,6,7], k = 2</span><br><span class=\"line\">Output: 5</span><br><span class=\"line\">Explanation: Let&#x27;s see the rounds of the game:</span><br><span class=\"line\">Round |       arr       | winner | win<span class=\"emphasis\">_count</span></span><br><span class=\"line\"><span class=\"emphasis\">  1   | [2,1,3,5,4,6,7] | 2      | 1</span></span><br><span class=\"line\"><span class=\"emphasis\">  2   | [2,3,5,4,6,7,1] | 3      | 1</span></span><br><span class=\"line\"><span class=\"emphasis\">  3   | [3,5,4,6,7,1,2] | 5      | 1</span></span><br><span class=\"line\"><span class=\"emphasis\">  4   | [5,4,6,7,1,2,3] | 5      | 2</span></span><br><span class=\"line\"><span class=\"emphasis\">So we can see that 4 rounds will be played and 5 is the winner because it wins 2 consecutive games.</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr = [3,2,1], k = 10</span><br><span class=\"line\">Output: 3</span><br><span class=\"line\">Explanation: 3 will win the first 10 rounds consecutively.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr = [1,9,8,2,3,7,6,4,5], k = 7</span><br><span class=\"line\">Output: 9</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 4:</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr = [1,11,22,33,44,55,66,77,88,99], k = 1000000000</span><br><span class=\"line\">Output: 99</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"My-Solution\"><a href=\"#My-Solution\" class=\"headerlink\" title=\"My Solution\"></a>My Solution</h2><p>____<strong>k</strong>:joy:</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getWinner</span><span class=\"params\">(<span class=\"keyword\">int</span>[] arr, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = -<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> zero = k-<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> solution = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(k&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> currMax = Math.max(arr[<span class=\"number\">0</span>],arr[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> currMin = Math.min(arr[<span class=\"number\">0</span>], arr[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        helper(currMax, currMin, arr);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(res == -<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">// initial, no compare</span></span><br><span class=\"line\">            res = currMax;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(currMax == res)&#123;</span><br><span class=\"line\">                k--;</span><br><span class=\"line\">                solution = currMax;</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                k = zero;</span><br><span class=\"line\">                res = currMax;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> solution;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span> max, <span class=\"keyword\">int</span> min, <span class=\"keyword\">int</span>[] arr)</span></span>&#123;</span><br><span class=\"line\">    arr[<span class=\"number\">0</span>] = max;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; arr.length - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">        arr[i] = arr[i + <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    arr[arr.length-<span class=\"number\">1</span>] = min;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>Time Limited</code></p>\n<h2 id=\"Niubility-Solution\"><a href=\"#Niubility-Solution\" class=\"headerlink\" title=\"Niubility Solution\"></a>Niubility Solution</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getWinner</span><span class=\"params\">(<span class=\"keyword\">int</span>[] arr, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = arr.length;</span><br><span class=\"line\">    <span class=\"comment\">// k</span></span><br><span class=\"line\">    k = Math.min(k, n);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> A = arr[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> rep = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">// iterate</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>;;i++)&#123;</span><br><span class=\"line\">        <span class=\"comment\">// i%n forin</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> B = arr[i%n];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(A &gt;= B)&#123;</span><br><span class=\"line\">            rep++;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            A = B;</span><br><span class=\"line\">            rep = <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// repk</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(rep == k)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> A;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong> </p>\n<ol>\n<li>460</li>\n<li><code>Math.min(k, n)</code>k<code>10000000</code>,<code>8</code>,<code>8</code> </li>\n</ol>\n<p>i</p>\n<p>i.e. arr = [2,1,3,5,4,6,7], k = 2</p>"},{"title":"contest201","date":"2020-08-09T04:22:53.000Z","_content":"\nLeetcode201.\n\n<!--more-->\n\n# 1544 Make The String Great\n\nGiven a string `s` of lower and upper case English letters.\n\nA good string is a string which doesn't have **two adjacent characters** `s[i]` and `s[i + 1]` where:\n\n- `0 <= i <= s.length - 2`\n- `s[i]` is a lower-case letter and `s[i + 1]` is the same letter but in upper-case or **vice-versa**.\n\nTo make the string good, you can choose **two adjacent** characters that make the string bad and remove them. You can keep doing this until the string becomes good.\n\nReturn *the string* after making it good. The answer is guaranteed to be unique under the given constraints.\n\n**Notice** that an empty string is also good.\n\n**Example 1:**\n\n```\nInput: s = \"leEeetcode\"\nOutput: \"leetcode\"\nExplanation: In the first step, either you choose i = 1 or i = 2, both will result \"leEeetcode\" to be reduced to \"leetcode\".\n```\n\n**Example 2:**\n\n```\nInput: s = \"abBAcC\"\nOutput: \"\"\nExplanation: We have many possible scenarios, and all lead to the same answer. For example:\n\"abBAcC\" --> \"aAcC\" --> \"cC\" --> \"\"\n\"abBAcC\" --> \"abBA\" --> \"aA\" --> \"\"\n```\n\n**Example 3:**\n\n```\nInput: s = \"s\"\nOutput: \"s\"\n```\n\n## Solution\n\n- `vice-versa`****\n- `example 2`**\n\n### mine\n\n```java\npublic String makeGood(String s) {\n    Stack<Character> stack = new Stack<>();\n    for (int i = 0; i < s.length(); i++) {\n        char c = s.charAt(i);\n        if (!stack.empty() && (\n                (Character.isUpperCase(c) && Character.isLowerCase(stack.peek()) && ((stack.peek() - 'a') == (c - 'A')))\n                        ||\n                        (Character.isLowerCase(c) && Character.isUpperCase(stack.peek()) && ((stack.peek() - 'A') == (c - 'a')))\n        )) {\n            stack.pop();\n        } else {\n            stack.push(c);\n        }\n    }\n    Iterator<Character> iterator = stack.iterator();\n    StringBuilder sb = new StringBuilder();\n    while (iterator.hasNext()) {\n        sb.append(iterator.next());\n    }\n\t// iteratorreverse()\n    return sb.toString();\n}\n```\n### better\n\n```java\nboolean ch = true;\nwhile (ch) {\n    ch = false;\n    String t = s;\n    for (int i = 0; i < s.length() - 1; ++i) {\n        if (s.charAt(i) + 32 == s.charAt(i + 1) || s.charAt(i + 1) + 32 == s.charAt(i)) {\n            t = s.substring(0, i) + s.substring(i + 2);\n            ch = true;\n            break;\n        }\n    }\n    s = t;\n}\nreturn s;\n```\n\n# 1545 Find Kth Bit in Nth Binary String\n\nGiven two positive integers `n` and `k`, the binary string `Sn` is formed as follows:\n\n- `S1 = \"0\"`\n- `Si = Si-1 + \"1\" + reverse(invert(Si-1))` for `i > 1`\n\nWhere `+` denotes the concatenation operation, `reverse(x)` returns the reversed string x, and `invert(x)` inverts all the bits in x (0 changes to 1 and 1 changes to 0).\n\nFor example, the first 4 strings in the above sequence are:\n\n- S1 = \"0\"\n- S2 = \"0**1**1\"\n- S3 = \"011**1**001\"\n- S4 = \"0111001**1**0110001\"\n\nReturn *the* `kth` *bit* *in* `Sn`. It is guaranteed that `k` is valid for the given `n`.\n\n \n\n**Example 1:**\n\n```\nInput: n = 3, k = 1\nOutput: \"0\"\nExplanation: S3 is \"0111001\". The first bit is \"0\".\n```\n\n**Example 2:**\n\n```\nInput: n = 4, k = 11\nOutput: \"1\"\nExplanation: S4 is \"011100110110001\". The 11th bit is \"1\".\n```\n\n**Example 3:**\n\n```\nInput: n = 1, k = 1\nOutput: \"0\"\n```\n\n**Example 4:**\n\n```\nInput: n = 2, k = 3\nOutput: \"1\"\n```\n\n## Solution\n\n\n\n```java\npublic char findKthBit(int n, int k) {\n    StringBuilder sb = new StringBuilder(\"0\");\n    while (n > 1) {\n        int integer = Integer.parseInt(sb.toString());\n        StringBuilder stringBuilder = new StringBuilder(Integer.toBinaryString(integer));\n        // 0-1 inverse\n        for (int i = 0; i < stringBuilder.length(); i++) {\n            if (stringBuilder.charAt(i) == '0') {\n                stringBuilder.replace(i, i + 1, \"1\");\n            } else {\n                stringBuilder.replace(i, i + 1, \"0\");\n            }\n        }\n        stringBuilder.reverse();\n        sb.append(\"1\").append(stringBuilder);\n        n--;\n        System.out.println(sb.toString());\n    }\n\n    char[] chars = sb.toString().toCharArray();\n    return chars[k - 1];\n}\n```\n\nn=4\n\n### better\n\n`0-1```\n\n-  ^ 00`1``0-1`\n\n#### method 1\n\n\n\n```java\npublic char findKthBit(int n, int k) {\n    String s = \"0\";\n    while (n>1) {\n        --n;\n        s = s+\"1\"+sinv(s);\n    }\n    // 0k-1\n    return s.charAt(k-1);\n}\n\npublic String sinv(String s) {\n    StringBuilder a = new StringBuilder();\n    // reverse()\n    for (int i = s.length()-1; i>=0; --i) {\n        char c = s.charAt(i);\n        // 0-1\n        c^=1;\n        a.append(c);\n    }\n    return a.toString();\n}\n```\n\n#### method 2\n\n\n\n```java\npublic char findKthBit(int n, int k){\n    char findKthBit(int n, int k) \n    s[1]=\"0\";\n    t[1]=\"1\";\n    for(int i=2;i<=n;i++){\n        s[i]=s[i-1];\n        s[i]+='1';\n        s[i]+=t[i-1];\n        t[i]=s[i-1];\n        t[i]+='0';\n        t[i]+=t[i-1];\n    }\n    return s[n][k-1];\n}\n```\n\n#### method 3\n\n\n\n```java\nchar dfs(int n, int k) {\n    if (n == 1) {\n        return '0';\n    } else {\n        int len = (1 << n) - 1;\n        int base = (1 << (n - 1)) - 1;\n        if (k == base + 1) {\n            return '1';\n        } else if (k <= base) {\n            return dfs(n - 1, k);\n        } else {\n            return dfs(n - 1, len - k + 1) ^ 1;\n        }\n    }\n}\n\nchar findKthBit(int n, int k) {\n    return dfs(n, k);\n}\n```\n\n","source":"_posts/contest201.md","raw":"---\ntitle: contest201\ndate: 2020-08-09 12:22:53\ncategories: Leetcode\ntags: algorithm\n---\n\nLeetcode201.\n\n<!--more-->\n\n# 1544 Make The String Great\n\nGiven a string `s` of lower and upper case English letters.\n\nA good string is a string which doesn't have **two adjacent characters** `s[i]` and `s[i + 1]` where:\n\n- `0 <= i <= s.length - 2`\n- `s[i]` is a lower-case letter and `s[i + 1]` is the same letter but in upper-case or **vice-versa**.\n\nTo make the string good, you can choose **two adjacent** characters that make the string bad and remove them. You can keep doing this until the string becomes good.\n\nReturn *the string* after making it good. The answer is guaranteed to be unique under the given constraints.\n\n**Notice** that an empty string is also good.\n\n**Example 1:**\n\n```\nInput: s = \"leEeetcode\"\nOutput: \"leetcode\"\nExplanation: In the first step, either you choose i = 1 or i = 2, both will result \"leEeetcode\" to be reduced to \"leetcode\".\n```\n\n**Example 2:**\n\n```\nInput: s = \"abBAcC\"\nOutput: \"\"\nExplanation: We have many possible scenarios, and all lead to the same answer. For example:\n\"abBAcC\" --> \"aAcC\" --> \"cC\" --> \"\"\n\"abBAcC\" --> \"abBA\" --> \"aA\" --> \"\"\n```\n\n**Example 3:**\n\n```\nInput: s = \"s\"\nOutput: \"s\"\n```\n\n## Solution\n\n- `vice-versa`****\n- `example 2`**\n\n### mine\n\n```java\npublic String makeGood(String s) {\n    Stack<Character> stack = new Stack<>();\n    for (int i = 0; i < s.length(); i++) {\n        char c = s.charAt(i);\n        if (!stack.empty() && (\n                (Character.isUpperCase(c) && Character.isLowerCase(stack.peek()) && ((stack.peek() - 'a') == (c - 'A')))\n                        ||\n                        (Character.isLowerCase(c) && Character.isUpperCase(stack.peek()) && ((stack.peek() - 'A') == (c - 'a')))\n        )) {\n            stack.pop();\n        } else {\n            stack.push(c);\n        }\n    }\n    Iterator<Character> iterator = stack.iterator();\n    StringBuilder sb = new StringBuilder();\n    while (iterator.hasNext()) {\n        sb.append(iterator.next());\n    }\n\t// iteratorreverse()\n    return sb.toString();\n}\n```\n### better\n\n```java\nboolean ch = true;\nwhile (ch) {\n    ch = false;\n    String t = s;\n    for (int i = 0; i < s.length() - 1; ++i) {\n        if (s.charAt(i) + 32 == s.charAt(i + 1) || s.charAt(i + 1) + 32 == s.charAt(i)) {\n            t = s.substring(0, i) + s.substring(i + 2);\n            ch = true;\n            break;\n        }\n    }\n    s = t;\n}\nreturn s;\n```\n\n# 1545 Find Kth Bit in Nth Binary String\n\nGiven two positive integers `n` and `k`, the binary string `Sn` is formed as follows:\n\n- `S1 = \"0\"`\n- `Si = Si-1 + \"1\" + reverse(invert(Si-1))` for `i > 1`\n\nWhere `+` denotes the concatenation operation, `reverse(x)` returns the reversed string x, and `invert(x)` inverts all the bits in x (0 changes to 1 and 1 changes to 0).\n\nFor example, the first 4 strings in the above sequence are:\n\n- S1 = \"0\"\n- S2 = \"0**1**1\"\n- S3 = \"011**1**001\"\n- S4 = \"0111001**1**0110001\"\n\nReturn *the* `kth` *bit* *in* `Sn`. It is guaranteed that `k` is valid for the given `n`.\n\n \n\n**Example 1:**\n\n```\nInput: n = 3, k = 1\nOutput: \"0\"\nExplanation: S3 is \"0111001\". The first bit is \"0\".\n```\n\n**Example 2:**\n\n```\nInput: n = 4, k = 11\nOutput: \"1\"\nExplanation: S4 is \"011100110110001\". The 11th bit is \"1\".\n```\n\n**Example 3:**\n\n```\nInput: n = 1, k = 1\nOutput: \"0\"\n```\n\n**Example 4:**\n\n```\nInput: n = 2, k = 3\nOutput: \"1\"\n```\n\n## Solution\n\n\n\n```java\npublic char findKthBit(int n, int k) {\n    StringBuilder sb = new StringBuilder(\"0\");\n    while (n > 1) {\n        int integer = Integer.parseInt(sb.toString());\n        StringBuilder stringBuilder = new StringBuilder(Integer.toBinaryString(integer));\n        // 0-1 inverse\n        for (int i = 0; i < stringBuilder.length(); i++) {\n            if (stringBuilder.charAt(i) == '0') {\n                stringBuilder.replace(i, i + 1, \"1\");\n            } else {\n                stringBuilder.replace(i, i + 1, \"0\");\n            }\n        }\n        stringBuilder.reverse();\n        sb.append(\"1\").append(stringBuilder);\n        n--;\n        System.out.println(sb.toString());\n    }\n\n    char[] chars = sb.toString().toCharArray();\n    return chars[k - 1];\n}\n```\n\nn=4\n\n### better\n\n`0-1```\n\n-  ^ 00`1``0-1`\n\n#### method 1\n\n\n\n```java\npublic char findKthBit(int n, int k) {\n    String s = \"0\";\n    while (n>1) {\n        --n;\n        s = s+\"1\"+sinv(s);\n    }\n    // 0k-1\n    return s.charAt(k-1);\n}\n\npublic String sinv(String s) {\n    StringBuilder a = new StringBuilder();\n    // reverse()\n    for (int i = s.length()-1; i>=0; --i) {\n        char c = s.charAt(i);\n        // 0-1\n        c^=1;\n        a.append(c);\n    }\n    return a.toString();\n}\n```\n\n#### method 2\n\n\n\n```java\npublic char findKthBit(int n, int k){\n    char findKthBit(int n, int k) \n    s[1]=\"0\";\n    t[1]=\"1\";\n    for(int i=2;i<=n;i++){\n        s[i]=s[i-1];\n        s[i]+='1';\n        s[i]+=t[i-1];\n        t[i]=s[i-1];\n        t[i]+='0';\n        t[i]+=t[i-1];\n    }\n    return s[n][k-1];\n}\n```\n\n#### method 3\n\n\n\n```java\nchar dfs(int n, int k) {\n    if (n == 1) {\n        return '0';\n    } else {\n        int len = (1 << n) - 1;\n        int base = (1 << (n - 1)) - 1;\n        if (k == base + 1) {\n            return '1';\n        } else if (k <= base) {\n            return dfs(n - 1, k);\n        } else {\n            return dfs(n - 1, len - k + 1) ^ 1;\n        }\n    }\n}\n\nchar findKthBit(int n, int k) {\n    return dfs(n, k);\n}\n```\n\n","slug":"contest201","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q72000fw5ih3h1zgn5l","content":"<p>Leetcode201.</p>\n<a id=\"more\"></a>\n\n<h1 id=\"1544-Make-The-String-Great\"><a href=\"#1544-Make-The-String-Great\" class=\"headerlink\" title=\"1544 Make The String Great\"></a>1544 Make The String Great</h1><p>Given a string <code>s</code> of lower and upper case English letters.</p>\n<p>A good string is a string which doesnt have <strong>two adjacent characters</strong> <code>s[i]</code> and <code>s[i + 1]</code> where:</p>\n<ul>\n<li><code>0 &lt;= i &lt;= s.length - 2</code></li>\n<li><code>s[i]</code> is a lower-case letter and <code>s[i + 1]</code> is the same letter but in upper-case or <strong>vice-versa</strong>.</li>\n</ul>\n<p>To make the string good, you can choose <strong>two adjacent</strong> characters that make the string bad and remove them. You can keep doing this until the string becomes good.</p>\n<p>Return <em>the string</em> after making it good. The answer is guaranteed to be unique under the given constraints.</p>\n<p><strong>Notice</strong> that an empty string is also good.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: s &#x3D; &quot;leEeetcode&quot;</span><br><span class=\"line\">Output: &quot;leetcode&quot;</span><br><span class=\"line\">Explanation: In the first step, either you choose i &#x3D; 1 or i &#x3D; 2, both will result &quot;leEeetcode&quot; to be reduced to &quot;leetcode&quot;.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: s &#x3D; &quot;abBAcC&quot;</span><br><span class=\"line\">Output: &quot;&quot;</span><br><span class=\"line\">Explanation: We have many possible scenarios, and all lead to the same answer. For example:</span><br><span class=\"line\">&quot;abBAcC&quot; --&gt; &quot;aAcC&quot; --&gt; &quot;cC&quot; --&gt; &quot;&quot;</span><br><span class=\"line\">&quot;abBAcC&quot; --&gt; &quot;abBA&quot; --&gt; &quot;aA&quot; --&gt; &quot;&quot;</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: s &#x3D; &quot;s&quot;</span><br><span class=\"line\">Output: &quot;s&quot;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Solution\"><a href=\"#Solution\" class=\"headerlink\" title=\"Solution\"></a>Solution</h2><ul>\n<li><code>vice-versa</code><strong></strong></li>\n<li><code>example 2</code><em></em></li>\n</ul>\n<h3 id=\"mine\"><a href=\"#mine\" class=\"headerlink\" title=\"mine\"></a>mine</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">makeGood</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">    Stack&lt;Character&gt; stack = <span class=\"keyword\">new</span> Stack&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c = s.charAt(i);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!stack.empty() &amp;&amp; (</span><br><span class=\"line\">                (Character.isUpperCase(c) &amp;&amp; Character.isLowerCase(stack.peek()) &amp;&amp; ((stack.peek() - <span class=\"string\">&#x27;a&#x27;</span>) == (c - <span class=\"string\">&#x27;A&#x27;</span>)))</span><br><span class=\"line\">                        ||</span><br><span class=\"line\">                        (Character.isLowerCase(c) &amp;&amp; Character.isUpperCase(stack.peek()) &amp;&amp; ((stack.peek() - <span class=\"string\">&#x27;A&#x27;</span>) == (c - <span class=\"string\">&#x27;a&#x27;</span>)))</span><br><span class=\"line\">        )) &#123;</span><br><span class=\"line\">            stack.pop();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            stack.push(c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Iterator&lt;Character&gt; iterator = stack.iterator();</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (iterator.hasNext()) &#123;</span><br><span class=\"line\">        sb.append(iterator.next());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t<span class=\"comment\">// iteratorreverse()</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"better\"><a href=\"#better\" class=\"headerlink\" title=\"better\"></a>better</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">boolean</span> ch = <span class=\"keyword\">true</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (ch) &#123;</span><br><span class=\"line\">    ch = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    String t = s;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; s.length() - <span class=\"number\">1</span>; ++i) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s.charAt(i) + <span class=\"number\">32</span> == s.charAt(i + <span class=\"number\">1</span>) || s.charAt(i + <span class=\"number\">1</span>) + <span class=\"number\">32</span> == s.charAt(i)) &#123;</span><br><span class=\"line\">            t = s.substring(<span class=\"number\">0</span>, i) + s.substring(i + <span class=\"number\">2</span>);</span><br><span class=\"line\">            ch = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    s = t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">return</span> s;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"1545-Find-Kth-Bit-in-Nth-Binary-String\"><a href=\"#1545-Find-Kth-Bit-in-Nth-Binary-String\" class=\"headerlink\" title=\"1545 Find Kth Bit in Nth Binary String\"></a>1545 Find Kth Bit in Nth Binary String</h1><p>Given two positive integers <code>n</code> and <code>k</code>, the binary string <code>Sn</code> is formed as follows:</p>\n<ul>\n<li><code>S1 = &quot;0&quot;</code></li>\n<li><code>Si = Si-1 + &quot;1&quot; + reverse(invert(Si-1))</code> for <code>i &gt; 1</code></li>\n</ul>\n<p>Where <code>+</code> denotes the concatenation operation, <code>reverse(x)</code> returns the reversed string x, and <code>invert(x)</code> inverts all the bits in x (0 changes to 1 and 1 changes to 0).</p>\n<p>For example, the first 4 strings in the above sequence are:</p>\n<ul>\n<li>S1 = 0</li>\n<li>S2 = 0<strong>1</strong>1</li>\n<li>S3 = 011<strong>1</strong>001</li>\n<li>S4 = 0111001<strong>1</strong>0110001</li>\n</ul>\n<p>Return <em>the</em> <code>kth</code> <em>bit</em> <em>in</em> <code>Sn</code>. It is guaranteed that <code>k</code> is valid for the given <code>n</code>.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 3, k &#x3D; 1</span><br><span class=\"line\">Output: &quot;0&quot;</span><br><span class=\"line\">Explanation: S3 is &quot;0111001&quot;. The first bit is &quot;0&quot;.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 4, k &#x3D; 11</span><br><span class=\"line\">Output: &quot;1&quot;</span><br><span class=\"line\">Explanation: S4 is &quot;011100110110001&quot;. The 11th bit is &quot;1&quot;.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 1, k &#x3D; 1</span><br><span class=\"line\">Output: &quot;0&quot;</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 4:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 2, k &#x3D; 3</span><br><span class=\"line\">Output: &quot;1&quot;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Solution-1\"><a href=\"#Solution-1\" class=\"headerlink\" title=\"Solution\"></a>Solution</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder(<span class=\"string\">&quot;0&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> integer = Integer.parseInt(sb.toString());</span><br><span class=\"line\">        StringBuilder stringBuilder = <span class=\"keyword\">new</span> StringBuilder(Integer.toBinaryString(integer));</span><br><span class=\"line\">        <span class=\"comment\">// 0-1 inverse</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; stringBuilder.length(); i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (stringBuilder.charAt(i) == <span class=\"string\">&#x27;0&#x27;</span>) &#123;</span><br><span class=\"line\">                stringBuilder.replace(i, i + <span class=\"number\">1</span>, <span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                stringBuilder.replace(i, i + <span class=\"number\">1</span>, <span class=\"string\">&quot;0&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        stringBuilder.reverse();</span><br><span class=\"line\">        sb.append(<span class=\"string\">&quot;1&quot;</span>).append(stringBuilder);</span><br><span class=\"line\">        n--;</span><br><span class=\"line\">        System.out.println(sb.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">char</span>[] chars = sb.toString().toCharArray();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> chars[k - <span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>n=4</p>\n<h3 id=\"better-1\"><a href=\"#better-1\" class=\"headerlink\" title=\"better\"></a>better</h3><p><code>0-1</code><code></code></p>\n<ul>\n<li> ^ 00<code>1</code><code>0-1</code></li>\n</ul>\n<h4 id=\"method-1\"><a href=\"#method-1\" class=\"headerlink\" title=\"method 1\"></a>method 1</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    String s = <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n&gt;<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        --n;</span><br><span class=\"line\">        s = s+<span class=\"string\">&quot;1&quot;</span>+sinv(s);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 0k-1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s.charAt(k-<span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sinv</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder a = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    <span class=\"comment\">// reverse()</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = s.length()-<span class=\"number\">1</span>; i&gt;=<span class=\"number\">0</span>; --i) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c = s.charAt(i);</span><br><span class=\"line\">        <span class=\"comment\">// 0-1</span></span><br><span class=\"line\">        c^=<span class=\"number\">1</span>;</span><br><span class=\"line\">        a.append(c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a.toString();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"method-2\"><a href=\"#method-2\" class=\"headerlink\" title=\"method 2\"></a>method 2</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span></span><br><span class=\"line\"><span class=\"function\">    s[1]</span>=<span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">    t[<span class=\"number\">1</span>]=<span class=\"string\">&quot;1&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        s[i]=s[i-<span class=\"number\">1</span>];</span><br><span class=\"line\">        s[i]+=<span class=\"string\">&#x27;1&#x27;</span>;</span><br><span class=\"line\">        s[i]+=t[i-<span class=\"number\">1</span>];</span><br><span class=\"line\">        t[i]=s[i-<span class=\"number\">1</span>];</span><br><span class=\"line\">        t[i]+=<span class=\"string\">&#x27;0&#x27;</span>;</span><br><span class=\"line\">        t[i]+=t[i-<span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s[n][k-<span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"method-3\"><a href=\"#method-3\" class=\"headerlink\" title=\"method 3\"></a>method 3</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">char</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&#x27;0&#x27;</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> len = (<span class=\"number\">1</span> &lt;&lt; n) - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> base = (<span class=\"number\">1</span> &lt;&lt; (n - <span class=\"number\">1</span>)) - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (k == base + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&#x27;1&#x27;</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (k &lt;= base) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> dfs(n - <span class=\"number\">1</span>, k);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> dfs(n - <span class=\"number\">1</span>, len - k + <span class=\"number\">1</span>) ^ <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> dfs(n, k);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>Leetcode201.</p>","more":"<h1 id=\"1544-Make-The-String-Great\"><a href=\"#1544-Make-The-String-Great\" class=\"headerlink\" title=\"1544 Make The String Great\"></a>1544 Make The String Great</h1><p>Given a string <code>s</code> of lower and upper case English letters.</p>\n<p>A good string is a string which doesnt have <strong>two adjacent characters</strong> <code>s[i]</code> and <code>s[i + 1]</code> where:</p>\n<ul>\n<li><code>0 &lt;= i &lt;= s.length - 2</code></li>\n<li><code>s[i]</code> is a lower-case letter and <code>s[i + 1]</code> is the same letter but in upper-case or <strong>vice-versa</strong>.</li>\n</ul>\n<p>To make the string good, you can choose <strong>two adjacent</strong> characters that make the string bad and remove them. You can keep doing this until the string becomes good.</p>\n<p>Return <em>the string</em> after making it good. The answer is guaranteed to be unique under the given constraints.</p>\n<p><strong>Notice</strong> that an empty string is also good.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: s &#x3D; &quot;leEeetcode&quot;</span><br><span class=\"line\">Output: &quot;leetcode&quot;</span><br><span class=\"line\">Explanation: In the first step, either you choose i &#x3D; 1 or i &#x3D; 2, both will result &quot;leEeetcode&quot; to be reduced to &quot;leetcode&quot;.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: s &#x3D; &quot;abBAcC&quot;</span><br><span class=\"line\">Output: &quot;&quot;</span><br><span class=\"line\">Explanation: We have many possible scenarios, and all lead to the same answer. For example:</span><br><span class=\"line\">&quot;abBAcC&quot; --&gt; &quot;aAcC&quot; --&gt; &quot;cC&quot; --&gt; &quot;&quot;</span><br><span class=\"line\">&quot;abBAcC&quot; --&gt; &quot;abBA&quot; --&gt; &quot;aA&quot; --&gt; &quot;&quot;</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: s &#x3D; &quot;s&quot;</span><br><span class=\"line\">Output: &quot;s&quot;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Solution\"><a href=\"#Solution\" class=\"headerlink\" title=\"Solution\"></a>Solution</h2><ul>\n<li><code>vice-versa</code><strong></strong></li>\n<li><code>example 2</code><em></em></li>\n</ul>\n<h3 id=\"mine\"><a href=\"#mine\" class=\"headerlink\" title=\"mine\"></a>mine</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">makeGood</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">    Stack&lt;Character&gt; stack = <span class=\"keyword\">new</span> Stack&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c = s.charAt(i);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!stack.empty() &amp;&amp; (</span><br><span class=\"line\">                (Character.isUpperCase(c) &amp;&amp; Character.isLowerCase(stack.peek()) &amp;&amp; ((stack.peek() - <span class=\"string\">&#x27;a&#x27;</span>) == (c - <span class=\"string\">&#x27;A&#x27;</span>)))</span><br><span class=\"line\">                        ||</span><br><span class=\"line\">                        (Character.isLowerCase(c) &amp;&amp; Character.isUpperCase(stack.peek()) &amp;&amp; ((stack.peek() - <span class=\"string\">&#x27;A&#x27;</span>) == (c - <span class=\"string\">&#x27;a&#x27;</span>)))</span><br><span class=\"line\">        )) &#123;</span><br><span class=\"line\">            stack.pop();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            stack.push(c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Iterator&lt;Character&gt; iterator = stack.iterator();</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (iterator.hasNext()) &#123;</span><br><span class=\"line\">        sb.append(iterator.next());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t<span class=\"comment\">// iteratorreverse()</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"better\"><a href=\"#better\" class=\"headerlink\" title=\"better\"></a>better</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">boolean</span> ch = <span class=\"keyword\">true</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (ch) &#123;</span><br><span class=\"line\">    ch = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    String t = s;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; s.length() - <span class=\"number\">1</span>; ++i) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s.charAt(i) + <span class=\"number\">32</span> == s.charAt(i + <span class=\"number\">1</span>) || s.charAt(i + <span class=\"number\">1</span>) + <span class=\"number\">32</span> == s.charAt(i)) &#123;</span><br><span class=\"line\">            t = s.substring(<span class=\"number\">0</span>, i) + s.substring(i + <span class=\"number\">2</span>);</span><br><span class=\"line\">            ch = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    s = t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">return</span> s;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"1545-Find-Kth-Bit-in-Nth-Binary-String\"><a href=\"#1545-Find-Kth-Bit-in-Nth-Binary-String\" class=\"headerlink\" title=\"1545 Find Kth Bit in Nth Binary String\"></a>1545 Find Kth Bit in Nth Binary String</h1><p>Given two positive integers <code>n</code> and <code>k</code>, the binary string <code>Sn</code> is formed as follows:</p>\n<ul>\n<li><code>S1 = &quot;0&quot;</code></li>\n<li><code>Si = Si-1 + &quot;1&quot; + reverse(invert(Si-1))</code> for <code>i &gt; 1</code></li>\n</ul>\n<p>Where <code>+</code> denotes the concatenation operation, <code>reverse(x)</code> returns the reversed string x, and <code>invert(x)</code> inverts all the bits in x (0 changes to 1 and 1 changes to 0).</p>\n<p>For example, the first 4 strings in the above sequence are:</p>\n<ul>\n<li>S1 = 0</li>\n<li>S2 = 0<strong>1</strong>1</li>\n<li>S3 = 011<strong>1</strong>001</li>\n<li>S4 = 0111001<strong>1</strong>0110001</li>\n</ul>\n<p>Return <em>the</em> <code>kth</code> <em>bit</em> <em>in</em> <code>Sn</code>. It is guaranteed that <code>k</code> is valid for the given <code>n</code>.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 3, k &#x3D; 1</span><br><span class=\"line\">Output: &quot;0&quot;</span><br><span class=\"line\">Explanation: S3 is &quot;0111001&quot;. The first bit is &quot;0&quot;.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 4, k &#x3D; 11</span><br><span class=\"line\">Output: &quot;1&quot;</span><br><span class=\"line\">Explanation: S4 is &quot;011100110110001&quot;. The 11th bit is &quot;1&quot;.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 1, k &#x3D; 1</span><br><span class=\"line\">Output: &quot;0&quot;</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 4:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 2, k &#x3D; 3</span><br><span class=\"line\">Output: &quot;1&quot;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Solution-1\"><a href=\"#Solution-1\" class=\"headerlink\" title=\"Solution\"></a>Solution</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder(<span class=\"string\">&quot;0&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> integer = Integer.parseInt(sb.toString());</span><br><span class=\"line\">        StringBuilder stringBuilder = <span class=\"keyword\">new</span> StringBuilder(Integer.toBinaryString(integer));</span><br><span class=\"line\">        <span class=\"comment\">// 0-1 inverse</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; stringBuilder.length(); i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (stringBuilder.charAt(i) == <span class=\"string\">&#x27;0&#x27;</span>) &#123;</span><br><span class=\"line\">                stringBuilder.replace(i, i + <span class=\"number\">1</span>, <span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                stringBuilder.replace(i, i + <span class=\"number\">1</span>, <span class=\"string\">&quot;0&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        stringBuilder.reverse();</span><br><span class=\"line\">        sb.append(<span class=\"string\">&quot;1&quot;</span>).append(stringBuilder);</span><br><span class=\"line\">        n--;</span><br><span class=\"line\">        System.out.println(sb.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">char</span>[] chars = sb.toString().toCharArray();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> chars[k - <span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>n=4</p>\n<h3 id=\"better-1\"><a href=\"#better-1\" class=\"headerlink\" title=\"better\"></a>better</h3><p><code>0-1</code><code></code></p>\n<ul>\n<li> ^ 00<code>1</code><code>0-1</code></li>\n</ul>\n<h4 id=\"method-1\"><a href=\"#method-1\" class=\"headerlink\" title=\"method 1\"></a>method 1</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    String s = <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n&gt;<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        --n;</span><br><span class=\"line\">        s = s+<span class=\"string\">&quot;1&quot;</span>+sinv(s);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 0k-1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s.charAt(k-<span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sinv</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder a = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    <span class=\"comment\">// reverse()</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = s.length()-<span class=\"number\">1</span>; i&gt;=<span class=\"number\">0</span>; --i) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c = s.charAt(i);</span><br><span class=\"line\">        <span class=\"comment\">// 0-1</span></span><br><span class=\"line\">        c^=<span class=\"number\">1</span>;</span><br><span class=\"line\">        a.append(c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a.toString();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"method-2\"><a href=\"#method-2\" class=\"headerlink\" title=\"method 2\"></a>method 2</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span></span><br><span class=\"line\"><span class=\"function\">    s[1]</span>=<span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">    t[<span class=\"number\">1</span>]=<span class=\"string\">&quot;1&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        s[i]=s[i-<span class=\"number\">1</span>];</span><br><span class=\"line\">        s[i]+=<span class=\"string\">&#x27;1&#x27;</span>;</span><br><span class=\"line\">        s[i]+=t[i-<span class=\"number\">1</span>];</span><br><span class=\"line\">        t[i]=s[i-<span class=\"number\">1</span>];</span><br><span class=\"line\">        t[i]+=<span class=\"string\">&#x27;0&#x27;</span>;</span><br><span class=\"line\">        t[i]+=t[i-<span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s[n][k-<span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"method-3\"><a href=\"#method-3\" class=\"headerlink\" title=\"method 3\"></a>method 3</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">char</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&#x27;0&#x27;</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> len = (<span class=\"number\">1</span> &lt;&lt; n) - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> base = (<span class=\"number\">1</span> &lt;&lt; (n - <span class=\"number\">1</span>)) - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (k == base + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&#x27;1&#x27;</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (k &lt;= base) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> dfs(n - <span class=\"number\">1</span>, k);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> dfs(n - <span class=\"number\">1</span>, len - k + <span class=\"number\">1</span>) ^ <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">char</span> <span class=\"title\">findKthBit</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> dfs(n, k);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"contest202","date":"2020-08-16T06:36:31.000Z","_content":"\nLeetocode202\n\n<!--more-->\n\n# 1550. Three Consecutive Odds\n\nGiven an integer array `arr`, return `true` if there are three consecutive odd numbers in the array. Otherwise, return `false`.\n\n**Example 1:**\n\n```\nInput: arr = [2,6,4,1]\nOutput: false\nExplanation: There are no three consecutive odds.\n```\n\n**Example 2:**\n\n```\nInput: arr = [1,2,34,3,4,5,7,23,12]\nOutput: true\nExplanation: [5,7,23] are three consecutive odds.\n```\n\n## solution\n\ntruefalse\n\n```java\npublic boolean threeConsecutiveOdds(int[] a) {\n    for(int i = 0;i+2 < a.length;i++){\n        if(a[i]%2 + a[i+1] % 2 + a[i+2] % 2 == 3){\n            return true;\n        }\n    }\n    return false;\n}\n```\n\nrank\n\nfor `i+2<a.length``+2`,forii21,3,\n\n**note:** \n\n\n\n# 1551. Minimum Operations to Make Array Equal\n\nYou have an array `arr` of length `n` where `arr[i] = (2 * i) + 1` for all valid values of `i` (i.e. `0 <= i < n`).\n\nIn one operation, you can select two indices `x` and `y` where `0 <= x, y < n` and subtract `1` from `arr[x]` and add `1` to `arr[y]` (i.e. perform `arr[x] -=1 `and `arr[y] += 1`). The goal is to make all the elements of the array **equal**. It is **guaranteed** that all the elements of the array can be made equal using some operations.\n\nGiven an integer `n`, the length of the array. Return *the minimum number of operations* needed to make all the elements of arr equal.\n\n**Example 1:**\n\n```\nInput: n = 3\nOutput: 2\nExplanation: arr = [1, 3, 5]\nFirst operation choose x = 2 and y = 0, this leads arr to be [2, 3, 4]\nIn the second operation choose x = 2 and y = 0 again, thus arr = [3, 3, 3].\n```\n\n**Example 2:**\n\n```\nInput: n = 6\nOutput: 9\n```\n\n## solution\n\n``n=6output=9\n\n```java\npublic int minOperations(int n) {\n    // Take care of overflow if n is too large.\n    if(n%2==1){\n        n/=2;\n        return (n*(n+1));\n    }        \n    n/=2;\n    return n*n;\n}\n```\n\n-- ","source":"_posts/contest202.md","raw":"---\ntitle: contest202\ndate: 2020-08-16 14:36:31\ncategories: Leetcode\ntags: algorithm\n---\n\nLeetocode202\n\n<!--more-->\n\n# 1550. Three Consecutive Odds\n\nGiven an integer array `arr`, return `true` if there are three consecutive odd numbers in the array. Otherwise, return `false`.\n\n**Example 1:**\n\n```\nInput: arr = [2,6,4,1]\nOutput: false\nExplanation: There are no three consecutive odds.\n```\n\n**Example 2:**\n\n```\nInput: arr = [1,2,34,3,4,5,7,23,12]\nOutput: true\nExplanation: [5,7,23] are three consecutive odds.\n```\n\n## solution\n\ntruefalse\n\n```java\npublic boolean threeConsecutiveOdds(int[] a) {\n    for(int i = 0;i+2 < a.length;i++){\n        if(a[i]%2 + a[i+1] % 2 + a[i+2] % 2 == 3){\n            return true;\n        }\n    }\n    return false;\n}\n```\n\nrank\n\nfor `i+2<a.length``+2`,forii21,3,\n\n**note:** \n\n\n\n# 1551. Minimum Operations to Make Array Equal\n\nYou have an array `arr` of length `n` where `arr[i] = (2 * i) + 1` for all valid values of `i` (i.e. `0 <= i < n`).\n\nIn one operation, you can select two indices `x` and `y` where `0 <= x, y < n` and subtract `1` from `arr[x]` and add `1` to `arr[y]` (i.e. perform `arr[x] -=1 `and `arr[y] += 1`). The goal is to make all the elements of the array **equal**. It is **guaranteed** that all the elements of the array can be made equal using some operations.\n\nGiven an integer `n`, the length of the array. Return *the minimum number of operations* needed to make all the elements of arr equal.\n\n**Example 1:**\n\n```\nInput: n = 3\nOutput: 2\nExplanation: arr = [1, 3, 5]\nFirst operation choose x = 2 and y = 0, this leads arr to be [2, 3, 4]\nIn the second operation choose x = 2 and y = 0 again, thus arr = [3, 3, 3].\n```\n\n**Example 2:**\n\n```\nInput: n = 6\nOutput: 9\n```\n\n## solution\n\n``n=6output=9\n\n```java\npublic int minOperations(int n) {\n    // Take care of overflow if n is too large.\n    if(n%2==1){\n        n/=2;\n        return (n*(n+1));\n    }        \n    n/=2;\n    return n*n;\n}\n```\n\n-- ","slug":"contest202","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q74000iw5ih3umqdncr","content":"<p>Leetocode202</p>\n<a id=\"more\"></a>\n\n<h1 id=\"1550-Three-Consecutive-Odds\"><a href=\"#1550-Three-Consecutive-Odds\" class=\"headerlink\" title=\"1550. Three Consecutive Odds\"></a>1550. Three Consecutive Odds</h1><p>Given an integer array <code>arr</code>, return <code>true</code> if there are three consecutive odd numbers in the array. Otherwise, return <code>false</code>.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr &#x3D; [2,6,4,1]</span><br><span class=\"line\">Output: false</span><br><span class=\"line\">Explanation: There are no three consecutive odds.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr &#x3D; [1,2,34,3,4,5,7,23,12]</span><br><span class=\"line\">Output: true</span><br><span class=\"line\">Explanation: [5,7,23] are three consecutive odds.</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"solution\"><a href=\"#solution\" class=\"headerlink\" title=\"solution\"></a>solution</h2><p>truefalse</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">threeConsecutiveOdds</span><span class=\"params\">(<span class=\"keyword\">int</span>[] a)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;i+<span class=\"number\">2</span> &lt; a.length;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(a[i]%<span class=\"number\">2</span> + a[i+<span class=\"number\">1</span>] % <span class=\"number\">2</span> + a[i+<span class=\"number\">2</span>] % <span class=\"number\">2</span> == <span class=\"number\">3</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>rank</p>\n<p>for <code>i+2&lt;a.length</code><code>+2</code>,forii21,3,</p>\n<p><strong>note:</strong> </p>\n<h1 id=\"1551-Minimum-Operations-to-Make-Array-Equal\"><a href=\"#1551-Minimum-Operations-to-Make-Array-Equal\" class=\"headerlink\" title=\"1551. Minimum Operations to Make Array Equal\"></a>1551. Minimum Operations to Make Array Equal</h1><p>You have an array <code>arr</code> of length <code>n</code> where <code>arr[i] = (2 * i) + 1</code> for all valid values of <code>i</code> (i.e. <code>0 &lt;= i &lt; n</code>).</p>\n<p>In one operation, you can select two indices <code>x</code> and <code>y</code> where <code>0 &lt;= x, y &lt; n</code> and subtract <code>1</code> from <code>arr[x]</code> and add <code>1</code> to <code>arr[y]</code> (i.e. perform <code>arr[x] -=1 </code>and <code>arr[y] += 1</code>). The goal is to make all the elements of the array <strong>equal</strong>. It is <strong>guaranteed</strong> that all the elements of the array can be made equal using some operations.</p>\n<p>Given an integer <code>n</code>, the length of the array. Return <em>the minimum number of operations</em> needed to make all the elements of arr equal.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 3</span><br><span class=\"line\">Output: 2</span><br><span class=\"line\">Explanation: arr &#x3D; [1, 3, 5]</span><br><span class=\"line\">First operation choose x &#x3D; 2 and y &#x3D; 0, this leads arr to be [2, 3, 4]</span><br><span class=\"line\">In the second operation choose x &#x3D; 2 and y &#x3D; 0 again, thus arr &#x3D; [3, 3, 3].</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 6</span><br><span class=\"line\">Output: 9</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"solution-1\"><a href=\"#solution-1\" class=\"headerlink\" title=\"solution\"></a>solution</h2><p><code></code>n=6output=9</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Take care of overflow if n is too large.</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n%<span class=\"number\">2</span>==<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        n/=<span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (n*(n+<span class=\"number\">1</span>));</span><br><span class=\"line\">    &#125;        </span><br><span class=\"line\">    n/=<span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> n*n;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>Leetocode202</p>","more":"<h1 id=\"1550-Three-Consecutive-Odds\"><a href=\"#1550-Three-Consecutive-Odds\" class=\"headerlink\" title=\"1550. Three Consecutive Odds\"></a>1550. Three Consecutive Odds</h1><p>Given an integer array <code>arr</code>, return <code>true</code> if there are three consecutive odd numbers in the array. Otherwise, return <code>false</code>.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr &#x3D; [2,6,4,1]</span><br><span class=\"line\">Output: false</span><br><span class=\"line\">Explanation: There are no three consecutive odds.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: arr &#x3D; [1,2,34,3,4,5,7,23,12]</span><br><span class=\"line\">Output: true</span><br><span class=\"line\">Explanation: [5,7,23] are three consecutive odds.</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"solution\"><a href=\"#solution\" class=\"headerlink\" title=\"solution\"></a>solution</h2><p>truefalse</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">threeConsecutiveOdds</span><span class=\"params\">(<span class=\"keyword\">int</span>[] a)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;i+<span class=\"number\">2</span> &lt; a.length;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(a[i]%<span class=\"number\">2</span> + a[i+<span class=\"number\">1</span>] % <span class=\"number\">2</span> + a[i+<span class=\"number\">2</span>] % <span class=\"number\">2</span> == <span class=\"number\">3</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>rank</p>\n<p>for <code>i+2&lt;a.length</code><code>+2</code>,forii21,3,</p>\n<p><strong>note:</strong> </p>\n<h1 id=\"1551-Minimum-Operations-to-Make-Array-Equal\"><a href=\"#1551-Minimum-Operations-to-Make-Array-Equal\" class=\"headerlink\" title=\"1551. Minimum Operations to Make Array Equal\"></a>1551. Minimum Operations to Make Array Equal</h1><p>You have an array <code>arr</code> of length <code>n</code> where <code>arr[i] = (2 * i) + 1</code> for all valid values of <code>i</code> (i.e. <code>0 &lt;= i &lt; n</code>).</p>\n<p>In one operation, you can select two indices <code>x</code> and <code>y</code> where <code>0 &lt;= x, y &lt; n</code> and subtract <code>1</code> from <code>arr[x]</code> and add <code>1</code> to <code>arr[y]</code> (i.e. perform <code>arr[x] -=1 </code>and <code>arr[y] += 1</code>). The goal is to make all the elements of the array <strong>equal</strong>. It is <strong>guaranteed</strong> that all the elements of the array can be made equal using some operations.</p>\n<p>Given an integer <code>n</code>, the length of the array. Return <em>the minimum number of operations</em> needed to make all the elements of arr equal.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 3</span><br><span class=\"line\">Output: 2</span><br><span class=\"line\">Explanation: arr &#x3D; [1, 3, 5]</span><br><span class=\"line\">First operation choose x &#x3D; 2 and y &#x3D; 0, this leads arr to be [2, 3, 4]</span><br><span class=\"line\">In the second operation choose x &#x3D; 2 and y &#x3D; 0 again, thus arr &#x3D; [3, 3, 3].</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 6</span><br><span class=\"line\">Output: 9</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"solution-1\"><a href=\"#solution-1\" class=\"headerlink\" title=\"solution\"></a>solution</h2><p><code></code>n=6output=9</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Take care of overflow if n is too large.</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n%<span class=\"number\">2</span>==<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        n/=<span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (n*(n+<span class=\"number\">1</span>));</span><br><span class=\"line\">    &#125;        </span><br><span class=\"line\">    n/=<span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> n*n;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> </p>"},{"title":"contest203","date":"2020-08-23T04:22:22.000Z","_content":"\nLeetcode203\n\n<!--more-->\n\n# 1560. Most Visited Sector in a Circular Track\n\nGiven an integer `n` and an integer array `rounds`. We have a circular track which consists of `n` sectors labeled from `1` to `n`. A marathon will be held on this track, the marathon consists of `m` rounds. The `ith` round starts at sector `rounds[i - 1]` and ends at sector `rounds[i]`. For example, round 1 starts at sector `rounds[0]` and ends at sector `rounds[1]`\n\nReturn *an array of the most visited sectors* sorted in **ascending** order.\n\nNotice that you circulate the track in ascending order of sector numbers in the counter-clockwise direction (See the first example).\n\n**Example 1:**\n\n![img](https://assets.leetcode.com/uploads/2020/08/14/tmp.jpg)\n\n```\nInput: n = 4, rounds = [1,3,1,2]\nOutput: [1,2]\nExplanation: The marathon starts at sector 1. The order of the visited sectors is as follows:\n1 --> 2 --> 3 (end of round 1) --> 4 --> 1 (end of round 2) --> 2 (end of round 3 and the marathon)\nWe can see that both sectors 1 and 2 are visited twice and they are the most visited sectors. Sectors 3 and 4 are visited only once.\n```\n\n**Example 2:**\n\n```\nInput: n = 2, rounds = [2,1,2,1,2,1,2,1,2]\nOutput: [2]\n```\n\n**Example 3:**\n\n```\nInput: n = 7, rounds = [1,3,5,7]\nOutput: [1,2,3,4,5,6,7]\n```\n\n## solution\n\n`easy`sectors\n\n```java\npublic List<Integer> mostVisited(int n, int[] rounds) {\n    // \n    int f = rounds[0], t = rounds[rounds.length-1];\n    List<Integer> ret = new ArrayList<>();\n    for(int i = f;;){\n        ret.add(i);\n        if(i == t)break;\n        i++;\n        if(i == n+1)i = 1;\n    }\n    Collections.sort(ret);\n    return ret;\n}\n```\n\nemmmm\n\n```java\npublic List<Integer> mostVisited(int n, int[] A) {\n    List<Integer> res = new ArrayList<>();\n    for (int i = A[0]; i <= A[A.length - 1]; ++i)\n        res.add(i);\n    if (res.size() > 0) return res;\n    // start>end[1, end] + [start, n]\n    for (int i = 1; i <= A[A.length - 1]; ++i)\n        res.add(i);\n    for (int i = A[0]; i <= n; ++i)\n        res.add(i);\n    return res;\n}\n```\n\nsector\n\n- start<=end\\[start, end\\]\n- start>end\\[start, n\\]+\\[1, end\\]\n\n\n\n```java\npublic List<Integer> mostVisited(int n, int[] rounds) {\n    int len = rounds.length, fr = rounds[0], to = rounds[len - 1];\n    List<Integer> res = new ArrayList<>();\n    if (to >= fr) {     // no circle, such as [1,3,1,2]\n        for (int i = fr; i <= to; i++) res.add(i);\n    } else {            // cross a circle, such as [2,3,2,1]\n        // sector\n        for (int i = 1; i <= n; i++) {\n            // sector\n            if (i == to + 1) i = fr;\n            res.add(i);\n        }\n    }\n    return res;\n}\n```\n\n``nsectorround\n\n\n\n# 1561. Maximum Number of Coins You Can Get\n\nThere are 3n piles of coins of varying size, you and your friends will take piles of coins as follows:\n\n- In each step, you will choose **any** 3 piles of coins (not necessarily consecutive).\n- Of your choice, Alice will pick the pile with the maximum number of coins.\n- You will pick the next pile with maximum number of coins.\n- Your friend Bob will pick the last pile.\n- Repeat until there are no more piles of coins.\n\nGiven an array of integers `piles` where `piles[i]` is the number of coins in the `ith` pile.\n\nReturn the maximum number of coins which you can have.\n\n \n\n**Example 1:**\n\n```\nInput: piles = [2,4,1,2,7,8]\nOutput: 9\nExplanation: Choose the triplet (2, 7, 8), Alice Pick the pile with 8 coins, you the pile with 7 coins and Bob the last one.\nChoose the triplet (1, 2, 4), Alice Pick the pile with 4 coins, you the pile with 2 coins and Bob the last one.\nThe maximum number of coins which you can have are: 7 + 2 = 9.\nOn the other hand if we choose this arrangement (1, 2, 8), (2, 4, 7) you only get 2 + 4 = 6 coins which is not optimal.\n```\n\n**Example 2:**\n\n```\nInput: piles = [2,4,5]\nOutput: 4\n```\n\n**Example 3:**\n\n```\nInput: piles = [9,8,7,6,5,1,2,3,4]\nOutput: 18\n```\n\n\n\n## solution\n\n\n\nexample1*[1,2,2,4,7,8]*BobAliceAlice\n\n```java\npublic int maxCoins(int[] A) {\n    Arrays.sort(A);\n    int res = 0, n = A.length;\n    for (int i = n / 3; i < n; i += 2)\n        res += A[i];\n    return res;\n}\n```\n\n","source":"_posts/contest203.md","raw":"---\ntitle: contest203\ndate: 2020-08-23 12:22:22\ntags: LeetCode\n---\n\nLeetcode203\n\n<!--more-->\n\n# 1560. Most Visited Sector in a Circular Track\n\nGiven an integer `n` and an integer array `rounds`. We have a circular track which consists of `n` sectors labeled from `1` to `n`. A marathon will be held on this track, the marathon consists of `m` rounds. The `ith` round starts at sector `rounds[i - 1]` and ends at sector `rounds[i]`. For example, round 1 starts at sector `rounds[0]` and ends at sector `rounds[1]`\n\nReturn *an array of the most visited sectors* sorted in **ascending** order.\n\nNotice that you circulate the track in ascending order of sector numbers in the counter-clockwise direction (See the first example).\n\n**Example 1:**\n\n![img](https://assets.leetcode.com/uploads/2020/08/14/tmp.jpg)\n\n```\nInput: n = 4, rounds = [1,3,1,2]\nOutput: [1,2]\nExplanation: The marathon starts at sector 1. The order of the visited sectors is as follows:\n1 --> 2 --> 3 (end of round 1) --> 4 --> 1 (end of round 2) --> 2 (end of round 3 and the marathon)\nWe can see that both sectors 1 and 2 are visited twice and they are the most visited sectors. Sectors 3 and 4 are visited only once.\n```\n\n**Example 2:**\n\n```\nInput: n = 2, rounds = [2,1,2,1,2,1,2,1,2]\nOutput: [2]\n```\n\n**Example 3:**\n\n```\nInput: n = 7, rounds = [1,3,5,7]\nOutput: [1,2,3,4,5,6,7]\n```\n\n## solution\n\n`easy`sectors\n\n```java\npublic List<Integer> mostVisited(int n, int[] rounds) {\n    // \n    int f = rounds[0], t = rounds[rounds.length-1];\n    List<Integer> ret = new ArrayList<>();\n    for(int i = f;;){\n        ret.add(i);\n        if(i == t)break;\n        i++;\n        if(i == n+1)i = 1;\n    }\n    Collections.sort(ret);\n    return ret;\n}\n```\n\nemmmm\n\n```java\npublic List<Integer> mostVisited(int n, int[] A) {\n    List<Integer> res = new ArrayList<>();\n    for (int i = A[0]; i <= A[A.length - 1]; ++i)\n        res.add(i);\n    if (res.size() > 0) return res;\n    // start>end[1, end] + [start, n]\n    for (int i = 1; i <= A[A.length - 1]; ++i)\n        res.add(i);\n    for (int i = A[0]; i <= n; ++i)\n        res.add(i);\n    return res;\n}\n```\n\nsector\n\n- start<=end\\[start, end\\]\n- start>end\\[start, n\\]+\\[1, end\\]\n\n\n\n```java\npublic List<Integer> mostVisited(int n, int[] rounds) {\n    int len = rounds.length, fr = rounds[0], to = rounds[len - 1];\n    List<Integer> res = new ArrayList<>();\n    if (to >= fr) {     // no circle, such as [1,3,1,2]\n        for (int i = fr; i <= to; i++) res.add(i);\n    } else {            // cross a circle, such as [2,3,2,1]\n        // sector\n        for (int i = 1; i <= n; i++) {\n            // sector\n            if (i == to + 1) i = fr;\n            res.add(i);\n        }\n    }\n    return res;\n}\n```\n\n``nsectorround\n\n\n\n# 1561. Maximum Number of Coins You Can Get\n\nThere are 3n piles of coins of varying size, you and your friends will take piles of coins as follows:\n\n- In each step, you will choose **any** 3 piles of coins (not necessarily consecutive).\n- Of your choice, Alice will pick the pile with the maximum number of coins.\n- You will pick the next pile with maximum number of coins.\n- Your friend Bob will pick the last pile.\n- Repeat until there are no more piles of coins.\n\nGiven an array of integers `piles` where `piles[i]` is the number of coins in the `ith` pile.\n\nReturn the maximum number of coins which you can have.\n\n \n\n**Example 1:**\n\n```\nInput: piles = [2,4,1,2,7,8]\nOutput: 9\nExplanation: Choose the triplet (2, 7, 8), Alice Pick the pile with 8 coins, you the pile with 7 coins and Bob the last one.\nChoose the triplet (1, 2, 4), Alice Pick the pile with 4 coins, you the pile with 2 coins and Bob the last one.\nThe maximum number of coins which you can have are: 7 + 2 = 9.\nOn the other hand if we choose this arrangement (1, 2, 8), (2, 4, 7) you only get 2 + 4 = 6 coins which is not optimal.\n```\n\n**Example 2:**\n\n```\nInput: piles = [2,4,5]\nOutput: 4\n```\n\n**Example 3:**\n\n```\nInput: piles = [9,8,7,6,5,1,2,3,4]\nOutput: 18\n```\n\n\n\n## solution\n\n\n\nexample1*[1,2,2,4,7,8]*BobAliceAlice\n\n```java\npublic int maxCoins(int[] A) {\n    Arrays.sort(A);\n    int res = 0, n = A.length;\n    for (int i = n / 3; i < n; i += 2)\n        res += A[i];\n    return res;\n}\n```\n\n","slug":"contest203","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q76000kw5ihc54z9u0j","content":"<p>Leetcode203</p>\n<a id=\"more\"></a>\n\n<h1 id=\"1560-Most-Visited-Sector-in-a-Circular-Track\"><a href=\"#1560-Most-Visited-Sector-in-a-Circular-Track\" class=\"headerlink\" title=\"1560. Most Visited Sector in a Circular Track\"></a>1560. Most Visited Sector in a Circular Track</h1><p>Given an integer <code>n</code> and an integer array <code>rounds</code>. We have a circular track which consists of <code>n</code> sectors labeled from <code>1</code> to <code>n</code>. A marathon will be held on this track, the marathon consists of <code>m</code> rounds. The <code>ith</code> round starts at sector <code>rounds[i - 1]</code> and ends at sector <code>rounds[i]</code>. For example, round 1 starts at sector <code>rounds[0]</code> and ends at sector <code>rounds[1]</code></p>\n<p>Return <em>an array of the most visited sectors</em> sorted in <strong>ascending</strong> order.</p>\n<p>Notice that you circulate the track in ascending order of sector numbers in the counter-clockwise direction (See the first example).</p>\n<p><strong>Example 1:</strong></p>\n<p><img src=\"https://assets.leetcode.com/uploads/2020/08/14/tmp.jpg\" alt=\"img\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 4, rounds &#x3D; [1,3,1,2]</span><br><span class=\"line\">Output: [1,2]</span><br><span class=\"line\">Explanation: The marathon starts at sector 1. The order of the visited sectors is as follows:</span><br><span class=\"line\">1 --&gt; 2 --&gt; 3 (end of round 1) --&gt; 4 --&gt; 1 (end of round 2) --&gt; 2 (end of round 3 and the marathon)</span><br><span class=\"line\">We can see that both sectors 1 and 2 are visited twice and they are the most visited sectors. Sectors 3 and 4 are visited only once.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 2, rounds &#x3D; [2,1,2,1,2,1,2,1,2]</span><br><span class=\"line\">Output: [2]</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 7, rounds &#x3D; [1,3,5,7]</span><br><span class=\"line\">Output: [1,2,3,4,5,6,7]</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"solution\"><a href=\"#solution\" class=\"headerlink\" title=\"solution\"></a>solution</h2><p><code>easy</code>sectors</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">mostVisited</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span>[] rounds)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> f = rounds[<span class=\"number\">0</span>], t = rounds[rounds.length-<span class=\"number\">1</span>];</span><br><span class=\"line\">    List&lt;Integer&gt; ret = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = f;;)&#123;</span><br><span class=\"line\">        ret.add(i);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i == t)<span class=\"keyword\">break</span>;</span><br><span class=\"line\">        i++;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i == n+<span class=\"number\">1</span>)i = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Collections.sort(ret);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>emmmm</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">mostVisited</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span>[] A)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;Integer&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = A[<span class=\"number\">0</span>]; i &lt;= A[A.length - <span class=\"number\">1</span>]; ++i)</span><br><span class=\"line\">        res.add(i);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (res.size() &gt; <span class=\"number\">0</span>) <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    <span class=\"comment\">// start&gt;end[1, end] + [start, n]</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt;= A[A.length - <span class=\"number\">1</span>]; ++i)</span><br><span class=\"line\">        res.add(i);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = A[<span class=\"number\">0</span>]; i &lt;= n; ++i)</span><br><span class=\"line\">        res.add(i);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sector</p>\n<ul>\n<li>start&lt;=end[start, end]</li>\n<li>start&gt;end[start, n]+[1, end]</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">mostVisited</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span>[] rounds)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = rounds.length, fr = rounds[<span class=\"number\">0</span>], to = rounds[len - <span class=\"number\">1</span>];</span><br><span class=\"line\">    List&lt;Integer&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (to &gt;= fr) &#123;     <span class=\"comment\">// no circle, such as [1,3,1,2]</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = fr; i &lt;= to; i++) res.add(i);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;            <span class=\"comment\">// cross a circle, such as [2,3,2,1]</span></span><br><span class=\"line\">        <span class=\"comment\">// sector</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// sector</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == to + <span class=\"number\">1</span>) i = fr;</span><br><span class=\"line\">            res.add(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code></code>nsectorround</p>\n<h1 id=\"1561-Maximum-Number-of-Coins-You-Can-Get\"><a href=\"#1561-Maximum-Number-of-Coins-You-Can-Get\" class=\"headerlink\" title=\"1561. Maximum Number of Coins You Can Get\"></a>1561. Maximum Number of Coins You Can Get</h1><p>There are 3n piles of coins of varying size, you and your friends will take piles of coins as follows:</p>\n<ul>\n<li>In each step, you will choose <strong>any</strong> 3 piles of coins (not necessarily consecutive).</li>\n<li>Of your choice, Alice will pick the pile with the maximum number of coins.</li>\n<li>You will pick the next pile with maximum number of coins.</li>\n<li>Your friend Bob will pick the last pile.</li>\n<li>Repeat until there are no more piles of coins.</li>\n</ul>\n<p>Given an array of integers <code>piles</code> where <code>piles[i]</code> is the number of coins in the <code>ith</code> pile.</p>\n<p>Return the maximum number of coins which you can have.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: piles &#x3D; [2,4,1,2,7,8]</span><br><span class=\"line\">Output: 9</span><br><span class=\"line\">Explanation: Choose the triplet (2, 7, 8), Alice Pick the pile with 8 coins, you the pile with 7 coins and Bob the last one.</span><br><span class=\"line\">Choose the triplet (1, 2, 4), Alice Pick the pile with 4 coins, you the pile with 2 coins and Bob the last one.</span><br><span class=\"line\">The maximum number of coins which you can have are: 7 + 2 &#x3D; 9.</span><br><span class=\"line\">On the other hand if we choose this arrangement (1, 2, 8), (2, 4, 7) you only get 2 + 4 &#x3D; 6 coins which is not optimal.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: piles &#x3D; [2,4,5]</span><br><span class=\"line\">Output: 4</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: piles &#x3D; [9,8,7,6,5,1,2,3,4]</span><br><span class=\"line\">Output: 18</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"solution-1\"><a href=\"#solution-1\" class=\"headerlink\" title=\"solution\"></a>solution</h2><p></p>\n<p>example1*[1,2,2,4,7,8]*BobAliceAlice</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">maxCoins</span><span class=\"params\">(<span class=\"keyword\">int</span>[] A)</span> </span>&#123;</span><br><span class=\"line\">    Arrays.sort(A);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>, n = A.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = n / <span class=\"number\">3</span>; i &lt; n; i += <span class=\"number\">2</span>)</span><br><span class=\"line\">        res += A[i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>Leetcode203</p>","more":"<h1 id=\"1560-Most-Visited-Sector-in-a-Circular-Track\"><a href=\"#1560-Most-Visited-Sector-in-a-Circular-Track\" class=\"headerlink\" title=\"1560. Most Visited Sector in a Circular Track\"></a>1560. Most Visited Sector in a Circular Track</h1><p>Given an integer <code>n</code> and an integer array <code>rounds</code>. We have a circular track which consists of <code>n</code> sectors labeled from <code>1</code> to <code>n</code>. A marathon will be held on this track, the marathon consists of <code>m</code> rounds. The <code>ith</code> round starts at sector <code>rounds[i - 1]</code> and ends at sector <code>rounds[i]</code>. For example, round 1 starts at sector <code>rounds[0]</code> and ends at sector <code>rounds[1]</code></p>\n<p>Return <em>an array of the most visited sectors</em> sorted in <strong>ascending</strong> order.</p>\n<p>Notice that you circulate the track in ascending order of sector numbers in the counter-clockwise direction (See the first example).</p>\n<p><strong>Example 1:</strong></p>\n<p><img src=\"https://assets.leetcode.com/uploads/2020/08/14/tmp.jpg\" alt=\"img\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 4, rounds &#x3D; [1,3,1,2]</span><br><span class=\"line\">Output: [1,2]</span><br><span class=\"line\">Explanation: The marathon starts at sector 1. The order of the visited sectors is as follows:</span><br><span class=\"line\">1 --&gt; 2 --&gt; 3 (end of round 1) --&gt; 4 --&gt; 1 (end of round 2) --&gt; 2 (end of round 3 and the marathon)</span><br><span class=\"line\">We can see that both sectors 1 and 2 are visited twice and they are the most visited sectors. Sectors 3 and 4 are visited only once.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 2, rounds &#x3D; [2,1,2,1,2,1,2,1,2]</span><br><span class=\"line\">Output: [2]</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: n &#x3D; 7, rounds &#x3D; [1,3,5,7]</span><br><span class=\"line\">Output: [1,2,3,4,5,6,7]</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"solution\"><a href=\"#solution\" class=\"headerlink\" title=\"solution\"></a>solution</h2><p><code>easy</code>sectors</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">mostVisited</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span>[] rounds)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> f = rounds[<span class=\"number\">0</span>], t = rounds[rounds.length-<span class=\"number\">1</span>];</span><br><span class=\"line\">    List&lt;Integer&gt; ret = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = f;;)&#123;</span><br><span class=\"line\">        ret.add(i);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i == t)<span class=\"keyword\">break</span>;</span><br><span class=\"line\">        i++;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i == n+<span class=\"number\">1</span>)i = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Collections.sort(ret);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>emmmm</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">mostVisited</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span>[] A)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;Integer&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = A[<span class=\"number\">0</span>]; i &lt;= A[A.length - <span class=\"number\">1</span>]; ++i)</span><br><span class=\"line\">        res.add(i);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (res.size() &gt; <span class=\"number\">0</span>) <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    <span class=\"comment\">// start&gt;end[1, end] + [start, n]</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt;= A[A.length - <span class=\"number\">1</span>]; ++i)</span><br><span class=\"line\">        res.add(i);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = A[<span class=\"number\">0</span>]; i &lt;= n; ++i)</span><br><span class=\"line\">        res.add(i);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sector</p>\n<ul>\n<li>start&lt;=end[start, end]</li>\n<li>start&gt;end[start, n]+[1, end]</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">mostVisited</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span>[] rounds)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> len = rounds.length, fr = rounds[<span class=\"number\">0</span>], to = rounds[len - <span class=\"number\">1</span>];</span><br><span class=\"line\">    List&lt;Integer&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (to &gt;= fr) &#123;     <span class=\"comment\">// no circle, such as [1,3,1,2]</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = fr; i &lt;= to; i++) res.add(i);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;            <span class=\"comment\">// cross a circle, such as [2,3,2,1]</span></span><br><span class=\"line\">        <span class=\"comment\">// sector</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// sector</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == to + <span class=\"number\">1</span>) i = fr;</span><br><span class=\"line\">            res.add(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code></code>nsectorround</p>\n<h1 id=\"1561-Maximum-Number-of-Coins-You-Can-Get\"><a href=\"#1561-Maximum-Number-of-Coins-You-Can-Get\" class=\"headerlink\" title=\"1561. Maximum Number of Coins You Can Get\"></a>1561. Maximum Number of Coins You Can Get</h1><p>There are 3n piles of coins of varying size, you and your friends will take piles of coins as follows:</p>\n<ul>\n<li>In each step, you will choose <strong>any</strong> 3 piles of coins (not necessarily consecutive).</li>\n<li>Of your choice, Alice will pick the pile with the maximum number of coins.</li>\n<li>You will pick the next pile with maximum number of coins.</li>\n<li>Your friend Bob will pick the last pile.</li>\n<li>Repeat until there are no more piles of coins.</li>\n</ul>\n<p>Given an array of integers <code>piles</code> where <code>piles[i]</code> is the number of coins in the <code>ith</code> pile.</p>\n<p>Return the maximum number of coins which you can have.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: piles &#x3D; [2,4,1,2,7,8]</span><br><span class=\"line\">Output: 9</span><br><span class=\"line\">Explanation: Choose the triplet (2, 7, 8), Alice Pick the pile with 8 coins, you the pile with 7 coins and Bob the last one.</span><br><span class=\"line\">Choose the triplet (1, 2, 4), Alice Pick the pile with 4 coins, you the pile with 2 coins and Bob the last one.</span><br><span class=\"line\">The maximum number of coins which you can have are: 7 + 2 &#x3D; 9.</span><br><span class=\"line\">On the other hand if we choose this arrangement (1, 2, 8), (2, 4, 7) you only get 2 + 4 &#x3D; 6 coins which is not optimal.</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: piles &#x3D; [2,4,5]</span><br><span class=\"line\">Output: 4</span><br></pre></td></tr></table></figure>\n\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: piles &#x3D; [9,8,7,6,5,1,2,3,4]</span><br><span class=\"line\">Output: 18</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"solution-1\"><a href=\"#solution-1\" class=\"headerlink\" title=\"solution\"></a>solution</h2><p></p>\n<p>example1*[1,2,2,4,7,8]*BobAliceAlice</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">maxCoins</span><span class=\"params\">(<span class=\"keyword\">int</span>[] A)</span> </span>&#123;</span><br><span class=\"line\">    Arrays.sort(A);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>, n = A.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = n / <span class=\"number\">3</span>; i &lt; n; i += <span class=\"number\">2</span>)</span><br><span class=\"line\">        res += A[i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"decorating","date":"2020-06-12T10:30:28.000Z","_content":"\n\n\n<!-- more -->\n\n# \n\n`Beverage`_cost()_HouseBlend, DarkRoast Decaf, Espresso... \n\n\n\n> \n\n\n\n# \n\n\n\n1. DarkRoast\n2. \n3. \n4. costdelegate\n\n\n\n# \n\n![Screenshot from 2020-06-12 20-50-33.png](https://i.loli.net/2020/06/12/jQwAkbz7V6n8dGK.png)\n\n\n\n`Condiment``Beverage``getDescription`Whip\n\n```java\npublic class Whip extends Condiment {\n    Beverage beverage;\n\n    public Whip(Beverage beverage) {\n        this.beverage = beverage;\n    }\n\n    @Override\n    public String getDescription() {\n        return beverage.getDescription() + \", Whip\";\n    }\n\n    @Override\n    public double cost() {\n        return .30 + beverage.cost();\n    }\n}\n```\n\n_cost_description\n\n```java\nBeverage beverage1 = new DarRoast();\nbeverage1 = new Mocha(beverage1);\nbeverage1 = new Mocha(beverage1);\nbeverage1 = new Whip(beverage1);\nSystem.out.println(beverage1.getDescription() + \" $\" + beverage1.cost());\n```\n\n```console\nBrazil Dark Roast Coffee, Mocha, Mocha, Whip $2.75\n```\n\n****.\n\n# \n\n## Java I/O\n\n`Decorator Pattern`javaio0101_FileInputStream__Beverage__BufferedInputStream__Espresso__LineNumberInutStream__Mocha_\n\n```flow\npara1=>parallel: FileInputStream\npara2=>parallel: BufferedInputStream\npara3=>parallel: LineNumberInputStream\nop1=>operation: Beferage\nop2=>operation: Espresso\nop3=>operation: Mocha\npara1(path1, bottom)->para2\npara2(path1,bottom)->para3\npara1(path2, right)->op1\npara2(path2, right)->op2\npara3(path2, right)->op3\n```\n\n","source":"_posts/decorating.md","raw":"---\n\ntitle: decorating\ndate: 2020-06-12 18:30:28\ncategories: DesignPatterns\ntags: design_patterns\n---\n\n\n\n<!-- more -->\n\n# \n\n`Beverage`_cost()_HouseBlend, DarkRoast Decaf, Espresso... \n\n\n\n> \n\n\n\n# \n\n\n\n1. DarkRoast\n2. \n3. \n4. costdelegate\n\n\n\n# \n\n![Screenshot from 2020-06-12 20-50-33.png](https://i.loli.net/2020/06/12/jQwAkbz7V6n8dGK.png)\n\n\n\n`Condiment``Beverage``getDescription`Whip\n\n```java\npublic class Whip extends Condiment {\n    Beverage beverage;\n\n    public Whip(Beverage beverage) {\n        this.beverage = beverage;\n    }\n\n    @Override\n    public String getDescription() {\n        return beverage.getDescription() + \", Whip\";\n    }\n\n    @Override\n    public double cost() {\n        return .30 + beverage.cost();\n    }\n}\n```\n\n_cost_description\n\n```java\nBeverage beverage1 = new DarRoast();\nbeverage1 = new Mocha(beverage1);\nbeverage1 = new Mocha(beverage1);\nbeverage1 = new Whip(beverage1);\nSystem.out.println(beverage1.getDescription() + \" $\" + beverage1.cost());\n```\n\n```console\nBrazil Dark Roast Coffee, Mocha, Mocha, Whip $2.75\n```\n\n****.\n\n# \n\n## Java I/O\n\n`Decorator Pattern`javaio0101_FileInputStream__Beverage__BufferedInputStream__Espresso__LineNumberInutStream__Mocha_\n\n```flow\npara1=>parallel: FileInputStream\npara2=>parallel: BufferedInputStream\npara3=>parallel: LineNumberInputStream\nop1=>operation: Beferage\nop2=>operation: Espresso\nop3=>operation: Mocha\npara1(path1, bottom)->para2\npara2(path1,bottom)->para3\npara1(path2, right)->op1\npara2(path2, right)->op2\npara3(path2, right)->op3\n```\n\n","slug":"decorating","published":1,"updated":"2021-03-24T06:44:13.967Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q78000ow5ih6vi74u1i","content":"<p></p>\n<a id=\"more\"></a>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>Beverage</code>_cost()_HouseBlend, DarkRoast Decaf, Espresso </p>\n<p></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li>DarkRoast</li>\n<li></li>\n<li></li>\n<li>costdelegate</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/06/12/jQwAkbz7V6n8dGK.png\" alt=\"Screenshot from 2020-06-12 20-50-33.png\"></p>\n<p><code>Condiment</code><code>Beverage</code><code>getDescription</code>Whip</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Whip</span> <span class=\"keyword\">extends</span> <span class=\"title\">Condiment</span> </span>&#123;</span><br><span class=\"line\">    Beverage beverage;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Whip</span><span class=\"params\">(Beverage beverage)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.beverage = beverage;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getDescription</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> beverage.getDescription() + <span class=\"string\">&quot;, Whip&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">double</span> <span class=\"title\">cost</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">.30</span> + beverage.cost();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>_cost_description</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Beverage beverage1 = <span class=\"keyword\">new</span> DarRoast();</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Mocha(beverage1);</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Mocha(beverage1);</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Whip(beverage1);</span><br><span class=\"line\">System.out.println(beverage1.getDescription() + <span class=\"string\">&quot; $&quot;</span> + beverage1.cost());</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Brazil Dark Roast Coffee, Mocha, Mocha, Whip $2.75</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong>.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Java-I-O\"><a href=\"#Java-I-O\" class=\"headerlink\" title=\"Java I/O\"></a>Java I/O</h2><p><code>Decorator Pattern</code>javaio0101_FileInputStream__Beverage__BufferedInputStream__Espresso__LineNumberInutStream__Mocha_</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">para1&#x3D;&gt;parallel: FileInputStream</span><br><span class=\"line\">para2&#x3D;&gt;parallel: BufferedInputStream</span><br><span class=\"line\">para3&#x3D;&gt;parallel: LineNumberInputStream</span><br><span class=\"line\">op1&#x3D;&gt;operation: Beferage</span><br><span class=\"line\">op2&#x3D;&gt;operation: Espresso</span><br><span class=\"line\">op3&#x3D;&gt;operation: Mocha</span><br><span class=\"line\">para1(path1, bottom)-&gt;para2</span><br><span class=\"line\">para2(path1,bottom)-&gt;para3</span><br><span class=\"line\">para1(path2, right)-&gt;op1</span><br><span class=\"line\">para2(path2, right)-&gt;op2</span><br><span class=\"line\">para3(path2, right)-&gt;op3</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p></p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>Beverage</code>_cost()_HouseBlend, DarkRoast Decaf, Espresso </p>\n<p></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li>DarkRoast</li>\n<li></li>\n<li></li>\n<li>costdelegate</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/06/12/jQwAkbz7V6n8dGK.png\" alt=\"Screenshot from 2020-06-12 20-50-33.png\"></p>\n<p><code>Condiment</code><code>Beverage</code><code>getDescription</code>Whip</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Whip</span> <span class=\"keyword\">extends</span> <span class=\"title\">Condiment</span> </span>&#123;</span><br><span class=\"line\">    Beverage beverage;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Whip</span><span class=\"params\">(Beverage beverage)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.beverage = beverage;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getDescription</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> beverage.getDescription() + <span class=\"string\">&quot;, Whip&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">double</span> <span class=\"title\">cost</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">.30</span> + beverage.cost();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>_cost_description</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Beverage beverage1 = <span class=\"keyword\">new</span> DarRoast();</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Mocha(beverage1);</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Mocha(beverage1);</span><br><span class=\"line\">beverage1 = <span class=\"keyword\">new</span> Whip(beverage1);</span><br><span class=\"line\">System.out.println(beverage1.getDescription() + <span class=\"string\">&quot; $&quot;</span> + beverage1.cost());</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Brazil Dark Roast Coffee, Mocha, Mocha, Whip $2.75</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong>.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Java-I-O\"><a href=\"#Java-I-O\" class=\"headerlink\" title=\"Java I/O\"></a>Java I/O</h2><p><code>Decorator Pattern</code>javaio0101_FileInputStream__Beverage__BufferedInputStream__Espresso__LineNumberInutStream__Mocha_</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">para1&#x3D;&gt;parallel: FileInputStream</span><br><span class=\"line\">para2&#x3D;&gt;parallel: BufferedInputStream</span><br><span class=\"line\">para3&#x3D;&gt;parallel: LineNumberInputStream</span><br><span class=\"line\">op1&#x3D;&gt;operation: Beferage</span><br><span class=\"line\">op2&#x3D;&gt;operation: Espresso</span><br><span class=\"line\">op3&#x3D;&gt;operation: Mocha</span><br><span class=\"line\">para1(path1, bottom)-&gt;para2</span><br><span class=\"line\">para2(path1,bottom)-&gt;para3</span><br><span class=\"line\">para1(path2, right)-&gt;op1</span><br><span class=\"line\">para2(path2, right)-&gt;op2</span><br><span class=\"line\">para3(path2, right)-&gt;op3</span><br></pre></td></tr></table></figure>"},{"title":"hashmap","date":"2020-08-20T15:04:30.000Z","_content":"\nJava Hashmapjdk8\n\n<!--more-->\n\n# Example\n\n```java\nMap<String, Object> map = new HashMap<>();\nmap.put(\"name\", \"Gloria\");\nmap.put(\"age\", 3);\nmap.put(\"wage\", 539.8);\nSystem.out.println(map);\n```\n\n`put`\n\n## \n\nHashMapmap\n\n```java\nMap<String, Object> map1 = new HashMap<>(map); // map\n```\n\n\n\n```java\n    /**\n     * The load factor for the hash table.\n     *\n     * @serial\n     */\n    final float loadFactor;\n```\n\nHashMap`0.75`,\n\n```java\nMap<String, Object> map = new HashMap<>(16);\n```\n\nmap****12`0.75`,****\n\n## put\n\n```java\n/**\n * Implements Map.put and related methods.\n *\n * @param hash hash for key\n * @param key the key\n * @param value the value to put\n * @param onlyIfAbsent if true, don't change existing value\n * @param evict if false, the table is in creation mode.\n * @return previous value, or null if none\n */\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    return putVal(hash(key), key, value, false, true);\n}key\n```\n\nputhashhashkeyhashhash\n\n```java\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n}\n```\n\neasykeynull0hashmapkeynull,keynull****:\n\n- ^ (0)\n- \\>\\>\\> 0\n\nhkeyhashCodekeyhashcodeObject`native`h16\n\n`table``Noe<K,V> []`Node\n\n\n\n# Node\n\nHahsMap\n\n```java\n /**\n  * Basic hash bin node, used for most entries.  (See below for\n  * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)\n  */\nstatic class Node<K,V> implements Map.Entry<K,V> {\n    final int hash; // \n    final K key;\n    V value;\n    Node<K,V> next; // Node\n\n    Node(int hash, K key, V value, Node<K,V> next) {\n        this.hash = hash;\n        this.key = key;\n        this.value = value;\n        this.next = next;\n    }\n    \n    // get, set equals ...\n}\n```\n\n-  `Node<K, V> next`\n- `table`Node+\n- `Map.Entry<K, V>`k-v\n- `next``hash`, `key`, `value`\n\n\n\n# \n\n\n\n=+`Node<K, V>``Node<K, V> []`hashmap`+`\n\nhashmap****`table`****\n\n```java\n/**\n  * The number of key-value mappings contained in this map.\n  */\ntransient int size;\n\n/**\n  * The number of times this HashMap has been structurally modified\n  * Structural modifications are those that change the number of mappings in\n  * the HashMap or otherwise modify its internal structure (e.g.,\n  * rehash).  This field is used to make iterators on Collection-views of\n  * the HashMap fail-fast.  (See ConcurrentModificationException).\n  */\ntransient int modCount;\n\n/**\n  * The next size value at which to resize (capacity * load factor).\n  *\n  * @serial\n  */\n// (The javadoc description is true upon serialization.\n// Additionally, if the table array has not been allocated, this\n// field holds the initial array capacity, or zero signifying\n// DEFAULT_INITIAL_CAPACITY.)\nint threshold;\n\n/**\n  * The load factor for the hash table.\n  *\n  * @serial\n  */\nfinal float loadFactor;\n```\n\n`threshold`k-vNode<K,V>[] tablelength16, loadFactor0.75,\n\n> threshold = loadFactor * length\n\ntableNode`threshold`12.Node12 16,12,1.\n\nsizeNode\n\nHashMaptable2n****\n\n- 2n````\n\nHashTable`initialCapacity`11. jdk8****8hashmap\n\n\n\n# \n\nhahsmapk-vNodetablekeyhashtableindex uhash\n\n> keyhashCode\n\nkeyhashCodehashNode hashmap\n\n```java\nif ((p = tab[i = (n - 1) & hash]) == null)\n            tab[i] = newNode(hash, key, value, null);\n```\n\nnhashkeyn2n`(n-1)&hash`length`%`\n\n \n\n# put\n\n```java\n/**\n * Implements Map.put and related methods.\n *\n * @param hash hash for key\n * @param key the key\n * @param value the value to put\n * @param onlyIfAbsent if true, don't change existing value\n * @param evict if false, the table is in creation mode.\n * @return previous value, or null if none\n */\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // table\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // null\n    if ((p = tab[i = (n - 1) & hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n    else {\n        Node<K,V> e; K k;\n        // keyugovalue\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n            e = p;\n        // \n        else if (p instanceof TreeNode)\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        else {\n            // table\n            for (int binCount = 0; ; ++binCount) {\n                if ((e = p.next) == null) {\n                    // \n                    p.next = newNode(hash, key, value, null);\n                    // 8\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                }\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    break;\n                p = e;\n            }\n        }\n        if (e != null) { // existing mapping for key\n            V oldValue = e.value;\n            if (!onlyIfAbsent || oldValue == null)\n                e.value = value;\n            afterNodeAccess(e);\n            return oldValue;\n        }\n    }\n    ++modCount;\n    // \n    if (++size > threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n}\n```\n\n\n\n# \n\nHashMapArrayListHashMapNode\n\n> note: HashMap\n\n```java\n/**\n * Initializes or doubles table size.  If null, allocates in\n * accord with initial capacity target held in field threshold.\n * Otherwise, because we are using power-of-two expansion, the\n * elements from each bin must either stay at same index, or move\n * with a power of two offset in the new table.\n *\n * @return the table\n */\nfinal Node<K,V>[] resize() {\n    Node<K,V>[] oldTab = table;\n    int oldCap = (oldTab == null) ? 0 : oldTab.length;\n    int oldThr = threshold;\n    int newCap, newThr = 0;\n    if (oldCap > 0) {\n        // let it go\n        if (oldCap >= MAXIMUM_CAPACITY) {\n            threshold = Integer.MAX_VALUE;\n            return oldTab;\n        }\n        // X2\n        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                 oldCap >= DEFAULT_INITIAL_CAPACITY)\n            newThr = oldThr << 1; // double threshold\n    }\n    else if (oldThr > 0) // initial capacity was placed in threshold\n        newCap = oldThr;\n    else {               // zero initial threshold signifies using defaults\n        newCap = DEFAULT_INITIAL_CAPACITY;\n        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    }\n    // resize\n    if (newThr == 0) {\n        float ft = (float)newCap * loadFactor;\n        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    }\n    threshold = newThr;\n    @SuppressWarnings({\"rawtypes\",\"unchecked\"})\n    Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];\n    table = newTab;\n    if (oldTab != null) {\n        // \n        for (int j = 0; j < oldCap; ++j) {\n            Node<K,V> e;\n            if ((e = oldTab[j]) != null) {\n                oldTab[j] = null;\n                if (e.next == null)\n                    newTab[e.hash & (newCap - 1)] = e;\n                else if (e instanceof TreeNode)\n                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                else { // preserve order\n                    Node<K,V> loHead = null, loTail = null;\n                    Node<K,V> hiHead = null, hiTail = null;\n                    Node<K,V> next;\n                    do {\n                        next = e.next;\n                        if ((e.hash & oldCap) == 0) {\n                            if (loTail == null)\n                                loHead = e;\n                            else\n                                loTail.next = e;\n                            loTail = e;\n                        }\n                        else {\n                            if (hiTail == null)\n                                hiHead = e;\n                            else\n                                hiTail.next = e;\n                            hiTail = e;\n                        }\n                    } while ((e = next) != null);\n                    if (loTail != null) {\n                        loTail.next = null;\n                        newTab[j] = loHead;\n                    }\n                    if (hiTail != null) {\n                        hiTail.next = null;\n                        newTab[j + oldCap] = hiHead;\n                    }\n                }\n            }\n        }\n    }\n    return newTab;\n}\n```\n\n","source":"_posts/hashmap.md","raw":"---\ntitle: hashmap\ndate: 2020-08-20 23:04:30\ncategories: Java\ntags: hashmap, data structure\n---\n\nJava Hashmapjdk8\n\n<!--more-->\n\n# Example\n\n```java\nMap<String, Object> map = new HashMap<>();\nmap.put(\"name\", \"Gloria\");\nmap.put(\"age\", 3);\nmap.put(\"wage\", 539.8);\nSystem.out.println(map);\n```\n\n`put`\n\n## \n\nHashMapmap\n\n```java\nMap<String, Object> map1 = new HashMap<>(map); // map\n```\n\n\n\n```java\n    /**\n     * The load factor for the hash table.\n     *\n     * @serial\n     */\n    final float loadFactor;\n```\n\nHashMap`0.75`,\n\n```java\nMap<String, Object> map = new HashMap<>(16);\n```\n\nmap****12`0.75`,****\n\n## put\n\n```java\n/**\n * Implements Map.put and related methods.\n *\n * @param hash hash for key\n * @param key the key\n * @param value the value to put\n * @param onlyIfAbsent if true, don't change existing value\n * @param evict if false, the table is in creation mode.\n * @return previous value, or null if none\n */\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    return putVal(hash(key), key, value, false, true);\n}key\n```\n\nputhashhashkeyhashhash\n\n```java\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n}\n```\n\neasykeynull0hashmapkeynull,keynull****:\n\n- ^ (0)\n- \\>\\>\\> 0\n\nhkeyhashCodekeyhashcodeObject`native`h16\n\n`table``Noe<K,V> []`Node\n\n\n\n# Node\n\nHahsMap\n\n```java\n /**\n  * Basic hash bin node, used for most entries.  (See below for\n  * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)\n  */\nstatic class Node<K,V> implements Map.Entry<K,V> {\n    final int hash; // \n    final K key;\n    V value;\n    Node<K,V> next; // Node\n\n    Node(int hash, K key, V value, Node<K,V> next) {\n        this.hash = hash;\n        this.key = key;\n        this.value = value;\n        this.next = next;\n    }\n    \n    // get, set equals ...\n}\n```\n\n-  `Node<K, V> next`\n- `table`Node+\n- `Map.Entry<K, V>`k-v\n- `next``hash`, `key`, `value`\n\n\n\n# \n\n\n\n=+`Node<K, V>``Node<K, V> []`hashmap`+`\n\nhashmap****`table`****\n\n```java\n/**\n  * The number of key-value mappings contained in this map.\n  */\ntransient int size;\n\n/**\n  * The number of times this HashMap has been structurally modified\n  * Structural modifications are those that change the number of mappings in\n  * the HashMap or otherwise modify its internal structure (e.g.,\n  * rehash).  This field is used to make iterators on Collection-views of\n  * the HashMap fail-fast.  (See ConcurrentModificationException).\n  */\ntransient int modCount;\n\n/**\n  * The next size value at which to resize (capacity * load factor).\n  *\n  * @serial\n  */\n// (The javadoc description is true upon serialization.\n// Additionally, if the table array has not been allocated, this\n// field holds the initial array capacity, or zero signifying\n// DEFAULT_INITIAL_CAPACITY.)\nint threshold;\n\n/**\n  * The load factor for the hash table.\n  *\n  * @serial\n  */\nfinal float loadFactor;\n```\n\n`threshold`k-vNode<K,V>[] tablelength16, loadFactor0.75,\n\n> threshold = loadFactor * length\n\ntableNode`threshold`12.Node12 16,12,1.\n\nsizeNode\n\nHashMaptable2n****\n\n- 2n````\n\nHashTable`initialCapacity`11. jdk8****8hashmap\n\n\n\n# \n\nhahsmapk-vNodetablekeyhashtableindex uhash\n\n> keyhashCode\n\nkeyhashCodehashNode hashmap\n\n```java\nif ((p = tab[i = (n - 1) & hash]) == null)\n            tab[i] = newNode(hash, key, value, null);\n```\n\nnhashkeyn2n`(n-1)&hash`length`%`\n\n \n\n# put\n\n```java\n/**\n * Implements Map.put and related methods.\n *\n * @param hash hash for key\n * @param key the key\n * @param value the value to put\n * @param onlyIfAbsent if true, don't change existing value\n * @param evict if false, the table is in creation mode.\n * @return previous value, or null if none\n */\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // table\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // null\n    if ((p = tab[i = (n - 1) & hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n    else {\n        Node<K,V> e; K k;\n        // keyugovalue\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n            e = p;\n        // \n        else if (p instanceof TreeNode)\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        else {\n            // table\n            for (int binCount = 0; ; ++binCount) {\n                if ((e = p.next) == null) {\n                    // \n                    p.next = newNode(hash, key, value, null);\n                    // 8\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                }\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    break;\n                p = e;\n            }\n        }\n        if (e != null) { // existing mapping for key\n            V oldValue = e.value;\n            if (!onlyIfAbsent || oldValue == null)\n                e.value = value;\n            afterNodeAccess(e);\n            return oldValue;\n        }\n    }\n    ++modCount;\n    // \n    if (++size > threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n}\n```\n\n\n\n# \n\nHashMapArrayListHashMapNode\n\n> note: HashMap\n\n```java\n/**\n * Initializes or doubles table size.  If null, allocates in\n * accord with initial capacity target held in field threshold.\n * Otherwise, because we are using power-of-two expansion, the\n * elements from each bin must either stay at same index, or move\n * with a power of two offset in the new table.\n *\n * @return the table\n */\nfinal Node<K,V>[] resize() {\n    Node<K,V>[] oldTab = table;\n    int oldCap = (oldTab == null) ? 0 : oldTab.length;\n    int oldThr = threshold;\n    int newCap, newThr = 0;\n    if (oldCap > 0) {\n        // let it go\n        if (oldCap >= MAXIMUM_CAPACITY) {\n            threshold = Integer.MAX_VALUE;\n            return oldTab;\n        }\n        // X2\n        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                 oldCap >= DEFAULT_INITIAL_CAPACITY)\n            newThr = oldThr << 1; // double threshold\n    }\n    else if (oldThr > 0) // initial capacity was placed in threshold\n        newCap = oldThr;\n    else {               // zero initial threshold signifies using defaults\n        newCap = DEFAULT_INITIAL_CAPACITY;\n        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    }\n    // resize\n    if (newThr == 0) {\n        float ft = (float)newCap * loadFactor;\n        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    }\n    threshold = newThr;\n    @SuppressWarnings({\"rawtypes\",\"unchecked\"})\n    Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];\n    table = newTab;\n    if (oldTab != null) {\n        // \n        for (int j = 0; j < oldCap; ++j) {\n            Node<K,V> e;\n            if ((e = oldTab[j]) != null) {\n                oldTab[j] = null;\n                if (e.next == null)\n                    newTab[e.hash & (newCap - 1)] = e;\n                else if (e instanceof TreeNode)\n                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                else { // preserve order\n                    Node<K,V> loHead = null, loTail = null;\n                    Node<K,V> hiHead = null, hiTail = null;\n                    Node<K,V> next;\n                    do {\n                        next = e.next;\n                        if ((e.hash & oldCap) == 0) {\n                            if (loTail == null)\n                                loHead = e;\n                            else\n                                loTail.next = e;\n                            loTail = e;\n                        }\n                        else {\n                            if (hiTail == null)\n                                hiHead = e;\n                            else\n                                hiTail.next = e;\n                            hiTail = e;\n                        }\n                    } while ((e = next) != null);\n                    if (loTail != null) {\n                        loTail.next = null;\n                        newTab[j] = loHead;\n                    }\n                    if (hiTail != null) {\n                        hiTail.next = null;\n                        newTab[j + oldCap] = hiHead;\n                    }\n                }\n            }\n        }\n    }\n    return newTab;\n}\n```\n\n","slug":"hashmap","published":1,"updated":"2020-12-15T13:25:48.842Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7a000qw5ihcptj9jqw","content":"<p>Java Hashmapjdk8</p>\n<a id=\"more\"></a>\n\n<h1 id=\"Example\"><a href=\"#Example\" class=\"headerlink\" title=\"Example\"></a>Example</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;name&quot;</span>, <span class=\"string\">&quot;Gloria&quot;</span>);</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;age&quot;</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;wage&quot;</span>, <span class=\"number\">539.8</span>);</span><br><span class=\"line\">System.out.println(map);</span><br></pre></td></tr></table></figure>\n\n<p><code>put</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HashMapmap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map1 = <span class=\"keyword\">new</span> HashMap&lt;&gt;(map); <span class=\"comment\">// map</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * The load factor for the hash table.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">float</span> loadFactor;</span><br></pre></td></tr></table></figure>\n\n<p>HashMap<code>0.75</code>,</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">16</span>);</span><br></pre></td></tr></table></figure>\n\n<p>map<strong></strong>12<code>0.75</code>,<strong></strong></p>\n<h2 id=\"put\"><a href=\"#put\" class=\"headerlink\" title=\"put\"></a>put</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Implements Map.put and related methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> hash hash for key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> key the key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> value the value to put</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> evict if false, the table is in creation mode.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> previous value, or null if none</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> V <span class=\"title\">putVal</span><span class=\"params\">(<span class=\"keyword\">int</span> hash, K key, V value, <span class=\"keyword\">boolean</span> onlyIfAbsent,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">               <span class=\"keyword\">boolean</span> evict)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> putVal(hash(key), key, value, <span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>);</span><br><span class=\"line\">&#125;key</span><br></pre></td></tr></table></figure>\n\n<p>puthashhashkeyhashhash</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">hash</span><span class=\"params\">(Object key)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> h;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (key == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>easykeynull0hashmapkeynull,keynull<strong></strong>:</p>\n<ul>\n<li>^ (0)</li>\n<li>&gt;&gt;&gt; 0</li>\n</ul>\n<p>hkeyhashCodekeyhashcodeObject<code>native</code>h16</p>\n<p><code>table</code><code>Noe&lt;K,V&gt; []</code>Node</p>\n<h1 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a>Node</h1><p>HahsMap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * Basic hash bin node, used for most entries.  (See below for</span></span><br><span class=\"line\"><span class=\"comment\">  * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Node</span>&lt;<span class=\"title\">K</span>,<span class=\"title\">V</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">Map</span>.<span class=\"title\">Entry</span>&lt;<span class=\"title\">K</span>,<span class=\"title\">V</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> hash; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> K key;</span><br><span class=\"line\">    V value;</span><br><span class=\"line\">    Node&lt;K,V&gt; next; <span class=\"comment\">// Node</span></span><br><span class=\"line\"></span><br><span class=\"line\">    Node(<span class=\"keyword\">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hash = hash;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.key = key;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// get, set equals ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> <code>Node&lt;K, V&gt; next</code></li>\n<li><code>table</code>Node+</li>\n<li><code>Map.Entry&lt;K, V&gt;</code>k-v</li>\n<li><code>next</code><code>hash</code>, <code>key</code>, <code>value</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>=+<code>Node&lt;K, V&gt;</code><code>Node&lt;K, V&gt; []</code>hashmap<code>+</code></p>\n<p>hashmap<strong></strong><code>table</code><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The number of key-value mappings contained in this map.</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">transient</span> <span class=\"keyword\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The number of times this HashMap has been structurally modified</span></span><br><span class=\"line\"><span class=\"comment\">  * Structural modifications are those that change the number of mappings in</span></span><br><span class=\"line\"><span class=\"comment\">  * the HashMap or otherwise modify its internal structure (e.g.,</span></span><br><span class=\"line\"><span class=\"comment\">  * rehash).  This field is used to make iterators on Collection-views of</span></span><br><span class=\"line\"><span class=\"comment\">  * the HashMap fail-fast.  (See ConcurrentModificationException).</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">transient</span> <span class=\"keyword\">int</span> modCount;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The next size value at which to resize (capacity * load factor).</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"comment\">// (The javadoc description is true upon serialization.</span></span><br><span class=\"line\"><span class=\"comment\">// Additionally, if the table array has not been allocated, this</span></span><br><span class=\"line\"><span class=\"comment\">// field holds the initial array capacity, or zero signifying</span></span><br><span class=\"line\"><span class=\"comment\">// DEFAULT_INITIAL_CAPACITY.)</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> threshold;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The load factor for the hash table.</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">float</span> loadFactor;</span><br></pre></td></tr></table></figure>\n\n<p><code>threshold</code>k-vNode&lt;K,V&gt;[] tablelength16, loadFactor0.75,</p>\n<blockquote>\n<p>threshold = loadFactor * length</p>\n</blockquote>\n<p>tableNode<code>threshold</code>12.Node12 16,12,1.</p>\n<p>sizeNode</p>\n<p>HashMaptable2n<strong></strong></p>\n<ul>\n<li>2n<code></code><code></code></li>\n</ul>\n<p>HashTable<code>initialCapacity</code>11. jdk8<strong></strong>8hashmap</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>hahsmapk-vNodetablekeyhashtableindex uhash</p>\n<blockquote>\n<p>keyhashCode</p>\n</blockquote>\n<p>keyhashCodehashNode hashmap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            tab[i] = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br></pre></td></tr></table></figure>\n\n<p>nhashkeyn2n<code>(n-1)&amp;hash</code>length<code>%</code></p>\n<h1 id=\"put\"><a href=\"#put\" class=\"headerlink\" title=\"put\"></a>put</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Implements Map.put and related methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> hash hash for key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> key the key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> value the value to put</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> evict if false, the table is in creation mode.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> previous value, or null if none</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> V <span class=\"title\">putVal</span><span class=\"params\">(<span class=\"keyword\">int</span> hash, K key, V value, <span class=\"keyword\">boolean</span> onlyIfAbsent,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">               <span class=\"keyword\">boolean</span> evict)</span> </span>&#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class=\"keyword\">int</span> n, i;</span><br><span class=\"line\">    <span class=\"comment\">// table</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tab = table) == <span class=\"keyword\">null</span> || (n = tab.length) == <span class=\"number\">0</span>)</span><br><span class=\"line\">        n = (tab = resize()).length;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        tab[i] = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        Node&lt;K,V&gt; e; K k;</span><br><span class=\"line\">        <span class=\"comment\">// keyugovalue</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.hash == hash &amp;&amp;</span><br><span class=\"line\">            ((k = p.key) == key || (key != <span class=\"keyword\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">            e = p;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (p <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class=\"keyword\">this</span>, tab, hash, key, value);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// table</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> binCount = <span class=\"number\">0</span>; ; ++binCount) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((e = p.next) == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    p.next = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// 8</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class=\"number\">1</span>) <span class=\"comment\">// -1 for 1st</span></span><br><span class=\"line\">                        treeifyBin(tab, hash);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.hash == hash &amp;&amp;</span><br><span class=\"line\">                    ((k = e.key) == key || (key != <span class=\"keyword\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                p = e;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123; <span class=\"comment\">// existing mapping for key</span></span><br><span class=\"line\">            V oldValue = e.value;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!onlyIfAbsent || oldValue == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                e.value = value;</span><br><span class=\"line\">            afterNodeAccess(e);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ++modCount;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (++size &gt; threshold)</span><br><span class=\"line\">        resize();</span><br><span class=\"line\">    afterNodeInsertion(evict);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>HashMapArrayListHashMapNode</p>\n<blockquote>\n<p>note: HashMap</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Initializes or doubles table size.  If null, allocates in</span></span><br><span class=\"line\"><span class=\"comment\"> * accord with initial capacity target held in field threshold.</span></span><br><span class=\"line\"><span class=\"comment\"> * Otherwise, because we are using power-of-two expansion, the</span></span><br><span class=\"line\"><span class=\"comment\"> * elements from each bin must either stay at same index, or move</span></span><br><span class=\"line\"><span class=\"comment\"> * with a power of two offset in the new table.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> the table</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldCap = (oldTab == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : oldTab.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldThr = threshold;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> newCap, newThr = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldCap &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// let it go</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class=\"line\">            threshold = Integer.MAX_VALUE;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldTab;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// X2</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ((newCap = oldCap &lt;&lt; <span class=\"number\">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class=\"line\">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class=\"line\">            newThr = oldThr &lt;&lt; <span class=\"number\">1</span>; <span class=\"comment\">// double threshold</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (oldThr &gt; <span class=\"number\">0</span>) <span class=\"comment\">// initial capacity was placed in threshold</span></span><br><span class=\"line\">        newCap = oldThr;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;               <span class=\"comment\">// zero initial threshold signifies using defaults</span></span><br><span class=\"line\">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class=\"line\">        newThr = (<span class=\"keyword\">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// resize</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newThr == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">float</span> ft = (<span class=\"keyword\">float</span>)newCap * loadFactor;</span><br><span class=\"line\">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class=\"keyword\">float</span>)MAXIMUM_CAPACITY ?</span><br><span class=\"line\">                  (<span class=\"keyword\">int</span>)ft : Integer.MAX_VALUE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    threshold = newThr;</span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class=\"line\">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class=\"keyword\">new</span> Node[newCap];</span><br><span class=\"line\">    table = newTab;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldTab != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class=\"line\">            Node&lt;K,V&gt; e;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((e = oldTab[j]) != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                oldTab[j] = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.next == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                    newTab[e.hash &amp; (newCap - <span class=\"number\">1</span>)] = e;</span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (e <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">                    ((TreeNode&lt;K,V&gt;)e).split(<span class=\"keyword\">this</span>, newTab, j, oldCap);</span><br><span class=\"line\">                <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// preserve order</span></span><br><span class=\"line\">                    Node&lt;K,V&gt; loHead = <span class=\"keyword\">null</span>, loTail = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; hiHead = <span class=\"keyword\">null</span>, hiTail = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; next;</span><br><span class=\"line\">                    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">                        next = e.next;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> ((e.hash &amp; oldCap) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (loTail == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                                loHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                loTail.next = e;</span><br><span class=\"line\">                            loTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (hiTail == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                                hiHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                hiTail.next = e;</span><br><span class=\"line\">                            hiTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">while</span> ((e = next) != <span class=\"keyword\">null</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (loTail != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        loTail.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        newTab[j] = loHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (hiTail != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        hiTail.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        newTab[j + oldCap] = hiHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> newTab;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>Java Hashmapjdk8</p>","more":"<h1 id=\"Example\"><a href=\"#Example\" class=\"headerlink\" title=\"Example\"></a>Example</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;name&quot;</span>, <span class=\"string\">&quot;Gloria&quot;</span>);</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;age&quot;</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">map.put(<span class=\"string\">&quot;wage&quot;</span>, <span class=\"number\">539.8</span>);</span><br><span class=\"line\">System.out.println(map);</span><br></pre></td></tr></table></figure>\n\n<p><code>put</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HashMapmap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map1 = <span class=\"keyword\">new</span> HashMap&lt;&gt;(map); <span class=\"comment\">// map</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * The load factor for the hash table.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">float</span> loadFactor;</span><br></pre></td></tr></table></figure>\n\n<p>HashMap<code>0.75</code>,</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">16</span>);</span><br></pre></td></tr></table></figure>\n\n<p>map<strong></strong>12<code>0.75</code>,<strong></strong></p>\n<h2 id=\"put\"><a href=\"#put\" class=\"headerlink\" title=\"put\"></a>put</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Implements Map.put and related methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> hash hash for key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> key the key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> value the value to put</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> evict if false, the table is in creation mode.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> previous value, or null if none</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> V <span class=\"title\">putVal</span><span class=\"params\">(<span class=\"keyword\">int</span> hash, K key, V value, <span class=\"keyword\">boolean</span> onlyIfAbsent,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">               <span class=\"keyword\">boolean</span> evict)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> putVal(hash(key), key, value, <span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>);</span><br><span class=\"line\">&#125;key</span><br></pre></td></tr></table></figure>\n\n<p>puthashhashkeyhashhash</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">hash</span><span class=\"params\">(Object key)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> h;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (key == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>easykeynull0hashmapkeynull,keynull<strong></strong>:</p>\n<ul>\n<li>^ (0)</li>\n<li>&gt;&gt;&gt; 0</li>\n</ul>\n<p>hkeyhashCodekeyhashcodeObject<code>native</code>h16</p>\n<p><code>table</code><code>Noe&lt;K,V&gt; []</code>Node</p>\n<h1 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a>Node</h1><p>HahsMap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * Basic hash bin node, used for most entries.  (See below for</span></span><br><span class=\"line\"><span class=\"comment\">  * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Node</span>&lt;<span class=\"title\">K</span>,<span class=\"title\">V</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">Map</span>.<span class=\"title\">Entry</span>&lt;<span class=\"title\">K</span>,<span class=\"title\">V</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> hash; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> K key;</span><br><span class=\"line\">    V value;</span><br><span class=\"line\">    Node&lt;K,V&gt; next; <span class=\"comment\">// Node</span></span><br><span class=\"line\"></span><br><span class=\"line\">    Node(<span class=\"keyword\">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hash = hash;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.key = key;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// get, set equals ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> <code>Node&lt;K, V&gt; next</code></li>\n<li><code>table</code>Node+</li>\n<li><code>Map.Entry&lt;K, V&gt;</code>k-v</li>\n<li><code>next</code><code>hash</code>, <code>key</code>, <code>value</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>=+<code>Node&lt;K, V&gt;</code><code>Node&lt;K, V&gt; []</code>hashmap<code>+</code></p>\n<p>hashmap<strong></strong><code>table</code><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The number of key-value mappings contained in this map.</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">transient</span> <span class=\"keyword\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The number of times this HashMap has been structurally modified</span></span><br><span class=\"line\"><span class=\"comment\">  * Structural modifications are those that change the number of mappings in</span></span><br><span class=\"line\"><span class=\"comment\">  * the HashMap or otherwise modify its internal structure (e.g.,</span></span><br><span class=\"line\"><span class=\"comment\">  * rehash).  This field is used to make iterators on Collection-views of</span></span><br><span class=\"line\"><span class=\"comment\">  * the HashMap fail-fast.  (See ConcurrentModificationException).</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">transient</span> <span class=\"keyword\">int</span> modCount;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The next size value at which to resize (capacity * load factor).</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"comment\">// (The javadoc description is true upon serialization.</span></span><br><span class=\"line\"><span class=\"comment\">// Additionally, if the table array has not been allocated, this</span></span><br><span class=\"line\"><span class=\"comment\">// field holds the initial array capacity, or zero signifying</span></span><br><span class=\"line\"><span class=\"comment\">// DEFAULT_INITIAL_CAPACITY.)</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> threshold;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * The load factor for the hash table.</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@serial</span></span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">float</span> loadFactor;</span><br></pre></td></tr></table></figure>\n\n<p><code>threshold</code>k-vNode&lt;K,V&gt;[] tablelength16, loadFactor0.75,</p>\n<blockquote>\n<p>threshold = loadFactor * length</p>\n</blockquote>\n<p>tableNode<code>threshold</code>12.Node12 16,12,1.</p>\n<p>sizeNode</p>\n<p>HashMaptable2n<strong></strong></p>\n<ul>\n<li>2n<code></code><code></code></li>\n</ul>\n<p>HashTable<code>initialCapacity</code>11. jdk8<strong></strong>8hashmap</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>hahsmapk-vNodetablekeyhashtableindex uhash</p>\n<blockquote>\n<p>keyhashCode</p>\n</blockquote>\n<p>keyhashCodehashNode hashmap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            tab[i] = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br></pre></td></tr></table></figure>\n\n<p>nhashkeyn2n<code>(n-1)&amp;hash</code>length<code>%</code></p>\n<h1 id=\"put\"><a href=\"#put\" class=\"headerlink\" title=\"put\"></a>put</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Implements Map.put and related methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> hash hash for key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> key the key</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> value the value to put</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> evict if false, the table is in creation mode.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> previous value, or null if none</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> V <span class=\"title\">putVal</span><span class=\"params\">(<span class=\"keyword\">int</span> hash, K key, V value, <span class=\"keyword\">boolean</span> onlyIfAbsent,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">               <span class=\"keyword\">boolean</span> evict)</span> </span>&#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class=\"keyword\">int</span> n, i;</span><br><span class=\"line\">    <span class=\"comment\">// table</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tab = table) == <span class=\"keyword\">null</span> || (n = tab.length) == <span class=\"number\">0</span>)</span><br><span class=\"line\">        n = (tab = resize()).length;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((p = tab[i = (n - <span class=\"number\">1</span>) &amp; hash]) == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        tab[i] = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        Node&lt;K,V&gt; e; K k;</span><br><span class=\"line\">        <span class=\"comment\">// keyugovalue</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.hash == hash &amp;&amp;</span><br><span class=\"line\">            ((k = p.key) == key || (key != <span class=\"keyword\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">            e = p;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (p <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class=\"keyword\">this</span>, tab, hash, key, value);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// table</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> binCount = <span class=\"number\">0</span>; ; ++binCount) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((e = p.next) == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    p.next = newNode(hash, key, value, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// 8</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class=\"number\">1</span>) <span class=\"comment\">// -1 for 1st</span></span><br><span class=\"line\">                        treeifyBin(tab, hash);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.hash == hash &amp;&amp;</span><br><span class=\"line\">                    ((k = e.key) == key || (key != <span class=\"keyword\">null</span> &amp;&amp; key.equals(k))))</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                p = e;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123; <span class=\"comment\">// existing mapping for key</span></span><br><span class=\"line\">            V oldValue = e.value;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!onlyIfAbsent || oldValue == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                e.value = value;</span><br><span class=\"line\">            afterNodeAccess(e);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ++modCount;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (++size &gt; threshold)</span><br><span class=\"line\">        resize();</span><br><span class=\"line\">    afterNodeInsertion(evict);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>HashMapArrayListHashMapNode</p>\n<blockquote>\n<p>note: HashMap</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Initializes or doubles table size.  If null, allocates in</span></span><br><span class=\"line\"><span class=\"comment\"> * accord with initial capacity target held in field threshold.</span></span><br><span class=\"line\"><span class=\"comment\"> * Otherwise, because we are using power-of-two expansion, the</span></span><br><span class=\"line\"><span class=\"comment\"> * elements from each bin must either stay at same index, or move</span></span><br><span class=\"line\"><span class=\"comment\"> * with a power of two offset in the new table.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> the table</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class=\"line\">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldCap = (oldTab == <span class=\"keyword\">null</span>) ? <span class=\"number\">0</span> : oldTab.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> oldThr = threshold;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> newCap, newThr = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldCap &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// let it go</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class=\"line\">            threshold = Integer.MAX_VALUE;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> oldTab;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// X2</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ((newCap = oldCap &lt;&lt; <span class=\"number\">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class=\"line\">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class=\"line\">            newThr = oldThr &lt;&lt; <span class=\"number\">1</span>; <span class=\"comment\">// double threshold</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (oldThr &gt; <span class=\"number\">0</span>) <span class=\"comment\">// initial capacity was placed in threshold</span></span><br><span class=\"line\">        newCap = oldThr;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;               <span class=\"comment\">// zero initial threshold signifies using defaults</span></span><br><span class=\"line\">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class=\"line\">        newThr = (<span class=\"keyword\">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// resize</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newThr == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">float</span> ft = (<span class=\"keyword\">float</span>)newCap * loadFactor;</span><br><span class=\"line\">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class=\"keyword\">float</span>)MAXIMUM_CAPACITY ?</span><br><span class=\"line\">                  (<span class=\"keyword\">int</span>)ft : Integer.MAX_VALUE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    threshold = newThr;</span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class=\"line\">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class=\"keyword\">new</span> Node[newCap];</span><br><span class=\"line\">    table = newTab;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (oldTab != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class=\"line\">            Node&lt;K,V&gt; e;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((e = oldTab[j]) != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                oldTab[j] = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e.next == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                    newTab[e.hash &amp; (newCap - <span class=\"number\">1</span>)] = e;</span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (e <span class=\"keyword\">instanceof</span> TreeNode)</span><br><span class=\"line\">                    ((TreeNode&lt;K,V&gt;)e).split(<span class=\"keyword\">this</span>, newTab, j, oldCap);</span><br><span class=\"line\">                <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// preserve order</span></span><br><span class=\"line\">                    Node&lt;K,V&gt; loHead = <span class=\"keyword\">null</span>, loTail = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; hiHead = <span class=\"keyword\">null</span>, hiTail = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    Node&lt;K,V&gt; next;</span><br><span class=\"line\">                    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">                        next = e.next;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> ((e.hash &amp; oldCap) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (loTail == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                                loHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                loTail.next = e;</span><br><span class=\"line\">                            loTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (hiTail == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                                hiHead = e;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                                hiTail.next = e;</span><br><span class=\"line\">                            hiTail = e;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">while</span> ((e = next) != <span class=\"keyword\">null</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (loTail != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        loTail.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        newTab[j] = loHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (hiTail != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        hiTail.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        newTab[j + oldCap] = hiHead;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> newTab;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"heap","date":"2020-06-06T14:54:27.000Z","_content":"\nJVM\n\ntopN\n\n<!-- more -->\n\n# \n\n\t\n\n## \n\n- \n- \n- \n\n## \n\n- \n- \n\n# \n\n\n\n\n\n![Screenshot from 2020-06-06 15-24-34.png](https://i.loli.net/2020/06/06/JbDlczXVh35sEF1.png)\n\n{62,42,59,32,39,44,13,22,29,14,33,30,17,9}\n\n_i__2i+1__2i+2__(i-1)/2_39424+1=9\n\n# \n\n## \n\ntop n \n\n## TOP N\n\n/\n\n```java\n// n\npublic static int[] topN(int[] array, int n) {\n    if (n == 0) {\n        return new int[0];\n    }\n    // default big heap, lambda make it small heap\n    Queue<Integer> heap = new PriorityQueue<>(n, ((o1, o2) -> Integer.compare(o2, o1)));\n\n    for (int e : array) {\n        // put the integer in when it smaller than the top of integer\n        if (heap.isEmpty() || heap.size() < n || e < heap.peek()) {\n            heap.offer(e);\n        }\n        if (heap.size() > n) {\n            // delete the top of heap integer\n            heap.poll();\n        }\n    }\n\n    int[] res = new int[heap.size()];\n    int j = 0;\n    for (int e : heap) {\n        res[j++] = e;\n    }\n    return res;\n}\n```\n\nforFIFO\n\nn\n\n```java\n// \nQueue<Integer> heap = new PriorityQueue<>(n);\nfor(int e: array){\n    // \n    if(heap.isEmpty() || heap.size() < n || e > heap.peak()){\n        heap.offer(e);\n    }\n    // \n    if(heap.size() > n){\n        heap.pool();\n    }\n}\n```\n\n\n\n\n\n","source":"_posts/heap.md","raw":"---\ntitle: heap\ndate: 2020-06-06 22:54:27\ncategories: Java\ntags: datastructure\n---\n\nJVM\n\ntopN\n\n<!-- more -->\n\n# \n\n\t\n\n## \n\n- \n- \n- \n\n## \n\n- \n- \n\n# \n\n\n\n\n\n![Screenshot from 2020-06-06 15-24-34.png](https://i.loli.net/2020/06/06/JbDlczXVh35sEF1.png)\n\n{62,42,59,32,39,44,13,22,29,14,33,30,17,9}\n\n_i__2i+1__2i+2__(i-1)/2_39424+1=9\n\n# \n\n## \n\ntop n \n\n## TOP N\n\n/\n\n```java\n// n\npublic static int[] topN(int[] array, int n) {\n    if (n == 0) {\n        return new int[0];\n    }\n    // default big heap, lambda make it small heap\n    Queue<Integer> heap = new PriorityQueue<>(n, ((o1, o2) -> Integer.compare(o2, o1)));\n\n    for (int e : array) {\n        // put the integer in when it smaller than the top of integer\n        if (heap.isEmpty() || heap.size() < n || e < heap.peek()) {\n            heap.offer(e);\n        }\n        if (heap.size() > n) {\n            // delete the top of heap integer\n            heap.poll();\n        }\n    }\n\n    int[] res = new int[heap.size()];\n    int j = 0;\n    for (int e : heap) {\n        res[j++] = e;\n    }\n    return res;\n}\n```\n\nforFIFO\n\nn\n\n```java\n// \nQueue<Integer> heap = new PriorityQueue<>(n);\nfor(int e: array){\n    // \n    if(heap.isEmpty() || heap.size() < n || e > heap.peak()){\n        heap.offer(e);\n    }\n    // \n    if(heap.size() > n){\n        heap.pool();\n    }\n}\n```\n\n\n\n\n\n","slug":"heap","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7c000uw5ihbz9pcsev","content":"<p>JVM</p>\n<p>topN</p>\n<a id=\"more\"></a>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>    </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2020/06/06/JbDlczXVh35sEF1.png\" alt=\"Screenshot from 2020-06-06 15-24-34.png\"></p>\n<p>{62,42,59,32,39,44,13,22,29,14,33,30,17,9}</p>\n<p>_i__2i+1__2i+2__(i-1)/2_39424+1=9</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>top n </p>\n<h2 id=\"TOP-N\"><a href=\"#TOP-N\" class=\"headerlink\" title=\"TOP N\"></a>TOP N</h2><p>/</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// n</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span>[] topN(<span class=\"keyword\">int</span>[] array, <span class=\"keyword\">int</span> n) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// default big heap, lambda make it small heap</span></span><br><span class=\"line\">    Queue&lt;Integer&gt; heap = <span class=\"keyword\">new</span> PriorityQueue&lt;&gt;(n, ((o1, o2) -&gt; Integer.compare(o2, o1)));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> e : array) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// put the integer in when it smaller than the top of integer</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (heap.isEmpty() || heap.size() &lt; n || e &lt; heap.peek()) &#123;</span><br><span class=\"line\">            heap.offer(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (heap.size() &gt; n) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// delete the top of heap integer</span></span><br><span class=\"line\">            heap.poll();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] res = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[heap.size()];</span><br><span class=\"line\">    <span class=\"keyword\">int</span> j = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> e : heap) &#123;</span><br><span class=\"line\">        res[j++] = e;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>forFIFO</p>\n<p>n</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">Queue&lt;Integer&gt; heap = <span class=\"keyword\">new</span> PriorityQueue&lt;&gt;(n);</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e: array)&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(heap.isEmpty() || heap.size() &lt; n || e &gt; heap.peak())&#123;</span><br><span class=\"line\">        heap.offer(e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(heap.size() &gt; n)&#123;</span><br><span class=\"line\">        heap.pool();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>JVM</p>\n<p>topN</p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>    </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p><img src=\"https://i.loli.net/2020/06/06/JbDlczXVh35sEF1.png\" alt=\"Screenshot from 2020-06-06 15-24-34.png\"></p>\n<p>{62,42,59,32,39,44,13,22,29,14,33,30,17,9}</p>\n<p>_i__2i+1__2i+2__(i-1)/2_39424+1=9</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>top n </p>\n<h2 id=\"TOP-N\"><a href=\"#TOP-N\" class=\"headerlink\" title=\"TOP N\"></a>TOP N</h2><p>/</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// n</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span>[] topN(<span class=\"keyword\">int</span>[] array, <span class=\"keyword\">int</span> n) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// default big heap, lambda make it small heap</span></span><br><span class=\"line\">    Queue&lt;Integer&gt; heap = <span class=\"keyword\">new</span> PriorityQueue&lt;&gt;(n, ((o1, o2) -&gt; Integer.compare(o2, o1)));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> e : array) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// put the integer in when it smaller than the top of integer</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (heap.isEmpty() || heap.size() &lt; n || e &lt; heap.peek()) &#123;</span><br><span class=\"line\">            heap.offer(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (heap.size() &gt; n) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// delete the top of heap integer</span></span><br><span class=\"line\">            heap.poll();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] res = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[heap.size()];</span><br><span class=\"line\">    <span class=\"keyword\">int</span> j = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> e : heap) &#123;</span><br><span class=\"line\">        res[j++] = e;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>forFIFO</p>\n<p>n</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">Queue&lt;Integer&gt; heap = <span class=\"keyword\">new</span> PriorityQueue&lt;&gt;(n);</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e: array)&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(heap.isEmpty() || heap.size() &lt; n || e &gt; heap.peak())&#123;</span><br><span class=\"line\">        heap.offer(e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(heap.size() &gt; n)&#123;</span><br><span class=\"line\">        heap.pool();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"https","date":"2020-03-14T02:43:29.000Z","_content":"\n**Hypertext Transfer Protocol Secure**, an extension of the Hypertext Transfer Protocol. \n\nHow to encrypt communication? Through referred to as **HTTP over TLS**, or **HTTP over SSL**\n\n- Transport Layer Security\n- Secure Sockets Layer\n\n<!-- more -->\n\n# HTTPHTTPS\n\n\n\n## Difference\n\nHTTPSURL`https://``443`httpTCPSSLTSLheader\n\n---\n\nHTTPURL`http://``80`TCP\n\n\n\n## Limitation\n\nSSL/TSLwebsite crawler\n\n\n\n# URIURLURN\n\nurluri\n\n## URI\n\n*A string of characters that unambiguously identifies a particular resource*.  `http://`\n\n## URN\n\n*A Uniform Resource Name(URN) is a URI that identifies a resource by name in a particular namespace.* \n\n## URL\n\n*A Uniform Resource Locator(URL) is a URI that specifies the means of acting upon or obtaining the representation of a resource.* http\n\n[reference](https://en.wikipedia.org/wiki/Uniform_Resource_Identifier)","source":"_posts/https.md","raw":"---\ntitle: https\ndate: 2020-03-14 10:43:29\ncategories: Network\ntags: ['http','https']\n---\n\n**Hypertext Transfer Protocol Secure**, an extension of the Hypertext Transfer Protocol. \n\nHow to encrypt communication? Through referred to as **HTTP over TLS**, or **HTTP over SSL**\n\n- Transport Layer Security\n- Secure Sockets Layer\n\n<!-- more -->\n\n# HTTPHTTPS\n\n\n\n## Difference\n\nHTTPSURL`https://``443`httpTCPSSLTSLheader\n\n---\n\nHTTPURL`http://``80`TCP\n\n\n\n## Limitation\n\nSSL/TSLwebsite crawler\n\n\n\n# URIURLURN\n\nurluri\n\n## URI\n\n*A string of characters that unambiguously identifies a particular resource*.  `http://`\n\n## URN\n\n*A Uniform Resource Name(URN) is a URI that identifies a resource by name in a particular namespace.* \n\n## URL\n\n*A Uniform Resource Locator(URL) is a URI that specifies the means of acting upon or obtaining the representation of a resource.* http\n\n[reference](https://en.wikipedia.org/wiki/Uniform_Resource_Identifier)","slug":"https","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7e000xw5ih6igs72r5","content":"<p><strong>Hypertext Transfer Protocol Secure</strong>, an extension of the Hypertext Transfer Protocol. </p>\n<p>How to encrypt communication? Through referred to as <strong>HTTP over TLS</strong>, or <strong>HTTP over SSL</strong></p>\n<ul>\n<li>Transport Layer Security</li>\n<li>Secure Sockets Layer</li>\n</ul>\n<a id=\"more\"></a>\n\n<h1 id=\"HTTPHTTPS\"><a href=\"#HTTPHTTPS\" class=\"headerlink\" title=\"HTTPHTTPS\"></a>HTTPHTTPS</h1><h2 id=\"Difference\"><a href=\"#Difference\" class=\"headerlink\" title=\"Difference\"></a>Difference</h2><p>HTTPSURL<code>https://</code><code>443</code>httpTCPSSLTSLheader</p>\n<hr>\n<p>HTTPURL<code>http://</code><code>80</code>TCP</p>\n<h2 id=\"Limitation\"><a href=\"#Limitation\" class=\"headerlink\" title=\"Limitation\"></a>Limitation</h2><p>SSL/TSLwebsite crawler</p>\n<h1 id=\"URIURLURN\"><a href=\"#URIURLURN\" class=\"headerlink\" title=\"URIURLURN\"></a>URIURLURN</h1><p>urluri</p>\n<h2 id=\"URI\"><a href=\"#URI\" class=\"headerlink\" title=\"URI\"></a>URI</h2><p><em>A string of characters that unambiguously identifies a particular resource</em>.  <code>http://</code></p>\n<h2 id=\"URN\"><a href=\"#URN\" class=\"headerlink\" title=\"URN\"></a>URN</h2><p><em>A Uniform Resource Name(URN) is a URI that identifies a resource by name in a particular namespace.</em> </p>\n<h2 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a>URL</h2><p><em>A Uniform Resource Locator(URL) is a URI that specifies the means of acting upon or obtaining the representation of a resource.</em> http</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Uniform_Resource_Identifier\">reference</a></p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p><strong>Hypertext Transfer Protocol Secure</strong>, an extension of the Hypertext Transfer Protocol. </p>\n<p>How to encrypt communication? Through referred to as <strong>HTTP over TLS</strong>, or <strong>HTTP over SSL</strong></p>\n<ul>\n<li>Transport Layer Security</li>\n<li>Secure Sockets Layer</li>\n</ul>","more":"<h1 id=\"HTTPHTTPS\"><a href=\"#HTTPHTTPS\" class=\"headerlink\" title=\"HTTPHTTPS\"></a>HTTPHTTPS</h1><h2 id=\"Difference\"><a href=\"#Difference\" class=\"headerlink\" title=\"Difference\"></a>Difference</h2><p>HTTPSURL<code>https://</code><code>443</code>httpTCPSSLTSLheader</p>\n<hr>\n<p>HTTPURL<code>http://</code><code>80</code>TCP</p>\n<h2 id=\"Limitation\"><a href=\"#Limitation\" class=\"headerlink\" title=\"Limitation\"></a>Limitation</h2><p>SSL/TSLwebsite crawler</p>\n<h1 id=\"URIURLURN\"><a href=\"#URIURLURN\" class=\"headerlink\" title=\"URIURLURN\"></a>URIURLURN</h1><p>urluri</p>\n<h2 id=\"URI\"><a href=\"#URI\" class=\"headerlink\" title=\"URI\"></a>URI</h2><p><em>A string of characters that unambiguously identifies a particular resource</em>.  <code>http://</code></p>\n<h2 id=\"URN\"><a href=\"#URN\" class=\"headerlink\" title=\"URN\"></a>URN</h2><p><em>A Uniform Resource Name(URN) is a URI that identifies a resource by name in a particular namespace.</em> </p>\n<h2 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a>URL</h2><p><em>A Uniform Resource Locator(URL) is a URI that specifies the means of acting upon or obtaining the representation of a resource.</em> http</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Uniform_Resource_Identifier\">reference</a></p>"},{"title":"java collection framework","date":"2021-03-06T04:03:11.000Z","_content":"\n****\n\n<!-- import -->\n\n<!-- toc -->\n\n# \n\n\t\tjdk--JDKjdkObjectemmmidea\n\n# \n\n\t\t\n\n\t\t`Collection`collectionfor`iterator``collection``iterator`iterator\n\n```java\npublic abstract Iterator<E> iterator();\n\npublic abstract int size();\n\npublic void clear() {\n    Iterator<E> it = iterator();\n    while (it.hasNext()) {\n        it.next();\n        it.remove();\n    }\n}\n\npublic Object[] toArray() {\n    // Estimate size of array; be prepared to see more or fewer elements\n    Object[] r = new Object[size()];\n    Iterator<E> it = iterator();\n    for (int i = 0; i < r.length; i++) {\n        if (! it.hasNext()) // fewer elements than expected\n            return Arrays.copyOf(r, i);\n        r[i] = it.next();\n    }\n    return it.hasNext() ? finishToArray(r, it) : r;\n}\n\npublic boolean add(E e) {\n    throw new UnsupportedOperationException();\n}\n```\n\n`collection`collection`List``Set``Queue``Collection``Collection``Collection``Collection`collectionMap\n\njdk\n\n# \n\n \n\n","source":"_posts/java-collection-framework.md","raw":"---\ntitle: java collection framework\ndate: 2021-03-06 12:03:11\ncategories: jdk\ntags: framework\n---\n\n****\n\n<!-- import -->\n\n<!-- toc -->\n\n# \n\n\t\tjdk--JDKjdkObjectemmmidea\n\n# \n\n\t\t\n\n\t\t`Collection`collectionfor`iterator``collection``iterator`iterator\n\n```java\npublic abstract Iterator<E> iterator();\n\npublic abstract int size();\n\npublic void clear() {\n    Iterator<E> it = iterator();\n    while (it.hasNext()) {\n        it.next();\n        it.remove();\n    }\n}\n\npublic Object[] toArray() {\n    // Estimate size of array; be prepared to see more or fewer elements\n    Object[] r = new Object[size()];\n    Iterator<E> it = iterator();\n    for (int i = 0; i < r.length; i++) {\n        if (! it.hasNext()) // fewer elements than expected\n            return Arrays.copyOf(r, i);\n        r[i] = it.next();\n    }\n    return it.hasNext() ? finishToArray(r, it) : r;\n}\n\npublic boolean add(E e) {\n    throw new UnsupportedOperationException();\n}\n```\n\n`collection`collection`List``Set``Queue``Collection``Collection``Collection``Collection`collectionMap\n\njdk\n\n# \n\n \n\n","slug":"java-collection-framework","published":1,"updated":"2021-03-06T14:18:56.499Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7g0011w5ih3swj1f2a","content":"<p><strong></strong></p>\n<!-- import -->\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        jdkJDKjdkObjectemmmidea</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        </p>\n<p>        <code>Collection</code>collectionfor<code>iterator</code><code>collection</code><code>iterator</code>iterator</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> Iterator&lt;E&gt; <span class=\"title\">iterator</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">int</span> <span class=\"title\">size</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">clear</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    Iterator&lt;E&gt; it = iterator();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (it.hasNext()) &#123;</span><br><span class=\"line\">        it.next();</span><br><span class=\"line\">        it.remove();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> Object[] toArray() &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Estimate size of array; be prepared to see more or fewer elements</span></span><br><span class=\"line\">    Object[] r = <span class=\"keyword\">new</span> Object[size()];</span><br><span class=\"line\">    Iterator&lt;E&gt; it = iterator();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; r.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! it.hasNext()) <span class=\"comment\">// fewer elements than expected</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> Arrays.copyOf(r, i);</span><br><span class=\"line\">        r[i] = it.next();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> it.hasNext() ? finishToArray(r, it) : r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">add</span><span class=\"params\">(E e)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> UnsupportedOperationException();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>collection</code>collection<code>List</code><code>Set</code><code>Queue</code><code>Collection</code><code>Collection</code><code>Collection</code><code>Collection</code>collectionMap</p>\n<p>jdk</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> </p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":"<p><strong></strong></p>\n<!-- import -->\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        jdkJDKjdkObjectemmmidea</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        </p>\n<p>        <code>Collection</code>collectionfor<code>iterator</code><code>collection</code><code>iterator</code>iterator</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> Iterator&lt;E&gt; <span class=\"title\">iterator</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">int</span> <span class=\"title\">size</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">clear</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    Iterator&lt;E&gt; it = iterator();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (it.hasNext()) &#123;</span><br><span class=\"line\">        it.next();</span><br><span class=\"line\">        it.remove();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> Object[] toArray() &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Estimate size of array; be prepared to see more or fewer elements</span></span><br><span class=\"line\">    Object[] r = <span class=\"keyword\">new</span> Object[size()];</span><br><span class=\"line\">    Iterator&lt;E&gt; it = iterator();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; r.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! it.hasNext()) <span class=\"comment\">// fewer elements than expected</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> Arrays.copyOf(r, i);</span><br><span class=\"line\">        r[i] = it.next();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> it.hasNext() ? finishToArray(r, it) : r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">add</span><span class=\"params\">(E e)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> UnsupportedOperationException();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>collection</code>collection<code>List</code><code>Set</code><code>Queue</code><code>Collection</code><code>Collection</code><code>Collection</code><code>Collection</code>collectionMap</p>\n<p>jdk</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> </p>\n"},{"title":"SpringBoot refresh","date":"2021-02-15T08:19:30.000Z","_content":"\nSpringBootrun*refresh*\n\n<!--more-->\n\nSpringBootrefreshrefreshrefreshrefresh\n\n```java\nsynchronized (this.startupShutdownMonitor) {\n    // Prepare this context for refreshing.\n    prepareRefresh();\n\n    // Tell the subclass to refresh the internal bean factory.\n    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();\n\n    // Prepare the bean factory for use in this context.\n    prepareBeanFactory(beanFactory);\n\n    try {\n        // Allows post-processing of the bean factory in context subclasses.\n        postProcessBeanFactory(beanFactory);\n\n        // Invoke factory processors registered as beans in the context.\n        invokeBeanFactoryPostProcessors(beanFactory);\n\n        // Register bean processors that intercept bean creation.\n        registerBeanPostProcessors(beanFactory);\n\n        // Initialize message source for this context.\n        initMessageSource();\n\n        // Initialize event multicaster for this context.\n        initApplicationEventMulticaster();\n\n        // Initialize other special beans in specific context subclasses.\n        onRefresh();\n\n        // Check for listener beans and register them.\n        registerListeners();\n\n        // Instantiate all remaining (non-lazy-init) singletons.\n        finishBeanFactoryInitialization(beanFactory);\n\n        // Last step: publish corresponding event.\n        finishRefresh();\n    }\n```\n\n<!--toc-->\n\n# prepareRefresh\n\nproperty\n\n\n\n# prepareBeanFactory\n\nbeanFactory\n\n1. bean\n\n2. beanPostProcessor`ApplicationContextAwarePostProcessor`\n\n   ```java\n   // Configure the bean factory with context callbacks.\n   beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));\n   beanFactory.ignoreDependencyInterface(EnvironmentAware.class);\n   beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);\n   beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);\n   beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);\n   beanFactory.ignoreDependencyInterface(MessageSourceAware.class);\n   beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);\n   ```\n\n3. bean*registerResolvableDependency*key-valuemap\n\n   ```java\n   // BeanFactory interface not registered as resolvable type in a plain factory.\n   // MessageSource registered (and found for autowiring) as a bean.\n   beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);\n   // this\n   beanFactory.registerResolvableDependency(ResourceLoader.class, this);\n   beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this);\n   beanFactory.registerResolvableDependency(ApplicationContext.class, this);\n   ```\n\n\n\n# postProcessBeanFactory\n\npostProcessorbeanFacotrywebbeanservletContext\n\n```java\nprotected void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) {\n    // addignoreprocessor\n    beanFactory.addBeanPostProcessor(new ServletContextAwareProcessor(this.servletContext, this.servletConfig));\n    beanFactory.ignoreDependencyInterface(ServletContextAware.class);\n    beanFactory.ignoreDependencyInterface(ServletConfigAware.class);\n\n    WebApplicationContextUtils.registerWebApplicationScopes(beanFactory, this.servletContext);\n    WebApplicationContextUtils.registerEnvironmentBeans(beanFactory, this.servletContext, this.servletConfig);\n}\n```\n\n\n\n# invokeBeanFactoryPostProcessors\n\npostProcessContextpostProcessorBeanFactory`PostProcessorRegistrationDelegate`\n\n\t\tpostProcessorpriorityOrdered, ordered, regularprocessorcontextcontext*BeanDefinitionRegistry*postProcessor\n\n```java\nString[] postProcessorNames =\n    beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);\nfor (String ppName : postProcessorNames) {\n    if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {\n        // configurationClassPostProcessor@Config\n        currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));\n        processedBeans.add(ppName);\n    }\n}\nsortPostProcessors(currentRegistryProcessors, beanFactory);\nregistryProcessors.addAll(currentRegistryProcessors);\ninvokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);\ncurrentRegistryProcessors.clear();\n```\n\n\t\tConfigertaion@SpringApplication`ConfigurationClassParser`beanBeanDefinitionHolderbeanDefinitionbean*doProcessConfigurationClass*@PropertySource@ComponentScan@Import@ImportResourceimport`selector`\n\n\t\t@SpringApplication\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@SpringBootConfiguration\n@EnableAutoConfiguration // \n@ComponentScan(excludeFilters = { @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),\n\t\t@Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) })\npublic @interface SpringBootApplication {\n    // ...\n}\n```\n\n\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@AutoConfigurationPackage\n@Import(AutoConfigurationImportSelector.class) // \npublic @interface EnableAutoConfiguration {\n    // ...\n}\n```\n\nAutoConfigurationImportSelectorselectImport`getCandidateConfigurations`*EnableAutoConfiguration.class*key*spring.factories*values\n\n```properties\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\\norg.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\\n# ...\n```\n\nbeanFactory\n\n\n\n# registerBeanPostProcessors\n\n`PostProcessorRegistrationDelegate`\n\n\n\n# InitMessageSource\n\n\n\n\n\n# initApplicationEventMulticaster\n\n\n\n\n\n# onRefresh\n\nServletweb\n\n\n\n# registerListeners\n\n\n\n\n\n# finishBeanFactoryInitialization\n\nbean\n\n\n\n# finishRefresh\n\n\n\n\n\n# \n\nrefresh\n\n- \n- \n- bean","source":"_posts/SpringBoot-refresh.md","raw":"---\ntitle: SpringBoot refresh\ndate: 2021-02-15 16:19:30\ncategories: springboot\ntags: source\n---\n\nSpringBootrun*refresh*\n\n<!--more-->\n\nSpringBootrefreshrefreshrefreshrefresh\n\n```java\nsynchronized (this.startupShutdownMonitor) {\n    // Prepare this context for refreshing.\n    prepareRefresh();\n\n    // Tell the subclass to refresh the internal bean factory.\n    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();\n\n    // Prepare the bean factory for use in this context.\n    prepareBeanFactory(beanFactory);\n\n    try {\n        // Allows post-processing of the bean factory in context subclasses.\n        postProcessBeanFactory(beanFactory);\n\n        // Invoke factory processors registered as beans in the context.\n        invokeBeanFactoryPostProcessors(beanFactory);\n\n        // Register bean processors that intercept bean creation.\n        registerBeanPostProcessors(beanFactory);\n\n        // Initialize message source for this context.\n        initMessageSource();\n\n        // Initialize event multicaster for this context.\n        initApplicationEventMulticaster();\n\n        // Initialize other special beans in specific context subclasses.\n        onRefresh();\n\n        // Check for listener beans and register them.\n        registerListeners();\n\n        // Instantiate all remaining (non-lazy-init) singletons.\n        finishBeanFactoryInitialization(beanFactory);\n\n        // Last step: publish corresponding event.\n        finishRefresh();\n    }\n```\n\n<!--toc-->\n\n# prepareRefresh\n\nproperty\n\n\n\n# prepareBeanFactory\n\nbeanFactory\n\n1. bean\n\n2. beanPostProcessor`ApplicationContextAwarePostProcessor`\n\n   ```java\n   // Configure the bean factory with context callbacks.\n   beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));\n   beanFactory.ignoreDependencyInterface(EnvironmentAware.class);\n   beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);\n   beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);\n   beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);\n   beanFactory.ignoreDependencyInterface(MessageSourceAware.class);\n   beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);\n   ```\n\n3. bean*registerResolvableDependency*key-valuemap\n\n   ```java\n   // BeanFactory interface not registered as resolvable type in a plain factory.\n   // MessageSource registered (and found for autowiring) as a bean.\n   beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);\n   // this\n   beanFactory.registerResolvableDependency(ResourceLoader.class, this);\n   beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this);\n   beanFactory.registerResolvableDependency(ApplicationContext.class, this);\n   ```\n\n\n\n# postProcessBeanFactory\n\npostProcessorbeanFacotrywebbeanservletContext\n\n```java\nprotected void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) {\n    // addignoreprocessor\n    beanFactory.addBeanPostProcessor(new ServletContextAwareProcessor(this.servletContext, this.servletConfig));\n    beanFactory.ignoreDependencyInterface(ServletContextAware.class);\n    beanFactory.ignoreDependencyInterface(ServletConfigAware.class);\n\n    WebApplicationContextUtils.registerWebApplicationScopes(beanFactory, this.servletContext);\n    WebApplicationContextUtils.registerEnvironmentBeans(beanFactory, this.servletContext, this.servletConfig);\n}\n```\n\n\n\n# invokeBeanFactoryPostProcessors\n\npostProcessContextpostProcessorBeanFactory`PostProcessorRegistrationDelegate`\n\n\t\tpostProcessorpriorityOrdered, ordered, regularprocessorcontextcontext*BeanDefinitionRegistry*postProcessor\n\n```java\nString[] postProcessorNames =\n    beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);\nfor (String ppName : postProcessorNames) {\n    if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {\n        // configurationClassPostProcessor@Config\n        currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));\n        processedBeans.add(ppName);\n    }\n}\nsortPostProcessors(currentRegistryProcessors, beanFactory);\nregistryProcessors.addAll(currentRegistryProcessors);\ninvokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);\ncurrentRegistryProcessors.clear();\n```\n\n\t\tConfigertaion@SpringApplication`ConfigurationClassParser`beanBeanDefinitionHolderbeanDefinitionbean*doProcessConfigurationClass*@PropertySource@ComponentScan@Import@ImportResourceimport`selector`\n\n\t\t@SpringApplication\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@SpringBootConfiguration\n@EnableAutoConfiguration // \n@ComponentScan(excludeFilters = { @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),\n\t\t@Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) })\npublic @interface SpringBootApplication {\n    // ...\n}\n```\n\n\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@AutoConfigurationPackage\n@Import(AutoConfigurationImportSelector.class) // \npublic @interface EnableAutoConfiguration {\n    // ...\n}\n```\n\nAutoConfigurationImportSelectorselectImport`getCandidateConfigurations`*EnableAutoConfiguration.class*key*spring.factories*values\n\n```properties\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\\norg.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\\n# ...\n```\n\nbeanFactory\n\n\n\n# registerBeanPostProcessors\n\n`PostProcessorRegistrationDelegate`\n\n\n\n# InitMessageSource\n\n\n\n\n\n# initApplicationEventMulticaster\n\n\n\n\n\n# onRefresh\n\nServletweb\n\n\n\n# registerListeners\n\n\n\n\n\n# finishBeanFactoryInitialization\n\nbean\n\n\n\n# finishRefresh\n\n\n\n\n\n# \n\nrefresh\n\n- \n- \n- bean","slug":"SpringBoot-refresh","published":1,"updated":"2021-02-17T07:46:12.104Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7h0013w5ihhdjgbwme","content":"<p>SpringBootrun<em>refresh</em></p>\n<a id=\"more\"></a>\n\n<p>SpringBootrefreshrefreshrefreshrefresh</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.startupShutdownMonitor) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Prepare this context for refreshing.</span></span><br><span class=\"line\">    prepareRefresh();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Tell the subclass to refresh the internal bean factory.</span></span><br><span class=\"line\">    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Prepare the bean factory for use in this context.</span></span><br><span class=\"line\">    prepareBeanFactory(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Allows post-processing of the bean factory in context subclasses.</span></span><br><span class=\"line\">        postProcessBeanFactory(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Invoke factory processors registered as beans in the context.</span></span><br><span class=\"line\">        invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Register bean processors that intercept bean creation.</span></span><br><span class=\"line\">        registerBeanPostProcessors(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize message source for this context.</span></span><br><span class=\"line\">        initMessageSource();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize event multicaster for this context.</span></span><br><span class=\"line\">        initApplicationEventMulticaster();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize other special beans in specific context subclasses.</span></span><br><span class=\"line\">        onRefresh();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Check for listener beans and register them.</span></span><br><span class=\"line\">        registerListeners();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Instantiate all remaining (non-lazy-init) singletons.</span></span><br><span class=\"line\">        finishBeanFactoryInitialization(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Last step: publish corresponding event.</span></span><br><span class=\"line\">        finishRefresh();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<!--toc-->\n\n<h1 id=\"prepareRefresh\"><a href=\"#prepareRefresh\" class=\"headerlink\" title=\"prepareRefresh\"></a>prepareRefresh</h1><p>property</p>\n<h1 id=\"prepareBeanFactory\"><a href=\"#prepareBeanFactory\" class=\"headerlink\" title=\"prepareBeanFactory\"></a>prepareBeanFactory</h1><p>beanFactory</p>\n<ol>\n<li><p>bean</p>\n</li>\n<li><p>beanPostProcessor<code>ApplicationContextAwarePostProcessor</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Configure the bean factory with context callbacks.</span></span><br><span class=\"line\">beanFactory.addBeanPostProcessor(<span class=\"keyword\">new</span> ApplicationContextAwareProcessor(<span class=\"keyword\">this</span>));</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(EnvironmentAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(MessageSourceAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>bean<em>registerResolvableDependency</em>key-valuemap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// BeanFactory interface not registered as resolvable type in a plain factory.</span></span><br><span class=\"line\"><span class=\"comment\">// MessageSource registered (and found for autowiring) as a bean.</span></span><br><span class=\"line\">beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);</span><br><span class=\"line\"><span class=\"comment\">// this</span></span><br><span class=\"line\">beanFactory.registerResolvableDependency(ResourceLoader.class, <span class=\"keyword\">this</span>);</span><br><span class=\"line\">beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, <span class=\"keyword\">this</span>);</span><br><span class=\"line\">beanFactory.registerResolvableDependency(ApplicationContext.class, <span class=\"keyword\">this</span>);</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ol>\n<h1 id=\"postProcessBeanFactory\"><a href=\"#postProcessBeanFactory\" class=\"headerlink\" title=\"postProcessBeanFactory\"></a>postProcessBeanFactory</h1><p>postProcessorbeanFacotrywebbeanservletContext</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">postProcessBeanFactory</span><span class=\"params\">(ConfigurableListableBeanFactory beanFactory)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// addignoreprocessor</span></span><br><span class=\"line\">    beanFactory.addBeanPostProcessor(<span class=\"keyword\">new</span> ServletContextAwareProcessor(<span class=\"keyword\">this</span>.servletContext, <span class=\"keyword\">this</span>.servletConfig));</span><br><span class=\"line\">    beanFactory.ignoreDependencyInterface(ServletContextAware.class);</span><br><span class=\"line\">    beanFactory.ignoreDependencyInterface(ServletConfigAware.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    WebApplicationContextUtils.registerWebApplicationScopes(beanFactory, <span class=\"keyword\">this</span>.servletContext);</span><br><span class=\"line\">    WebApplicationContextUtils.registerEnvironmentBeans(beanFactory, <span class=\"keyword\">this</span>.servletContext, <span class=\"keyword\">this</span>.servletConfig);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"invokeBeanFactoryPostProcessors\"><a href=\"#invokeBeanFactoryPostProcessors\" class=\"headerlink\" title=\"invokeBeanFactoryPostProcessors\"></a>invokeBeanFactoryPostProcessors</h1><p>postProcessContextpostProcessorBeanFactory<code>PostProcessorRegistrationDelegate</code></p>\n<p>        postProcessorpriorityOrdered, ordered, regularprocessorcontextcontext<em>BeanDefinitionRegistry</em>postProcessor</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String[] postProcessorNames =</span><br><span class=\"line\">    beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, <span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String ppName : postProcessorNames) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// configurationClassPostProcessor@Config</span></span><br><span class=\"line\">        currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));</span><br><span class=\"line\">        processedBeans.add(ppName);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">sortPostProcessors(currentRegistryProcessors, beanFactory);</span><br><span class=\"line\">registryProcessors.addAll(currentRegistryProcessors);</span><br><span class=\"line\">invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);</span><br><span class=\"line\">currentRegistryProcessors.clear();</span><br></pre></td></tr></table></figure>\n\n<p>        Configertaion@SpringApplication<code>ConfigurationClassParser</code>beanBeanDefinitionHolderbeanDefinitionbean<em>doProcessConfigurationClass</em>@PropertySource@ComponentScan@Import@ImportResourceimport<code>selector</code></p>\n<p>        @SpringApplication</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootConfiguration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableAutoConfiguration</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan(excludeFilters = &#123; @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),</span></span><br><span class=\"line\"><span class=\"meta\">\t\t@Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) &#125;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> SpringBootApplication &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@AutoConfigurationPackage</span></span><br><span class=\"line\"><span class=\"meta\">@Import(AutoConfigurationImportSelector.class)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> EnableAutoConfiguration &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AutoConfigurationImportSelectorselectImport<code>getCandidateConfigurations</code><em>EnableAutoConfiguration.class</em>key<em>spring.factories</em>values</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\</span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br></pre></td></tr></table></figure>\n\n<p>beanFactory</p>\n<h1 id=\"registerBeanPostProcessors\"><a href=\"#registerBeanPostProcessors\" class=\"headerlink\" title=\"registerBeanPostProcessors\"></a>registerBeanPostProcessors</h1><p><code>PostProcessorRegistrationDelegate</code></p>\n<h1 id=\"InitMessageSource\"><a href=\"#InitMessageSource\" class=\"headerlink\" title=\"InitMessageSource\"></a>InitMessageSource</h1><p></p>\n<h1 id=\"initApplicationEventMulticaster\"><a href=\"#initApplicationEventMulticaster\" class=\"headerlink\" title=\"initApplicationEventMulticaster\"></a>initApplicationEventMulticaster</h1><p></p>\n<h1 id=\"onRefresh\"><a href=\"#onRefresh\" class=\"headerlink\" title=\"onRefresh\"></a>onRefresh</h1><p>Servletweb</p>\n<h1 id=\"registerListeners\"><a href=\"#registerListeners\" class=\"headerlink\" title=\"registerListeners\"></a>registerListeners</h1><p></p>\n<h1 id=\"finishBeanFactoryInitialization\"><a href=\"#finishBeanFactoryInitialization\" class=\"headerlink\" title=\"finishBeanFactoryInitialization\"></a>finishBeanFactoryInitialization</h1><p>bean</p>\n<h1 id=\"finishRefresh\"><a href=\"#finishRefresh\" class=\"headerlink\" title=\"finishRefresh\"></a>finishRefresh</h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>refresh</p>\n<ul>\n<li></li>\n<li></li>\n<li>bean</li>\n</ul>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>SpringBootrun<em>refresh</em></p>","more":"<p>SpringBootrefreshrefreshrefreshrefresh</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.startupShutdownMonitor) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Prepare this context for refreshing.</span></span><br><span class=\"line\">    prepareRefresh();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Tell the subclass to refresh the internal bean factory.</span></span><br><span class=\"line\">    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Prepare the bean factory for use in this context.</span></span><br><span class=\"line\">    prepareBeanFactory(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Allows post-processing of the bean factory in context subclasses.</span></span><br><span class=\"line\">        postProcessBeanFactory(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Invoke factory processors registered as beans in the context.</span></span><br><span class=\"line\">        invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Register bean processors that intercept bean creation.</span></span><br><span class=\"line\">        registerBeanPostProcessors(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize message source for this context.</span></span><br><span class=\"line\">        initMessageSource();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize event multicaster for this context.</span></span><br><span class=\"line\">        initApplicationEventMulticaster();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Initialize other special beans in specific context subclasses.</span></span><br><span class=\"line\">        onRefresh();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Check for listener beans and register them.</span></span><br><span class=\"line\">        registerListeners();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Instantiate all remaining (non-lazy-init) singletons.</span></span><br><span class=\"line\">        finishBeanFactoryInitialization(beanFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Last step: publish corresponding event.</span></span><br><span class=\"line\">        finishRefresh();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<!--toc-->\n\n<h1 id=\"prepareRefresh\"><a href=\"#prepareRefresh\" class=\"headerlink\" title=\"prepareRefresh\"></a>prepareRefresh</h1><p>property</p>\n<h1 id=\"prepareBeanFactory\"><a href=\"#prepareBeanFactory\" class=\"headerlink\" title=\"prepareBeanFactory\"></a>prepareBeanFactory</h1><p>beanFactory</p>\n<ol>\n<li><p>bean</p>\n</li>\n<li><p>beanPostProcessor<code>ApplicationContextAwarePostProcessor</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Configure the bean factory with context callbacks.</span></span><br><span class=\"line\">beanFactory.addBeanPostProcessor(<span class=\"keyword\">new</span> ApplicationContextAwareProcessor(<span class=\"keyword\">this</span>));</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(EnvironmentAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(MessageSourceAware.class);</span><br><span class=\"line\">beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>bean<em>registerResolvableDependency</em>key-valuemap</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// BeanFactory interface not registered as resolvable type in a plain factory.</span></span><br><span class=\"line\"><span class=\"comment\">// MessageSource registered (and found for autowiring) as a bean.</span></span><br><span class=\"line\">beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);</span><br><span class=\"line\"><span class=\"comment\">// this</span></span><br><span class=\"line\">beanFactory.registerResolvableDependency(ResourceLoader.class, <span class=\"keyword\">this</span>);</span><br><span class=\"line\">beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, <span class=\"keyword\">this</span>);</span><br><span class=\"line\">beanFactory.registerResolvableDependency(ApplicationContext.class, <span class=\"keyword\">this</span>);</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ol>\n<h1 id=\"postProcessBeanFactory\"><a href=\"#postProcessBeanFactory\" class=\"headerlink\" title=\"postProcessBeanFactory\"></a>postProcessBeanFactory</h1><p>postProcessorbeanFacotrywebbeanservletContext</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">postProcessBeanFactory</span><span class=\"params\">(ConfigurableListableBeanFactory beanFactory)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// addignoreprocessor</span></span><br><span class=\"line\">    beanFactory.addBeanPostProcessor(<span class=\"keyword\">new</span> ServletContextAwareProcessor(<span class=\"keyword\">this</span>.servletContext, <span class=\"keyword\">this</span>.servletConfig));</span><br><span class=\"line\">    beanFactory.ignoreDependencyInterface(ServletContextAware.class);</span><br><span class=\"line\">    beanFactory.ignoreDependencyInterface(ServletConfigAware.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    WebApplicationContextUtils.registerWebApplicationScopes(beanFactory, <span class=\"keyword\">this</span>.servletContext);</span><br><span class=\"line\">    WebApplicationContextUtils.registerEnvironmentBeans(beanFactory, <span class=\"keyword\">this</span>.servletContext, <span class=\"keyword\">this</span>.servletConfig);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"invokeBeanFactoryPostProcessors\"><a href=\"#invokeBeanFactoryPostProcessors\" class=\"headerlink\" title=\"invokeBeanFactoryPostProcessors\"></a>invokeBeanFactoryPostProcessors</h1><p>postProcessContextpostProcessorBeanFactory<code>PostProcessorRegistrationDelegate</code></p>\n<p>        postProcessorpriorityOrdered, ordered, regularprocessorcontextcontext<em>BeanDefinitionRegistry</em>postProcessor</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String[] postProcessorNames =</span><br><span class=\"line\">    beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, <span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String ppName : postProcessorNames) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// configurationClassPostProcessor@Config</span></span><br><span class=\"line\">        currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));</span><br><span class=\"line\">        processedBeans.add(ppName);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">sortPostProcessors(currentRegistryProcessors, beanFactory);</span><br><span class=\"line\">registryProcessors.addAll(currentRegistryProcessors);</span><br><span class=\"line\">invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);</span><br><span class=\"line\">currentRegistryProcessors.clear();</span><br></pre></td></tr></table></figure>\n\n<p>        Configertaion@SpringApplication<code>ConfigurationClassParser</code>beanBeanDefinitionHolderbeanDefinitionbean<em>doProcessConfigurationClass</em>@PropertySource@ComponentScan@Import@ImportResourceimport<code>selector</code></p>\n<p>        @SpringApplication</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootConfiguration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableAutoConfiguration</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan(excludeFilters = &#123; @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),</span></span><br><span class=\"line\"><span class=\"meta\">\t\t@Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) &#125;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> SpringBootApplication &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@AutoConfigurationPackage</span></span><br><span class=\"line\"><span class=\"meta\">@Import(AutoConfigurationImportSelector.class)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> EnableAutoConfiguration &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AutoConfigurationImportSelectorselectImport<code>getCandidateConfigurations</code><em>EnableAutoConfiguration.class</em>key<em>spring.factories</em>values</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\</span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br></pre></td></tr></table></figure>\n\n<p>beanFactory</p>\n<h1 id=\"registerBeanPostProcessors\"><a href=\"#registerBeanPostProcessors\" class=\"headerlink\" title=\"registerBeanPostProcessors\"></a>registerBeanPostProcessors</h1><p><code>PostProcessorRegistrationDelegate</code></p>\n<h1 id=\"InitMessageSource\"><a href=\"#InitMessageSource\" class=\"headerlink\" title=\"InitMessageSource\"></a>InitMessageSource</h1><p></p>\n<h1 id=\"initApplicationEventMulticaster\"><a href=\"#initApplicationEventMulticaster\" class=\"headerlink\" title=\"initApplicationEventMulticaster\"></a>initApplicationEventMulticaster</h1><p></p>\n<h1 id=\"onRefresh\"><a href=\"#onRefresh\" class=\"headerlink\" title=\"onRefresh\"></a>onRefresh</h1><p>Servletweb</p>\n<h1 id=\"registerListeners\"><a href=\"#registerListeners\" class=\"headerlink\" title=\"registerListeners\"></a>registerListeners</h1><p></p>\n<h1 id=\"finishBeanFactoryInitialization\"><a href=\"#finishBeanFactoryInitialization\" class=\"headerlink\" title=\"finishBeanFactoryInitialization\"></a>finishBeanFactoryInitialization</h1><p>bean</p>\n<h1 id=\"finishRefresh\"><a href=\"#finishRefresh\" class=\"headerlink\" title=\"finishRefresh\"></a>finishRefresh</h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>refresh</p>\n<ul>\n<li></li>\n<li></li>\n<li>bean</li>\n</ul>"},{"title":"SpringBoot environment","date":"2021-02-15T08:19:17.000Z","_content":"\n\t\tSpringBootSpringBootymlproperties\n\n<!--more-->\n\n<!--toc-->\n\nSpringBootSpringApplicationrunrun\n\n```java\nprivate ConfigurableEnvironment prepareEnvironment(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments) {\n    // \n    ConfigurableEnvironment environment = getOrCreateEnvironment();\n    configureEnvironment(environment, applicationArguments.getSourceArgs());\n    ConfigurationPropertySources.attach(environment);\n    listeners.environmentPrepared(environment);\n    bindToSpringApplication(environment);\n    if (!this.isCustomEnvironment) {\n        environment = new EnvironmentConverter(getClassLoader()).convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());\n    }\n    ConfigurationPropertySources.attach(environment);\n    return environment;\n}\n```\n\n\n\n# \n\n`getOrCreateEnvironment`***Servlet* *REACTIVE*`ConfigurableEnvironment`\n\n```java\nvoid setActiveProfiles(String... profiles);\n\nvoid addActiveProfile(String profile);\n\nvoid setDefaultProfiles(String... profiles);\n\nMutablePropertySources getPropertySources();\n\nMap<String, Object> getSystemProperties();\n\nMap<String, Object> getSystemEnvironment();\n\nvoid merge(ConfigurableEnvironment parent);\n```\n\nprofilepropertymap\n\n# \n\n`property``profile`profile\n\nConfigurationPropertySourcesattach \n\n```java\nprivate static final String ATTACHED_PROPERTY_SOURCE_NAME = \"configurationProperties\";\n```\n\nenvironmentpropertySourceMutablePropertySource*CopyOnWriteArrayList*PropertySource\n\neventlistenerlistener `ConfigFileApplicationListener`\n\n```java\nprivate void onApplicationEnvironmentPreparedEvent(ApplicationEnvironmentPreparedEvent event) {\n    List<EnvironmentPostProcessor> postProcessors = loadPostProcessors();\n    // listenerEnvironmentPostProcessor\n    postProcessors.add(this);\n    AnnotationAwareOrderComparator.sort(postProcessors);\n    for (EnvironmentPostProcessor postProcessor : postProcessors) {\n        postProcessor.postProcessEnvironment(event.getEnvironment(), event.getSpringApplication());\n    }\n}\n```\n\n\n\n```java\nList<EnvironmentPostProcessor> loadPostProcessors() {\n    // \n    return SpringFactoriesLoader.loadFactories(EnvironmentPostProcessor.class, getClass().getClassLoader());\n}\n```\n\n```properties\n# Environment Post Processors\norg.springframework.boot.env.EnvironmentPostProcessor=\\\norg.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\\norg.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\\\norg.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\\\norg.springframework.boot.reactor.DebugAgentEnvironmentPostProcessor\n```\n\nlistenerprocessorprocessor\n\n## Load\n\n\n\n```java\nprotected void addPropertySources(ConfigurableEnvironment environment, ResourceLoader resourceLoader) {\n    RandomValuePropertySource.addToEnvironment(environment);\n    // loaderload\n    new Loader(environment, resourceLoader).load();\n}\n```\n\n```java\nprivate static final Set<String> LOAD_FILTERED_PROPERTY;\n\nstatic {\n    Set<String> filteredProperties = new HashSet<>();\n    filteredProperties.add(\"spring.profiles.active\");\n    filteredProperties.add(\"spring.profiles.include\");\n    LOAD_FILTERED_PROPERTY = Collections.unmodifiableSet(filteredProperties);\n}\nvoid load() {\n    // defaultProperties\n    FilteredPropertySource.apply(this.environment, DEFAULT_PROPERTIES, LOAD_FILTERED_PROPERTY,\n                                 (defaultProperties) -> {\n                                     this.profiles = new LinkedList<>();\n                                     this.processedProfiles = new LinkedList<>();\n                                     this.activatedProfiles = false;\n                                     this.loaded = new LinkedHashMap<>();\n                                     initializeProfiles();\n                                     while (!this.profiles.isEmpty()) {\n                                         Profile profile = this.profiles.poll();\n                                         if (isDefaultProfile(profile)) {\n                                             addProfileToEnvironment(profile.getName());\n                                         }\n                                         // load\n                                         load(profile, this::getPositiveProfileFilter,\n                                              addToLoaded(MutablePropertySources::addLast, false));\n                                         this.processedProfiles.add(profile);\n                                     }\n                                     // load\n                                     load(null, this::getNegativeProfileFilter, addToLoaded(MutablePropertySources::addFirst, true));\n                                     addLoadedPropertySources();\n                                     applyActiveProfiles(defaultProperties);\n                                 });\n\n```\n\nlambdaapplyconsumerlistenerpropertiesymlloadload*propertySourceLoaders*loaderloadpropertySourceLoader`PropertiesPropertySourceLoader``YamlPropertySourceLoader`\n\n## \n\npostprocessorprocessorSPIMETA-INFspring.factorieskey`EnvironmentPostProcessor`","source":"_posts/SpringBoot-environment.md","raw":"---\ntitle: SpringBoot environment\ndate: 2021-02-15 16:19:17\ncategories: springboot\ntags: source\n---\n\n\t\tSpringBootSpringBootymlproperties\n\n<!--more-->\n\n<!--toc-->\n\nSpringBootSpringApplicationrunrun\n\n```java\nprivate ConfigurableEnvironment prepareEnvironment(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments) {\n    // \n    ConfigurableEnvironment environment = getOrCreateEnvironment();\n    configureEnvironment(environment, applicationArguments.getSourceArgs());\n    ConfigurationPropertySources.attach(environment);\n    listeners.environmentPrepared(environment);\n    bindToSpringApplication(environment);\n    if (!this.isCustomEnvironment) {\n        environment = new EnvironmentConverter(getClassLoader()).convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());\n    }\n    ConfigurationPropertySources.attach(environment);\n    return environment;\n}\n```\n\n\n\n# \n\n`getOrCreateEnvironment`***Servlet* *REACTIVE*`ConfigurableEnvironment`\n\n```java\nvoid setActiveProfiles(String... profiles);\n\nvoid addActiveProfile(String profile);\n\nvoid setDefaultProfiles(String... profiles);\n\nMutablePropertySources getPropertySources();\n\nMap<String, Object> getSystemProperties();\n\nMap<String, Object> getSystemEnvironment();\n\nvoid merge(ConfigurableEnvironment parent);\n```\n\nprofilepropertymap\n\n# \n\n`property``profile`profile\n\nConfigurationPropertySourcesattach \n\n```java\nprivate static final String ATTACHED_PROPERTY_SOURCE_NAME = \"configurationProperties\";\n```\n\nenvironmentpropertySourceMutablePropertySource*CopyOnWriteArrayList*PropertySource\n\neventlistenerlistener `ConfigFileApplicationListener`\n\n```java\nprivate void onApplicationEnvironmentPreparedEvent(ApplicationEnvironmentPreparedEvent event) {\n    List<EnvironmentPostProcessor> postProcessors = loadPostProcessors();\n    // listenerEnvironmentPostProcessor\n    postProcessors.add(this);\n    AnnotationAwareOrderComparator.sort(postProcessors);\n    for (EnvironmentPostProcessor postProcessor : postProcessors) {\n        postProcessor.postProcessEnvironment(event.getEnvironment(), event.getSpringApplication());\n    }\n}\n```\n\n\n\n```java\nList<EnvironmentPostProcessor> loadPostProcessors() {\n    // \n    return SpringFactoriesLoader.loadFactories(EnvironmentPostProcessor.class, getClass().getClassLoader());\n}\n```\n\n```properties\n# Environment Post Processors\norg.springframework.boot.env.EnvironmentPostProcessor=\\\norg.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\\norg.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\\\norg.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\\\norg.springframework.boot.reactor.DebugAgentEnvironmentPostProcessor\n```\n\nlistenerprocessorprocessor\n\n## Load\n\n\n\n```java\nprotected void addPropertySources(ConfigurableEnvironment environment, ResourceLoader resourceLoader) {\n    RandomValuePropertySource.addToEnvironment(environment);\n    // loaderload\n    new Loader(environment, resourceLoader).load();\n}\n```\n\n```java\nprivate static final Set<String> LOAD_FILTERED_PROPERTY;\n\nstatic {\n    Set<String> filteredProperties = new HashSet<>();\n    filteredProperties.add(\"spring.profiles.active\");\n    filteredProperties.add(\"spring.profiles.include\");\n    LOAD_FILTERED_PROPERTY = Collections.unmodifiableSet(filteredProperties);\n}\nvoid load() {\n    // defaultProperties\n    FilteredPropertySource.apply(this.environment, DEFAULT_PROPERTIES, LOAD_FILTERED_PROPERTY,\n                                 (defaultProperties) -> {\n                                     this.profiles = new LinkedList<>();\n                                     this.processedProfiles = new LinkedList<>();\n                                     this.activatedProfiles = false;\n                                     this.loaded = new LinkedHashMap<>();\n                                     initializeProfiles();\n                                     while (!this.profiles.isEmpty()) {\n                                         Profile profile = this.profiles.poll();\n                                         if (isDefaultProfile(profile)) {\n                                             addProfileToEnvironment(profile.getName());\n                                         }\n                                         // load\n                                         load(profile, this::getPositiveProfileFilter,\n                                              addToLoaded(MutablePropertySources::addLast, false));\n                                         this.processedProfiles.add(profile);\n                                     }\n                                     // load\n                                     load(null, this::getNegativeProfileFilter, addToLoaded(MutablePropertySources::addFirst, true));\n                                     addLoadedPropertySources();\n                                     applyActiveProfiles(defaultProperties);\n                                 });\n\n```\n\nlambdaapplyconsumerlistenerpropertiesymlloadload*propertySourceLoaders*loaderloadpropertySourceLoader`PropertiesPropertySourceLoader``YamlPropertySourceLoader`\n\n## \n\npostprocessorprocessorSPIMETA-INFspring.factorieskey`EnvironmentPostProcessor`","slug":"SpringBoot-environment","published":1,"updated":"2021-02-17T13:12:36.286Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7j0018w5ihfke5chrb","content":"<p>        SpringBootSpringBootymlproperties</p>\n<a id=\"more\"></a>\n\n<!--toc-->\n\n<p>SpringBootSpringApplicationrunrun</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> ConfigurableEnvironment <span class=\"title\">prepareEnvironment</span><span class=\"params\">(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ConfigurableEnvironment environment = getOrCreateEnvironment();</span><br><span class=\"line\">    configureEnvironment(environment, applicationArguments.getSourceArgs());</span><br><span class=\"line\">    ConfigurationPropertySources.attach(environment);</span><br><span class=\"line\">    listeners.environmentPrepared(environment);</span><br><span class=\"line\">    bindToSpringApplication(environment);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.isCustomEnvironment) &#123;</span><br><span class=\"line\">        environment = <span class=\"keyword\">new</span> EnvironmentConverter(getClassLoader()).convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ConfigurationPropertySources.attach(environment);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> environment;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>getOrCreateEnvironment</code><em></em><em>Servlet</em> <em>REACTIVE</em><code>ConfigurableEnvironment</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setActiveProfiles</span><span class=\"params\">(String... profiles)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addActiveProfile</span><span class=\"params\">(String profile)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setDefaultProfiles</span><span class=\"params\">(String... profiles)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">MutablePropertySources <span class=\"title\">getPropertySources</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Map&lt;String, Object&gt; <span class=\"title\">getSystemProperties</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Map&lt;String, Object&gt; <span class=\"title\">getSystemEnvironment</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">merge</span><span class=\"params\">(ConfigurableEnvironment parent)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>profilepropertymap</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>property</code><code>profile</code>profile</p>\n<p>ConfigurationPropertySourcesattach </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String ATTACHED_PROPERTY_SOURCE_NAME = <span class=\"string\">&quot;configurationProperties&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>environmentpropertySourceMutablePropertySource<em>CopyOnWriteArrayList</em>PropertySource</p>\n<p>eventlistenerlistener <code>ConfigFileApplicationListener</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">onApplicationEnvironmentPreparedEvent</span><span class=\"params\">(ApplicationEnvironmentPreparedEvent event)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;EnvironmentPostProcessor&gt; postProcessors = loadPostProcessors();</span><br><span class=\"line\">    <span class=\"comment\">// listenerEnvironmentPostProcessor</span></span><br><span class=\"line\">    postProcessors.add(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    AnnotationAwareOrderComparator.sort(postProcessors);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (EnvironmentPostProcessor postProcessor : postProcessors) &#123;</span><br><span class=\"line\">        postProcessor.postProcessEnvironment(event.getEnvironment(), event.getSpringApplication());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">List&lt;EnvironmentPostProcessor&gt; <span class=\"title\">loadPostProcessors</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> SpringFactoriesLoader.loadFactories(EnvironmentPostProcessor.class, getClass().getClassLoader());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Environment Post Processors</span></span><br><span class=\"line\"><span class=\"meta\">org.springframework.boot.env.EnvironmentPostProcessor</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\</span><br><span class=\"line\">org.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\\</span><br><span class=\"line\">org.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\\</span><br><span class=\"line\"><span class=\"attr\">org.springframework.boot.reactor.DebugAgentEnvironmentPostProcessor</span></span><br></pre></td></tr></table></figure>\n\n<p>listenerprocessorprocessor</p>\n<h2 id=\"Load\"><a href=\"#Load\" class=\"headerlink\" title=\"Load\"></a>Load</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">addPropertySources</span><span class=\"params\">(ConfigurableEnvironment environment, ResourceLoader resourceLoader)</span> </span>&#123;</span><br><span class=\"line\">    RandomValuePropertySource.addToEnvironment(environment);</span><br><span class=\"line\">    <span class=\"comment\">// loaderload</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Loader(environment, resourceLoader).load();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Set&lt;String&gt; LOAD_FILTERED_PROPERTY;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">    Set&lt;String&gt; filteredProperties = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\">    filteredProperties.add(<span class=\"string\">&quot;spring.profiles.active&quot;</span>);</span><br><span class=\"line\">    filteredProperties.add(<span class=\"string\">&quot;spring.profiles.include&quot;</span>);</span><br><span class=\"line\">    LOAD_FILTERED_PROPERTY = Collections.unmodifiableSet(filteredProperties);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">load</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// defaultProperties</span></span><br><span class=\"line\">    FilteredPropertySource.apply(<span class=\"keyword\">this</span>.environment, DEFAULT_PROPERTIES, LOAD_FILTERED_PROPERTY,</span><br><span class=\"line\">                                 (defaultProperties) -&gt; &#123;</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.profiles = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.processedProfiles = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.activatedProfiles = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.loaded = <span class=\"keyword\">new</span> LinkedHashMap&lt;&gt;();</span><br><span class=\"line\">                                     initializeProfiles();</span><br><span class=\"line\">                                     <span class=\"keyword\">while</span> (!<span class=\"keyword\">this</span>.profiles.isEmpty()) &#123;</span><br><span class=\"line\">                                         Profile profile = <span class=\"keyword\">this</span>.profiles.poll();</span><br><span class=\"line\">                                         <span class=\"keyword\">if</span> (isDefaultProfile(profile)) &#123;</span><br><span class=\"line\">                                             addProfileToEnvironment(profile.getName());</span><br><span class=\"line\">                                         &#125;</span><br><span class=\"line\">                                         <span class=\"comment\">// load</span></span><br><span class=\"line\">                                         load(profile, <span class=\"keyword\">this</span>::getPositiveProfileFilter,</span><br><span class=\"line\">                                              addToLoaded(MutablePropertySources::addLast, <span class=\"keyword\">false</span>));</span><br><span class=\"line\">                                         <span class=\"keyword\">this</span>.processedProfiles.add(profile);</span><br><span class=\"line\">                                     &#125;</span><br><span class=\"line\">                                     <span class=\"comment\">// load</span></span><br><span class=\"line\">                                     load(<span class=\"keyword\">null</span>, <span class=\"keyword\">this</span>::getNegativeProfileFilter, addToLoaded(MutablePropertySources::addFirst, <span class=\"keyword\">true</span>));</span><br><span class=\"line\">                                     addLoadedPropertySources();</span><br><span class=\"line\">                                     applyActiveProfiles(defaultProperties);</span><br><span class=\"line\">                                 &#125;);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>lambdaapplyconsumerlistenerpropertiesymlloadload<em>propertySourceLoaders</em>loaderloadpropertySourceLoader<code>PropertiesPropertySourceLoader</code><code>YamlPropertySourceLoader</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>postprocessorprocessorSPIMETA-INFspring.factorieskey<code>EnvironmentPostProcessor</code></p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>        SpringBootSpringBootymlproperties</p>","more":"<!--toc-->\n\n<p>SpringBootSpringApplicationrunrun</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> ConfigurableEnvironment <span class=\"title\">prepareEnvironment</span><span class=\"params\">(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    ConfigurableEnvironment environment = getOrCreateEnvironment();</span><br><span class=\"line\">    configureEnvironment(environment, applicationArguments.getSourceArgs());</span><br><span class=\"line\">    ConfigurationPropertySources.attach(environment);</span><br><span class=\"line\">    listeners.environmentPrepared(environment);</span><br><span class=\"line\">    bindToSpringApplication(environment);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.isCustomEnvironment) &#123;</span><br><span class=\"line\">        environment = <span class=\"keyword\">new</span> EnvironmentConverter(getClassLoader()).convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ConfigurationPropertySources.attach(environment);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> environment;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>getOrCreateEnvironment</code><em></em><em>Servlet</em> <em>REACTIVE</em><code>ConfigurableEnvironment</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setActiveProfiles</span><span class=\"params\">(String... profiles)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addActiveProfile</span><span class=\"params\">(String profile)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setDefaultProfiles</span><span class=\"params\">(String... profiles)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">MutablePropertySources <span class=\"title\">getPropertySources</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Map&lt;String, Object&gt; <span class=\"title\">getSystemProperties</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Map&lt;String, Object&gt; <span class=\"title\">getSystemEnvironment</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">merge</span><span class=\"params\">(ConfigurableEnvironment parent)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>profilepropertymap</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>property</code><code>profile</code>profile</p>\n<p>ConfigurationPropertySourcesattach </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String ATTACHED_PROPERTY_SOURCE_NAME = <span class=\"string\">&quot;configurationProperties&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>environmentpropertySourceMutablePropertySource<em>CopyOnWriteArrayList</em>PropertySource</p>\n<p>eventlistenerlistener <code>ConfigFileApplicationListener</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">onApplicationEnvironmentPreparedEvent</span><span class=\"params\">(ApplicationEnvironmentPreparedEvent event)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;EnvironmentPostProcessor&gt; postProcessors = loadPostProcessors();</span><br><span class=\"line\">    <span class=\"comment\">// listenerEnvironmentPostProcessor</span></span><br><span class=\"line\">    postProcessors.add(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    AnnotationAwareOrderComparator.sort(postProcessors);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (EnvironmentPostProcessor postProcessor : postProcessors) &#123;</span><br><span class=\"line\">        postProcessor.postProcessEnvironment(event.getEnvironment(), event.getSpringApplication());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">List&lt;EnvironmentPostProcessor&gt; <span class=\"title\">loadPostProcessors</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> SpringFactoriesLoader.loadFactories(EnvironmentPostProcessor.class, getClass().getClassLoader());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Environment Post Processors</span></span><br><span class=\"line\"><span class=\"meta\">org.springframework.boot.env.EnvironmentPostProcessor</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\</span><br><span class=\"line\">org.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\\</span><br><span class=\"line\">org.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\\</span><br><span class=\"line\"><span class=\"attr\">org.springframework.boot.reactor.DebugAgentEnvironmentPostProcessor</span></span><br></pre></td></tr></table></figure>\n\n<p>listenerprocessorprocessor</p>\n<h2 id=\"Load\"><a href=\"#Load\" class=\"headerlink\" title=\"Load\"></a>Load</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">addPropertySources</span><span class=\"params\">(ConfigurableEnvironment environment, ResourceLoader resourceLoader)</span> </span>&#123;</span><br><span class=\"line\">    RandomValuePropertySource.addToEnvironment(environment);</span><br><span class=\"line\">    <span class=\"comment\">// loaderload</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> Loader(environment, resourceLoader).load();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Set&lt;String&gt; LOAD_FILTERED_PROPERTY;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">    Set&lt;String&gt; filteredProperties = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\">    filteredProperties.add(<span class=\"string\">&quot;spring.profiles.active&quot;</span>);</span><br><span class=\"line\">    filteredProperties.add(<span class=\"string\">&quot;spring.profiles.include&quot;</span>);</span><br><span class=\"line\">    LOAD_FILTERED_PROPERTY = Collections.unmodifiableSet(filteredProperties);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">load</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// defaultProperties</span></span><br><span class=\"line\">    FilteredPropertySource.apply(<span class=\"keyword\">this</span>.environment, DEFAULT_PROPERTIES, LOAD_FILTERED_PROPERTY,</span><br><span class=\"line\">                                 (defaultProperties) -&gt; &#123;</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.profiles = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.processedProfiles = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.activatedProfiles = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                                     <span class=\"keyword\">this</span>.loaded = <span class=\"keyword\">new</span> LinkedHashMap&lt;&gt;();</span><br><span class=\"line\">                                     initializeProfiles();</span><br><span class=\"line\">                                     <span class=\"keyword\">while</span> (!<span class=\"keyword\">this</span>.profiles.isEmpty()) &#123;</span><br><span class=\"line\">                                         Profile profile = <span class=\"keyword\">this</span>.profiles.poll();</span><br><span class=\"line\">                                         <span class=\"keyword\">if</span> (isDefaultProfile(profile)) &#123;</span><br><span class=\"line\">                                             addProfileToEnvironment(profile.getName());</span><br><span class=\"line\">                                         &#125;</span><br><span class=\"line\">                                         <span class=\"comment\">// load</span></span><br><span class=\"line\">                                         load(profile, <span class=\"keyword\">this</span>::getPositiveProfileFilter,</span><br><span class=\"line\">                                              addToLoaded(MutablePropertySources::addLast, <span class=\"keyword\">false</span>));</span><br><span class=\"line\">                                         <span class=\"keyword\">this</span>.processedProfiles.add(profile);</span><br><span class=\"line\">                                     &#125;</span><br><span class=\"line\">                                     <span class=\"comment\">// load</span></span><br><span class=\"line\">                                     load(<span class=\"keyword\">null</span>, <span class=\"keyword\">this</span>::getNegativeProfileFilter, addToLoaded(MutablePropertySources::addFirst, <span class=\"keyword\">true</span>));</span><br><span class=\"line\">                                     addLoadedPropertySources();</span><br><span class=\"line\">                                     applyActiveProfiles(defaultProperties);</span><br><span class=\"line\">                                 &#125;);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>lambdaapplyconsumerlistenerpropertiesymlloadload<em>propertySourceLoaders</em>loaderloadpropertySourceLoader<code>PropertiesPropertySourceLoader</code><code>YamlPropertySourceLoader</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>postprocessorprocessorSPIMETA-INFspring.factorieskey<code>EnvironmentPostProcessor</code></p>"},{"title":"jvm","date":"2020-05-24T09:39:25.000Z","_content":"\nassociate with juc\n\n<!--more-->\n\n<!--toc-->\n\n# \n\n![Screenshot from 2020-06-04 20-11-48.png](https://i.loli.net/2020/06/04/UQfq2lrGu9mLc4C.png)\n\n- \n- \n\n# \n\njavacxxx.classJVMxxx.ClassclassClass\n\n> Car.class -> Class Loader -> Car Class -> car1/car2/car3\n\nCar Classcar1car2car3car\n\n![Screenshot from 2020-06-04 20-33-54.png](https://i.loli.net/2020/06/04/EYRbMN1fgIOuHBk.png)\n\n## \n\n### Bootstrap\n\nC++Object, ArrayList, String\n\n### Extension\n\nJavaExtensionjavaxjava\n\n### AppClassLoader\n\n\n\n### \n\nClassLoader\n\n## \n\nA.javaBootstrapExtensionApplication\n\n**Bootstrap** --> **Extension** --> **Application**\n\n```java\npublic class String{\n    public static void main(String[] args){\n        System.out.println(\"hello world!\");\n    }\n}\n```\n\n> java.lang.StringmainBootstrap\n\n## \n\n**note**: jdkObject\n\n## Native Interface\n\nJavaC/C++nativejava\n\nSocketwebService\n\n### Native\n\nC\n\n### \n\nnativenativenativeExecution Engine\n\n# PC\n\n\n\n\n\n# \n\n- \n- ====/\n\n**Java**\n\n## \n\njava\n\n- Local Variables: \n\n  ```java\n  //  x, y resultresult\n  public int add(int x, int y){\n      int result = 0;\n      result = x + y;\n      return result;\n  }\n  ```\n\n- Operand Stack: \n\n- Frame Data: \n\n## \n\nStack FrameMethodA\n\n```java\n//  Exception: StackOverflowError \npublic static void m1(){\n    m1();\n}\n```\n\n\n\nJVM256K756K\n\n\n\n# \n\nclassClassLoaderJVMClass`(PermGen space)``(Metaspace)`\n\n- ====\n- \n\n****\n\n```java\npublic class Car{\n    int price = 1233435;\n    public park(){\n        System.out.println(\"stop ...\");\n    }\n}\n```\n\n\n\njvmjava8****native memoryjavaMaxPermSize\n\ni.e.\n\n```java\npublic class Demo{\n    public void hello(){}\n    public static void main(String[] args){\n        Demo demo = new Demo();\n        demo.hello();\n    }\n}\n```\n\nnewhellodemo\n\n# \n\n```java\nPerson person1 = new Person();\nPerson person2 = new Person();\n```\n\nnew\n\nperson1person2\n\nhotsoptjavaClass -->-->\n\n# \n\nJava7\tJvm\n\n(Java8)\t\n\n+\n\n## \n\n++\n\n Youg Generation Space (Eden Sapce + Survivor 0 space + Survivor 1 space)\n\nTenure Generation Space\n\nPermanent Space\n\n- Eden: 0space: 1space  = 8 : 1 : 1\n- Young : Old = 1 : 2\n\n## \n\nEden Sapce,GCSurvivior 0 spaceEden SpaceSurvivor 0 spaceGCSurvivor 1 spaceTenure Genreration SpaceFull GCOutOfMemoryError(OOM)\n\n## \n\nSurvivor 0 space: from\n\nSurrivor 1 space: to\n\nGCto\n\n1. Eden, SurvivorFrom copy to SurviviorTo\n2. clean up Eden, SurvivorFrom\n3. Swap SurvivorTo and SurvivorFrom\n\n## \n\njdkClassInterfaceJVM\n\n## \n\n```java\npublic static void main(String[] args){\n    // Returns the maximum amount of memory that the Java virtual machine will attempt to use.\n    long l = Runtime.getRuntime().maxMemory();\n\n    // Returns the total amount of memory in the Java virtual machine.\n    long l1 = Runtime.getRuntime().totalMemory();\n\n    // 1/4\n    System.out.println(\"(-xmx) MAX_MEMORY: \" + l + \"bytes, \" + (l / (double) 1024 / 1024 + \"MB\"));\n    \n    // 1/64\n    System.out.println(\"(-xms) TOTAL_MEMORY: \" + l1 + \"bytes, \" + (l1 / (double) 1024 / 1024 + \"MB\"));\n}\n```\n\n**note:** \n\n> -XX:MaxTenuringThreshold java815\n\n# GC\n\n- minor GC\n- major/full GC\n\nmajor GCminor GCyoungold\n\n## \n\n\n\n### \n\n1,0JVM\n\n### Copying\n\nMinor GCCopying\n\n\n\n### Mark-Sweep\n\nMajor GCMark-SweepMark-Compact--CopyingJVM\n\n### Mark-Compact\n\nMark-Sweep-Compact\n\nGC\n\n# JMM\n\nJavaJava Memory  Model)****\n\n``java\n\n\n\n## violatile\n\njavasyncronized\n\n- \n- \n- \n\n\n\n# \n\njvmjavajava*native**class*jvmjvmjavajmmjmmjvm\n\n\n\n","source":"_posts/jvm.md","raw":"---\ntitle: jvm\ndate: 2020-05-24 17:39:25\ncategories: JVM\ntags: summary\n---\n\nassociate with juc\n\n<!--more-->\n\n<!--toc-->\n\n# \n\n![Screenshot from 2020-06-04 20-11-48.png](https://i.loli.net/2020/06/04/UQfq2lrGu9mLc4C.png)\n\n- \n- \n\n# \n\njavacxxx.classJVMxxx.ClassclassClass\n\n> Car.class -> Class Loader -> Car Class -> car1/car2/car3\n\nCar Classcar1car2car3car\n\n![Screenshot from 2020-06-04 20-33-54.png](https://i.loli.net/2020/06/04/EYRbMN1fgIOuHBk.png)\n\n## \n\n### Bootstrap\n\nC++Object, ArrayList, String\n\n### Extension\n\nJavaExtensionjavaxjava\n\n### AppClassLoader\n\n\n\n### \n\nClassLoader\n\n## \n\nA.javaBootstrapExtensionApplication\n\n**Bootstrap** --> **Extension** --> **Application**\n\n```java\npublic class String{\n    public static void main(String[] args){\n        System.out.println(\"hello world!\");\n    }\n}\n```\n\n> java.lang.StringmainBootstrap\n\n## \n\n**note**: jdkObject\n\n## Native Interface\n\nJavaC/C++nativejava\n\nSocketwebService\n\n### Native\n\nC\n\n### \n\nnativenativenativeExecution Engine\n\n# PC\n\n\n\n\n\n# \n\n- \n- ====/\n\n**Java**\n\n## \n\njava\n\n- Local Variables: \n\n  ```java\n  //  x, y resultresult\n  public int add(int x, int y){\n      int result = 0;\n      result = x + y;\n      return result;\n  }\n  ```\n\n- Operand Stack: \n\n- Frame Data: \n\n## \n\nStack FrameMethodA\n\n```java\n//  Exception: StackOverflowError \npublic static void m1(){\n    m1();\n}\n```\n\n\n\nJVM256K756K\n\n\n\n# \n\nclassClassLoaderJVMClass`(PermGen space)``(Metaspace)`\n\n- ====\n- \n\n****\n\n```java\npublic class Car{\n    int price = 1233435;\n    public park(){\n        System.out.println(\"stop ...\");\n    }\n}\n```\n\n\n\njvmjava8****native memoryjavaMaxPermSize\n\ni.e.\n\n```java\npublic class Demo{\n    public void hello(){}\n    public static void main(String[] args){\n        Demo demo = new Demo();\n        demo.hello();\n    }\n}\n```\n\nnewhellodemo\n\n# \n\n```java\nPerson person1 = new Person();\nPerson person2 = new Person();\n```\n\nnew\n\nperson1person2\n\nhotsoptjavaClass -->-->\n\n# \n\nJava7\tJvm\n\n(Java8)\t\n\n+\n\n## \n\n++\n\n Youg Generation Space (Eden Sapce + Survivor 0 space + Survivor 1 space)\n\nTenure Generation Space\n\nPermanent Space\n\n- Eden: 0space: 1space  = 8 : 1 : 1\n- Young : Old = 1 : 2\n\n## \n\nEden Sapce,GCSurvivior 0 spaceEden SpaceSurvivor 0 spaceGCSurvivor 1 spaceTenure Genreration SpaceFull GCOutOfMemoryError(OOM)\n\n## \n\nSurvivor 0 space: from\n\nSurrivor 1 space: to\n\nGCto\n\n1. Eden, SurvivorFrom copy to SurviviorTo\n2. clean up Eden, SurvivorFrom\n3. Swap SurvivorTo and SurvivorFrom\n\n## \n\njdkClassInterfaceJVM\n\n## \n\n```java\npublic static void main(String[] args){\n    // Returns the maximum amount of memory that the Java virtual machine will attempt to use.\n    long l = Runtime.getRuntime().maxMemory();\n\n    // Returns the total amount of memory in the Java virtual machine.\n    long l1 = Runtime.getRuntime().totalMemory();\n\n    // 1/4\n    System.out.println(\"(-xmx) MAX_MEMORY: \" + l + \"bytes, \" + (l / (double) 1024 / 1024 + \"MB\"));\n    \n    // 1/64\n    System.out.println(\"(-xms) TOTAL_MEMORY: \" + l1 + \"bytes, \" + (l1 / (double) 1024 / 1024 + \"MB\"));\n}\n```\n\n**note:** \n\n> -XX:MaxTenuringThreshold java815\n\n# GC\n\n- minor GC\n- major/full GC\n\nmajor GCminor GCyoungold\n\n## \n\n\n\n### \n\n1,0JVM\n\n### Copying\n\nMinor GCCopying\n\n\n\n### Mark-Sweep\n\nMajor GCMark-SweepMark-Compact--CopyingJVM\n\n### Mark-Compact\n\nMark-Sweep-Compact\n\nGC\n\n# JMM\n\nJavaJava Memory  Model)****\n\n``java\n\n\n\n## violatile\n\njavasyncronized\n\n- \n- \n- \n\n\n\n# \n\njvmjavajava*native**class*jvmjvmjavajmmjmmjvm\n\n\n\n","slug":"jvm","published":1,"updated":"2021-03-23T15:40:34.973Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7k001aw5ih69a14lt6","content":"<p>associate with juc</p>\n<a id=\"more\"></a>\n\n<!--toc-->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/06/04/UQfq2lrGu9mLc4C.png\" alt=\"Screenshot from 2020-06-04 20-11-48.png\"></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>javacxxx.classJVMxxx.ClassclassClass</p>\n<blockquote>\n<p>Car.class -&gt; Class Loader -&gt; Car Class -&gt; car1/car2/car3</p>\n</blockquote>\n<p>Car Classcar1car2car3car</p>\n<p><img src=\"https://i.loli.net/2020/06/04/EYRbMN1fgIOuHBk.png\" alt=\"Screenshot from 2020-06-04 20-33-54.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Bootstrap\"><a href=\"#Bootstrap\" class=\"headerlink\" title=\"Bootstrap\"></a>Bootstrap</h3><p>C++Object, ArrayList, String</p>\n<h3 id=\"Extension\"><a href=\"#Extension\" class=\"headerlink\" title=\"Extension\"></a>Extension</h3><p>JavaExtensionjavaxjava</p>\n<h3 id=\"AppClassLoader\"><a href=\"#AppClassLoader\" class=\"headerlink\" title=\"AppClassLoader\"></a>AppClassLoader</h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ClassLoader</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>A.javaBootstrapExtensionApplication</p>\n<p><strong>Bootstrap</strong> &gt; <strong>Extension</strong> &gt; <strong>Application</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">String</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;hello world!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>java.lang.StringmainBootstrap</p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>note</strong>: jdkObject</p>\n<h2 id=\"Native-Interface\"><a href=\"#Native-Interface\" class=\"headerlink\" title=\"Native Interface\"></a>Native Interface</h2><p>JavaC/C++nativejava</p>\n<p>SocketwebService</p>\n<h3 id=\"Native\"><a href=\"#Native\" class=\"headerlink\" title=\"Native\"></a>Native</h3><p>C</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nativenativenativeExecution Engine</p>\n<h1 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC\"></a>PC</h1><p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li>====/</li>\n</ul>\n<p><strong>Java</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>java</p>\n<ul>\n<li><p>Local Variables: </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  x, y resultresult</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> result = <span class=\"number\">0</span>;</span><br><span class=\"line\">    result = x + y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Operand Stack: </p>\n</li>\n<li><p>Frame Data: </p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Stack FrameMethodA</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Exception: StackOverflowError </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">m1</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    m1();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>JVM256K756K</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>classClassLoaderJVMClass<code>(PermGen space)</code><code>(Metaspace)</code></p>\n<ul>\n<li>====</li>\n<li></li>\n</ul>\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> price = <span class=\"number\">1233435</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">park</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;stop ...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>jvmjava8<strong></strong>native memoryjavaMaxPermSize</p>\n<p>i.e.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Demo</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">hello</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Demo demo = <span class=\"keyword\">new</span> Demo();</span><br><span class=\"line\">        demo.hello();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>newhellodemo</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Person person1 = <span class=\"keyword\">new</span> Person();</span><br><span class=\"line\">Person person2 = <span class=\"keyword\">new</span> Person();</span><br></pre></td></tr></table></figure>\n\n<p>new</p>\n<p>person1person2</p>\n<p>hotsoptjavaClass &gt;&gt;</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Java7    Jvm</p>\n<p>(Java8)    </p>\n<p>+</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>++</p>\n<p> Youg Generation Space (Eden Sapce + Survivor 0 space + Survivor 1 space)</p>\n<p>Tenure Generation Space</p>\n<p>Permanent Space</p>\n<ul>\n<li>Eden: 0space: 1space  = 8 : 1 : 1</li>\n<li>Young : Old = 1 : 2</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Eden Sapce,GCSurvivior 0 spaceEden SpaceSurvivor 0 spaceGCSurvivor 1 spaceTenure Genreration SpaceFull GCOutOfMemoryError(OOM)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Survivor 0 space: from</p>\n<p>Surrivor 1 space: to</p>\n<p>GCto</p>\n<ol>\n<li>Eden, SurvivorFrom copy to SurviviorTo</li>\n<li>clean up Eden, SurvivorFrom</li>\n<li>Swap SurvivorTo and SurvivorFrom</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>jdkClassInterfaceJVM</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Returns the maximum amount of memory that the Java virtual machine will attempt to use.</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span> l = Runtime.getRuntime().maxMemory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Returns the total amount of memory in the Java virtual machine.</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span> l1 = Runtime.getRuntime().totalMemory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1/4</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;(-xmx) MAX_MEMORY: &quot;</span> + l + <span class=\"string\">&quot;bytes, &quot;</span> + (l / (<span class=\"keyword\">double</span>) <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;MB&quot;</span>));</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 1/64</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;(-xms) TOTAL_MEMORY: &quot;</span> + l1 + <span class=\"string\">&quot;bytes, &quot;</span> + (l1 / (<span class=\"keyword\">double</span>) <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;MB&quot;</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>note:</strong> </p>\n<blockquote>\n<p>-XX:MaxTenuringThreshold java815</p>\n</blockquote>\n<h1 id=\"GC\"><a href=\"#GC\" class=\"headerlink\" title=\"GC\"></a>GC</h1><ul>\n<li>minor GC</li>\n<li>major/full GC</li>\n</ul>\n<p>major GCminor GCyoungold</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1,0JVM</p>\n<h3 id=\"Copying\"><a href=\"#Copying\" class=\"headerlink\" title=\"Copying\"></a>Copying</h3><p>Minor GCCopying</p>\n<p></p>\n<h3 id=\"Mark-Sweep\"><a href=\"#Mark-Sweep\" class=\"headerlink\" title=\"Mark-Sweep\"></a>Mark-Sweep</h3><p>Major GCMark-SweepMark-Compact--CopyingJVM</p>\n<h3 id=\"Mark-Compact\"><a href=\"#Mark-Compact\" class=\"headerlink\" title=\"Mark-Compact\"></a>Mark-Compact</h3><p>Mark-Sweep-Compact</p>\n<p>GC</p>\n<h1 id=\"JMM\"><a href=\"#JMM\" class=\"headerlink\" title=\"JMM\"></a>JMM</h1><p>JavaJava Memory  Model)<strong></strong></p>\n<p><code></code>java</p>\n<p></p>\n<h2 id=\"violatile\"><a href=\"#violatile\" class=\"headerlink\" title=\"violatile\"></a>violatile</h2><p>javasyncronized</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jvmjavajava<em>native</em><em>class</em>jvmjvmjavajmmjmmjvm</p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>associate with juc</p>","more":"<!--toc-->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/06/04/UQfq2lrGu9mLc4C.png\" alt=\"Screenshot from 2020-06-04 20-11-48.png\"></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>javacxxx.classJVMxxx.ClassclassClass</p>\n<blockquote>\n<p>Car.class -&gt; Class Loader -&gt; Car Class -&gt; car1/car2/car3</p>\n</blockquote>\n<p>Car Classcar1car2car3car</p>\n<p><img src=\"https://i.loli.net/2020/06/04/EYRbMN1fgIOuHBk.png\" alt=\"Screenshot from 2020-06-04 20-33-54.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Bootstrap\"><a href=\"#Bootstrap\" class=\"headerlink\" title=\"Bootstrap\"></a>Bootstrap</h3><p>C++Object, ArrayList, String</p>\n<h3 id=\"Extension\"><a href=\"#Extension\" class=\"headerlink\" title=\"Extension\"></a>Extension</h3><p>JavaExtensionjavaxjava</p>\n<h3 id=\"AppClassLoader\"><a href=\"#AppClassLoader\" class=\"headerlink\" title=\"AppClassLoader\"></a>AppClassLoader</h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ClassLoader</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>A.javaBootstrapExtensionApplication</p>\n<p><strong>Bootstrap</strong> &gt; <strong>Extension</strong> &gt; <strong>Application</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">String</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;hello world!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>java.lang.StringmainBootstrap</p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>note</strong>: jdkObject</p>\n<h2 id=\"Native-Interface\"><a href=\"#Native-Interface\" class=\"headerlink\" title=\"Native Interface\"></a>Native Interface</h2><p>JavaC/C++nativejava</p>\n<p>SocketwebService</p>\n<h3 id=\"Native\"><a href=\"#Native\" class=\"headerlink\" title=\"Native\"></a>Native</h3><p>C</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nativenativenativeExecution Engine</p>\n<h1 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC\"></a>PC</h1><p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li>====/</li>\n</ul>\n<p><strong>Java</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>java</p>\n<ul>\n<li><p>Local Variables: </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  x, y resultresult</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> result = <span class=\"number\">0</span>;</span><br><span class=\"line\">    result = x + y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Operand Stack: </p>\n</li>\n<li><p>Frame Data: </p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Stack FrameMethodA</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  Exception: StackOverflowError </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">m1</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    m1();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>JVM256K756K</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>classClassLoaderJVMClass<code>(PermGen space)</code><code>(Metaspace)</code></p>\n<ul>\n<li>====</li>\n<li></li>\n</ul>\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> price = <span class=\"number\">1233435</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">park</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;stop ...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>jvmjava8<strong></strong>native memoryjavaMaxPermSize</p>\n<p>i.e.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Demo</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">hello</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        Demo demo = <span class=\"keyword\">new</span> Demo();</span><br><span class=\"line\">        demo.hello();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>newhellodemo</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Person person1 = <span class=\"keyword\">new</span> Person();</span><br><span class=\"line\">Person person2 = <span class=\"keyword\">new</span> Person();</span><br></pre></td></tr></table></figure>\n\n<p>new</p>\n<p>person1person2</p>\n<p>hotsoptjavaClass &gt;&gt;</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Java7    Jvm</p>\n<p>(Java8)    </p>\n<p>+</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>++</p>\n<p> Youg Generation Space (Eden Sapce + Survivor 0 space + Survivor 1 space)</p>\n<p>Tenure Generation Space</p>\n<p>Permanent Space</p>\n<ul>\n<li>Eden: 0space: 1space  = 8 : 1 : 1</li>\n<li>Young : Old = 1 : 2</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Eden Sapce,GCSurvivior 0 spaceEden SpaceSurvivor 0 spaceGCSurvivor 1 spaceTenure Genreration SpaceFull GCOutOfMemoryError(OOM)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Survivor 0 space: from</p>\n<p>Surrivor 1 space: to</p>\n<p>GCto</p>\n<ol>\n<li>Eden, SurvivorFrom copy to SurviviorTo</li>\n<li>clean up Eden, SurvivorFrom</li>\n<li>Swap SurvivorTo and SurvivorFrom</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>jdkClassInterfaceJVM</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Returns the maximum amount of memory that the Java virtual machine will attempt to use.</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span> l = Runtime.getRuntime().maxMemory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Returns the total amount of memory in the Java virtual machine.</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span> l1 = Runtime.getRuntime().totalMemory();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1/4</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;(-xmx) MAX_MEMORY: &quot;</span> + l + <span class=\"string\">&quot;bytes, &quot;</span> + (l / (<span class=\"keyword\">double</span>) <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;MB&quot;</span>));</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 1/64</span></span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;(-xms) TOTAL_MEMORY: &quot;</span> + l1 + <span class=\"string\">&quot;bytes, &quot;</span> + (l1 / (<span class=\"keyword\">double</span>) <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;MB&quot;</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>note:</strong> </p>\n<blockquote>\n<p>-XX:MaxTenuringThreshold java815</p>\n</blockquote>\n<h1 id=\"GC\"><a href=\"#GC\" class=\"headerlink\" title=\"GC\"></a>GC</h1><ul>\n<li>minor GC</li>\n<li>major/full GC</li>\n</ul>\n<p>major GCminor GCyoungold</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1,0JVM</p>\n<h3 id=\"Copying\"><a href=\"#Copying\" class=\"headerlink\" title=\"Copying\"></a>Copying</h3><p>Minor GCCopying</p>\n<p></p>\n<h3 id=\"Mark-Sweep\"><a href=\"#Mark-Sweep\" class=\"headerlink\" title=\"Mark-Sweep\"></a>Mark-Sweep</h3><p>Major GCMark-SweepMark-Compact--CopyingJVM</p>\n<h3 id=\"Mark-Compact\"><a href=\"#Mark-Compact\" class=\"headerlink\" title=\"Mark-Compact\"></a>Mark-Compact</h3><p>Mark-Sweep-Compact</p>\n<p>GC</p>\n<h1 id=\"JMM\"><a href=\"#JMM\" class=\"headerlink\" title=\"JMM\"></a>JMM</h1><p>JavaJava Memory  Model)<strong></strong></p>\n<p><code></code>java</p>\n<p></p>\n<h2 id=\"violatile\"><a href=\"#violatile\" class=\"headerlink\" title=\"violatile\"></a>violatile</h2><p>javasyncronized</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jvmjavajava<em>native</em><em>class</em>jvmjvmjavajmmjmmjvm</p>"},{"title":"kafka","date":"2019-12-03T14:34:16.000Z","_content":"\n\n\n<!-- mroe -->\n\n# \n``````Message Queue)\n\n## \n\n1. \n2. \n\n\n\n### \n\n1. : QueueQueueQueueQueue\n    ABCAAC``\n\n2. topictopic\n   \n    1. \n    2. \n    \n    - \n    - \n    \n    ``topic\n\n## \n\nkafka()\n\n1. brokerbrokerpartitionleaderfollowerleader+\n2. ``\n3. zookeeperzookeeperzookeeperok0.9zkkafka7\n\n## \n\n","source":"_posts/kafka.md","raw":"---\ntitle: kafka\ndate: 2019-12-03 22:34:16\ncategories: MiddleWare\ntags: kafka\n---\n\n\n\n<!-- mroe -->\n\n# \n``````Message Queue)\n\n## \n\n1. \n2. \n\n\n\n### \n\n1. : QueueQueueQueueQueue\n    ABCAAC``\n\n2. topictopic\n   \n    1. \n    2. \n    \n    - \n    - \n    \n    ``topic\n\n## \n\nkafka()\n\n1. brokerbrokerpartitionleaderfollowerleader+\n2. ``\n3. zookeeperzookeeperzookeeperok0.9zkkafka7\n\n## \n\n","slug":"kafka","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7m001fw5ih3bqj38se","content":"<p></p>\n<!-- mroe -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code></code><code></code><code></code>Message Queue)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><p>: QueueQueueQueueQueue<br> ABCAAC<code></code></p>\n</li>\n<li><p>topictopic</p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n<p><code></code>topic</p>\n</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>kafka()</p>\n<ol>\n<li>brokerbrokerpartitionleaderfollowerleader+</li>\n<li><code></code></li>\n<li>zookeeperzookeeperzookeeperok0.9zkkafka7</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2>","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":"<p></p>\n<!-- mroe -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code></code><code></code><code></code>Message Queue)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><p>: QueueQueueQueueQueue<br> ABCAAC<code></code></p>\n</li>\n<li><p>topictopic</p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n<p><code></code>topic</p>\n</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>kafka()</p>\n<ol>\n<li>brokerbrokerpartitionleaderfollowerleader+</li>\n<li><code></code></li>\n<li>zookeeperzookeeperzookeeperok0.9zkkafka7</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2>"},{"title":"lock","date":"2020-07-20T13:46:41.000Z","_content":"\n\n\n<!--more-->\n\n# \n\n![image.png](https://i.loli.net/2020/07/20/AwVJYTyQqzUpEPl.png)\n\n# |\n\n**JVM**java\n\n- Java`synchronized``Lock`\n- Java****`CAS`Java**CAS**\n\n********\n\n```java\n// synchronized\npublic synchronized void testMehthod(){\n    // do something...\n}\n\n// ReentrantLock\nprivate ReentrantLock lock = new ReentrantLock();\npublic void modifyPublicResources()){\n    try{\n        lock.lock();\n        // do something...\n    }finally{\n        lock.unlock();\n    }\n}\n\n// \nprivate AtomicInteger ai = new AtomicInteger();\natomicInteger.incrementAndGet(); // 1\n```\n\n\n\n# Compare And Swap\n\nCASjava****\n\n- V \n- A\n- B\n\n`V=A`CASBV\n\n## AtomicInteger\n\n```java\npublic class AtomicInteger extends Number implements java.io.Serializable {\n    private static final long serialVersionUID = 6214790243416807050L;\n\n    // setup to use Unsafe.compareAndSwapInt for updates\n    // \n    private static final Unsafe unsafe = Unsafe.getUnsafe();\n    // valueAtomicInteger\n    private static final long valueOffset;\n\n    static {\n        try {\n            valueOffset = unsafe.objectFieldOffset\n                (AtomicInteger.class.getDeclaredField(\"value\"));\n        } catch (Exception ex) { throw new Error(ex); }\n    }\n\t// AtomicIntegerint\n    private volatile int value;\n```\n\n```java\npublic final int getAndIncrement() {\n    return unsafe.getAndAddInt(this, valueOffset, 1);\n}\n```\n\n```java\npublic final int getAndAddInt(Object var1, long var2, int var4) {\n    int var5;\n    do {\n        var5 = this.getIntVolatile(var1, var2);\n    } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n\n    return var5;\n}\n```\n\n```java\npublic final native boolean compareAndSwapInt(Object var1, long var2, int var4, int var5);\n```\n\n`compareAndSwapInt``native`+JDKCPUcmpxchgAVCAS\n\n- `do-while`CPU\n\n**note:** ABAABACASfalse1A-2B-3A\"\n\n# |\n\n\n\nCPU\n\nreference [here](https://mp.weixin.qq.com/s?__biz=MjM5NjQ5MTI5OA==&mid=2651749434&idx=3&sn=5ffa63ad47fe166f2f1a9f604ed10091&chksm=bd12a5778a652c61509d9e718ab086ff27ad8768586ea9b38c3dcf9e017a8e49bcae3df9bcc8&scene=38#wechat_redirect)\n\n# |\n\n\n\n`ReentrantLock``Sync``AbstractQueuedSnchronizer``Sync``FairSync``NonfairSync``ReentrantLock`\n\n# |\n\n==JDK`synchronized``Lock`\n\n\n\nAQS`ReentrantReadWriteLock``ReadLock``WriteLock`","source":"_posts/lock.md","raw":"---\ntitle: lock\ndate: 2020-07-20 21:46:41\ncategories: Java\ntags: lock\n---\n\n\n\n<!--more-->\n\n# \n\n![image.png](https://i.loli.net/2020/07/20/AwVJYTyQqzUpEPl.png)\n\n# |\n\n**JVM**java\n\n- Java`synchronized``Lock`\n- Java****`CAS`Java**CAS**\n\n********\n\n```java\n// synchronized\npublic synchronized void testMehthod(){\n    // do something...\n}\n\n// ReentrantLock\nprivate ReentrantLock lock = new ReentrantLock();\npublic void modifyPublicResources()){\n    try{\n        lock.lock();\n        // do something...\n    }finally{\n        lock.unlock();\n    }\n}\n\n// \nprivate AtomicInteger ai = new AtomicInteger();\natomicInteger.incrementAndGet(); // 1\n```\n\n\n\n# Compare And Swap\n\nCASjava****\n\n- V \n- A\n- B\n\n`V=A`CASBV\n\n## AtomicInteger\n\n```java\npublic class AtomicInteger extends Number implements java.io.Serializable {\n    private static final long serialVersionUID = 6214790243416807050L;\n\n    // setup to use Unsafe.compareAndSwapInt for updates\n    // \n    private static final Unsafe unsafe = Unsafe.getUnsafe();\n    // valueAtomicInteger\n    private static final long valueOffset;\n\n    static {\n        try {\n            valueOffset = unsafe.objectFieldOffset\n                (AtomicInteger.class.getDeclaredField(\"value\"));\n        } catch (Exception ex) { throw new Error(ex); }\n    }\n\t// AtomicIntegerint\n    private volatile int value;\n```\n\n```java\npublic final int getAndIncrement() {\n    return unsafe.getAndAddInt(this, valueOffset, 1);\n}\n```\n\n```java\npublic final int getAndAddInt(Object var1, long var2, int var4) {\n    int var5;\n    do {\n        var5 = this.getIntVolatile(var1, var2);\n    } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n\n    return var5;\n}\n```\n\n```java\npublic final native boolean compareAndSwapInt(Object var1, long var2, int var4, int var5);\n```\n\n`compareAndSwapInt``native`+JDKCPUcmpxchgAVCAS\n\n- `do-while`CPU\n\n**note:** ABAABACASfalse1A-2B-3A\"\n\n# |\n\n\n\nCPU\n\nreference [here](https://mp.weixin.qq.com/s?__biz=MjM5NjQ5MTI5OA==&mid=2651749434&idx=3&sn=5ffa63ad47fe166f2f1a9f604ed10091&chksm=bd12a5778a652c61509d9e718ab086ff27ad8768586ea9b38c3dcf9e017a8e49bcae3df9bcc8&scene=38#wechat_redirect)\n\n# |\n\n\n\n`ReentrantLock``Sync``AbstractQueuedSnchronizer``Sync``FairSync``NonfairSync``ReentrantLock`\n\n# |\n\n==JDK`synchronized``Lock`\n\n\n\nAQS`ReentrantReadWriteLock``ReadLock``WriteLock`","slug":"lock","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7n001hw5ih9xrv26ea","content":"<p></p>\n<a id=\"more\"></a>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/07/20/AwVJYTyQqzUpEPl.png\" alt=\"image.png\"></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p><strong>JVM</strong>java</p>\n<ul>\n<li>Java<code>synchronized</code><code>Lock</code></li>\n<li>Java<strong></strong><code>CAS</code>Java<strong>CAS</strong></li>\n</ul>\n<p><strong></strong><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// synchronized</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">testMehthod</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ReentrantLock</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> ReentrantLock lock = <span class=\"keyword\">new</span> ReentrantLock();</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">modifyPublicResources</span><span class=\"params\">()</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">        lock.lock();</span><br><span class=\"line\">        <span class=\"comment\">// do something...</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">        lock.unlock();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">private</span> AtomicInteger ai = <span class=\"keyword\">new</span> AtomicInteger();</span><br><span class=\"line\">atomicInteger.incrementAndGet(); <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"Compare-And-Swap\"><a href=\"#Compare-And-Swap\" class=\"headerlink\" title=\"Compare And Swap\"></a>Compare And Swap</h1><p>CASjava<strong></strong></p>\n<ul>\n<li>V </li>\n<li>A</li>\n<li>B</li>\n</ul>\n<p><code>V=A</code>CASBV</p>\n<h2 id=\"AtomicInteger\"><a href=\"#AtomicInteger\" class=\"headerlink\" title=\"AtomicInteger\"></a>AtomicInteger</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AtomicInteger</span> <span class=\"keyword\">extends</span> <span class=\"title\">Number</span> <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> serialVersionUID = <span class=\"number\">6214790243416807050L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// setup to use Unsafe.compareAndSwapInt for updates</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Unsafe unsafe = Unsafe.getUnsafe();</span><br><span class=\"line\">    <span class=\"comment\">// valueAtomicInteger</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> valueOffset;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            valueOffset = unsafe.objectFieldOffset</span><br><span class=\"line\">                (AtomicInteger.class.getDeclaredField(<span class=\"string\">&quot;value&quot;</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(ex); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t<span class=\"comment\">// AtomicIntegerint</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> value;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndIncrement</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> unsafe.getAndAddInt(<span class=\"keyword\">this</span>, valueOffset, <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndAddInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> var5;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">        var5 = <span class=\"keyword\">this</span>.getIntVolatile(var1, var2);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">while</span>(!<span class=\"keyword\">this</span>.compareAndSwapInt(var1, var2, var5, var5 + var4));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> var5;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">boolean</span> <span class=\"title\">compareAndSwapInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4, <span class=\"keyword\">int</span> var5)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><code>compareAndSwapInt</code><code>native</code>+JDKCPUcmpxchgAVCAS</p>\n<ul>\n<li><code>do-while</code>CPU</li>\n</ul>\n<p><strong>note:</strong> ABAABACASfalse1A-2B-3A</p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p></p>\n<p>CPU</p>\n<p>reference <a href=\"https://mp.weixin.qq.com/s?__biz=MjM5NjQ5MTI5OA==&mid=2651749434&idx=3&sn=5ffa63ad47fe166f2f1a9f604ed10091&chksm=bd12a5778a652c61509d9e718ab086ff27ad8768586ea9b38c3dcf9e017a8e49bcae3df9bcc8&scene=38#wechat_redirect\">here</a></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p></p>\n<p><code>ReentrantLock</code><code>Sync</code><code>AbstractQueuedSnchronizer</code><code>Sync</code><code>FairSync</code><code>NonfairSync</code><code>ReentrantLock</code></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p>==JDK<code>synchronized</code><code>Lock</code></p>\n<p></p>\n<p>AQS<code>ReentrantReadWriteLock</code><code>ReadLock</code><code>WriteLock</code></p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p></p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"https://i.loli.net/2020/07/20/AwVJYTyQqzUpEPl.png\" alt=\"image.png\"></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p><strong>JVM</strong>java</p>\n<ul>\n<li>Java<code>synchronized</code><code>Lock</code></li>\n<li>Java<strong></strong><code>CAS</code>Java<strong>CAS</strong></li>\n</ul>\n<p><strong></strong><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// synchronized</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">testMehthod</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ReentrantLock</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> ReentrantLock lock = <span class=\"keyword\">new</span> ReentrantLock();</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">modifyPublicResources</span><span class=\"params\">()</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">        lock.lock();</span><br><span class=\"line\">        <span class=\"comment\">// do something...</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">        lock.unlock();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">private</span> AtomicInteger ai = <span class=\"keyword\">new</span> AtomicInteger();</span><br><span class=\"line\">atomicInteger.incrementAndGet(); <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"Compare-And-Swap\"><a href=\"#Compare-And-Swap\" class=\"headerlink\" title=\"Compare And Swap\"></a>Compare And Swap</h1><p>CASjava<strong></strong></p>\n<ul>\n<li>V </li>\n<li>A</li>\n<li>B</li>\n</ul>\n<p><code>V=A</code>CASBV</p>\n<h2 id=\"AtomicInteger\"><a href=\"#AtomicInteger\" class=\"headerlink\" title=\"AtomicInteger\"></a>AtomicInteger</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AtomicInteger</span> <span class=\"keyword\">extends</span> <span class=\"title\">Number</span> <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> serialVersionUID = <span class=\"number\">6214790243416807050L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// setup to use Unsafe.compareAndSwapInt for updates</span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Unsafe unsafe = Unsafe.getUnsafe();</span><br><span class=\"line\">    <span class=\"comment\">// valueAtomicInteger</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> valueOffset;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            valueOffset = unsafe.objectFieldOffset</span><br><span class=\"line\">                (AtomicInteger.class.getDeclaredField(<span class=\"string\">&quot;value&quot;</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(ex); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t<span class=\"comment\">// AtomicIntegerint</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> value;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndIncrement</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> unsafe.getAndAddInt(<span class=\"keyword\">this</span>, valueOffset, <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndAddInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> var5;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">        var5 = <span class=\"keyword\">this</span>.getIntVolatile(var1, var2);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">while</span>(!<span class=\"keyword\">this</span>.compareAndSwapInt(var1, var2, var5, var5 + var4));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> var5;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">boolean</span> <span class=\"title\">compareAndSwapInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4, <span class=\"keyword\">int</span> var5)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><code>compareAndSwapInt</code><code>native</code>+JDKCPUcmpxchgAVCAS</p>\n<ul>\n<li><code>do-while</code>CPU</li>\n</ul>\n<p><strong>note:</strong> ABAABACASfalse1A-2B-3A</p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p></p>\n<p>CPU</p>\n<p>reference <a href=\"https://mp.weixin.qq.com/s?__biz=MjM5NjQ5MTI5OA==&mid=2651749434&idx=3&sn=5ffa63ad47fe166f2f1a9f604ed10091&chksm=bd12a5778a652c61509d9e718ab086ff27ad8768586ea9b38c3dcf9e017a8e49bcae3df9bcc8&scene=38#wechat_redirect\">here</a></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p></p>\n<p><code>ReentrantLock</code><code>Sync</code><code>AbstractQueuedSnchronizer</code><code>Sync</code><code>FairSync</code><code>NonfairSync</code><code>ReentrantLock</code></p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"|\"></a>|</h1><p>==JDK<code>synchronized</code><code>Lock</code></p>\n<p></p>\n<p>AQS<code>ReentrantReadWriteLock</code><code>ReadLock</code><code>WriteLock</code></p>"},{"title":"mybatis autoconfiguration","date":"2021-03-09T12:48:57.000Z","_content":"\nmybatisspringbootSpringBootSpringmybatisstarterspringboot\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\nSpringBoot`META-INF``spring.factories``EnableAutoConfiguration`mybatismybatis\n\n```properties\n# Auto Configure\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.mybatis.spring.boot.autoconfigure.MybatisLanguageDriverAutoConfiguration,\\\norg.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration\n```\n\n*thymeleaf**framemarker*web`MybatisAutoConfiguration`\n\n# \n\n\n\n```java\n@Configuration\n@ConditionalOnClass({SqlSessionFactory.class, SqlSessionFactoryBean.class}) // class\n@ConditionalOnSingleCandidate(DataSource.class) // \n@EnableConfigurationProperties({MybatisProperties.class}) // mybatis\n@AutoConfigureAfter({DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class}) // \npublic class MybatisAutoConfiguration implements InitializingBean {\n    // ...\n}\n```\n\n## sqlSessionFactory\n\n```java\n@Bean\n@ConditionalOnMissingBean // bean\npublic SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {\n    // ...\n}\n```\n\nsqlSessionFactorysqlSessionsqlsqlSessionfactory`MapperProperties`facotry\n\n## sqlSessionTemplate\n\n```java\n@Bean\n@ConditionalOnMissingBean // sqlSessionFactory\npublic SqlSessionTemplate sqlSessionTemplate(SqlSessionFactory sqlSessionFactory) {\n    ExecutorType executorType = this.properties.getExecutorType();\n    return executorType != null ? new SqlSessionTemplate(sqlSessionFactory, executorType) : new SqlSessionTemplate(sqlSessionFactory);\n}\n```\n\nsqlSessionFactorysqlSessionFactory`executorType`sqlSessionTemplatebeansqlSession`executorType`\n\n- SIMPLE\n- REUSE\n- BATCH\n\n## MapperScannerRegistrarNotFoundConfiguration\n\n```java\n@Configuration\n@Import({MybatisAutoConfiguration.AutoConfiguredMapperScannerRegistrar.class}) // \n@ConditionalOnMissingBean({MapperFactoryBean.class, MapperScannerConfigurer.class}) // \npublic static class MapperScannerRegistrarNotFoundConfiguration implements InitializingBean {\n    public MapperScannerRegistrarNotFoundConfiguration() {\n    }\n\n    public void afterPropertiesSet() {\n        MybatisAutoConfiguration.logger.debug(\"Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.\");\n    }\n}\n```\n\n`MapperFactoryBean``MapperScannerConfigure.class`***@MapperScan***\n\n```java\npublic class MapperFactoryBean<T> extends SqlSessionDaoSupport implements FactoryBean<T> {\n    private Class<T> mapperInterface;\n    private boolean addToConfig = true;\n\n    public MapperFactoryBean() {\n    }\n\n    public MapperFactoryBean(Class<T> mapperInterface) {\n        this.mapperInterface = mapperInterface;\n    }\n\n    protected void checkDaoConfig() {\n        super.checkDaoConfig();\n        Assert.notNull(this.mapperInterface, \"Property 'mapperInterface' is required\");\n        Configuration configuration = this.getSqlSession().getConfiguration();\n        // \n        if (this.addToConfig && !configuration.hasMapper(this.mapperInterface)) {\n            try {\n                // mybatis\n                configuration.addMapper(this.mapperInterface);\n            } catch (Exception var6) {\n                this.logger.error(\"Error while adding the mapper '\" + this.mapperInterface + \"' to configuration.\", var6);\n                throw new IllegalArgumentException(var6);\n            } finally {\n                ErrorContext.instance().reset();\n            }\n        }\n\n    }\n    // ...\n}\n\n```\n\n\n\n1. \n2. sqlSessionFactorybeandataSource\n3. sqlSessionTemplatebeansqlSessionFactory\n4. mapperbeanmapper\n\nmybatismappersqlSessionFactorysqlSessionTemplatemybatisConfigurationmapper`mapperRegister`mappermapperHashMap","source":"_posts/mybatis-autoconfiguration.md","raw":"---\ntitle: mybatis autoconfiguration\ndate: 2021-03-09 20:48:57\ncategories: framework\ntags: mybatis\n---\n\nmybatisspringbootSpringBootSpringmybatisstarterspringboot\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\nSpringBoot`META-INF``spring.factories``EnableAutoConfiguration`mybatismybatis\n\n```properties\n# Auto Configure\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.mybatis.spring.boot.autoconfigure.MybatisLanguageDriverAutoConfiguration,\\\norg.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration\n```\n\n*thymeleaf**framemarker*web`MybatisAutoConfiguration`\n\n# \n\n\n\n```java\n@Configuration\n@ConditionalOnClass({SqlSessionFactory.class, SqlSessionFactoryBean.class}) // class\n@ConditionalOnSingleCandidate(DataSource.class) // \n@EnableConfigurationProperties({MybatisProperties.class}) // mybatis\n@AutoConfigureAfter({DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class}) // \npublic class MybatisAutoConfiguration implements InitializingBean {\n    // ...\n}\n```\n\n## sqlSessionFactory\n\n```java\n@Bean\n@ConditionalOnMissingBean // bean\npublic SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {\n    // ...\n}\n```\n\nsqlSessionFactorysqlSessionsqlsqlSessionfactory`MapperProperties`facotry\n\n## sqlSessionTemplate\n\n```java\n@Bean\n@ConditionalOnMissingBean // sqlSessionFactory\npublic SqlSessionTemplate sqlSessionTemplate(SqlSessionFactory sqlSessionFactory) {\n    ExecutorType executorType = this.properties.getExecutorType();\n    return executorType != null ? new SqlSessionTemplate(sqlSessionFactory, executorType) : new SqlSessionTemplate(sqlSessionFactory);\n}\n```\n\nsqlSessionFactorysqlSessionFactory`executorType`sqlSessionTemplatebeansqlSession`executorType`\n\n- SIMPLE\n- REUSE\n- BATCH\n\n## MapperScannerRegistrarNotFoundConfiguration\n\n```java\n@Configuration\n@Import({MybatisAutoConfiguration.AutoConfiguredMapperScannerRegistrar.class}) // \n@ConditionalOnMissingBean({MapperFactoryBean.class, MapperScannerConfigurer.class}) // \npublic static class MapperScannerRegistrarNotFoundConfiguration implements InitializingBean {\n    public MapperScannerRegistrarNotFoundConfiguration() {\n    }\n\n    public void afterPropertiesSet() {\n        MybatisAutoConfiguration.logger.debug(\"Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.\");\n    }\n}\n```\n\n`MapperFactoryBean``MapperScannerConfigure.class`***@MapperScan***\n\n```java\npublic class MapperFactoryBean<T> extends SqlSessionDaoSupport implements FactoryBean<T> {\n    private Class<T> mapperInterface;\n    private boolean addToConfig = true;\n\n    public MapperFactoryBean() {\n    }\n\n    public MapperFactoryBean(Class<T> mapperInterface) {\n        this.mapperInterface = mapperInterface;\n    }\n\n    protected void checkDaoConfig() {\n        super.checkDaoConfig();\n        Assert.notNull(this.mapperInterface, \"Property 'mapperInterface' is required\");\n        Configuration configuration = this.getSqlSession().getConfiguration();\n        // \n        if (this.addToConfig && !configuration.hasMapper(this.mapperInterface)) {\n            try {\n                // mybatis\n                configuration.addMapper(this.mapperInterface);\n            } catch (Exception var6) {\n                this.logger.error(\"Error while adding the mapper '\" + this.mapperInterface + \"' to configuration.\", var6);\n                throw new IllegalArgumentException(var6);\n            } finally {\n                ErrorContext.instance().reset();\n            }\n        }\n\n    }\n    // ...\n}\n\n```\n\n\n\n1. \n2. sqlSessionFactorybeandataSource\n3. sqlSessionTemplatebeansqlSessionFactory\n4. mapperbeanmapper\n\nmybatismappersqlSessionFactorysqlSessionTemplatemybatisConfigurationmapper`mapperRegister`mappermapperHashMap","slug":"mybatis-autoconfiguration","published":1,"updated":"2021-03-22T14:15:53.417Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7p001lw5ih0n9t6rvg","content":"<p>mybatisspringbootSpringBootSpringmybatisstarterspringboot</p>\n<a id=\"more\"></a>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringBoot<code>META-INF</code><code>spring.factories</code><code>EnableAutoConfiguration</code>mybatismybatis</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Auto Configure</span></span><br><span class=\"line\"><span class=\"meta\">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.mybatis.spring.boot.autoconfigure.MybatisLanguageDriverAutoConfiguration,\\</span><br><span class=\"line\"><span class=\"attr\">org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration</span></span><br></pre></td></tr></table></figure>\n\n<p><em>thymeleaf</em><em>framemarker</em>web<code>MybatisAutoConfiguration</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnClass(&#123;SqlSessionFactory.class, SqlSessionFactoryBean.class&#125;)</span> <span class=\"comment\">// class</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnSingleCandidate(DataSource.class)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@EnableConfigurationProperties(&#123;MybatisProperties.class&#125;)</span> <span class=\"comment\">// mybatis</span></span><br><span class=\"line\"><span class=\"meta\">@AutoConfigureAfter(&#123;DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MybatisAutoConfiguration</span> <span class=\"keyword\">implements</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"sqlSessionFactory\"><a href=\"#sqlSessionFactory\" class=\"headerlink\" title=\"sqlSessionFactory\"></a>sqlSessionFactory</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// bean</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> SqlSessionFactory <span class=\"title\">sqlSessionFactory</span><span class=\"params\">(DataSource dataSource)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sqlSessionFactorysqlSessionsqlsqlSessionfactory<code>MapperProperties</code>facotry</p>\n<h2 id=\"sqlSessionTemplate\"><a href=\"#sqlSessionTemplate\" class=\"headerlink\" title=\"sqlSessionTemplate\"></a>sqlSessionTemplate</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// sqlSessionFactory</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> SqlSessionTemplate <span class=\"title\">sqlSessionTemplate</span><span class=\"params\">(SqlSessionFactory sqlSessionFactory)</span> </span>&#123;</span><br><span class=\"line\">    ExecutorType executorType = <span class=\"keyword\">this</span>.properties.getExecutorType();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> executorType != <span class=\"keyword\">null</span> ? <span class=\"keyword\">new</span> SqlSessionTemplate(sqlSessionFactory, executorType) : <span class=\"keyword\">new</span> SqlSessionTemplate(sqlSessionFactory);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sqlSessionFactorysqlSessionFactory<code>executorType</code>sqlSessionTemplatebeansqlSession<code>executorType</code></p>\n<ul>\n<li>SIMPLE</li>\n<li>REUSE</li>\n<li>BATCH</li>\n</ul>\n<h2 id=\"MapperScannerRegistrarNotFoundConfiguration\"><a href=\"#MapperScannerRegistrarNotFoundConfiguration\" class=\"headerlink\" title=\"MapperScannerRegistrarNotFoundConfiguration\"></a>MapperScannerRegistrarNotFoundConfiguration</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@Import(&#123;MybatisAutoConfiguration.AutoConfiguredMapperScannerRegistrar.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean(&#123;MapperFactoryBean.class, MapperScannerConfigurer.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MapperScannerRegistrarNotFoundConfiguration</span> <span class=\"keyword\">implements</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperScannerRegistrarNotFoundConfiguration</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterPropertiesSet</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        MybatisAutoConfiguration.logger.debug(<span class=\"string\">&quot;Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>MapperFactoryBean</code><code>MapperScannerConfigure.class</code><strong>*@MapperScan*</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MapperFactoryBean</span>&lt;<span class=\"title\">T</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title\">SqlSessionDaoSupport</span> <span class=\"keyword\">implements</span> <span class=\"title\">FactoryBean</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Class&lt;T&gt; mapperInterface;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> addToConfig = <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperFactoryBean</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperFactoryBean</span><span class=\"params\">(Class&lt;T&gt; mapperInterface)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.mapperInterface = mapperInterface;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">checkDaoConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.checkDaoConfig();</span><br><span class=\"line\">        Assert.notNull(<span class=\"keyword\">this</span>.mapperInterface, <span class=\"string\">&quot;Property &#x27;mapperInterface&#x27; is required&quot;</span>);</span><br><span class=\"line\">        Configuration configuration = <span class=\"keyword\">this</span>.getSqlSession().getConfiguration();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.addToConfig &amp;&amp; !configuration.hasMapper(<span class=\"keyword\">this</span>.mapperInterface)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// mybatis</span></span><br><span class=\"line\">                configuration.addMapper(<span class=\"keyword\">this</span>.mapperInterface);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (Exception var6) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.logger.error(<span class=\"string\">&quot;Error while adding the mapper &#x27;&quot;</span> + <span class=\"keyword\">this</span>.mapperInterface + <span class=\"string\">&quot;&#x27; to configuration.&quot;</span>, var6);</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalArgumentException(var6);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                ErrorContext.instance().reset();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ol>\n<li></li>\n<li>sqlSessionFactorybeandataSource</li>\n<li>sqlSessionTemplatebeansqlSessionFactory</li>\n<li>mapperbeanmapper</li>\n</ol>\n<p>mybatismappersqlSessionFactorysqlSessionTemplatemybatisConfigurationmapper<code>mapperRegister</code>mappermapperHashMap</p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>mybatisspringbootSpringBootSpringmybatisstarterspringboot</p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringBoot<code>META-INF</code><code>spring.factories</code><code>EnableAutoConfiguration</code>mybatismybatis</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Auto Configure</span></span><br><span class=\"line\"><span class=\"meta\">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.mybatis.spring.boot.autoconfigure.MybatisLanguageDriverAutoConfiguration,\\</span><br><span class=\"line\"><span class=\"attr\">org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration</span></span><br></pre></td></tr></table></figure>\n\n<p><em>thymeleaf</em><em>framemarker</em>web<code>MybatisAutoConfiguration</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnClass(&#123;SqlSessionFactory.class, SqlSessionFactoryBean.class&#125;)</span> <span class=\"comment\">// class</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnSingleCandidate(DataSource.class)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@EnableConfigurationProperties(&#123;MybatisProperties.class&#125;)</span> <span class=\"comment\">// mybatis</span></span><br><span class=\"line\"><span class=\"meta\">@AutoConfigureAfter(&#123;DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MybatisAutoConfiguration</span> <span class=\"keyword\">implements</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"sqlSessionFactory\"><a href=\"#sqlSessionFactory\" class=\"headerlink\" title=\"sqlSessionFactory\"></a>sqlSessionFactory</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// bean</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> SqlSessionFactory <span class=\"title\">sqlSessionFactory</span><span class=\"params\">(DataSource dataSource)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sqlSessionFactorysqlSessionsqlsqlSessionfactory<code>MapperProperties</code>facotry</p>\n<h2 id=\"sqlSessionTemplate\"><a href=\"#sqlSessionTemplate\" class=\"headerlink\" title=\"sqlSessionTemplate\"></a>sqlSessionTemplate</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// sqlSessionFactory</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> SqlSessionTemplate <span class=\"title\">sqlSessionTemplate</span><span class=\"params\">(SqlSessionFactory sqlSessionFactory)</span> </span>&#123;</span><br><span class=\"line\">    ExecutorType executorType = <span class=\"keyword\">this</span>.properties.getExecutorType();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> executorType != <span class=\"keyword\">null</span> ? <span class=\"keyword\">new</span> SqlSessionTemplate(sqlSessionFactory, executorType) : <span class=\"keyword\">new</span> SqlSessionTemplate(sqlSessionFactory);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>sqlSessionFactorysqlSessionFactory<code>executorType</code>sqlSessionTemplatebeansqlSession<code>executorType</code></p>\n<ul>\n<li>SIMPLE</li>\n<li>REUSE</li>\n<li>BATCH</li>\n</ul>\n<h2 id=\"MapperScannerRegistrarNotFoundConfiguration\"><a href=\"#MapperScannerRegistrarNotFoundConfiguration\" class=\"headerlink\" title=\"MapperScannerRegistrarNotFoundConfiguration\"></a>MapperScannerRegistrarNotFoundConfiguration</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@Import(&#123;MybatisAutoConfiguration.AutoConfiguredMapperScannerRegistrar.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">@ConditionalOnMissingBean(&#123;MapperFactoryBean.class, MapperScannerConfigurer.class&#125;)</span> <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MapperScannerRegistrarNotFoundConfiguration</span> <span class=\"keyword\">implements</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperScannerRegistrarNotFoundConfiguration</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterPropertiesSet</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        MybatisAutoConfiguration.logger.debug(<span class=\"string\">&quot;Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>MapperFactoryBean</code><code>MapperScannerConfigure.class</code><strong>*@MapperScan*</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MapperFactoryBean</span>&lt;<span class=\"title\">T</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title\">SqlSessionDaoSupport</span> <span class=\"keyword\">implements</span> <span class=\"title\">FactoryBean</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Class&lt;T&gt; mapperInterface;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> addToConfig = <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperFactoryBean</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MapperFactoryBean</span><span class=\"params\">(Class&lt;T&gt; mapperInterface)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.mapperInterface = mapperInterface;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">checkDaoConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.checkDaoConfig();</span><br><span class=\"line\">        Assert.notNull(<span class=\"keyword\">this</span>.mapperInterface, <span class=\"string\">&quot;Property &#x27;mapperInterface&#x27; is required&quot;</span>);</span><br><span class=\"line\">        Configuration configuration = <span class=\"keyword\">this</span>.getSqlSession().getConfiguration();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.addToConfig &amp;&amp; !configuration.hasMapper(<span class=\"keyword\">this</span>.mapperInterface)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// mybatis</span></span><br><span class=\"line\">                configuration.addMapper(<span class=\"keyword\">this</span>.mapperInterface);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (Exception var6) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.logger.error(<span class=\"string\">&quot;Error while adding the mapper &#x27;&quot;</span> + <span class=\"keyword\">this</span>.mapperInterface + <span class=\"string\">&quot;&#x27; to configuration.&quot;</span>, var6);</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalArgumentException(var6);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                ErrorContext.instance().reset();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ol>\n<li></li>\n<li>sqlSessionFactorybeandataSource</li>\n<li>sqlSessionTemplatebeansqlSessionFactory</li>\n<li>mapperbeanmapper</li>\n</ol>\n<p>mybatismappersqlSessionFactorysqlSessionTemplatemybatisConfigurationmapper<code>mapperRegister</code>mappermapperHashMap</p>"},{"title":"mybatis sql resolution","date":"2021-03-07T11:03:54.000Z","_content":"\nmybatismybatisspringsqlsql\n\n<!-- more -->\n\n<!-- toc -->\n\n```java\npublic class Test {\n\n    // pojo\n    static class User {\n        int age;\n        int name;\n    }\n\n    public static void main(String[] args) {\n        // \n        UserMapper userMapper = (UserMapper) Proxy.newProxyInstance(Test.class.getClassLoader(), new Class<?>[]{UserMapper.class}, new InvocationHandler() {\n            @Override\n            public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n                // \n                Select annotation = method.getAnnotation(Select.class);\n                // \n                Map<String, Object> map = buildMethodArgNameMap(method, args);\n\n                System.out.println(map.toString());\n                if (annotation != null) {\n                    String[] value = annotation.value();\n                    String s = parseSql(value[0], map);\n                    System.out.println(s);\n                }\n                return null;\n            }\n        });\n        userMapper.selectUesList(2);\n    }\n\n    // sql\n    public static String parseSql(String sql, Map<String, Object> map) {\n        StringBuilder sb = new StringBuilder();\n        int length = sql.length();\n        for (int i = 0; i < length; i++) {\n            char c = sql.charAt(i);\n            if (c == '#') {\n                int nextIndex = i + 1;\n                char nextChar = sql.charAt(nextIndex);\n                if (nextChar != '{') {\n                    throw new RuntimeException(\"sql { \");\n                }\n                StringBuilder argSb = new StringBuilder();\n                i = parseSqlArg(argSb, sql, nextIndex);\n                String argName = argSb.toString();\n                Object argValue = map.get(argName);\n                sb.append(argValue.toString());\n                continue;\n            }\n            sb.append(c);\n        }\n\n        // sql\n        return sb.toString();\n    }\n\n    /**\n     * {}\n     */\n    private static int parseSqlArg(StringBuilder argSb, String sql, int nextIndex) {\n        for (int i = nextIndex + 1; i < sql.length(); i++) {\n            char c = sql.charAt(i);\n            if (c != '}') {\n                argSb.append(c);\n            } else {\n                return i;\n            }\n        }\n        throw new RuntimeException(\"sql } \");\n    }\n\n    /**\n     * \n     *\n     * @param method method\n     * @param args   \n     * @return \n     */\n    public static Map<String, Object> buildMethodArgNameMap(Method method, Object[] args) {\n        Map<String, Object> map = new HashMap<>(6);\n        // Integer id, args 6\n        Parameter[] parameters = method.getParameters();\n        for (int i = 0; i < parameters.length; i++) {\n            map.put(parameters[i].getName(), args[i]);\n        }\n        return map;\n    }\n}\n\n\ninterface UserMapper {\n\n    @Select(\"select * from User where id = #{id}\")\n    List<Test.User> selectUesList(Integer id);\n}\t\n```\n\nmybatissql![mybatis_structure.jpg](https://i.loli.net/2021/03/07/cPamMLRFU4xHXu8.jpg)\n\nsqlsqlmybatisxml`#{}`mybatissqlsqlsql","source":"_posts/mybatis-sql-resolution.md","raw":"---\ntitle: mybatis sql resolution\ndate: 2021-03-07 19:03:54\ncategories: framework\ntags: mybatis\n---\n\nmybatismybatisspringsqlsql\n\n<!-- more -->\n\n<!-- toc -->\n\n```java\npublic class Test {\n\n    // pojo\n    static class User {\n        int age;\n        int name;\n    }\n\n    public static void main(String[] args) {\n        // \n        UserMapper userMapper = (UserMapper) Proxy.newProxyInstance(Test.class.getClassLoader(), new Class<?>[]{UserMapper.class}, new InvocationHandler() {\n            @Override\n            public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n                // \n                Select annotation = method.getAnnotation(Select.class);\n                // \n                Map<String, Object> map = buildMethodArgNameMap(method, args);\n\n                System.out.println(map.toString());\n                if (annotation != null) {\n                    String[] value = annotation.value();\n                    String s = parseSql(value[0], map);\n                    System.out.println(s);\n                }\n                return null;\n            }\n        });\n        userMapper.selectUesList(2);\n    }\n\n    // sql\n    public static String parseSql(String sql, Map<String, Object> map) {\n        StringBuilder sb = new StringBuilder();\n        int length = sql.length();\n        for (int i = 0; i < length; i++) {\n            char c = sql.charAt(i);\n            if (c == '#') {\n                int nextIndex = i + 1;\n                char nextChar = sql.charAt(nextIndex);\n                if (nextChar != '{') {\n                    throw new RuntimeException(\"sql { \");\n                }\n                StringBuilder argSb = new StringBuilder();\n                i = parseSqlArg(argSb, sql, nextIndex);\n                String argName = argSb.toString();\n                Object argValue = map.get(argName);\n                sb.append(argValue.toString());\n                continue;\n            }\n            sb.append(c);\n        }\n\n        // sql\n        return sb.toString();\n    }\n\n    /**\n     * {}\n     */\n    private static int parseSqlArg(StringBuilder argSb, String sql, int nextIndex) {\n        for (int i = nextIndex + 1; i < sql.length(); i++) {\n            char c = sql.charAt(i);\n            if (c != '}') {\n                argSb.append(c);\n            } else {\n                return i;\n            }\n        }\n        throw new RuntimeException(\"sql } \");\n    }\n\n    /**\n     * \n     *\n     * @param method method\n     * @param args   \n     * @return \n     */\n    public static Map<String, Object> buildMethodArgNameMap(Method method, Object[] args) {\n        Map<String, Object> map = new HashMap<>(6);\n        // Integer id, args 6\n        Parameter[] parameters = method.getParameters();\n        for (int i = 0; i < parameters.length; i++) {\n            map.put(parameters[i].getName(), args[i]);\n        }\n        return map;\n    }\n}\n\n\ninterface UserMapper {\n\n    @Select(\"select * from User where id = #{id}\")\n    List<Test.User> selectUesList(Integer id);\n}\t\n```\n\nmybatissql![mybatis_structure.jpg](https://i.loli.net/2021/03/07/cPamMLRFU4xHXu8.jpg)\n\nsqlsqlmybatisxml`#{}`mybatissqlsqlsql","slug":"mybatis-sql-resolution","published":1,"updated":"2021-03-23T15:15:34.075Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7t001nw5ihe0yj0268","content":"<p>mybatismybatisspringsqlsql</p>\n<a id=\"more\"></a>\n\n<!-- toc -->\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// pojo</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> age;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        UserMapper userMapper = (UserMapper) Proxy.newProxyInstance(Test.class.getClassLoader(), <span class=\"keyword\">new</span> Class&lt;?&gt;[]&#123;UserMapper.class&#125;, <span class=\"keyword\">new</span> InvocationHandler() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                Select annotation = method.getAnnotation(Select.class);</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                Map&lt;String, Object&gt; map = buildMethodArgNameMap(method, args);</span><br><span class=\"line\"></span><br><span class=\"line\">                System.out.println(map.toString());</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (annotation != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    String[] value = annotation.value();</span><br><span class=\"line\">                    String s = parseSql(value[<span class=\"number\">0</span>], map);</span><br><span class=\"line\">                    System.out.println(s);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        userMapper.selectUesList(<span class=\"number\">2</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// sql</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">parseSql</span><span class=\"params\">(String sql, Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class=\"line\">        StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length = sql.length();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = sql.charAt(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c == <span class=\"string\">&#x27;#&#x27;</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> nextIndex = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">char</span> nextChar = sql.charAt(nextIndex);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nextChar != <span class=\"string\">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">&quot;sql &#123; &quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                StringBuilder argSb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">                i = parseSqlArg(argSb, sql, nextIndex);</span><br><span class=\"line\">                String argName = argSb.toString();</span><br><span class=\"line\">                Object argValue = map.get(argName);</span><br><span class=\"line\">                sb.append(argValue.toString());</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            sb.append(c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// sql</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * &#123;&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">parseSqlArg</span><span class=\"params\">(StringBuilder argSb, String sql, <span class=\"keyword\">int</span> nextIndex)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = nextIndex + <span class=\"number\">1</span>; i &lt; sql.length(); i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = sql.charAt(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c != <span class=\"string\">&#x27;&#125;&#x27;</span>) &#123;</span><br><span class=\"line\">                argSb.append(c);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> i;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">&quot;sql &#125; &quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> method method</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> args   </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Map&lt;String, Object&gt; <span class=\"title\">buildMethodArgNameMap</span><span class=\"params\">(Method method, Object[] args)</span> </span>&#123;</span><br><span class=\"line\">        Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">6</span>);</span><br><span class=\"line\">        <span class=\"comment\">// Integer id, args 6</span></span><br><span class=\"line\">        Parameter[] parameters = method.getParameters();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; parameters.length; i++) &#123;</span><br><span class=\"line\">            map.put(parameters[i].getName(), args[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Select(&quot;select * from User where id = #&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    List&lt;Test.User&gt; selectUesList(Integer id);</span><br><span class=\"line\">&#125;\t</span><br></pre></td></tr></table></figure>\n\n<p>mybatissql<img src=\"https://i.loli.net/2021/03/07/cPamMLRFU4xHXu8.jpg\" alt=\"mybatis_structure.jpg\"></p>\n<p>sqlsqlmybatisxml<code>#&#123;&#125;</code>mybatissqlsqlsql</p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>mybatismybatisspringsqlsql</p>","more":"<!-- toc -->\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// pojo</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> age;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        UserMapper userMapper = (UserMapper) Proxy.newProxyInstance(Test.class.getClassLoader(), <span class=\"keyword\">new</span> Class&lt;?&gt;[]&#123;UserMapper.class&#125;, <span class=\"keyword\">new</span> InvocationHandler() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                Select annotation = method.getAnnotation(Select.class);</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                Map&lt;String, Object&gt; map = buildMethodArgNameMap(method, args);</span><br><span class=\"line\"></span><br><span class=\"line\">                System.out.println(map.toString());</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (annotation != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    String[] value = annotation.value();</span><br><span class=\"line\">                    String s = parseSql(value[<span class=\"number\">0</span>], map);</span><br><span class=\"line\">                    System.out.println(s);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        userMapper.selectUesList(<span class=\"number\">2</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// sql</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">parseSql</span><span class=\"params\">(String sql, Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class=\"line\">        StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length = sql.length();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = sql.charAt(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c == <span class=\"string\">&#x27;#&#x27;</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> nextIndex = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">char</span> nextChar = sql.charAt(nextIndex);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nextChar != <span class=\"string\">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">&quot;sql &#123; &quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                StringBuilder argSb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">                i = parseSqlArg(argSb, sql, nextIndex);</span><br><span class=\"line\">                String argName = argSb.toString();</span><br><span class=\"line\">                Object argValue = map.get(argName);</span><br><span class=\"line\">                sb.append(argValue.toString());</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            sb.append(c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// sql</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * &#123;&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">parseSqlArg</span><span class=\"params\">(StringBuilder argSb, String sql, <span class=\"keyword\">int</span> nextIndex)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = nextIndex + <span class=\"number\">1</span>; i &lt; sql.length(); i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = sql.charAt(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c != <span class=\"string\">&#x27;&#125;&#x27;</span>) &#123;</span><br><span class=\"line\">                argSb.append(c);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> i;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">&quot;sql &#125; &quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> method method</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> args   </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Map&lt;String, Object&gt; <span class=\"title\">buildMethodArgNameMap</span><span class=\"params\">(Method method, Object[] args)</span> </span>&#123;</span><br><span class=\"line\">        Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;(<span class=\"number\">6</span>);</span><br><span class=\"line\">        <span class=\"comment\">// Integer id, args 6</span></span><br><span class=\"line\">        Parameter[] parameters = method.getParameters();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; parameters.length; i++) &#123;</span><br><span class=\"line\">            map.put(parameters[i].getName(), args[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Select(&quot;select * from User where id = #&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    List&lt;Test.User&gt; selectUesList(Integer id);</span><br><span class=\"line\">&#125;\t</span><br></pre></td></tr></table></figure>\n\n<p>mybatissql<img src=\"https://i.loli.net/2021/03/07/cPamMLRFU4xHXu8.jpg\" alt=\"mybatis_structure.jpg\"></p>\n<p>sqlsqlmybatisxml<code>#&#123;&#125;</code>mybatissqlsqlsql</p>"},{"title":"mybatis_preview","date":"2020-08-05T14:21:19.000Z","_content":"\nMybatisJDBC\n\n<!--more-->\n\n# \n\n```flow\nstart=>start: start\nconfig=>operation: mybatis-config.xml\nbuild=>operation: SqlSessionFactoryBuilder\nfactory=>operation: SqlSessionFactory\nsession=>parallel: SqlSession\nmapper=>operation: Sql Mapper\nend=>end: end\n\nstart->config->build->factory->session\nsession(path1,)->end\nsession(path2,right)->mapper->end\n```\n\n`SqlSessionFactoryBuilder``SqlSessionFactory`****`SqlSessionFactory`**`SqlSession` `SqlSession`session****session****`SqlSession`\n\n## \n\npojo`resultMap`****\n\n`resultType`HashMapkeymap`resultMap``resultType`\n\n## \n\nmybatissql\n\n```xml\n<settings>\n\t<setting name=\"logImpl\" value=\"log4j\"/>\n</settings>\n```\n\n## \n\nmybatis`limit``rowBounts`sql\n\n```sql\nselect * from USER limit #{index},#{size}\n```\n\n# \n\n\n\n## \n\nsession`close`\n\n## \n\n`namespace``Cache`\n","source":"_posts/mybatis_preview.md","raw":"---\ntitle: mybatis_preview\ndate: 2020-08-05 22:21:19\ncategories: framework\ntags: mybatis\n---\n\nMybatisJDBC\n\n<!--more-->\n\n# \n\n```flow\nstart=>start: start\nconfig=>operation: mybatis-config.xml\nbuild=>operation: SqlSessionFactoryBuilder\nfactory=>operation: SqlSessionFactory\nsession=>parallel: SqlSession\nmapper=>operation: Sql Mapper\nend=>end: end\n\nstart->config->build->factory->session\nsession(path1,)->end\nsession(path2,right)->mapper->end\n```\n\n`SqlSessionFactoryBuilder``SqlSessionFactory`****`SqlSessionFactory`**`SqlSession` `SqlSession`session****session****`SqlSession`\n\n## \n\npojo`resultMap`****\n\n`resultType`HashMapkeymap`resultMap``resultType`\n\n## \n\nmybatissql\n\n```xml\n<settings>\n\t<setting name=\"logImpl\" value=\"log4j\"/>\n</settings>\n```\n\n## \n\nmybatis`limit``rowBounts`sql\n\n```sql\nselect * from USER limit #{index},#{size}\n```\n\n# \n\n\n\n## \n\nsession`close`\n\n## \n\n`namespace``Cache`\n","slug":"mybatis_preview","published":1,"updated":"2021-03-07T11:04:27.952Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7v001pw5ihb0ns40jx","content":"<p>MybatisJDBC</p>\n<a id=\"more\"></a>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start&#x3D;&gt;start: start</span><br><span class=\"line\">config&#x3D;&gt;operation: mybatis-config.xml</span><br><span class=\"line\">build&#x3D;&gt;operation: SqlSessionFactoryBuilder</span><br><span class=\"line\">factory&#x3D;&gt;operation: SqlSessionFactory</span><br><span class=\"line\">session&#x3D;&gt;parallel: SqlSession</span><br><span class=\"line\">mapper&#x3D;&gt;operation: Sql Mapper</span><br><span class=\"line\">end&#x3D;&gt;end: end</span><br><span class=\"line\"></span><br><span class=\"line\">start-&gt;config-&gt;build-&gt;factory-&gt;session</span><br><span class=\"line\">session(path1,)-&gt;end</span><br><span class=\"line\">session(path2,right)-&gt;mapper-&gt;end</span><br></pre></td></tr></table></figure>\n\n<p><code>SqlSessionFactoryBuilder</code><code>SqlSessionFactory</code><strong></strong><code>SqlSessionFactory</code><em></em><code>SqlSession</code> <code>SqlSession</code>session<strong></strong>session<strong></strong><code>SqlSession</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>pojo<code>resultMap</code><strong></strong></p>\n<p><code>resultType</code>HashMapkeymap<code>resultMap</code><code>resultType</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>mybatissql</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">settings</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;logImpl&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;log4j&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>mybatis<code>limit</code><code>rowBounts</code>sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> <span class=\"keyword\">USER</span> <span class=\"keyword\">limit</span> <span class=\"comment\">#&#123;index&#125;,#&#123;size&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>session<code>close</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>namespace</code><code>Cache</code></p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>MybatisJDBC</p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start&#x3D;&gt;start: start</span><br><span class=\"line\">config&#x3D;&gt;operation: mybatis-config.xml</span><br><span class=\"line\">build&#x3D;&gt;operation: SqlSessionFactoryBuilder</span><br><span class=\"line\">factory&#x3D;&gt;operation: SqlSessionFactory</span><br><span class=\"line\">session&#x3D;&gt;parallel: SqlSession</span><br><span class=\"line\">mapper&#x3D;&gt;operation: Sql Mapper</span><br><span class=\"line\">end&#x3D;&gt;end: end</span><br><span class=\"line\"></span><br><span class=\"line\">start-&gt;config-&gt;build-&gt;factory-&gt;session</span><br><span class=\"line\">session(path1,)-&gt;end</span><br><span class=\"line\">session(path2,right)-&gt;mapper-&gt;end</span><br></pre></td></tr></table></figure>\n\n<p><code>SqlSessionFactoryBuilder</code><code>SqlSessionFactory</code><strong></strong><code>SqlSessionFactory</code><em></em><code>SqlSession</code> <code>SqlSession</code>session<strong></strong>session<strong></strong><code>SqlSession</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>pojo<code>resultMap</code><strong></strong></p>\n<p><code>resultType</code>HashMapkeymap<code>resultMap</code><code>resultType</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>mybatissql</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">settings</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;logImpl&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;log4j&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>mybatis<code>limit</code><code>rowBounts</code>sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> <span class=\"keyword\">USER</span> <span class=\"keyword\">limit</span> <span class=\"comment\">#&#123;index&#125;,#&#123;size&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>session<code>close</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>namespace</code><code>Cache</code></p>"},{"title":"nginx","date":"2019-11-02T14:53:32.000Z","_content":"# NIGNX\n\n*Nginx* (engine x) HTTP****webIMAP/POP3/SMTPNginxRambler.ru0.1.02004104\n\nWebIMAP/POP3BSD-like nginx\n\n\n\n- \n- \n- \n- \n\n\n\n## \n\nIP\n\n## \n\nInternetInternetnginx\n\n\n\n\n\n## \n\n\n\n\n\n## \n\n\n\nhtml, css, js\n\njsp, servlet\n\n## \n\n### \n\nnginx\n\n/usr/localnginx/sbin\n\n- nginx\n- \n- \n- nginx\n\n[referenct](https://mp.weixin.qq.com/s/PeNWaCDf_6gp2fCQa0Gvng)\n\n# \n\n1. EPEL\n\n   ```bash\n   sudo yum install -y epel-release\n   sudo yum -y update\n   ```\n\n2. nginx\n\n   ```bash\n   sudo yum instll -y nginx\n   ```\n\n   \n\n   ``_/usr/share/nginx/html_\n\n   ``_/etc/nginx/nginx.conf_\n\n   ``_/etc/nginx/conf.d/_\n\n3. 80443\n\n   \n\n   ```bash\n   sudo firewall-cmd --permanent --zone=public --add-service=http\n   sudo firewall-cmd --permanent --zone=public --add-service=https\n   sudo firewall-cmd --reload\n   ```\n\n4. \n\n   - \n\n     ```bash\n     systemctl start nginx\n     ```\n\n   - \n\n     ```bash\n     systemctl stop nginx\n     ```\n\n   - \n\n     ```bash\n     systemctl restart nginx\n     ```\n\n   - \n\n     ```bash\n     systemctl status nginx\n     ```\n\n   - \n\n     ```bash\n     systemctl enable nginx\n     ```\n\n     `nginx`\n\n     ```bash\n     nginx -t\n     ```\n\n     ```bash\n     nginx -s reload\n     ```\n\n     \n\n   - \n\n     ```bash\n     systemctl disbale nginx\n     ```\n\n5. https\n\n   1. https\n\n   3. nginx\n   \n      domain\n   \n      ```bash\n   mkdir -p /etc/nginx/ssl\n      \n   acme.sh --install-cert -d domain \\\n      --key-file       /etc/nginx/ssl/domain.key  \\\n      --fullchain-file /etc/nginx/ssl/domain.cer \\\n      --reloadcmd     \"service nginx force-reload\"\n      ```\n   \n6. nginx\n\n   **/etc/nginx/nginx.conf**server\n\n   ```markdown\n   server{\n   ...\n   }\n   ```\n\n   **/etc/nginx/conf.d****default.conf**\n\n   ```properties\n   server {\n       listen 80;\n       listen 443 ssl;\n       server_name  domain www.domain;\n       location / {\n            root /usr/share/nginx/html;\n            index  index.html index.htm;\n        }\n   \n       ssl_certificate /etc/nginx/ssl/domain.crt;\n       ssl_certificate_key /etc/nginx/ssl/domain.key;\n       ssl_session_timeout  5m;\n       ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n       ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE;\n       ssl_prefer_server_ciphers  on;\n   \n       error_page 497  https://$host$uri?$args;\n   }\n   ```\n   \n\n   \n\n   \n","source":"_posts/nginx.md","raw":"---\ntitle: nginx\ndate: 2019-11-02 22:53:32\ncategories: Network\ntags: network\n---\n# NIGNX\n\n*Nginx* (engine x) HTTP****webIMAP/POP3/SMTPNginxRambler.ru0.1.02004104\n\nWebIMAP/POP3BSD-like nginx\n\n\n\n- \n- \n- \n- \n\n\n\n## \n\nIP\n\n## \n\nInternetInternetnginx\n\n\n\n\n\n## \n\n\n\n\n\n## \n\n\n\nhtml, css, js\n\njsp, servlet\n\n## \n\n### \n\nnginx\n\n/usr/localnginx/sbin\n\n- nginx\n- \n- \n- nginx\n\n[referenct](https://mp.weixin.qq.com/s/PeNWaCDf_6gp2fCQa0Gvng)\n\n# \n\n1. EPEL\n\n   ```bash\n   sudo yum install -y epel-release\n   sudo yum -y update\n   ```\n\n2. nginx\n\n   ```bash\n   sudo yum instll -y nginx\n   ```\n\n   \n\n   ``_/usr/share/nginx/html_\n\n   ``_/etc/nginx/nginx.conf_\n\n   ``_/etc/nginx/conf.d/_\n\n3. 80443\n\n   \n\n   ```bash\n   sudo firewall-cmd --permanent --zone=public --add-service=http\n   sudo firewall-cmd --permanent --zone=public --add-service=https\n   sudo firewall-cmd --reload\n   ```\n\n4. \n\n   - \n\n     ```bash\n     systemctl start nginx\n     ```\n\n   - \n\n     ```bash\n     systemctl stop nginx\n     ```\n\n   - \n\n     ```bash\n     systemctl restart nginx\n     ```\n\n   - \n\n     ```bash\n     systemctl status nginx\n     ```\n\n   - \n\n     ```bash\n     systemctl enable nginx\n     ```\n\n     `nginx`\n\n     ```bash\n     nginx -t\n     ```\n\n     ```bash\n     nginx -s reload\n     ```\n\n     \n\n   - \n\n     ```bash\n     systemctl disbale nginx\n     ```\n\n5. https\n\n   1. https\n\n   3. nginx\n   \n      domain\n   \n      ```bash\n   mkdir -p /etc/nginx/ssl\n      \n   acme.sh --install-cert -d domain \\\n      --key-file       /etc/nginx/ssl/domain.key  \\\n      --fullchain-file /etc/nginx/ssl/domain.cer \\\n      --reloadcmd     \"service nginx force-reload\"\n      ```\n   \n6. nginx\n\n   **/etc/nginx/nginx.conf**server\n\n   ```markdown\n   server{\n   ...\n   }\n   ```\n\n   **/etc/nginx/conf.d****default.conf**\n\n   ```properties\n   server {\n       listen 80;\n       listen 443 ssl;\n       server_name  domain www.domain;\n       location / {\n            root /usr/share/nginx/html;\n            index  index.html index.htm;\n        }\n   \n       ssl_certificate /etc/nginx/ssl/domain.crt;\n       ssl_certificate_key /etc/nginx/ssl/domain.key;\n       ssl_session_timeout  5m;\n       ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n       ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE;\n       ssl_prefer_server_ciphers  on;\n   \n       error_page 497  https://$host$uri?$args;\n   }\n   ```\n   \n\n   \n\n   \n","slug":"nginx","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q7z001tw5ih51vqajrg","content":"<h1 id=\"NIGNX\"><a href=\"#NIGNX\" class=\"headerlink\" title=\"NIGNX\"></a>NIGNX</h1><p><em>Nginx</em> (engine x) HTTP<strong></strong>webIMAP/POP3/SMTPNginxRambler.ru0.1.02004104</p>\n<p>WebIMAP/POP3BSD-like nginx</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>IP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>InternetInternetnginx</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>html, css, js</p>\n<p>jsp, servlet</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nginx</p>\n<p>/usr/localnginx/sbin</p>\n<ul>\n<li>nginx</li>\n<li></li>\n<li></li>\n<li>nginx</li>\n</ul>\n<p><a href=\"https://mp.weixin.qq.com/s/PeNWaCDf_6gp2fCQa0Gvng\">referenct</a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li><p>EPEL</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y epel-release</span><br><span class=\"line\">sudo yum -y update</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum instll -y nginx</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code></code><em>/usr/share/nginx/html</em></p>\n<p><code></code><em>/etc/nginx/nginx.conf</em></p>\n<p><code></code><em>/etc/nginx/conf.d/</em></p>\n</li>\n<li><p>80443</p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo firewall-cmd --permanent --zone=public --add-service=http</span><br><span class=\"line\">sudo firewall-cmd --permanent --zone=public --add-service=https</span><br><span class=\"line\">sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl <span class=\"built_in\">enable</span> nginx</span><br></pre></td></tr></table></figure>\n\n<p><code>nginx</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -t</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -s reload</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl disbale nginx</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<ol start=\"5\">\n<li><p>https</p>\n<ol>\n<li><p>https</p>\n</li>\n<li><p>nginx</p>\n<p>domain</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/nginx/ssl</span><br><span class=\"line\">   </span><br><span class=\"line\">acme.sh --install-cert -d domain \\</span><br><span class=\"line\">   --key-file       /etc/nginx/ssl/domain.key  \\</span><br><span class=\"line\">   --fullchain-file /etc/nginx/ssl/domain.cer \\</span><br><span class=\"line\">   --reloadcmd     <span class=\"string\">&quot;service nginx force-reload&quot;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n<li><p>nginx</p>\n<p>**/etc/nginx/nginx.conf**server</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server&#123;</span><br><span class=\"line\">...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>**/etc/nginx/conf.d<strong></strong>default.conf**</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server</span> <span class=\"string\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">listen</span> <span class=\"string\">80;</span></span><br><span class=\"line\">    <span class=\"attr\">listen</span> <span class=\"string\">443 ssl;</span></span><br><span class=\"line\">    <span class=\"attr\">server_name</span>  <span class=\"string\">domain www.domain;</span></span><br><span class=\"line\">    <span class=\"attr\">location</span> <span class=\"string\">/ &#123;</span></span><br><span class=\"line\">         <span class=\"attr\">root</span> <span class=\"string\">/usr/share/nginx/html;</span></span><br><span class=\"line\">         <span class=\"attr\">index</span>  <span class=\"string\">index.html index.htm;</span></span><br><span class=\"line\">     <span class=\"attr\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">ssl_certificate</span> <span class=\"string\">/etc/nginx/ssl/domain.crt;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_certificate_key</span> <span class=\"string\">/etc/nginx/ssl/domain.key;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_session_timeout</span>  <span class=\"string\">5m;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_protocols</span> <span class=\"string\">TLSv1 TLSv1.1 TLSv1.2;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_ciphers</span> <span class=\"string\">ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_prefer_server_ciphers</span>  <span class=\"string\">on;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">error_page</span> <span class=\"string\">497  https://$host$uri?$args;</span></span><br><span class=\"line\"><span class=\"attr\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n</li>\n</ol>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":"<h1 id=\"NIGNX\"><a href=\"#NIGNX\" class=\"headerlink\" title=\"NIGNX\"></a>NIGNX</h1><p><em>Nginx</em> (engine x) HTTP<strong></strong>webIMAP/POP3/SMTPNginxRambler.ru0.1.02004104</p>\n<p>WebIMAP/POP3BSD-like nginx</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>IP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>InternetInternetnginx</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>html, css, js</p>\n<p>jsp, servlet</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nginx</p>\n<p>/usr/localnginx/sbin</p>\n<ul>\n<li>nginx</li>\n<li></li>\n<li></li>\n<li>nginx</li>\n</ul>\n<p><a href=\"https://mp.weixin.qq.com/s/PeNWaCDf_6gp2fCQa0Gvng\">referenct</a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li><p>EPEL</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y epel-release</span><br><span class=\"line\">sudo yum -y update</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum instll -y nginx</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code></code><em>/usr/share/nginx/html</em></p>\n<p><code></code><em>/etc/nginx/nginx.conf</em></p>\n<p><code></code><em>/etc/nginx/conf.d/</em></p>\n</li>\n<li><p>80443</p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo firewall-cmd --permanent --zone=public --add-service=http</span><br><span class=\"line\">sudo firewall-cmd --permanent --zone=public --add-service=https</span><br><span class=\"line\">sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl <span class=\"built_in\">enable</span> nginx</span><br></pre></td></tr></table></figure>\n\n<p><code>nginx</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -t</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -s reload</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl disbale nginx</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<ol start=\"5\">\n<li><p>https</p>\n<ol>\n<li><p>https</p>\n</li>\n<li><p>nginx</p>\n<p>domain</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/nginx/ssl</span><br><span class=\"line\">   </span><br><span class=\"line\">acme.sh --install-cert -d domain \\</span><br><span class=\"line\">   --key-file       /etc/nginx/ssl/domain.key  \\</span><br><span class=\"line\">   --fullchain-file /etc/nginx/ssl/domain.cer \\</span><br><span class=\"line\">   --reloadcmd     <span class=\"string\">&quot;service nginx force-reload&quot;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n<li><p>nginx</p>\n<p>**/etc/nginx/nginx.conf**server</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server&#123;</span><br><span class=\"line\">...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>**/etc/nginx/conf.d<strong></strong>default.conf**</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server</span> <span class=\"string\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">listen</span> <span class=\"string\">80;</span></span><br><span class=\"line\">    <span class=\"attr\">listen</span> <span class=\"string\">443 ssl;</span></span><br><span class=\"line\">    <span class=\"attr\">server_name</span>  <span class=\"string\">domain www.domain;</span></span><br><span class=\"line\">    <span class=\"attr\">location</span> <span class=\"string\">/ &#123;</span></span><br><span class=\"line\">         <span class=\"attr\">root</span> <span class=\"string\">/usr/share/nginx/html;</span></span><br><span class=\"line\">         <span class=\"attr\">index</span>  <span class=\"string\">index.html index.htm;</span></span><br><span class=\"line\">     <span class=\"attr\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">ssl_certificate</span> <span class=\"string\">/etc/nginx/ssl/domain.crt;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_certificate_key</span> <span class=\"string\">/etc/nginx/ssl/domain.key;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_session_timeout</span>  <span class=\"string\">5m;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_protocols</span> <span class=\"string\">TLSv1 TLSv1.1 TLSv1.2;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_ciphers</span> <span class=\"string\">ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE;</span></span><br><span class=\"line\">    <span class=\"attr\">ssl_prefer_server_ciphers</span>  <span class=\"string\">on;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">error_page</span> <span class=\"string\">497  https://$host$uri?$args;</span></span><br><span class=\"line\"><span class=\"attr\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n</li>\n</ol>\n"},{"title":"observer","date":"2020-06-12T09:12:38.000Z","_content":"\nMQ\n\n<!--more-->\n\n\n\n# \n\nAPI\n\n```java\npublic class WeatherData(){\n    getTemperature(){};\n    getHumidity(){};\n    \n    /**\n    * \n    */\n    measuremetnsChanged(){\n        // our codes go here\n    };\n}\n```\n\n`measuremetnsChanged`\n\n```java\npublic void measuremetnsChanged(){\n    currentConditionsDisplay.update(getTemperature(), getHumiditiy(), getPressure());\n    forecastDisplay.update(getTemperature(), getHumiditiy(), getPressure());\n    ......\n}\n```\n\n# \n\n\n\n\n\n- \n- \n\n\n\n\n\n> +=\n\nsubject\"observer\"\n\n********.\n\nobserver/observer\n\n## \n\n![Screenshot from 2020-06-12 18-03-04.png](https://i.loli.net/2020/06/12/cwTWVXNpIQ5ebGo.png)\n\nsubjectsubjectObserver\n\n```java\npublic CurrentConditionsDisplay(Subject weatherData) {\n    this.weatherData = weatherData;\n    weatherData.registerObserver(this);\n}\n```\n\napijavautil\n\n[](https://github.com/Sebastian-Getts/designPatternsPractice)\n\n## \n\n\n\n# \n\nJavaBeansSwingRMI","source":"_posts/observer.md","raw":"---\ntitle: observer\ndate: 2020-06-12 17:12:38\ncategories: DesignPatterns\ntags: design_patterns\n---\n\nMQ\n\n<!--more-->\n\n\n\n# \n\nAPI\n\n```java\npublic class WeatherData(){\n    getTemperature(){};\n    getHumidity(){};\n    \n    /**\n    * \n    */\n    measuremetnsChanged(){\n        // our codes go here\n    };\n}\n```\n\n`measuremetnsChanged`\n\n```java\npublic void measuremetnsChanged(){\n    currentConditionsDisplay.update(getTemperature(), getHumiditiy(), getPressure());\n    forecastDisplay.update(getTemperature(), getHumiditiy(), getPressure());\n    ......\n}\n```\n\n# \n\n\n\n\n\n- \n- \n\n\n\n\n\n> +=\n\nsubject\"observer\"\n\n********.\n\nobserver/observer\n\n## \n\n![Screenshot from 2020-06-12 18-03-04.png](https://i.loli.net/2020/06/12/cwTWVXNpIQ5ebGo.png)\n\nsubjectsubjectObserver\n\n```java\npublic CurrentConditionsDisplay(Subject weatherData) {\n    this.weatherData = weatherData;\n    weatherData.registerObserver(this);\n}\n```\n\napijavautil\n\n[](https://github.com/Sebastian-Getts/designPatternsPractice)\n\n## \n\n\n\n# \n\nJavaBeansSwingRMI","slug":"observer","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q82001ww5ih4e46g5xd","content":"<p>MQ</p>\n<a id=\"more\"></a>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> class <span class=\"title\">WeatherData</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    getTemperature()&#123;&#125;;</span><br><span class=\"line\">    getHumidity()&#123;&#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    measuremetnsChanged()&#123;</span><br><span class=\"line\">        <span class=\"comment\">// our codes go here</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>measuremetnsChanged</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">measuremetnsChanged</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    currentConditionsDisplay.update(getTemperature(), getHumiditiy(), getPressure());</span><br><span class=\"line\">    forecastDisplay.update(getTemperature(), getHumiditiy(), getPressure());</span><br><span class=\"line\">    ......</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<p></p>\n<blockquote>\n<p>+=</p>\n</blockquote>\n<p>subjectobserver</p>\n<p><strong></strong><strong></strong>.</p>\n<p>observer/observer</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"https://i.loli.net/2020/06/12/cwTWVXNpIQ5ebGo.png\" alt=\"Screenshot from 2020-06-12 18-03-04.png\"></p>\n<p>subjectsubjectObserver</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CurrentConditionsDisplay</span><span class=\"params\">(Subject weatherData)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.weatherData = weatherData;</span><br><span class=\"line\">    weatherData.registerObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>apijavautil</p>\n<p><a href=\"https://github.com/Sebastian-Getts/designPatternsPractice\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>JavaBeansSwingRMI</p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>MQ</p>","more":"<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> class <span class=\"title\">WeatherData</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    getTemperature()&#123;&#125;;</span><br><span class=\"line\">    getHumidity()&#123;&#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    measuremetnsChanged()&#123;</span><br><span class=\"line\">        <span class=\"comment\">// our codes go here</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>measuremetnsChanged</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">measuremetnsChanged</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    currentConditionsDisplay.update(getTemperature(), getHumiditiy(), getPressure());</span><br><span class=\"line\">    forecastDisplay.update(getTemperature(), getHumiditiy(), getPressure());</span><br><span class=\"line\">    ......</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<p></p>\n<blockquote>\n<p>+=</p>\n</blockquote>\n<p>subjectobserver</p>\n<p><strong></strong><strong></strong>.</p>\n<p>observer/observer</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"https://i.loli.net/2020/06/12/cwTWVXNpIQ5ebGo.png\" alt=\"Screenshot from 2020-06-12 18-03-04.png\"></p>\n<p>subjectsubjectObserver</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CurrentConditionsDisplay</span><span class=\"params\">(Subject weatherData)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.weatherData = weatherData;</span><br><span class=\"line\">    weatherData.registerObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>apijavautil</p>\n<p><a href=\"https://github.com/Sebastian-Getts/designPatternsPractice\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>JavaBeansSwingRMI</p>"},{"title":"redis","date":"2020-06-09T13:54:01.000Z","_content":"\nredisredis[reference](https://github.com/antirez/redis)\n\n<!--more-->\n\n# \n\nredis: ****************nosql\n\n## nosql\n\nnosql\n\n1. \n   - \n   - \n   - \n2.  **memcache**\n3. copy\n\nmysqlMyISAM****Innodb****\n\nmysql10+\n\n### \n\n1. key valuejava\n2. 8/11/\n3. \n4. \n5. \n6. \n7. CAPBASE\n8. Volume, Variety, Veiocity\n\n\n\nMongoDB\n\nMySQL\n\nFastDFS, GFS, HDFS, OSS...\n\nRedisTairMemcache\n\n==== \n\n### \n\nMongoDB\n\n### KV\n\nRedisTair\n\n### \n\nHBase\n\n\n\n### \n\n\n\nNeo4jInfoGrid\n\n# Redis\n\nRemote Dictionary Server. Capi\n\n- rdbaof\n- \n\n## \n\n\n\n```bash\nredis-benchmark -h localhost -p 6379 -100 -n 100000\n```\n\n## \n\n160 \n\n### GEOSPATIAL\n\nGETSET\n\n## springboot\n\n<2.0 jedisBIOjedis pool\n\n>2.0 lettuceNIOnetty\n\n## rdb\n\nrdb\n\nredisrdbrdbredis databse/\n\n```flow\nstart=>start: start\nend=>end: end\ncondition=>condition: rdb\nrdbfile=>inputoutput: dump.rdb\noperation=>operation: go on dealing with\n\nstart->condition\ncondition(yes)->rdbfile->end\ncondition(no)->operation->end\n```\n\n#### \n\n1. save\n2. flushall\n3. redis\n\ndump.rdb\n\n#### rdb\n\n```bash\nconfig get dir\n```\n\n#### \n\n1. \n2. 90srdb60s\n\n#### \n\n1. \n2. fork\n\n## AOF\n\nAppend Only File history\n\n- \n- \n\nredisaofredis\n\naof `redis-check-aof --fix`\n\n### \n\n1. \n2. \n\n### \n\n1. aofrdbrdb\n2. rdbaof\n\n**rdb**\n\n## \n\nredisredis\n\n\n\nreidsredis20G\n\nredis\n\n### \n\n```shell\ninfo replication # \n```\n\n\n\n```shell\nSLAVEOF ip:port # ip:port\n```\n\n****\n\n#### \n\n`info replication`\n\n\n\n-  masterslaver\n- \n\nmaster\n\n### \n\nSentinelRedis2.8\n\nRedisredis\n\n#### \n\n1. \n2. \n\n#### \n\n1. \n2. \n\n## redis\n\n### \n\n```flow\nstart=>start: request\nend=>end: response\ncondition=>condition: redis\nop1=>operation: select in mysql\nstart->condition\ncondition(yes)->end\ncondition(no)->op1->end\n```\n\nredisdaoredis\n\n#### \n\nhash\n\n#### \n\n### \n\n\n\n#### \n\n#### \n\n### \n\n\n\n#### redis\n\n#### \n\n#### \n\n\n\n","source":"_posts/redis.md","raw":"---\ntitle: redis\ndate: 2020-06-09 21:54:01\ncategories: DB\ntags: \n- redis\n- nosql\n---\n\nredisredis[reference](https://github.com/antirez/redis)\n\n<!--more-->\n\n# \n\nredis: ****************nosql\n\n## nosql\n\nnosql\n\n1. \n   - \n   - \n   - \n2.  **memcache**\n3. copy\n\nmysqlMyISAM****Innodb****\n\nmysql10+\n\n### \n\n1. key valuejava\n2. 8/11/\n3. \n4. \n5. \n6. \n7. CAPBASE\n8. Volume, Variety, Veiocity\n\n\n\nMongoDB\n\nMySQL\n\nFastDFS, GFS, HDFS, OSS...\n\nRedisTairMemcache\n\n==== \n\n### \n\nMongoDB\n\n### KV\n\nRedisTair\n\n### \n\nHBase\n\n\n\n### \n\n\n\nNeo4jInfoGrid\n\n# Redis\n\nRemote Dictionary Server. Capi\n\n- rdbaof\n- \n\n## \n\n\n\n```bash\nredis-benchmark -h localhost -p 6379 -100 -n 100000\n```\n\n## \n\n160 \n\n### GEOSPATIAL\n\nGETSET\n\n## springboot\n\n<2.0 jedisBIOjedis pool\n\n>2.0 lettuceNIOnetty\n\n## rdb\n\nrdb\n\nredisrdbrdbredis databse/\n\n```flow\nstart=>start: start\nend=>end: end\ncondition=>condition: rdb\nrdbfile=>inputoutput: dump.rdb\noperation=>operation: go on dealing with\n\nstart->condition\ncondition(yes)->rdbfile->end\ncondition(no)->operation->end\n```\n\n#### \n\n1. save\n2. flushall\n3. redis\n\ndump.rdb\n\n#### rdb\n\n```bash\nconfig get dir\n```\n\n#### \n\n1. \n2. 90srdb60s\n\n#### \n\n1. \n2. fork\n\n## AOF\n\nAppend Only File history\n\n- \n- \n\nredisaofredis\n\naof `redis-check-aof --fix`\n\n### \n\n1. \n2. \n\n### \n\n1. aofrdbrdb\n2. rdbaof\n\n**rdb**\n\n## \n\nredisredis\n\n\n\nreidsredis20G\n\nredis\n\n### \n\n```shell\ninfo replication # \n```\n\n\n\n```shell\nSLAVEOF ip:port # ip:port\n```\n\n****\n\n#### \n\n`info replication`\n\n\n\n-  masterslaver\n- \n\nmaster\n\n### \n\nSentinelRedis2.8\n\nRedisredis\n\n#### \n\n1. \n2. \n\n#### \n\n1. \n2. \n\n## redis\n\n### \n\n```flow\nstart=>start: request\nend=>end: response\ncondition=>condition: redis\nop1=>operation: select in mysql\nstart->condition\ncondition(yes)->end\ncondition(no)->op1->end\n```\n\nredisdaoredis\n\n#### \n\nhash\n\n#### \n\n### \n\n\n\n#### \n\n#### \n\n### \n\n\n\n#### redis\n\n#### \n\n#### \n\n\n\n","slug":"redis","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q840020w5ihbhmmer5d","content":"<p>redisredis<a href=\"https://github.com/antirez/redis\">reference</a></p>\n<a id=\"more\"></a>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>redis: <strong></strong><strong></strong><strong></strong><strong></strong>nosql</p>\n<h2 id=\"nosql\"><a href=\"#nosql\" class=\"headerlink\" title=\"nosql\"></a>nosql</h2><p>nosql</p>\n<ol>\n<li><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li> <strong>memcache</strong></li>\n<li>copy</li>\n</ol>\n<p>mysqlMyISAM<strong></strong>Innodb<strong></strong></p>\n<p>mysql10+</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>key valuejava</li>\n<li>8/11/</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>CAPBASE</li>\n<li>Volume, Variety, Veiocity</li>\n</ol>\n<p></p>\n<p>MongoDB</p>\n<p>MySQL</p>\n<p>FastDFS, GFS, HDFS, OSS</p>\n<p>RedisTairMemcache</p>\n<p>==== </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MongoDB</p>\n<h3 id=\"KV\"><a href=\"#KV\" class=\"headerlink\" title=\"KV\"></a>KV</h3><p>RedisTair</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>HBase</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>Neo4jInfoGrid</p>\n<h1 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h1><p>Remote Dictionary Server. Capi</p>\n<ul>\n<li>rdbaof</li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-benchmark -h localhost -p 6379 -100 -n 100000</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>160 </p>\n<h3 id=\"GEOSPATIAL\"><a href=\"#GEOSPATIAL\" class=\"headerlink\" title=\"GEOSPATIAL\"></a>GEOSPATIAL</h3><p>GETSET</p>\n<h2 id=\"springboot\"><a href=\"#springboot\" class=\"headerlink\" title=\"springboot\"></a>springboot</h2><p>&lt;2.0 jedisBIOjedis pool</p>\n<p>&gt;2.0 lettuceNIOnetty</p>\n<h2 id=\"rdb\"><a href=\"#rdb\" class=\"headerlink\" title=\"rdb\"></a>rdb</h2><p>rdb</p>\n<p>redisrdbrdbredis databse/</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start&#x3D;&gt;start: start</span><br><span class=\"line\">end&#x3D;&gt;end: end</span><br><span class=\"line\">condition&#x3D;&gt;condition: rdb</span><br><span class=\"line\">rdbfile&#x3D;&gt;inputoutput: dump.rdb</span><br><span class=\"line\">operation&#x3D;&gt;operation: go on dealing with</span><br><span class=\"line\"></span><br><span class=\"line\">start-&gt;condition</span><br><span class=\"line\">condition(yes)-&gt;rdbfile-&gt;end</span><br><span class=\"line\">condition(no)-&gt;operation-&gt;end</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>save</li>\n<li>flushall</li>\n<li>redis</li>\n</ol>\n<p>dump.rdb</p>\n<h4 id=\"rdb\"><a href=\"#rdb\" class=\"headerlink\" title=\"rdb\"></a>rdb</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">config get dir</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>90srdb60s</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>fork</li>\n</ol>\n<h2 id=\"AOF\"><a href=\"#AOF\" class=\"headerlink\" title=\"AOF\"></a>AOF</h2><p>Append Only File history</p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>redisaofredis</p>\n<p>aof <code>redis-check-aof --fix</code></p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>aofrdbrdb</li>\n<li>rdbaof</li>\n</ol>\n<p><strong>rdb</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>redisredis</p>\n<p></p>\n<p>reidsredis20G</p>\n<p>redis</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">info replication # </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SLAVEOF ip:port # ip:port</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code>info replication</code></p>\n<p></p>\n<ul>\n<li> masterslaver</li>\n<li></li>\n</ul>\n<p>master</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SentinelRedis2.8</p>\n<p>Redisredis</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start&#x3D;&gt;start: request</span><br><span class=\"line\">end&#x3D;&gt;end: response</span><br><span class=\"line\">condition&#x3D;&gt;condition: redis</span><br><span class=\"line\">op1&#x3D;&gt;operation: select in mysql</span><br><span class=\"line\">start-&gt;condition</span><br><span class=\"line\">condition(yes)-&gt;end</span><br><span class=\"line\">condition(no)-&gt;op1-&gt;end</span><br></pre></td></tr></table></figure>\n\n<p>redisdaoredis</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>hash</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h4 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>redisredis<a href=\"https://github.com/antirez/redis\">reference</a></p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>redis: <strong></strong><strong></strong><strong></strong><strong></strong>nosql</p>\n<h2 id=\"nosql\"><a href=\"#nosql\" class=\"headerlink\" title=\"nosql\"></a>nosql</h2><p>nosql</p>\n<ol>\n<li><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li> <strong>memcache</strong></li>\n<li>copy</li>\n</ol>\n<p>mysqlMyISAM<strong></strong>Innodb<strong></strong></p>\n<p>mysql10+</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>key valuejava</li>\n<li>8/11/</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>CAPBASE</li>\n<li>Volume, Variety, Veiocity</li>\n</ol>\n<p></p>\n<p>MongoDB</p>\n<p>MySQL</p>\n<p>FastDFS, GFS, HDFS, OSS</p>\n<p>RedisTairMemcache</p>\n<p>==== </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MongoDB</p>\n<h3 id=\"KV\"><a href=\"#KV\" class=\"headerlink\" title=\"KV\"></a>KV</h3><p>RedisTair</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>HBase</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>Neo4jInfoGrid</p>\n<h1 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h1><p>Remote Dictionary Server. Capi</p>\n<ul>\n<li>rdbaof</li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-benchmark -h localhost -p 6379 -100 -n 100000</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>160 </p>\n<h3 id=\"GEOSPATIAL\"><a href=\"#GEOSPATIAL\" class=\"headerlink\" title=\"GEOSPATIAL\"></a>GEOSPATIAL</h3><p>GETSET</p>\n<h2 id=\"springboot\"><a href=\"#springboot\" class=\"headerlink\" title=\"springboot\"></a>springboot</h2><p>&lt;2.0 jedisBIOjedis pool</p>\n<p>&gt;2.0 lettuceNIOnetty</p>\n<h2 id=\"rdb\"><a href=\"#rdb\" class=\"headerlink\" title=\"rdb\"></a>rdb</h2><p>rdb</p>\n<p>redisrdbrdbredis databse/</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start&#x3D;&gt;start: start</span><br><span class=\"line\">end&#x3D;&gt;end: end</span><br><span class=\"line\">condition&#x3D;&gt;condition: rdb</span><br><span class=\"line\">rdbfile&#x3D;&gt;inputoutput: dump.rdb</span><br><span class=\"line\">operation&#x3D;&gt;operation: go on dealing with</span><br><span class=\"line\"></span><br><span class=\"line\">start-&gt;condition</span><br><span class=\"line\">condition(yes)-&gt;rdbfile-&gt;end</span><br><span class=\"line\">condition(no)-&gt;operation-&gt;end</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>save</li>\n<li>flushall</li>\n<li>redis</li>\n</ol>\n<p>dump.rdb</p>\n<h4 id=\"rdb\"><a href=\"#rdb\" class=\"headerlink\" title=\"rdb\"></a>rdb</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">config get dir</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>90srdb60s</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li>fork</li>\n</ol>\n<h2 id=\"AOF\"><a href=\"#AOF\" class=\"headerlink\" title=\"AOF\"></a>AOF</h2><p>Append Only File history</p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>redisaofredis</p>\n<p>aof <code>redis-check-aof --fix</code></p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>aofrdbrdb</li>\n<li>rdbaof</li>\n</ol>\n<p><strong>rdb</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>redisredis</p>\n<p></p>\n<p>reidsredis20G</p>\n<p>redis</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">info replication # </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SLAVEOF ip:port # ip:port</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code>info replication</code></p>\n<p></p>\n<ul>\n<li> masterslaver</li>\n<li></li>\n</ul>\n<p>master</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SentinelRedis2.8</p>\n<p>Redisredis</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start&#x3D;&gt;start: request</span><br><span class=\"line\">end&#x3D;&gt;end: response</span><br><span class=\"line\">condition&#x3D;&gt;condition: redis</span><br><span class=\"line\">op1&#x3D;&gt;operation: select in mysql</span><br><span class=\"line\">start-&gt;condition</span><br><span class=\"line\">condition(yes)-&gt;end</span><br><span class=\"line\">condition(no)-&gt;op1-&gt;end</span><br></pre></td></tr></table></figure>\n\n<p>redisdaoredis</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>hash</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h4 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>"},{"title":"Springboot-servlet","date":"2021-02-28T14:01:17.000Z","_content":"\nSpringBootservlet\n\n<!-- more -->\n\n<!-- toc -->\n\njava webtomcattomcatspringboot\n\n# \n\nspringBootrefresh`onRefresh()`****`SpringApplication`classweb`ServletWebServerApplicationContext`\n\n```java\n@Override\nprotected void onRefresh() {\n    super.onRefresh();\n    try {\n        // web\n        createWebServer();\n    }\n    catch (Throwable ex) {\n        throw new ApplicationContextException(\"Unable to start web server\", ex);\n    }\n}\n```\n\n\n\n# \n\n\n\n```java\nprivate void createWebServer() {\n    // volatile\n    WebServer webServer = this.webServer;\n    // servlet\n    ServletContext servletContext = getServletContext();\n    // null\n    if (webServer == null && servletContext == null) {\n        // nullweb\n        ServletWebServerFactory factory = getWebServerFactory();\n        // web\n        this.webServer = factory.getWebServer(getSelfInitializer());\n        getBeanFactory().registerSingleton(\"webServerGracefulShutdown\",\n                                           new WebServerGracefulShutdownLifecycle(this.webServer));\n        getBeanFactory().registerSingleton(\"webServerStartStop\",\n                                           new WebServerStartStopLifecycle(this, this.webServer));\n    }\n    // null\n    else if (servletContext != null) {\n        try {\n            getSelfInitializer().onStartup(servletContext);\n        }\n        catch (ServletException ex) {\n            throw new ApplicationContextException(\"Cannot initialize servlet context\", ex);\n        }\n    }\n    initPropertySources();\n}\n```\n\n## getWebServerFactory\n\nSPI\n\n```java\nprotected ServletWebServerFactory getWebServerFactory() {\n    // Use bean names so that we don't consider the hierarchy\n    String[] beanNames = getBeanFactory().getBeanNamesForType(ServletWebServerFactory.class);\n    if (beanNames.length == 0) {\n        throw new ApplicationContextException(\"Unable to start ServletWebServerApplicationContext due to missing \"\n                                              + \"ServletWebServerFactory bean.\");\n    }\n    if (beanNames.length > 1) {\n        throw new ApplicationContextException(\"Unable to start ServletWebServerApplicationContext due to multiple \"\n                                              + \"ServletWebServerFactory beans : \" + StringUtils.arrayToCommaDelimitedString(beanNames));\n    }\n    return getBeanFactory().getBean(beanNames[0], ServletWebServerFactory.class);\n}\n```\n\n## getSelfInitializer\n\n\n\n```java\nprivate org.springframework.boot.web.servlet.ServletContextInitializer getSelfInitializer() {\n    return this::selfInitialize;\n}\n```\n\n\n\n# getWebServer\n\n```java\npublic WebServer getWebServer(ServletContextInitializer... initializers) {\n    if (this.disableMBeanRegistry) {\n        Registry.disableRegistry();\n    }\n    // tomcat\n    Tomcat tomcat = new Tomcat();\n    File baseDir = (this.baseDirectory != null) ? this.baseDirectory : createTempDir(\"tomcat\");\n    // \n    tomcat.setBaseDir(baseDir.getAbsolutePath());\n    Connector connector = new Connector(this.protocol);\n    connector.setThrowOnFailure(true);\n    tomcat.getService().addConnector(connector);\n    customizeConnector(connector);\n    tomcat.setConnector(connector);\n    tomcat.getHost().setAutoDeploy(false);\n    configureEngine(tomcat.getEngine());\n    for (Connector additionalConnector : this.additionalTomcatConnectors) {\n        tomcat.getService().addConnector(additionalConnector);\n    }\n    // \n    prepareContext(tomcat.getHost(), initializers);\n    // \n    return getTomcatWebServer(tomcat);\n}\n```\n\ntomcattomcat:\n\n```java\nprotected TomcatWebServer getTomcatWebServer(Tomcat tomcat) {\n    // \n    return new TomcatWebServer(tomcat, getPort() >= 0, getShutdown());\n}\n```\n\n```java\npublic TomcatWebServer(Tomcat tomcat, boolean autoStart, Shutdown shutdown) {\n    Assert.notNull(tomcat, \"Tomcat Server must not be null\");\n    this.tomcat = tomcat;\n    this.autoStart = autoStart;\n    this.gracefulShutdown = (shutdown == Shutdown.GRACEFUL) ? new GracefulShutdown(tomcat) : null;\n    // \n    initialize();\n}\n\nprivate void initialize() throws WebServerException {\n    logger.info(\"Tomcat initialized with port(s): \" + getPortsDescription(false));\n    synchronized (this.monitor) {\n        try {\n            addInstanceIdToEngineName();\n\n            Context context = findContext();\n            context.addLifecycleListener((event) -> {\n                if (context.equals(event.getSource()) && Lifecycle.START_EVENT.equals(event.getType())) {\n                    // Remove service connectors so that protocol binding doesn't\n                    // happen when the service is started.\n                    removeServiceConnectors();\n                }\n            });\n\n            // Start the server to trigger initialization listeners\n            this.tomcat.start();\n\n            // We can re-throw failure exception directly in the main thread\n            rethrowDeferredStartupExceptions();\n\n            try {\n                ContextBindings.bindClassLoader(context, context.getNamingToken(), getClass().getClassLoader());\n            }\n            catch (NamingException ex) {\n                // Naming is not enabled. Continue\n            }\n\n            // Unlike Jetty, all Tomcat threads are daemon threads. We create a\n            // blocking non-daemon to stop immediate shutdown\n            startDaemonAwaitThread();\n        }\n        catch (Exception ex) {\n            stopSilently();\n            destroySilently();\n            throw new WebServerException(\"Unable to start embedded Tomcat\", ex);\n        }\n    }\n}\n```\n\n","source":"_posts/springboot-servlet.md","raw":"---\ntitle: Springboot-servlet\ndate: 2021-02-28 22:01:17\ncategories: springboot\ntags: source\n---\n\nSpringBootservlet\n\n<!-- more -->\n\n<!-- toc -->\n\njava webtomcattomcatspringboot\n\n# \n\nspringBootrefresh`onRefresh()`****`SpringApplication`classweb`ServletWebServerApplicationContext`\n\n```java\n@Override\nprotected void onRefresh() {\n    super.onRefresh();\n    try {\n        // web\n        createWebServer();\n    }\n    catch (Throwable ex) {\n        throw new ApplicationContextException(\"Unable to start web server\", ex);\n    }\n}\n```\n\n\n\n# \n\n\n\n```java\nprivate void createWebServer() {\n    // volatile\n    WebServer webServer = this.webServer;\n    // servlet\n    ServletContext servletContext = getServletContext();\n    // null\n    if (webServer == null && servletContext == null) {\n        // nullweb\n        ServletWebServerFactory factory = getWebServerFactory();\n        // web\n        this.webServer = factory.getWebServer(getSelfInitializer());\n        getBeanFactory().registerSingleton(\"webServerGracefulShutdown\",\n                                           new WebServerGracefulShutdownLifecycle(this.webServer));\n        getBeanFactory().registerSingleton(\"webServerStartStop\",\n                                           new WebServerStartStopLifecycle(this, this.webServer));\n    }\n    // null\n    else if (servletContext != null) {\n        try {\n            getSelfInitializer().onStartup(servletContext);\n        }\n        catch (ServletException ex) {\n            throw new ApplicationContextException(\"Cannot initialize servlet context\", ex);\n        }\n    }\n    initPropertySources();\n}\n```\n\n## getWebServerFactory\n\nSPI\n\n```java\nprotected ServletWebServerFactory getWebServerFactory() {\n    // Use bean names so that we don't consider the hierarchy\n    String[] beanNames = getBeanFactory().getBeanNamesForType(ServletWebServerFactory.class);\n    if (beanNames.length == 0) {\n        throw new ApplicationContextException(\"Unable to start ServletWebServerApplicationContext due to missing \"\n                                              + \"ServletWebServerFactory bean.\");\n    }\n    if (beanNames.length > 1) {\n        throw new ApplicationContextException(\"Unable to start ServletWebServerApplicationContext due to multiple \"\n                                              + \"ServletWebServerFactory beans : \" + StringUtils.arrayToCommaDelimitedString(beanNames));\n    }\n    return getBeanFactory().getBean(beanNames[0], ServletWebServerFactory.class);\n}\n```\n\n## getSelfInitializer\n\n\n\n```java\nprivate org.springframework.boot.web.servlet.ServletContextInitializer getSelfInitializer() {\n    return this::selfInitialize;\n}\n```\n\n\n\n# getWebServer\n\n```java\npublic WebServer getWebServer(ServletContextInitializer... initializers) {\n    if (this.disableMBeanRegistry) {\n        Registry.disableRegistry();\n    }\n    // tomcat\n    Tomcat tomcat = new Tomcat();\n    File baseDir = (this.baseDirectory != null) ? this.baseDirectory : createTempDir(\"tomcat\");\n    // \n    tomcat.setBaseDir(baseDir.getAbsolutePath());\n    Connector connector = new Connector(this.protocol);\n    connector.setThrowOnFailure(true);\n    tomcat.getService().addConnector(connector);\n    customizeConnector(connector);\n    tomcat.setConnector(connector);\n    tomcat.getHost().setAutoDeploy(false);\n    configureEngine(tomcat.getEngine());\n    for (Connector additionalConnector : this.additionalTomcatConnectors) {\n        tomcat.getService().addConnector(additionalConnector);\n    }\n    // \n    prepareContext(tomcat.getHost(), initializers);\n    // \n    return getTomcatWebServer(tomcat);\n}\n```\n\ntomcattomcat:\n\n```java\nprotected TomcatWebServer getTomcatWebServer(Tomcat tomcat) {\n    // \n    return new TomcatWebServer(tomcat, getPort() >= 0, getShutdown());\n}\n```\n\n```java\npublic TomcatWebServer(Tomcat tomcat, boolean autoStart, Shutdown shutdown) {\n    Assert.notNull(tomcat, \"Tomcat Server must not be null\");\n    this.tomcat = tomcat;\n    this.autoStart = autoStart;\n    this.gracefulShutdown = (shutdown == Shutdown.GRACEFUL) ? new GracefulShutdown(tomcat) : null;\n    // \n    initialize();\n}\n\nprivate void initialize() throws WebServerException {\n    logger.info(\"Tomcat initialized with port(s): \" + getPortsDescription(false));\n    synchronized (this.monitor) {\n        try {\n            addInstanceIdToEngineName();\n\n            Context context = findContext();\n            context.addLifecycleListener((event) -> {\n                if (context.equals(event.getSource()) && Lifecycle.START_EVENT.equals(event.getType())) {\n                    // Remove service connectors so that protocol binding doesn't\n                    // happen when the service is started.\n                    removeServiceConnectors();\n                }\n            });\n\n            // Start the server to trigger initialization listeners\n            this.tomcat.start();\n\n            // We can re-throw failure exception directly in the main thread\n            rethrowDeferredStartupExceptions();\n\n            try {\n                ContextBindings.bindClassLoader(context, context.getNamingToken(), getClass().getClassLoader());\n            }\n            catch (NamingException ex) {\n                // Naming is not enabled. Continue\n            }\n\n            // Unlike Jetty, all Tomcat threads are daemon threads. We create a\n            // blocking non-daemon to stop immediate shutdown\n            startDaemonAwaitThread();\n        }\n        catch (Exception ex) {\n            stopSilently();\n            destroySilently();\n            throw new WebServerException(\"Unable to start embedded Tomcat\", ex);\n        }\n    }\n}\n```\n\n","slug":"springboot-servlet","published":1,"updated":"2021-03-02T15:48:34.523Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q870024w5ihg38x2fc4","content":"<p>SpringBootservlet</p>\n<a id=\"more\"></a>\n\n<!-- toc -->\n\n<p>java webtomcattomcatspringboot</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>springBootrefresh<code>onRefresh()</code><strong></strong><code>SpringApplication</code>classweb<code>ServletWebServerApplicationContext</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onRefresh</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>.onRefresh();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// web</span></span><br><span class=\"line\">        createWebServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start web server&quot;</span>, ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">createWebServer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// volatile</span></span><br><span class=\"line\">    WebServer webServer = <span class=\"keyword\">this</span>.webServer;</span><br><span class=\"line\">    <span class=\"comment\">// servlet</span></span><br><span class=\"line\">    ServletContext servletContext = getServletContext();</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (webServer == <span class=\"keyword\">null</span> &amp;&amp; servletContext == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// nullweb</span></span><br><span class=\"line\">        ServletWebServerFactory factory = getWebServerFactory();</span><br><span class=\"line\">        <span class=\"comment\">// web</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.webServer = factory.getWebServer(getSelfInitializer());</span><br><span class=\"line\">        getBeanFactory().registerSingleton(<span class=\"string\">&quot;webServerGracefulShutdown&quot;</span>,</span><br><span class=\"line\">                                           <span class=\"keyword\">new</span> WebServerGracefulShutdownLifecycle(<span class=\"keyword\">this</span>.webServer));</span><br><span class=\"line\">        getBeanFactory().registerSingleton(<span class=\"string\">&quot;webServerStartStop&quot;</span>,</span><br><span class=\"line\">                                           <span class=\"keyword\">new</span> WebServerStartStopLifecycle(<span class=\"keyword\">this</span>, <span class=\"keyword\">this</span>.webServer));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (servletContext != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            getSelfInitializer().onStartup(servletContext);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (ServletException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Cannot initialize servlet context&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    initPropertySources();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getWebServerFactory\"><a href=\"#getWebServerFactory\" class=\"headerlink\" title=\"getWebServerFactory\"></a>getWebServerFactory</h2><p>SPI</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> ServletWebServerFactory <span class=\"title\">getWebServerFactory</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Use bean names so that we don&#x27;t consider the hierarchy</span></span><br><span class=\"line\">    String[] beanNames = getBeanFactory().getBeanNamesForType(ServletWebServerFactory.class);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanNames.length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start ServletWebServerApplicationContext due to missing &quot;</span></span><br><span class=\"line\">                                              + <span class=\"string\">&quot;ServletWebServerFactory bean.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanNames.length &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start ServletWebServerApplicationContext due to multiple &quot;</span></span><br><span class=\"line\">                                              + <span class=\"string\">&quot;ServletWebServerFactory beans : &quot;</span> + StringUtils.arrayToCommaDelimitedString(beanNames));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> getBeanFactory().getBean(beanNames[<span class=\"number\">0</span>], ServletWebServerFactory.class);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getSelfInitializer\"><a href=\"#getSelfInitializer\" class=\"headerlink\" title=\"getSelfInitializer\"></a>getSelfInitializer</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> org.springframework.boot.web.servlet.<span class=\"function\">ServletContextInitializer <span class=\"title\">getSelfInitializer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>::selfInitialize;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"getWebServer\"><a href=\"#getWebServer\" class=\"headerlink\" title=\"getWebServer\"></a>getWebServer</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> WebServer <span class=\"title\">getWebServer</span><span class=\"params\">(ServletContextInitializer... initializers)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.disableMBeanRegistry) &#123;</span><br><span class=\"line\">        Registry.disableRegistry();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// tomcat</span></span><br><span class=\"line\">    Tomcat tomcat = <span class=\"keyword\">new</span> Tomcat();</span><br><span class=\"line\">    File baseDir = (<span class=\"keyword\">this</span>.baseDirectory != <span class=\"keyword\">null</span>) ? <span class=\"keyword\">this</span>.baseDirectory : createTempDir(<span class=\"string\">&quot;tomcat&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    tomcat.setBaseDir(baseDir.getAbsolutePath());</span><br><span class=\"line\">    Connector connector = <span class=\"keyword\">new</span> Connector(<span class=\"keyword\">this</span>.protocol);</span><br><span class=\"line\">    connector.setThrowOnFailure(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">    tomcat.getService().addConnector(connector);</span><br><span class=\"line\">    customizeConnector(connector);</span><br><span class=\"line\">    tomcat.setConnector(connector);</span><br><span class=\"line\">    tomcat.getHost().setAutoDeploy(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">    configureEngine(tomcat.getEngine());</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Connector additionalConnector : <span class=\"keyword\">this</span>.additionalTomcatConnectors) &#123;</span><br><span class=\"line\">        tomcat.getService().addConnector(additionalConnector);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    prepareContext(tomcat.getHost(), initializers);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> getTomcatWebServer(tomcat);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>tomcattomcat:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> TomcatWebServer <span class=\"title\">getTomcatWebServer</span><span class=\"params\">(Tomcat tomcat)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> TomcatWebServer(tomcat, getPort() &gt;= <span class=\"number\">0</span>, getShutdown());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TomcatWebServer</span><span class=\"params\">(Tomcat tomcat, <span class=\"keyword\">boolean</span> autoStart, Shutdown shutdown)</span> </span>&#123;</span><br><span class=\"line\">    Assert.notNull(tomcat, <span class=\"string\">&quot;Tomcat Server must not be null&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.tomcat = tomcat;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.autoStart = autoStart;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.gracefulShutdown = (shutdown == Shutdown.GRACEFUL) ? <span class=\"keyword\">new</span> GracefulShutdown(tomcat) : <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    initialize();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">initialize</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> WebServerException </span>&#123;</span><br><span class=\"line\">    logger.info(<span class=\"string\">&quot;Tomcat initialized with port(s): &quot;</span> + getPortsDescription(<span class=\"keyword\">false</span>));</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.monitor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            addInstanceIdToEngineName();</span><br><span class=\"line\"></span><br><span class=\"line\">            Context context = findContext();</span><br><span class=\"line\">            context.addLifecycleListener((event) -&gt; &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (context.equals(event.getSource()) &amp;&amp; Lifecycle.START_EVENT.equals(event.getType())) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Remove service connectors so that protocol binding doesn&#x27;t</span></span><br><span class=\"line\">                    <span class=\"comment\">// happen when the service is started.</span></span><br><span class=\"line\">                    removeServiceConnectors();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Start the server to trigger initialization listeners</span></span><br><span class=\"line\">            <span class=\"keyword\">this</span>.tomcat.start();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// We can re-throw failure exception directly in the main thread</span></span><br><span class=\"line\">            rethrowDeferredStartupExceptions();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                ContextBindings.bindClassLoader(context, context.getNamingToken(), getClass().getClassLoader());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (NamingException ex) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Naming is not enabled. Continue</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Unlike Jetty, all Tomcat threads are daemon threads. We create a</span></span><br><span class=\"line\">            <span class=\"comment\">// blocking non-daemon to stop immediate shutdown</span></span><br><span class=\"line\">            startDaemonAwaitThread();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            stopSilently();</span><br><span class=\"line\">            destroySilently();</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> WebServerException(<span class=\"string\">&quot;Unable to start embedded Tomcat&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>SpringBootservlet</p>","more":"<!-- toc -->\n\n<p>java webtomcattomcatspringboot</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>springBootrefresh<code>onRefresh()</code><strong></strong><code>SpringApplication</code>classweb<code>ServletWebServerApplicationContext</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onRefresh</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>.onRefresh();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// web</span></span><br><span class=\"line\">        createWebServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start web server&quot;</span>, ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">createWebServer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// volatile</span></span><br><span class=\"line\">    WebServer webServer = <span class=\"keyword\">this</span>.webServer;</span><br><span class=\"line\">    <span class=\"comment\">// servlet</span></span><br><span class=\"line\">    ServletContext servletContext = getServletContext();</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (webServer == <span class=\"keyword\">null</span> &amp;&amp; servletContext == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// nullweb</span></span><br><span class=\"line\">        ServletWebServerFactory factory = getWebServerFactory();</span><br><span class=\"line\">        <span class=\"comment\">// web</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.webServer = factory.getWebServer(getSelfInitializer());</span><br><span class=\"line\">        getBeanFactory().registerSingleton(<span class=\"string\">&quot;webServerGracefulShutdown&quot;</span>,</span><br><span class=\"line\">                                           <span class=\"keyword\">new</span> WebServerGracefulShutdownLifecycle(<span class=\"keyword\">this</span>.webServer));</span><br><span class=\"line\">        getBeanFactory().registerSingleton(<span class=\"string\">&quot;webServerStartStop&quot;</span>,</span><br><span class=\"line\">                                           <span class=\"keyword\">new</span> WebServerStartStopLifecycle(<span class=\"keyword\">this</span>, <span class=\"keyword\">this</span>.webServer));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (servletContext != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            getSelfInitializer().onStartup(servletContext);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (ServletException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Cannot initialize servlet context&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    initPropertySources();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getWebServerFactory\"><a href=\"#getWebServerFactory\" class=\"headerlink\" title=\"getWebServerFactory\"></a>getWebServerFactory</h2><p>SPI</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> ServletWebServerFactory <span class=\"title\">getWebServerFactory</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Use bean names so that we don&#x27;t consider the hierarchy</span></span><br><span class=\"line\">    String[] beanNames = getBeanFactory().getBeanNamesForType(ServletWebServerFactory.class);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanNames.length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start ServletWebServerApplicationContext due to missing &quot;</span></span><br><span class=\"line\">                                              + <span class=\"string\">&quot;ServletWebServerFactory bean.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanNames.length &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ApplicationContextException(<span class=\"string\">&quot;Unable to start ServletWebServerApplicationContext due to multiple &quot;</span></span><br><span class=\"line\">                                              + <span class=\"string\">&quot;ServletWebServerFactory beans : &quot;</span> + StringUtils.arrayToCommaDelimitedString(beanNames));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> getBeanFactory().getBean(beanNames[<span class=\"number\">0</span>], ServletWebServerFactory.class);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getSelfInitializer\"><a href=\"#getSelfInitializer\" class=\"headerlink\" title=\"getSelfInitializer\"></a>getSelfInitializer</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> org.springframework.boot.web.servlet.<span class=\"function\">ServletContextInitializer <span class=\"title\">getSelfInitializer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>::selfInitialize;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"getWebServer\"><a href=\"#getWebServer\" class=\"headerlink\" title=\"getWebServer\"></a>getWebServer</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> WebServer <span class=\"title\">getWebServer</span><span class=\"params\">(ServletContextInitializer... initializers)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.disableMBeanRegistry) &#123;</span><br><span class=\"line\">        Registry.disableRegistry();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// tomcat</span></span><br><span class=\"line\">    Tomcat tomcat = <span class=\"keyword\">new</span> Tomcat();</span><br><span class=\"line\">    File baseDir = (<span class=\"keyword\">this</span>.baseDirectory != <span class=\"keyword\">null</span>) ? <span class=\"keyword\">this</span>.baseDirectory : createTempDir(<span class=\"string\">&quot;tomcat&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    tomcat.setBaseDir(baseDir.getAbsolutePath());</span><br><span class=\"line\">    Connector connector = <span class=\"keyword\">new</span> Connector(<span class=\"keyword\">this</span>.protocol);</span><br><span class=\"line\">    connector.setThrowOnFailure(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">    tomcat.getService().addConnector(connector);</span><br><span class=\"line\">    customizeConnector(connector);</span><br><span class=\"line\">    tomcat.setConnector(connector);</span><br><span class=\"line\">    tomcat.getHost().setAutoDeploy(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">    configureEngine(tomcat.getEngine());</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Connector additionalConnector : <span class=\"keyword\">this</span>.additionalTomcatConnectors) &#123;</span><br><span class=\"line\">        tomcat.getService().addConnector(additionalConnector);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    prepareContext(tomcat.getHost(), initializers);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> getTomcatWebServer(tomcat);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>tomcattomcat:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> TomcatWebServer <span class=\"title\">getTomcatWebServer</span><span class=\"params\">(Tomcat tomcat)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> TomcatWebServer(tomcat, getPort() &gt;= <span class=\"number\">0</span>, getShutdown());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TomcatWebServer</span><span class=\"params\">(Tomcat tomcat, <span class=\"keyword\">boolean</span> autoStart, Shutdown shutdown)</span> </span>&#123;</span><br><span class=\"line\">    Assert.notNull(tomcat, <span class=\"string\">&quot;Tomcat Server must not be null&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.tomcat = tomcat;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.autoStart = autoStart;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.gracefulShutdown = (shutdown == Shutdown.GRACEFUL) ? <span class=\"keyword\">new</span> GracefulShutdown(tomcat) : <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    initialize();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">initialize</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> WebServerException </span>&#123;</span><br><span class=\"line\">    logger.info(<span class=\"string\">&quot;Tomcat initialized with port(s): &quot;</span> + getPortsDescription(<span class=\"keyword\">false</span>));</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>.monitor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            addInstanceIdToEngineName();</span><br><span class=\"line\"></span><br><span class=\"line\">            Context context = findContext();</span><br><span class=\"line\">            context.addLifecycleListener((event) -&gt; &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (context.equals(event.getSource()) &amp;&amp; Lifecycle.START_EVENT.equals(event.getType())) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Remove service connectors so that protocol binding doesn&#x27;t</span></span><br><span class=\"line\">                    <span class=\"comment\">// happen when the service is started.</span></span><br><span class=\"line\">                    removeServiceConnectors();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Start the server to trigger initialization listeners</span></span><br><span class=\"line\">            <span class=\"keyword\">this</span>.tomcat.start();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// We can re-throw failure exception directly in the main thread</span></span><br><span class=\"line\">            rethrowDeferredStartupExceptions();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                ContextBindings.bindClassLoader(context, context.getNamingToken(), getClass().getClassLoader());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (NamingException ex) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Naming is not enabled. Continue</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Unlike Jetty, all Tomcat threads are daemon threads. We create a</span></span><br><span class=\"line\">            <span class=\"comment\">// blocking non-daemon to stop immediate shutdown</span></span><br><span class=\"line\">            startDaemonAwaitThread();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            stopSilently();</span><br><span class=\"line\">            destroySilently();</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> WebServerException(<span class=\"string\">&quot;Unable to start embedded Tomcat&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>"},{"title":"subarray","date":"2021-02-27T05:45:38.000Z","_content":"\ntitlesubarray`map` + `preSum`\n\n<!-- more -->\n\n<!--toc-->\n\n# [Subarray Sum Equals K](https://leetcode.com/problems/subarray-sum-equals-k/)\n\nGiven an array of integers `nums` and an integer `k`, return *the total number of continuous subarrays whose sum equals to `k`*.\n\n\n\n```java\npublic int subarraySum(int[] nums, int k){\n    int res = 0;\n    for(int lo = 0, hi = 0, sum = 0; hi < nums.length; hi++){\n        sum += nums[i];\n        whlie(lo < nums.length && sum > k){\n            sum -= nums[lo++];\n        }\n        if(sum == k) res++;\n    }\n    \n    return res;\n}\n```\n\nAC**Constraints**\n\n- `1 <= nums.length <= 2 * 104`\n- `-1000 <= nums[i] <= 1000`\n- `-107 <= k <= 107`\n\n`sum-= nums[lo++]`OK\n\n## map + preSum\n\n\t\t`map``preSum`\n\n1,2,3,4,5,665P5152P23`P5 - P2`12\\[2, 3\\]maptarget`Px - Py = target (x > y)``Px - target = Py`map*Map\\<Integer, Integer\\>*****\n\n```java\npublic int subarraySum(int[] nums, int k){\n    if(nums.length == 0) return 0;\n    Map<Integer, Integer> map new HashMap<>();\n    int sum = 0, result = 0;\n    for(int cur : nums){\n        sum += cur; // preSum\n        if(sum == k) result++; //map map.put(0, 1)\n        result += map.getOrDefault(sum - k, 0);\n        map.put(sum, map.getOrDefault(sum, 0) + 1);\n    }\n    \n    return result;\n}\n```\n\nmap`sum(i, j) = sum(0, j) - sum(0, i)`\n\n# [Minimum Operations to Reduce X to Zero](https://leetcode.com/problems/minimum-operations-to-reduce-x-to-zero)\n\nYou are given an integer array `nums` and an integer `x`. In one operation, you can either remove the leftmost or the rightmost element from the array `nums` and subtract its value from `x`. Note that this **modifies** the array for future operations.\n\nReturn *the **minimum number** of operations to reduce* `x` *to **exactly*** `0` *if it's possible**, otherwise, return* `-1`.\n\n**Constraints:**\n\n- `1 <= nums.length <= 105`\n- `1 <= nums[i] <= 104`\n- `1 <= x <= 109`\n\n\t\t1,2,3,4,561515-6=996\n\n1\n\n```java\npublic int minOperations(int[] nums, int x){\n    int target = Arrays.stream(nums).sum() - x;\n    int size = -1, n = nums.length;\n    for(int lo = 0, hi = 0, sum = 0; hi < n; hi++){\n        sum += nums[hi];\n        while(lo < n && sum > target){\n            sum -= nums[lo++];\n        }\n        if(sum == target) size = Math.max(size, hi - lo + 1);\n    }\n    return size < 0 ? -1 : n - size;\n}\n```\n\n\n\n```java\npublic int minOperations(int[] nums, int x) {\n    int target = Arrays.stream(nums).sum() - x;\n    if(target == 0) return nums.length;\n    Map<Integer, Integer> map = new HashMap<>();\n    map.put(0, -1);//  i - map.value\n    int sum = 0, res = 0;\n    for(int i=0; i<nums.length; i++){\n        int num = nums[i];\n        sum += num;\n        if(map.containsKey(sum - target)){\n            res = Math.max(res, i - map.get(sum - target));\n        }\n        map.put(sum, i);\n    }\n\n    return res == 0 ? -1 : nums.length - res;\n}\n```\n\n","source":"_posts/subarray.md","raw":"---\ntitle: subarray\ndate: 2021-02-27 13:45:38\ncategories: Leetcode\ntags: \n- double poiters\n- map+preSum\n---\n\ntitlesubarray`map` + `preSum`\n\n<!-- more -->\n\n<!--toc-->\n\n# [Subarray Sum Equals K](https://leetcode.com/problems/subarray-sum-equals-k/)\n\nGiven an array of integers `nums` and an integer `k`, return *the total number of continuous subarrays whose sum equals to `k`*.\n\n\n\n```java\npublic int subarraySum(int[] nums, int k){\n    int res = 0;\n    for(int lo = 0, hi = 0, sum = 0; hi < nums.length; hi++){\n        sum += nums[i];\n        whlie(lo < nums.length && sum > k){\n            sum -= nums[lo++];\n        }\n        if(sum == k) res++;\n    }\n    \n    return res;\n}\n```\n\nAC**Constraints**\n\n- `1 <= nums.length <= 2 * 104`\n- `-1000 <= nums[i] <= 1000`\n- `-107 <= k <= 107`\n\n`sum-= nums[lo++]`OK\n\n## map + preSum\n\n\t\t`map``preSum`\n\n1,2,3,4,5,665P5152P23`P5 - P2`12\\[2, 3\\]maptarget`Px - Py = target (x > y)``Px - target = Py`map*Map\\<Integer, Integer\\>*****\n\n```java\npublic int subarraySum(int[] nums, int k){\n    if(nums.length == 0) return 0;\n    Map<Integer, Integer> map new HashMap<>();\n    int sum = 0, result = 0;\n    for(int cur : nums){\n        sum += cur; // preSum\n        if(sum == k) result++; //map map.put(0, 1)\n        result += map.getOrDefault(sum - k, 0);\n        map.put(sum, map.getOrDefault(sum, 0) + 1);\n    }\n    \n    return result;\n}\n```\n\nmap`sum(i, j) = sum(0, j) - sum(0, i)`\n\n# [Minimum Operations to Reduce X to Zero](https://leetcode.com/problems/minimum-operations-to-reduce-x-to-zero)\n\nYou are given an integer array `nums` and an integer `x`. In one operation, you can either remove the leftmost or the rightmost element from the array `nums` and subtract its value from `x`. Note that this **modifies** the array for future operations.\n\nReturn *the **minimum number** of operations to reduce* `x` *to **exactly*** `0` *if it's possible**, otherwise, return* `-1`.\n\n**Constraints:**\n\n- `1 <= nums.length <= 105`\n- `1 <= nums[i] <= 104`\n- `1 <= x <= 109`\n\n\t\t1,2,3,4,561515-6=996\n\n1\n\n```java\npublic int minOperations(int[] nums, int x){\n    int target = Arrays.stream(nums).sum() - x;\n    int size = -1, n = nums.length;\n    for(int lo = 0, hi = 0, sum = 0; hi < n; hi++){\n        sum += nums[hi];\n        while(lo < n && sum > target){\n            sum -= nums[lo++];\n        }\n        if(sum == target) size = Math.max(size, hi - lo + 1);\n    }\n    return size < 0 ? -1 : n - size;\n}\n```\n\n\n\n```java\npublic int minOperations(int[] nums, int x) {\n    int target = Arrays.stream(nums).sum() - x;\n    if(target == 0) return nums.length;\n    Map<Integer, Integer> map = new HashMap<>();\n    map.put(0, -1);//  i - map.value\n    int sum = 0, res = 0;\n    for(int i=0; i<nums.length; i++){\n        int num = nums[i];\n        sum += num;\n        if(map.containsKey(sum - target)){\n            res = Math.max(res, i - map.get(sum - target));\n        }\n        map.put(sum, i);\n    }\n\n    return res == 0 ? -1 : nums.length - res;\n}\n```\n\n","slug":"subarray","published":1,"updated":"2021-02-27T07:35:51.857Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q890028w5ihdly0flea","content":"<p>titlesubarray<code>map</code> + <code>preSum</code></p>\n<a id=\"more\"></a>\n\n<!--toc-->\n\n<h1 id=\"Subarray-Sum-Equals-K\"><a href=\"#Subarray-Sum-Equals-K\" class=\"headerlink\" title=\"Subarray Sum Equals K\"></a><a href=\"https://leetcode.com/problems/subarray-sum-equals-k/\">Subarray Sum Equals K</a></h1><p>Given an array of integers <code>nums</code> and an integer <code>k</code>, return <em>the total number of continuous subarrays whose sum equals to <code>k</code></em>.</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">subarraySum</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> lo = <span class=\"number\">0</span>, hi = <span class=\"number\">0</span>, sum = <span class=\"number\">0</span>; hi &lt; nums.length; hi++)&#123;</span><br><span class=\"line\">        sum += nums[i];</span><br><span class=\"line\">        whlie(lo &lt; nums.length &amp;&amp; sum &gt; k)&#123;</span><br><span class=\"line\">            sum -= nums[lo++];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == k) res++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AC<strong>Constraints</strong></p>\n<ul>\n<li><code>1 &lt;= nums.length &lt;= 2 * 104</code></li>\n<li><code>-1000 &lt;= nums[i] &lt;= 1000</code></li>\n<li><code>-107 &lt;= k &lt;= 107</code></li>\n</ul>\n<p><code>sum-= nums[lo++]</code>OK</p>\n<h2 id=\"map-preSum\"><a href=\"#map-preSum\" class=\"headerlink\" title=\"map + preSum\"></a>map + preSum</h2><p>        <code>map</code><code>preSum</code></p>\n<p>1,2,3,4,5,665P5152P23<code>P5 - P2</code>12[2, 3]maptarget<code>Px - Py = target (x &gt; y)</code><code>Px - target = Py</code>map<em>Map&lt;Integer, Integer&gt;<em></em></em><em></em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">subarraySum</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(nums.length == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    Map&lt;Integer, Integer&gt; map <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>, result = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> cur : nums)&#123;</span><br><span class=\"line\">        sum += cur; <span class=\"comment\">// preSum</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == k) result++; <span class=\"comment\">//map map.put(0, 1)</span></span><br><span class=\"line\">        result += map.getOrDefault(sum - k, <span class=\"number\">0</span>);</span><br><span class=\"line\">        map.put(sum, map.getOrDefault(sum, <span class=\"number\">0</span>) + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>map<code>sum(i, j) = sum(0, j) - sum(0, i)</code></p>\n<h1 id=\"Minimum-Operations-to-Reduce-X-to-Zero\"><a href=\"#Minimum-Operations-to-Reduce-X-to-Zero\" class=\"headerlink\" title=\"Minimum Operations to Reduce X to Zero\"></a><a href=\"https://leetcode.com/problems/minimum-operations-to-reduce-x-to-zero\">Minimum Operations to Reduce X to Zero</a></h1><p>You are given an integer array <code>nums</code> and an integer <code>x</code>. In one operation, you can either remove the leftmost or the rightmost element from the array <code>nums</code> and subtract its value from <code>x</code>. Note that this <strong>modifies</strong> the array for future operations.</p>\n<p>Return <em>the <strong>minimum number</strong> of operations to reduce</em> <code>x</code> <em>to <strong>exactly</strong></em> <code>0</code> <em>if its possible**, otherwise, return</em> <code>-1</code>.</p>\n<p><strong>Constraints:</strong></p>\n<ul>\n<li><code>1 &lt;= nums.length &lt;= 105</code></li>\n<li><code>1 &lt;= nums[i] &lt;= 104</code></li>\n<li><code>1 &lt;= x &lt;= 109</code></li>\n</ul>\n<p>        1,2,3,4,561515-6=996</p>\n<p>1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> target = Arrays.stream(nums).sum() - x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> size = -<span class=\"number\">1</span>, n = nums.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> lo = <span class=\"number\">0</span>, hi = <span class=\"number\">0</span>, sum = <span class=\"number\">0</span>; hi &lt; n; hi++)&#123;</span><br><span class=\"line\">        sum += nums[hi];</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(lo &lt; n &amp;&amp; sum &gt; target)&#123;</span><br><span class=\"line\">            sum -= nums[lo++];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == target) size = Math.max(size, hi - lo + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> size &lt; <span class=\"number\">0</span> ? -<span class=\"number\">1</span> : n - size;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> target = Arrays.stream(nums).sum() - x;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> nums.length;</span><br><span class=\"line\">    Map&lt;Integer, Integer&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    map.put(<span class=\"number\">0</span>, -<span class=\"number\">1</span>);<span class=\"comment\">//  i - map.value</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>, res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;nums.length; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> num = nums[i];</span><br><span class=\"line\">        sum += num;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(map.containsKey(sum - target))&#123;</span><br><span class=\"line\">            res = Math.max(res, i - map.get(sum - target));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        map.put(sum, i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res == <span class=\"number\">0</span> ? -<span class=\"number\">1</span> : nums.length - res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>titlesubarray<code>map</code> + <code>preSum</code></p>","more":"<!--toc-->\n\n<h1 id=\"Subarray-Sum-Equals-K\"><a href=\"#Subarray-Sum-Equals-K\" class=\"headerlink\" title=\"Subarray Sum Equals K\"></a><a href=\"https://leetcode.com/problems/subarray-sum-equals-k/\">Subarray Sum Equals K</a></h1><p>Given an array of integers <code>nums</code> and an integer <code>k</code>, return <em>the total number of continuous subarrays whose sum equals to <code>k</code></em>.</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">subarraySum</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> lo = <span class=\"number\">0</span>, hi = <span class=\"number\">0</span>, sum = <span class=\"number\">0</span>; hi &lt; nums.length; hi++)&#123;</span><br><span class=\"line\">        sum += nums[i];</span><br><span class=\"line\">        whlie(lo &lt; nums.length &amp;&amp; sum &gt; k)&#123;</span><br><span class=\"line\">            sum -= nums[lo++];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == k) res++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AC<strong>Constraints</strong></p>\n<ul>\n<li><code>1 &lt;= nums.length &lt;= 2 * 104</code></li>\n<li><code>-1000 &lt;= nums[i] &lt;= 1000</code></li>\n<li><code>-107 &lt;= k &lt;= 107</code></li>\n</ul>\n<p><code>sum-= nums[lo++]</code>OK</p>\n<h2 id=\"map-preSum\"><a href=\"#map-preSum\" class=\"headerlink\" title=\"map + preSum\"></a>map + preSum</h2><p>        <code>map</code><code>preSum</code></p>\n<p>1,2,3,4,5,665P5152P23<code>P5 - P2</code>12[2, 3]maptarget<code>Px - Py = target (x &gt; y)</code><code>Px - target = Py</code>map<em>Map&lt;Integer, Integer&gt;<em></em></em><em></em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">subarraySum</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(nums.length == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    Map&lt;Integer, Integer&gt; map <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>, result = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> cur : nums)&#123;</span><br><span class=\"line\">        sum += cur; <span class=\"comment\">// preSum</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == k) result++; <span class=\"comment\">//map map.put(0, 1)</span></span><br><span class=\"line\">        result += map.getOrDefault(sum - k, <span class=\"number\">0</span>);</span><br><span class=\"line\">        map.put(sum, map.getOrDefault(sum, <span class=\"number\">0</span>) + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>map<code>sum(i, j) = sum(0, j) - sum(0, i)</code></p>\n<h1 id=\"Minimum-Operations-to-Reduce-X-to-Zero\"><a href=\"#Minimum-Operations-to-Reduce-X-to-Zero\" class=\"headerlink\" title=\"Minimum Operations to Reduce X to Zero\"></a><a href=\"https://leetcode.com/problems/minimum-operations-to-reduce-x-to-zero\">Minimum Operations to Reduce X to Zero</a></h1><p>You are given an integer array <code>nums</code> and an integer <code>x</code>. In one operation, you can either remove the leftmost or the rightmost element from the array <code>nums</code> and subtract its value from <code>x</code>. Note that this <strong>modifies</strong> the array for future operations.</p>\n<p>Return <em>the <strong>minimum number</strong> of operations to reduce</em> <code>x</code> <em>to <strong>exactly</strong></em> <code>0</code> <em>if its possible**, otherwise, return</em> <code>-1</code>.</p>\n<p><strong>Constraints:</strong></p>\n<ul>\n<li><code>1 &lt;= nums.length &lt;= 105</code></li>\n<li><code>1 &lt;= nums[i] &lt;= 104</code></li>\n<li><code>1 &lt;= x &lt;= 109</code></li>\n</ul>\n<p>        1,2,3,4,561515-6=996</p>\n<p>1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> target = Arrays.stream(nums).sum() - x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> size = -<span class=\"number\">1</span>, n = nums.length;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> lo = <span class=\"number\">0</span>, hi = <span class=\"number\">0</span>, sum = <span class=\"number\">0</span>; hi &lt; n; hi++)&#123;</span><br><span class=\"line\">        sum += nums[hi];</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(lo &lt; n &amp;&amp; sum &gt; target)&#123;</span><br><span class=\"line\">            sum -= nums[lo++];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum == target) size = Math.max(size, hi - lo + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> size &lt; <span class=\"number\">0</span> ? -<span class=\"number\">1</span> : n - size;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">minOperations</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> target = Arrays.stream(nums).sum() - x;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(target == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> nums.length;</span><br><span class=\"line\">    Map&lt;Integer, Integer&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    map.put(<span class=\"number\">0</span>, -<span class=\"number\">1</span>);<span class=\"comment\">//  i - map.value</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>, res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>; i&lt;nums.length; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> num = nums[i];</span><br><span class=\"line\">        sum += num;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(map.containsKey(sum - target))&#123;</span><br><span class=\"line\">            res = Math.max(res, i - map.get(sum - target));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        map.put(sum, i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res == <span class=\"number\">0</span> ? -<span class=\"number\">1</span> : nums.length - res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"uml","date":"2020-01-12T15:14:16.000Z","_content":"\nThe **Unified Modeling Language(UML)** is a general-purpose, developmental, modeling language in the field of software engineering that is intended to provide a standard way to visualize the design of a system.\n\n<!-- more -->\n\n# \n\nUML(Class Relationships)\n\n[reference1](https://www.visual-paradigm.com/cn/guide/), [reference2](https://support.typora.io/Draw-Diagrams-With-Markdown/)\n\n## Class Relationships\n\nA class may be involved in one or more relationships with other classes.\n\n## Inheritance(or Generalization)\n\n- Represents an \"is-a\" relationship\n- An abstract class name is shown *in italics*\n- SubClass1 and SubClass2 are specializations of Super Class\n- **A solid line with a hollow arrowhead that point <u>from the child to the parent class</u>**\n\n```mermaid\nclassDiagram\nClass <|-- SubClass1\nClass <|-- SubClass2 \n```\n\n\n\n---\n\n## Simple Association\n\n- A structural link between two peer classes\n- There is an association between Class1 and Class2\n- **A solid line connecting two classes**\n\n```mermaid\nclassDiagram\nClass1 .. Class2\n```\n\n\n\n---\n\n## Aggregation\n\nA special type of association. It represents a \"part of\" relationship.\n\n- Class2 is part of Class1.\n- Many instances(denoted by the *) of Class2 can be associated with Class1\n- Objects of Class1 and Class2 have separate lifetimes\n- **A solid line with an unfilled diamond at the association end connected to the class of composite**\n\n```mermaid\nclassDiagram\nClass1 o-- Class2\n```\n\n---\n\n## Composition\n\nA special type of aggregation **where parts are destroyed when the whole is destroyed.**\n\n- Objects of Class2 live and die with Class1\n- Class2 cannot stand by itself\n- **A solid line with a filled diamond at the association connected to the class of composite**\n\n```mermaid\nclassDiagram\nClass1 *-- Class2\n```\n\n---\n\n## Dependency\n\n- Exists between two classes if the changes to the definition of one may cause changes to the other (but not the other way around)\n- Class1 depends on Class2\n- A dashed line with an open arrow\n\n```mermaid\nclassDiagram\nClass1 ..> Class2\n```\n\n\n\n","source":"_posts/uml.md","raw":"---\ntitle: uml\ndate: 2020-01-12 23:14:16\ncategories: Utils\ntags: utils\n---\n\nThe **Unified Modeling Language(UML)** is a general-purpose, developmental, modeling language in the field of software engineering that is intended to provide a standard way to visualize the design of a system.\n\n<!-- more -->\n\n# \n\nUML(Class Relationships)\n\n[reference1](https://www.visual-paradigm.com/cn/guide/), [reference2](https://support.typora.io/Draw-Diagrams-With-Markdown/)\n\n## Class Relationships\n\nA class may be involved in one or more relationships with other classes.\n\n## Inheritance(or Generalization)\n\n- Represents an \"is-a\" relationship\n- An abstract class name is shown *in italics*\n- SubClass1 and SubClass2 are specializations of Super Class\n- **A solid line with a hollow arrowhead that point <u>from the child to the parent class</u>**\n\n```mermaid\nclassDiagram\nClass <|-- SubClass1\nClass <|-- SubClass2 \n```\n\n\n\n---\n\n## Simple Association\n\n- A structural link between two peer classes\n- There is an association between Class1 and Class2\n- **A solid line connecting two classes**\n\n```mermaid\nclassDiagram\nClass1 .. Class2\n```\n\n\n\n---\n\n## Aggregation\n\nA special type of association. It represents a \"part of\" relationship.\n\n- Class2 is part of Class1.\n- Many instances(denoted by the *) of Class2 can be associated with Class1\n- Objects of Class1 and Class2 have separate lifetimes\n- **A solid line with an unfilled diamond at the association end connected to the class of composite**\n\n```mermaid\nclassDiagram\nClass1 o-- Class2\n```\n\n---\n\n## Composition\n\nA special type of aggregation **where parts are destroyed when the whole is destroyed.**\n\n- Objects of Class2 live and die with Class1\n- Class2 cannot stand by itself\n- **A solid line with a filled diamond at the association connected to the class of composite**\n\n```mermaid\nclassDiagram\nClass1 *-- Class2\n```\n\n---\n\n## Dependency\n\n- Exists between two classes if the changes to the definition of one may cause changes to the other (but not the other way around)\n- Class1 depends on Class2\n- A dashed line with an open arrow\n\n```mermaid\nclassDiagram\nClass1 ..> Class2\n```\n\n\n\n","slug":"uml","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q8a002aw5ihd43v2r8d","content":"<p>The <strong>Unified Modeling Language(UML)</strong> is a general-purpose, developmental, modeling language in the field of software engineering that is intended to provide a standard way to visualize the design of a system.</p>\n<a id=\"more\"></a>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>UML(Class Relationships)</p>\n<p><a href=\"https://www.visual-paradigm.com/cn/guide/\">reference1</a>, <a href=\"https://support.typora.io/Draw-Diagrams-With-Markdown/\">reference2</a></p>\n<h2 id=\"Class-Relationships\"><a href=\"#Class-Relationships\" class=\"headerlink\" title=\"Class Relationships\"></a>Class Relationships</h2><p>A class may be involved in one or more relationships with other classes.</p>\n<h2 id=\"Inheritance-or-Generalization\"><a href=\"#Inheritance-or-Generalization\" class=\"headerlink\" title=\"Inheritance(or Generalization)\"></a>Inheritance(or Generalization)</h2><ul>\n<li>Represents an is-a relationship</li>\n<li>An abstract class name is shown <em>in italics</em></li>\n<li>SubClass1 and SubClass2 are specializations of Super Class</li>\n<li><strong>A solid line with a hollow arrowhead that point <u>from the child to the parent class</u></strong></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class &lt;|-- SubClass1</span><br><span class=\"line\">Class &lt;|-- SubClass2 </span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<h2 id=\"Simple-Association\"><a href=\"#Simple-Association\" class=\"headerlink\" title=\"Simple Association\"></a>Simple Association</h2><ul>\n<li>A structural link between two peer classes</li>\n<li>There is an association between Class1 and Class2</li>\n<li><strong>A solid line connecting two classes</strong></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 .. Class2</span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<h2 id=\"Aggregation\"><a href=\"#Aggregation\" class=\"headerlink\" title=\"Aggregation\"></a>Aggregation</h2><p>A special type of association. It represents a part of relationship.</p>\n<ul>\n<li>Class2 is part of Class1.</li>\n<li>Many instances(denoted by the *) of Class2 can be associated with Class1</li>\n<li>Objects of Class1 and Class2 have separate lifetimes</li>\n<li><strong>A solid line with an unfilled diamond at the association end connected to the class of composite</strong></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 o-- Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Composition\"><a href=\"#Composition\" class=\"headerlink\" title=\"Composition\"></a>Composition</h2><p>A special type of aggregation <strong>where parts are destroyed when the whole is destroyed.</strong></p>\n<ul>\n<li>Objects of Class2 live and die with Class1</li>\n<li>Class2 cannot stand by itself</li>\n<li><strong>A solid line with a filled diamond at the association connected to the class of composite</strong></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 *-- Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Dependency\"><a href=\"#Dependency\" class=\"headerlink\" title=\"Dependency\"></a>Dependency</h2><ul>\n<li>Exists between two classes if the changes to the definition of one may cause changes to the other (but not the other way around)</li>\n<li>Class1 depends on Class2</li>\n<li>A dashed line with an open arrow</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 ..&gt; Class2</span><br></pre></td></tr></table></figure>\n\n\n\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>The <strong>Unified Modeling Language(UML)</strong> is a general-purpose, developmental, modeling language in the field of software engineering that is intended to provide a standard way to visualize the design of a system.</p>","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>UML(Class Relationships)</p>\n<p><a href=\"https://www.visual-paradigm.com/cn/guide/\">reference1</a>, <a href=\"https://support.typora.io/Draw-Diagrams-With-Markdown/\">reference2</a></p>\n<h2 id=\"Class-Relationships\"><a href=\"#Class-Relationships\" class=\"headerlink\" title=\"Class Relationships\"></a>Class Relationships</h2><p>A class may be involved in one or more relationships with other classes.</p>\n<h2 id=\"Inheritance-or-Generalization\"><a href=\"#Inheritance-or-Generalization\" class=\"headerlink\" title=\"Inheritance(or Generalization)\"></a>Inheritance(or Generalization)</h2><ul>\n<li>Represents an is-a relationship</li>\n<li>An abstract class name is shown <em>in italics</em></li>\n<li>SubClass1 and SubClass2 are specializations of Super Class</li>\n<li><strong>A solid line with a hollow arrowhead that point <u>from the child to the parent class</u></strong></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class &lt;|-- SubClass1</span><br><span class=\"line\">Class &lt;|-- SubClass2 </span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<h2 id=\"Simple-Association\"><a href=\"#Simple-Association\" class=\"headerlink\" title=\"Simple Association\"></a>Simple Association</h2><ul>\n<li>A structural link between two peer classes</li>\n<li>There is an association between Class1 and Class2</li>\n<li><strong>A solid line connecting two classes</strong></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 .. Class2</span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<h2 id=\"Aggregation\"><a href=\"#Aggregation\" class=\"headerlink\" title=\"Aggregation\"></a>Aggregation</h2><p>A special type of association. It represents a part of relationship.</p>\n<ul>\n<li>Class2 is part of Class1.</li>\n<li>Many instances(denoted by the *) of Class2 can be associated with Class1</li>\n<li>Objects of Class1 and Class2 have separate lifetimes</li>\n<li><strong>A solid line with an unfilled diamond at the association end connected to the class of composite</strong></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 o-- Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Composition\"><a href=\"#Composition\" class=\"headerlink\" title=\"Composition\"></a>Composition</h2><p>A special type of aggregation <strong>where parts are destroyed when the whole is destroyed.</strong></p>\n<ul>\n<li>Objects of Class2 live and die with Class1</li>\n<li>Class2 cannot stand by itself</li>\n<li><strong>A solid line with a filled diamond at the association connected to the class of composite</strong></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 *-- Class2</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"Dependency\"><a href=\"#Dependency\" class=\"headerlink\" title=\"Dependency\"></a>Dependency</h2><ul>\n<li>Exists between two classes if the changes to the definition of one may cause changes to the other (but not the other way around)</li>\n<li>Class1 depends on Class2</li>\n<li>A dashed line with an open arrow</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classDiagram</span><br><span class=\"line\">Class1 ..&gt; Class2</span><br></pre></td></tr></table></figure>"},{"title":"volatile","date":"2020-07-20T13:23:51.000Z","_content":"\nJava`being stored in main memory`volatileCPUvolatileCPU\n\n<!--more-->\n\n# Visibility problems\n\n`volatile`CPUCPUCPUCPU\n\n`volatile`JavaCPUCPU\n\n```java\npublic class ShareObject{\n    public int counter = 0;\n}\n```\n\n112\n\ncounter`volatile`CPUcounterCPUJVMVisibility problem****\n\n# Visibility Guarantee\n\n`volatile`counter`volatile``volatile`\n\n```java\npublic class ShareObject{\n    // volatile\n    public volatile int counter = 0 ;\n}\n```\n\n1212`volatile`\n\n## Full Visibility Guarantee\n\n`volatile``volatile`\n\n- A`volatile`B`volatile`AB`volatile`\n\n- A`volatile`A\n\n\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n    \n    // daysvolatile\n    public void update(int years, int months, int days){\n        this.years = year;\n        this.months = months;\n        this.days = days;    \n    }\n}\n```\n\nFull Visibility Guaranteedaysmonthsyears\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n\n    public int totalDays(){\n        int total = this.days;\n        total += months * 30;\n        total += years * 365;\n        return total;   \n    }\n\n    public void update(int years, int months, int days){\n        this.years = years;\n        this.months = months;\n        this.days = days;\n}\n}\n```\n\n*totalDays()*`days``total` ,`days``volatile``days`monthsyears`volatile``volatile`****`volatile`\n\n# Instruction Reordering\n\nJVMCPU\n\n```java\nint a = 1;\nint b = 2;\na++;\nb++;\n```\n\n\n\n```java\nint a  = 1;\na++;\nint b = 2;\nb++\n```\n\n`volatile`\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n    \n    public void update(int years, int months, int days){\n        this.years = years;\n        this.months = months;\n        this.days = days;\n    }\n}\n```\n\nJVM\n\n```java\n    public void update(int years, int months, int days){\n        // days\n        this.days = days;\n        this.years = years;\n        this.months = months;\n    }\n```\n\ndaysmonthsyears\n\n## Volatile Happens-Before Guarantee\n\n`volatile`\n\n- /`volatile`\n- /`volatile`\n\n# Volatile is Not Always Enough\n\ncountercounter``**syncronized**`lock`\n","source":"_posts/volatile.md","raw":"---\ntitle: volatile\ndate: 2020-07-20 21:23:51\ncategories: Java\ntags: lock\n---\n\nJava`being stored in main memory`volatileCPUvolatileCPU\n\n<!--more-->\n\n# Visibility problems\n\n`volatile`CPUCPUCPUCPU\n\n`volatile`JavaCPUCPU\n\n```java\npublic class ShareObject{\n    public int counter = 0;\n}\n```\n\n112\n\ncounter`volatile`CPUcounterCPUJVMVisibility problem****\n\n# Visibility Guarantee\n\n`volatile`counter`volatile``volatile`\n\n```java\npublic class ShareObject{\n    // volatile\n    public volatile int counter = 0 ;\n}\n```\n\n1212`volatile`\n\n## Full Visibility Guarantee\n\n`volatile``volatile`\n\n- A`volatile`B`volatile`AB`volatile`\n\n- A`volatile`A\n\n\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n    \n    // daysvolatile\n    public void update(int years, int months, int days){\n        this.years = year;\n        this.months = months;\n        this.days = days;    \n    }\n}\n```\n\nFull Visibility Guaranteedaysmonthsyears\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n\n    public int totalDays(){\n        int total = this.days;\n        total += months * 30;\n        total += years * 365;\n        return total;   \n    }\n\n    public void update(int years, int months, int days){\n        this.years = years;\n        this.months = months;\n        this.days = days;\n}\n}\n```\n\n*totalDays()*`days``total` ,`days``volatile``days`monthsyears`volatile``volatile`****`volatile`\n\n# Instruction Reordering\n\nJVMCPU\n\n```java\nint a = 1;\nint b = 2;\na++;\nb++;\n```\n\n\n\n```java\nint a  = 1;\na++;\nint b = 2;\nb++\n```\n\n`volatile`\n\n```java\npublic class MyClass{\n    private int years;\n    private int months;\n    private volatile int days;\n    \n    public void update(int years, int months, int days){\n        this.years = years;\n        this.months = months;\n        this.days = days;\n    }\n}\n```\n\nJVM\n\n```java\n    public void update(int years, int months, int days){\n        // days\n        this.days = days;\n        this.years = years;\n        this.months = months;\n    }\n```\n\ndaysmonthsyears\n\n## Volatile Happens-Before Guarantee\n\n`volatile`\n\n- /`volatile`\n- /`volatile`\n\n# Volatile is Not Always Enough\n\ncountercounter``**syncronized**`lock`\n","slug":"volatile","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q8c002fw5ihend92pom","content":"<p>Java<code>being stored in main memory</code>volatileCPUvolatileCPU</p>\n<a id=\"more\"></a>\n\n<h1 id=\"Visibility-problems\"><a href=\"#Visibility-problems\" class=\"headerlink\" title=\"Visibility problems\"></a>Visibility problems</h1><p><code>volatile</code>CPUCPUCPUCPU</p>\n<p><code>volatile</code>JavaCPUCPU</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShareObject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>112</p>\n<p>counter<code>volatile</code>CPUcounterCPUJVMVisibility problem<strong></strong></p>\n<h1 id=\"Visibility-Guarantee\"><a href=\"#Visibility-Guarantee\" class=\"headerlink\" title=\"Visibility Guarantee\"></a>Visibility Guarantee</h1><p><code>volatile</code>counter<code>volatile</code><code>volatile</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShareObject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// volatile</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span> ;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>1212<code>volatile</code></p>\n<h2 id=\"Full-Visibility-Guarantee\"><a href=\"#Full-Visibility-Guarantee\" class=\"headerlink\" title=\"Full Visibility Guarantee\"></a>Full Visibility Guarantee</h2><p><code>volatile</code><code>volatile</code></p>\n<ul>\n<li><p>A<code>volatile</code>B<code>volatile</code>AB<code>volatile</code></p>\n</li>\n<li><p>A<code>volatile</code>A</p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// daysvolatile</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = year;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;    </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Full Visibility Guaranteedaysmonthsyears</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">totalDays</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> total = <span class=\"keyword\">this</span>.days;</span><br><span class=\"line\">        total += months * <span class=\"number\">30</span>;</span><br><span class=\"line\">        total += years * <span class=\"number\">365</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> total;   </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>totalDays()<em><code>days</code><code>total</code> ,<code>days</code><code>volatile</code><code>days</code>monthsyears<code>volatile</code><code>volatile</code></em></em>**<code>volatile</code></p>\n<h1 id=\"Instruction-Reordering\"><a href=\"#Instruction-Reordering\" class=\"headerlink\" title=\"Instruction Reordering\"></a>Instruction Reordering</h1><p>JVMCPU</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">2</span>;</span><br><span class=\"line\">a++;</span><br><span class=\"line\">b++;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a  = <span class=\"number\">1</span>;</span><br><span class=\"line\">a++;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">2</span>;</span><br><span class=\"line\">b++</span><br></pre></td></tr></table></figure>\n\n<p><code>volatile</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JVM</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// days</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>daysmonthsyears</p>\n<h2 id=\"Volatile-Happens-Before-Guarantee\"><a href=\"#Volatile-Happens-Before-Guarantee\" class=\"headerlink\" title=\"Volatile Happens-Before Guarantee\"></a>Volatile Happens-Before Guarantee</h2><p><code>volatile</code></p>\n<ul>\n<li>/<code>volatile</code></li>\n<li>/<code>volatile</code></li>\n</ul>\n<h1 id=\"Volatile-is-Not-Always-Enough\"><a href=\"#Volatile-is-Not-Always-Enough\" class=\"headerlink\" title=\"Volatile is Not Always Enough\"></a>Volatile is Not Always Enough</h1><p>countercounter<code></code><strong>syncronized</strong><code>lock</code></p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>Java<code>being stored in main memory</code>volatileCPUvolatileCPU</p>","more":"<h1 id=\"Visibility-problems\"><a href=\"#Visibility-problems\" class=\"headerlink\" title=\"Visibility problems\"></a>Visibility problems</h1><p><code>volatile</code>CPUCPUCPUCPU</p>\n<p><code>volatile</code>JavaCPUCPU</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShareObject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>112</p>\n<p>counter<code>volatile</code>CPUcounterCPUJVMVisibility problem<strong></strong></p>\n<h1 id=\"Visibility-Guarantee\"><a href=\"#Visibility-Guarantee\" class=\"headerlink\" title=\"Visibility Guarantee\"></a>Visibility Guarantee</h1><p><code>volatile</code>counter<code>volatile</code><code>volatile</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShareObject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// volatile</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span> ;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>1212<code>volatile</code></p>\n<h2 id=\"Full-Visibility-Guarantee\"><a href=\"#Full-Visibility-Guarantee\" class=\"headerlink\" title=\"Full Visibility Guarantee\"></a>Full Visibility Guarantee</h2><p><code>volatile</code><code>volatile</code></p>\n<ul>\n<li><p>A<code>volatile</code>B<code>volatile</code>AB<code>volatile</code></p>\n</li>\n<li><p>A<code>volatile</code>A</p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// daysvolatile</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = year;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;    </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Full Visibility Guaranteedaysmonthsyears</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">totalDays</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> total = <span class=\"keyword\">this</span>.days;</span><br><span class=\"line\">        total += months * <span class=\"number\">30</span>;</span><br><span class=\"line\">        total += years * <span class=\"number\">365</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> total;   </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>totalDays()<em><code>days</code><code>total</code> ,<code>days</code><code>volatile</code><code>days</code>monthsyears<code>volatile</code><code>volatile</code></em></em>**<code>volatile</code></p>\n<h1 id=\"Instruction-Reordering\"><a href=\"#Instruction-Reordering\" class=\"headerlink\" title=\"Instruction Reordering\"></a>Instruction Reordering</h1><p>JVMCPU</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">2</span>;</span><br><span class=\"line\">a++;</span><br><span class=\"line\">b++;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a  = <span class=\"number\">1</span>;</span><br><span class=\"line\">a++;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">2</span>;</span><br><span class=\"line\">b++</span><br></pre></td></tr></table></figure>\n\n<p><code>volatile</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> years;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> months;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> days;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>JVM</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> years, <span class=\"keyword\">int</span> months, <span class=\"keyword\">int</span> days)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// days</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.days = days;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.years = years;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.months = months;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>daysmonthsyears</p>\n<h2 id=\"Volatile-Happens-Before-Guarantee\"><a href=\"#Volatile-Happens-Before-Guarantee\" class=\"headerlink\" title=\"Volatile Happens-Before Guarantee\"></a>Volatile Happens-Before Guarantee</h2><p><code>volatile</code></p>\n<ul>\n<li>/<code>volatile</code></li>\n<li>/<code>volatile</code></li>\n</ul>\n<h1 id=\"Volatile-is-Not-Always-Enough\"><a href=\"#Volatile-is-Not-Always-Enough\" class=\"headerlink\" title=\"Volatile is Not Always Enough\"></a>Volatile is Not Always Enough</h1><p>countercounter<code></code><strong>syncronized</strong><code>lock</code></p>"},{"title":"jvm concurrency","date":"2021-03-23T15:32:31.000Z","_content":"","source":"_posts/jvm-concurrency.md","raw":"---\ntitle: jvm concurrency\ndate: 2021-03-23 23:32:31\ntags:\n---\n","slug":"jvm-concurrency","published":1,"updated":"2021-03-23T15:32:31.607Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q8d002hw5ihecp5hxja","content":"","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"","more":""},{"title":"jvm classloader","date":"2021-03-23T15:32:02.000Z","_content":"\njava\n\n<!-- more -->\n\n<!-- toc -->\n\n# class\n\nclass\n\n\n\n# classLoader\n\n\n\n# ","source":"_posts/jvm-classloader.md","raw":"---\ntitle: jvm classloader\ndate: 2021-03-23 23:32:02\ncategories: JVM\ntags: classloader\n---\n\njava\n\n<!-- more -->\n\n<!-- toc -->\n\n# class\n\nclass\n\n\n\n# classLoader\n\n\n\n# ","slug":"jvm-classloader","published":1,"updated":"2021-03-23T16:08:43.178Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q8e002kw5ih3cavee9c","content":"<p>java</p>\n<a id=\"more\"></a>\n\n<!-- toc -->\n\n<h1 id=\"class\"><a href=\"#class\" class=\"headerlink\" title=\"class\"></a>class</h1><p>class</p>\n<h1 id=\"classLoader\"><a href=\"#classLoader\" class=\"headerlink\" title=\"classLoader\"></a>classLoader</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>java</p>","more":"<!-- toc -->\n\n<h1 id=\"class\"><a href=\"#class\" class=\"headerlink\" title=\"class\"></a>class</h1><p>class</p>\n<h1 id=\"classLoader\"><a href=\"#classLoader\" class=\"headerlink\" title=\"classLoader\"></a>classLoader</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>"},{"title":"jvm memory-manage","date":"2021-03-23T15:38:15.000Z","_content":"\njvmoomjavajavajvmC++\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\njvmjvm****jvm\n\n\t\tjava**new**InitializeSpring**new**classjvm\n\n\t\tjvmnewnew****2newstar\n\n## \n\n\n\n*Mark Word***GC\n\n********java\n\n> reference ->  ->\n\nreferencejavareferencereference\n\n# \n\n\n\n\n\n**Bump the Pointer****Free List****CAS+****Thread Local Allocation Buffer, TLAB**\n\n# \n\n\t\tjavajavajavajvmjvmG1\n\n\n\n\n\nG1","source":"_posts/jvm-memory-manage.md","raw":"---\ntitle: jvm memory-manage\ndate: 2021-03-23 23:38:15\ncategories: JVM\ntags: memory\n---\n\njvmoomjavajavajvmC++\n\n<!-- more -->\n\n<!-- toc -->\n\n# \n\njvmjvm****jvm\n\n\t\tjava**new**InitializeSpring**new**classjvm\n\n\t\tjvmnewnew****2newstar\n\n## \n\n\n\n*Mark Word***GC\n\n********java\n\n> reference ->  ->\n\nreferencejavareferencereference\n\n# \n\n\n\n\n\n**Bump the Pointer****Free List****CAS+****Thread Local Allocation Buffer, TLAB**\n\n# \n\n\t\tjavajavajavajvmjvmG1\n\n\n\n\n\nG1","slug":"jvm-memory-manage","published":1,"updated":"2021-03-25T16:12:00.978Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q8f002nw5ih51ws5ehk","content":"<p>jvmoomjavajavajvmC++</p>\n<a id=\"more\"></a>\n\n<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jvmjvm<strong></strong>jvm</p>\n<p>        java<strong>new</strong>InitializeSpring<strong>new</strong>classjvm</p>\n<p>        jvmnewnew<strong></strong>2newstar</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p><em>Mark Word</em><em></em>GC</p>\n<p><strong></strong><strong></strong>java</p>\n<blockquote>\n<p>reference -&gt;  -&gt;</p>\n</blockquote>\n<p>referencejavareferencereference</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p><strong>Bump the Pointer</strong><strong>Free List</strong><strong>CAS+</strong><strong>Thread Local Allocation Buffer, TLAB</strong></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        javajavajavajvmjvmG1</p>\n<p></p>\n<p></p>\n<p>G1</p>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>jvmoomjavajavajvmC++</p>","more":"<!-- toc -->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jvmjvm<strong></strong>jvm</p>\n<p>        java<strong>new</strong>InitializeSpring<strong>new</strong>classjvm</p>\n<p>        jvmnewnew<strong></strong>2newstar</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p><em>Mark Word</em><em></em>GC</p>\n<p><strong></strong><strong></strong>java</p>\n<blockquote>\n<p>reference -&gt;  -&gt;</p>\n</blockquote>\n<p>referencejavareferencereference</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p><strong>Bump the Pointer</strong><strong>Free List</strong><strong>CAS+</strong><strong>Thread Local Allocation Buffer, TLAB</strong></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>        javajavajavajvmjvmG1</p>\n<p></p>\n<p></p>\n<p>G1</p>"},{"title":"SpringBoot startup","date":"2021-02-15T05:18:14.000Z","_content":"\nSpringBootSpringBoot\n\n<!--more-->\n\n\t\tSpringBootSpringStruts2SpringBootwebmainproperties/ymlSpringSpringBootIOCAOPweb\n\n<!--toc-->\n\n# \n\n```java\n@SpringBootApplication\npublic class MyApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(MyApplication.class, args);\n    }\n}\n```\n\nSpringBootresources\n\n- @SpringBootApplication\n- SpringApplicationrunclassmainargs\n\nrunrun\n\n- SpringApplication\n- run\n\n\n\n# \n\n```java\npublic SpringApplication(ResourceLoader resourceLoader, Class<?>... primarySources) {\n    // null\n    this.resourceLoader = resourceLoader;\n    Assert.notNull(primarySources, \"PrimarySources must not be null\");\n    // class\n    this.primarySources = new LinkedHashSet<>(Arrays.asList(primarySources));\n    // \n    this.webApplicationType = WebApplicationType.deduceFromClasspath();\n    // \n    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));\n    // \n    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));\n    // \n    this.mainApplicationClass = deduceMainApplicationClass();\n}\n```\n\n\n\n## \n\nSpringBootwebwebSpring\n\nwebSpringBootwebwebclasswebclass\n\n```java\nprivate static final String WEBMVC_INDICATOR_CLASS = \"org.springframework.web.servlet.DispatcherServlet\";\n\n\tprivate static final String WEBFLUX_INDICATOR_CLASS = \"org.springframework.web.reactive.DispatcherHandler\";\n\n\tprivate static final String JERSEY_INDICATOR_CLASS = \"org.glassfish.jersey.servlet.ServletContainer\";\n\nstatic WebApplicationType deduceFromClasspath() {\n    if (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, null) && !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, null)\n        && !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, null)) {\n        return WebApplicationType.REACTIVE;\n    }\n    for (String className : SERVLET_INDICATOR_CLASSES) {\n        if (!ClassUtils.isPresent(className, null)) {\n            return WebApplicationType.NONE;\n        }\n    }\n    return WebApplicationType.SERVLET;\n}\n```\n\n## SPI\n\nSPI\n\n```java\npublic static final String FACTORIES_RESOURCE_LOCATION = \"META-INF/spring.factories\";\n```\n\nSpringBootkey-value`ApplicaitonListener`class\n\n## \n\n```properties\norg.springframework.context.ApplicationListener=\\\norg.springframework.boot.ClearCachesApplicationListener,\\\norg.springframework.boot.builder.ParentContextCloserApplicationListener,\\\norg.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\\norg.springframework.boot.context.FileEncodingApplicationListener,\\\norg.springframework.boot.context.config.AnsiOutputApplicationListener,\\\norg.springframework.boot.context.config.ConfigFileApplicationListener,\\\norg.springframework.boot.context.config.DelegatingApplicationListener,\\\norg.springframework.boot.context.logging.ClasspathLoggingApplicationListener,\\\norg.springframework.boot.context.logging.LoggingApplicationListener,\\\norg.springframework.boot.liquibase.LiquibaseServiceLocatorApplicationListener\n```\n\n*spring.facories*listenerlistenerevent`ClearCachesApplicationListener`\n\nrunList\n\n## \n\n`ApplicationContextInitializer`\n\n```properties\norg.springframework.context.ApplicationContextInitializer=\\\norg.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\\\norg.springframework.boot.context.ContextIdApplicationContextInitializer,\\\norg.springframework.boot.context.config.DelegatingApplicationContextInitializer,\\\norg.springframework.boot.rsocket.context.RSocketPortInfoApplicationContextInitializer,\\\norg.springframework.boot.web.context.ServerPortInfoApplicationContextInitializ\n```\n\ncontextSpring warningsList\n\n# Run\n\nrunrunrun\n\n```java\npublic ConfigurableApplicationContext run(String... args) {\n    StopWatch stopWatch = new StopWatch();\n    stopWatch.start();\n    ConfigurableApplicationContext context = null;\n    Collection<SpringBootExceptionReporter> exceptionReporters = new ArrayList<>();\n    configureHeadlessProperty();\n    // listenerslistener\n    SpringApplicationRunListeners listeners = getRunListeners(args);\n    listeners.starting();\n    try {\n        ApplicationArguments applicationArguments = new DefaultApplicationArguments(args);\n        // \n        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);\n        configureIgnoreBeanInfo(environment);\n        Banner printedBanner = printBanner(environment);\n        // \n        context = createApplicationContext();\n        exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,\n                                                         new Class[] { ConfigurableApplicationContext.class }, context);\n        // \n        prepareContext(context, environment, listeners, applicationArguments, printedBanner);\n        // \n        refreshContext(context);\n        afterRefresh(context, applicationArguments);\n        stopWatch.stop();\n        if (this.logStartupInfo) {\n            new StartupInfoLogger(this.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);\n        }\n        listeners.started(context);\n        callRunners(context, applicationArguments);\n    }\n    catch (Throwable ex) {\n        handleRunFailure(context, ex, exceptionReporters, listeners);\n        throw new IllegalStateException(ex);\n    }\n\n    try {\n        listeners.running(context);\n    }\n    catch (Throwable ex) {\n        handleRunFailure(context, ex, exceptionReporters, null);\n        throw new IllegalStateException(ex);\n    }\n    return context;\n}\n```\n\n\n\n## RunListeners\n\n`SpringApplicaitonRunListeners`listener\n\n```java\nprivate SpringApplicationRunListeners getRunListeners(String[] args) {\n    Class<?>[] types = new Class<?>[] { SpringApplication.class, String[].class };\n    return new SpringApplicationRunListeners(logger,\n                                             getSpringFactoriesInstances(SpringApplicationRunListener.class, types, this, args));\n}\n```\n\n`EventPublishingRunListener``SpringApplicationRunListeners``EventPublishingRunListener`runlisteners`EventPublishingRunListenr`listeners\n\n`EventPublishingRunListener``SimpleApplicationEventMulticaster`\n\n```java\n@Override\npublic void starting() {\n    this.initialMulticaster.multicastEvent(new ApplicationStartingEvent(this.application, this.args));\n}\n```\n\n`this.application``SpringApplication``SpringApplication`getlistenerseventlistener\n\n## createApplicationContext\n\n```java\n\tpublic static final String DEFAULT_CONTEXT_CLASS = \"org.springframework.context.\"\n\t\t\t+ \"annotation.AnnotationConfigApplicationContext\";\n\n\tpublic static final String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = \"org.springframework.boot.\"\n\t\t\t+ \"web.servlet.context.AnnotationConfigServletWebServerApplicationContext\";\n\n\tpublic static final String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = \"org.springframework.\"\n\t\t\t+ \"boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext\";\n\nprotected ConfigurableApplicationContext createApplicationContext() {\n    Class<?> contextClass = this.applicationContextClass;\n    if (contextClass == null) {\n        try {\n            switch (this.webApplicationType) {\n                case SERVLET:\n                    contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);\n                    break;\n                case REACTIVE:\n                    contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);\n                    break;\n                default:\n                    contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);\n            }\n        }\n        catch (ClassNotFoundException ex) {\n            throw new IllegalStateException(\n                \"Unable create a default ApplicationContext, please specify an ApplicationContextClass\", ex);\n        }\n    }\n    return (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);\n}\n```\n\n\n\n## prepareContext\n\n\n\n```java\nprivate void prepareContext(ConfigurableApplicationContext context, ConfigurableEnvironment environment,\n                            SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner) {\n    context.setEnvironment(environment);\n    // \n    postProcessApplicationContext(context);\n    // \n    applyInitializers(context);\n    listeners.contextPrepared(context);\n    if (this.logStartupInfo) {\n        logStartupInfo(context.getParent() == null);\n        logStartupProfileInfo(context);\n    }\n    // Add boot specific singleton beans\n    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();\n    beanFactory.registerSingleton(\"springApplicationArguments\", applicationArguments);\n    if (printedBanner != null) {\n        beanFactory.registerSingleton(\"springBootBanner\", printedBanner);\n    }\n    if (beanFactory instanceof DefaultListableBeanFactory) {\n        ((DefaultListableBeanFactory) beanFactory)\n        .setAllowBeanDefinitionOverriding(this.allowBeanDefinitionOverriding);\n    }\n    if (this.lazyInitialization) {\n        context.addBeanFactoryPostProcessor(new LazyInitializationBeanFactoryPostProcessor());\n    }\n    // Load the sources\n    Set<Object> sources = getAllSources();\n    Assert.notEmpty(sources, \"Sources must not be empty\");\n    // BeanDefinitionLoader\n    load(context, sources.toArray(new Object[0]));\n    listeners.contextLoaded(context);\n}\n```\n\nlisteners*contextPrepared**contextLoaded*bean\n\n### contextPrepared\n\n\n\n#### postProcess\n\n```java\nprotected void postProcessApplicationContext(ConfigurableApplicationContext context) {\n    if (this.beanNameGenerator != null) {\n        // bean\n        context.getBeanFactory().registerSingleton(AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR,\n                                                   this.beanNameGenerator);\n    }\n    if (this.resourceLoader != null) {\n        if (context instanceof GenericApplicationContext) {\n            ((GenericApplicationContext) context).setResourceLoader(this.resourceLoader);\n        }\n        if (context instanceof DefaultResourceLoader) {\n            ((DefaultResourceLoader) context).setClassLoader(this.resourceLoader.getClassLoader());\n        }\n    }\n    if (this.addConversionService) {\n        context.getBeanFactory().setConversionService(ApplicationConversionService.getSharedInstance());\n    }\n}\n```\n\n`beanNameGenerator`\n\n#### applyInitializers\n\n```java\nprotected void applyInitializers(ConfigurableApplicationContext context) {\n    for (ApplicationContextInitializer initializer : getInitializers()) {\n        Class<?> requiredType = GenericTypeResolver.resolveTypeArgument(initializer.getClass(),\n                                                                        ApplicationContextInitializer.class);\n        Assert.isInstanceOf(requiredType, context, \"Unable to call initializer.\");\n        initializer.initialize(context);\n    }\n}\n```\n\n\n\n### contextLoaded\n\n`BeanDefinitionLoader`xmljavaConfigbean\n\n```java\nprotected void load(ApplicationContext context, Object[] sources) {\n    if (logger.isDebugEnabled()) {\n        logger.debug(\"Loading source \" + StringUtils.arrayToCommaDelimitedString(sources));\n    }\n    BeanDefinitionLoader loader = createBeanDefinitionLoader(getBeanDefinitionRegistry(context), sources);\n    if (this.beanNameGenerator != null) {\n        loader.setBeanNameGenerator(this.beanNameGenerator);\n    }\n    if (this.resourceLoader != null) {\n        loader.setResourceLoader(this.resourceLoader);\n    }\n    if (this.environment != null) {\n        loader.setEnvironment(this.environment);\n    }\n    loader.load();\n}\n```\n\n\n\n# \n\nSpringBoot\n\n- \n- \n- ","source":"_posts/SpringBoot-startup.md","raw":"---\ntitle: SpringBoot startup\ndate: 2021-02-15 13:18:14\ncategories: springboot\ntags: source\n---\n\nSpringBootSpringBoot\n\n<!--more-->\n\n\t\tSpringBootSpringStruts2SpringBootwebmainproperties/ymlSpringSpringBootIOCAOPweb\n\n<!--toc-->\n\n# \n\n```java\n@SpringBootApplication\npublic class MyApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(MyApplication.class, args);\n    }\n}\n```\n\nSpringBootresources\n\n- @SpringBootApplication\n- SpringApplicationrunclassmainargs\n\nrunrun\n\n- SpringApplication\n- run\n\n\n\n# \n\n```java\npublic SpringApplication(ResourceLoader resourceLoader, Class<?>... primarySources) {\n    // null\n    this.resourceLoader = resourceLoader;\n    Assert.notNull(primarySources, \"PrimarySources must not be null\");\n    // class\n    this.primarySources = new LinkedHashSet<>(Arrays.asList(primarySources));\n    // \n    this.webApplicationType = WebApplicationType.deduceFromClasspath();\n    // \n    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));\n    // \n    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));\n    // \n    this.mainApplicationClass = deduceMainApplicationClass();\n}\n```\n\n\n\n## \n\nSpringBootwebwebSpring\n\nwebSpringBootwebwebclasswebclass\n\n```java\nprivate static final String WEBMVC_INDICATOR_CLASS = \"org.springframework.web.servlet.DispatcherServlet\";\n\n\tprivate static final String WEBFLUX_INDICATOR_CLASS = \"org.springframework.web.reactive.DispatcherHandler\";\n\n\tprivate static final String JERSEY_INDICATOR_CLASS = \"org.glassfish.jersey.servlet.ServletContainer\";\n\nstatic WebApplicationType deduceFromClasspath() {\n    if (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, null) && !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, null)\n        && !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, null)) {\n        return WebApplicationType.REACTIVE;\n    }\n    for (String className : SERVLET_INDICATOR_CLASSES) {\n        if (!ClassUtils.isPresent(className, null)) {\n            return WebApplicationType.NONE;\n        }\n    }\n    return WebApplicationType.SERVLET;\n}\n```\n\n## SPI\n\nSPI\n\n```java\npublic static final String FACTORIES_RESOURCE_LOCATION = \"META-INF/spring.factories\";\n```\n\nSpringBootkey-value`ApplicaitonListener`class\n\n## \n\n```properties\norg.springframework.context.ApplicationListener=\\\norg.springframework.boot.ClearCachesApplicationListener,\\\norg.springframework.boot.builder.ParentContextCloserApplicationListener,\\\norg.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\\norg.springframework.boot.context.FileEncodingApplicationListener,\\\norg.springframework.boot.context.config.AnsiOutputApplicationListener,\\\norg.springframework.boot.context.config.ConfigFileApplicationListener,\\\norg.springframework.boot.context.config.DelegatingApplicationListener,\\\norg.springframework.boot.context.logging.ClasspathLoggingApplicationListener,\\\norg.springframework.boot.context.logging.LoggingApplicationListener,\\\norg.springframework.boot.liquibase.LiquibaseServiceLocatorApplicationListener\n```\n\n*spring.facories*listenerlistenerevent`ClearCachesApplicationListener`\n\nrunList\n\n## \n\n`ApplicationContextInitializer`\n\n```properties\norg.springframework.context.ApplicationContextInitializer=\\\norg.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\\\norg.springframework.boot.context.ContextIdApplicationContextInitializer,\\\norg.springframework.boot.context.config.DelegatingApplicationContextInitializer,\\\norg.springframework.boot.rsocket.context.RSocketPortInfoApplicationContextInitializer,\\\norg.springframework.boot.web.context.ServerPortInfoApplicationContextInitializ\n```\n\ncontextSpring warningsList\n\n# Run\n\nrunrunrun\n\n```java\npublic ConfigurableApplicationContext run(String... args) {\n    StopWatch stopWatch = new StopWatch();\n    stopWatch.start();\n    ConfigurableApplicationContext context = null;\n    Collection<SpringBootExceptionReporter> exceptionReporters = new ArrayList<>();\n    configureHeadlessProperty();\n    // listenerslistener\n    SpringApplicationRunListeners listeners = getRunListeners(args);\n    listeners.starting();\n    try {\n        ApplicationArguments applicationArguments = new DefaultApplicationArguments(args);\n        // \n        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);\n        configureIgnoreBeanInfo(environment);\n        Banner printedBanner = printBanner(environment);\n        // \n        context = createApplicationContext();\n        exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,\n                                                         new Class[] { ConfigurableApplicationContext.class }, context);\n        // \n        prepareContext(context, environment, listeners, applicationArguments, printedBanner);\n        // \n        refreshContext(context);\n        afterRefresh(context, applicationArguments);\n        stopWatch.stop();\n        if (this.logStartupInfo) {\n            new StartupInfoLogger(this.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);\n        }\n        listeners.started(context);\n        callRunners(context, applicationArguments);\n    }\n    catch (Throwable ex) {\n        handleRunFailure(context, ex, exceptionReporters, listeners);\n        throw new IllegalStateException(ex);\n    }\n\n    try {\n        listeners.running(context);\n    }\n    catch (Throwable ex) {\n        handleRunFailure(context, ex, exceptionReporters, null);\n        throw new IllegalStateException(ex);\n    }\n    return context;\n}\n```\n\n\n\n## RunListeners\n\n`SpringApplicaitonRunListeners`listener\n\n```java\nprivate SpringApplicationRunListeners getRunListeners(String[] args) {\n    Class<?>[] types = new Class<?>[] { SpringApplication.class, String[].class };\n    return new SpringApplicationRunListeners(logger,\n                                             getSpringFactoriesInstances(SpringApplicationRunListener.class, types, this, args));\n}\n```\n\n`EventPublishingRunListener``SpringApplicationRunListeners``EventPublishingRunListener`runlisteners`EventPublishingRunListenr`listeners\n\n`EventPublishingRunListener``SimpleApplicationEventMulticaster`\n\n```java\n@Override\npublic void starting() {\n    this.initialMulticaster.multicastEvent(new ApplicationStartingEvent(this.application, this.args));\n}\n```\n\n`this.application``SpringApplication``SpringApplication`getlistenerseventlistener\n\n## createApplicationContext\n\n```java\n\tpublic static final String DEFAULT_CONTEXT_CLASS = \"org.springframework.context.\"\n\t\t\t+ \"annotation.AnnotationConfigApplicationContext\";\n\n\tpublic static final String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = \"org.springframework.boot.\"\n\t\t\t+ \"web.servlet.context.AnnotationConfigServletWebServerApplicationContext\";\n\n\tpublic static final String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = \"org.springframework.\"\n\t\t\t+ \"boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext\";\n\nprotected ConfigurableApplicationContext createApplicationContext() {\n    Class<?> contextClass = this.applicationContextClass;\n    if (contextClass == null) {\n        try {\n            switch (this.webApplicationType) {\n                case SERVLET:\n                    contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);\n                    break;\n                case REACTIVE:\n                    contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);\n                    break;\n                default:\n                    contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);\n            }\n        }\n        catch (ClassNotFoundException ex) {\n            throw new IllegalStateException(\n                \"Unable create a default ApplicationContext, please specify an ApplicationContextClass\", ex);\n        }\n    }\n    return (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);\n}\n```\n\n\n\n## prepareContext\n\n\n\n```java\nprivate void prepareContext(ConfigurableApplicationContext context, ConfigurableEnvironment environment,\n                            SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner) {\n    context.setEnvironment(environment);\n    // \n    postProcessApplicationContext(context);\n    // \n    applyInitializers(context);\n    listeners.contextPrepared(context);\n    if (this.logStartupInfo) {\n        logStartupInfo(context.getParent() == null);\n        logStartupProfileInfo(context);\n    }\n    // Add boot specific singleton beans\n    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();\n    beanFactory.registerSingleton(\"springApplicationArguments\", applicationArguments);\n    if (printedBanner != null) {\n        beanFactory.registerSingleton(\"springBootBanner\", printedBanner);\n    }\n    if (beanFactory instanceof DefaultListableBeanFactory) {\n        ((DefaultListableBeanFactory) beanFactory)\n        .setAllowBeanDefinitionOverriding(this.allowBeanDefinitionOverriding);\n    }\n    if (this.lazyInitialization) {\n        context.addBeanFactoryPostProcessor(new LazyInitializationBeanFactoryPostProcessor());\n    }\n    // Load the sources\n    Set<Object> sources = getAllSources();\n    Assert.notEmpty(sources, \"Sources must not be empty\");\n    // BeanDefinitionLoader\n    load(context, sources.toArray(new Object[0]));\n    listeners.contextLoaded(context);\n}\n```\n\nlisteners*contextPrepared**contextLoaded*bean\n\n### contextPrepared\n\n\n\n#### postProcess\n\n```java\nprotected void postProcessApplicationContext(ConfigurableApplicationContext context) {\n    if (this.beanNameGenerator != null) {\n        // bean\n        context.getBeanFactory().registerSingleton(AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR,\n                                                   this.beanNameGenerator);\n    }\n    if (this.resourceLoader != null) {\n        if (context instanceof GenericApplicationContext) {\n            ((GenericApplicationContext) context).setResourceLoader(this.resourceLoader);\n        }\n        if (context instanceof DefaultResourceLoader) {\n            ((DefaultResourceLoader) context).setClassLoader(this.resourceLoader.getClassLoader());\n        }\n    }\n    if (this.addConversionService) {\n        context.getBeanFactory().setConversionService(ApplicationConversionService.getSharedInstance());\n    }\n}\n```\n\n`beanNameGenerator`\n\n#### applyInitializers\n\n```java\nprotected void applyInitializers(ConfigurableApplicationContext context) {\n    for (ApplicationContextInitializer initializer : getInitializers()) {\n        Class<?> requiredType = GenericTypeResolver.resolveTypeArgument(initializer.getClass(),\n                                                                        ApplicationContextInitializer.class);\n        Assert.isInstanceOf(requiredType, context, \"Unable to call initializer.\");\n        initializer.initialize(context);\n    }\n}\n```\n\n\n\n### contextLoaded\n\n`BeanDefinitionLoader`xmljavaConfigbean\n\n```java\nprotected void load(ApplicationContext context, Object[] sources) {\n    if (logger.isDebugEnabled()) {\n        logger.debug(\"Loading source \" + StringUtils.arrayToCommaDelimitedString(sources));\n    }\n    BeanDefinitionLoader loader = createBeanDefinitionLoader(getBeanDefinitionRegistry(context), sources);\n    if (this.beanNameGenerator != null) {\n        loader.setBeanNameGenerator(this.beanNameGenerator);\n    }\n    if (this.resourceLoader != null) {\n        loader.setResourceLoader(this.resourceLoader);\n    }\n    if (this.environment != null) {\n        loader.setEnvironment(this.environment);\n    }\n    loader.load();\n}\n```\n\n\n\n# \n\nSpringBoot\n\n- \n- \n- ","slug":"SpringBoot-startup","published":1,"updated":"2021-02-17T04:26:57.895Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q920040w5ih87kh5m6w","content":"<p>SpringBootSpringBoot</p>\n<a id=\"more\"></a>\n\n<p>        SpringBootSpringStruts2SpringBootwebmainproperties/ymlSpringSpringBootIOCAOPweb</p>\n<!--toc-->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyApplication</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SpringBootresources</p>\n<ul>\n<li>@SpringBootApplication</li>\n<li>SpringApplicationrunclassmainargs</li>\n</ul>\n<p>runrun</p>\n<ul>\n<li>SpringApplication</li>\n<li>run</li>\n</ul>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SpringApplication</span><span class=\"params\">(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.resourceLoader = resourceLoader;</span><br><span class=\"line\">    Assert.notNull(primarySources, <span class=\"string\">&quot;PrimarySources must not be null&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// class</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.primarySources = <span class=\"keyword\">new</span> LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.webApplicationType = WebApplicationType.deduceFromClasspath();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.mainApplicationClass = deduceMainApplicationClass();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SpringBootwebwebSpring</p>\n<p>webSpringBootwebwebclasswebclass</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String WEBMVC_INDICATOR_CLASS = <span class=\"string\">&quot;org.springframework.web.servlet.DispatcherServlet&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String WEBFLUX_INDICATOR_CLASS = <span class=\"string\">&quot;org.springframework.web.reactive.DispatcherHandler&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String JERSEY_INDICATOR_CLASS = <span class=\"string\">&quot;org.glassfish.jersey.servlet.ServletContainer&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> WebApplicationType <span class=\"title\">deduceFromClasspath</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, <span class=\"keyword\">null</span>) &amp;&amp; !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        &amp;&amp; !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> WebApplicationType.REACTIVE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String className : SERVLET_INDICATOR_CLASSES) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!ClassUtils.isPresent(className, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> WebApplicationType.NONE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> WebApplicationType.SERVLET;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SPI\"><a href=\"#SPI\" class=\"headerlink\" title=\"SPI\"></a>SPI</h2><p>SPI</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String FACTORIES_RESOURCE_LOCATION = <span class=\"string\">&quot;META-INF/spring.factories&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>SpringBootkey-value<code>ApplicaitonListener</code>class</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.context.ApplicationListener</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.springframework.boot.ClearCachesApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.builder.ParentContextCloserApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\</span><br><span class=\"line\">org.springframework.boot.context.FileEncodingApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.config.AnsiOutputApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.config.ConfigFileApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.config.DelegatingApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.logging.ClasspathLoggingApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.logging.LoggingApplicationListener,\\</span><br><span class=\"line\"><span class=\"attr\">org.springframework.boot.liquibase.LiquibaseServiceLocatorApplicationListener</span></span><br></pre></td></tr></table></figure>\n\n<p><em>spring.facories</em>listenerlistenerevent<code>ClearCachesApplicationListener</code></p>\n<p>runList</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>ApplicationContextInitializer</code></p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.context.ApplicationContextInitializer</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\\</span><br><span class=\"line\">org.springframework.boot.context.ContextIdApplicationContextInitializer,\\</span><br><span class=\"line\">org.springframework.boot.context.config.DelegatingApplicationContextInitializer,\\</span><br><span class=\"line\">org.springframework.boot.rsocket.context.RSocketPortInfoApplicationContextInitializer,\\</span><br><span class=\"line\"><span class=\"attr\">org.springframework.boot.web.context.ServerPortInfoApplicationContextInitializ</span></span><br></pre></td></tr></table></figure>\n\n<p>contextSpring warningsList</p>\n<h1 id=\"Run\"><a href=\"#Run\" class=\"headerlink\" title=\"Run\"></a>Run</h1><p>runrunrun</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ConfigurableApplicationContext <span class=\"title\">run</span><span class=\"params\">(String... args)</span> </span>&#123;</span><br><span class=\"line\">    StopWatch stopWatch = <span class=\"keyword\">new</span> StopWatch();</span><br><span class=\"line\">    stopWatch.start();</span><br><span class=\"line\">    ConfigurableApplicationContext context = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    configureHeadlessProperty();</span><br><span class=\"line\">    <span class=\"comment\">// listenerslistener</span></span><br><span class=\"line\">    SpringApplicationRunListeners listeners = getRunListeners(args);</span><br><span class=\"line\">    listeners.starting();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        ApplicationArguments applicationArguments = <span class=\"keyword\">new</span> DefaultApplicationArguments(args);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);</span><br><span class=\"line\">        configureIgnoreBeanInfo(environment);</span><br><span class=\"line\">        Banner printedBanner = printBanner(environment);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        context = createApplicationContext();</span><br><span class=\"line\">        exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,</span><br><span class=\"line\">                                                         <span class=\"keyword\">new</span> Class[] &#123; ConfigurableApplicationContext.class &#125;, context);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        prepareContext(context, environment, listeners, applicationArguments, printedBanner);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        refreshContext(context);</span><br><span class=\"line\">        afterRefresh(context, applicationArguments);</span><br><span class=\"line\">        stopWatch.stop();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.logStartupInfo) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> StartupInfoLogger(<span class=\"keyword\">this</span>.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        listeners.started(context);</span><br><span class=\"line\">        callRunners(context, applicationArguments);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        handleRunFailure(context, ex, exceptionReporters, listeners);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        listeners.running(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        handleRunFailure(context, ex, exceptionReporters, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> context;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"RunListeners\"><a href=\"#RunListeners\" class=\"headerlink\" title=\"RunListeners\"></a>RunListeners</h2><p><code>SpringApplicaitonRunListeners</code>listener</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> SpringApplicationRunListeners <span class=\"title\">getRunListeners</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    Class&lt;?&gt;[] types = <span class=\"keyword\">new</span> Class&lt;?&gt;[] &#123; SpringApplication.class, String[].class &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> SpringApplicationRunListeners(logger,</span><br><span class=\"line\">                                             getSpringFactoriesInstances(SpringApplicationRunListener.class, types, <span class=\"keyword\">this</span>, args));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>EventPublishingRunListener</code><code>SpringApplicationRunListeners</code><code>EventPublishingRunListener</code>runlisteners<code>EventPublishingRunListenr</code>listeners</p>\n<p><code>EventPublishingRunListener</code><code>SimpleApplicationEventMulticaster</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">starting</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.initialMulticaster.multicastEvent(<span class=\"keyword\">new</span> ApplicationStartingEvent(<span class=\"keyword\">this</span>.application, <span class=\"keyword\">this</span>.args));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>this.application</code><code>SpringApplication</code><code>SpringApplication</code>getlistenerseventlistener</p>\n<h2 id=\"createApplicationContext\"><a href=\"#createApplicationContext\" class=\"headerlink\" title=\"createApplicationContext\"></a>createApplicationContext</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.context.&quot;</span></span><br><span class=\"line\">\t\t\t+ <span class=\"string\">&quot;annotation.AnnotationConfigApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.boot.&quot;</span></span><br><span class=\"line\">\t\t\t+ <span class=\"string\">&quot;web.servlet.context.AnnotationConfigServletWebServerApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.&quot;</span></span><br><span class=\"line\">\t\t\t+ <span class=\"string\">&quot;boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> ConfigurableApplicationContext <span class=\"title\">createApplicationContext</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    Class&lt;?&gt; contextClass = <span class=\"keyword\">this</span>.applicationContextClass;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (contextClass == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">switch</span> (<span class=\"keyword\">this</span>.webApplicationType) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> SERVLET:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> REACTIVE:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (ClassNotFoundException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(</span><br><span class=\"line\">                <span class=\"string\">&quot;Unable create a default ApplicationContext, please specify an ApplicationContextClass&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"prepareContext\"><a href=\"#prepareContext\" class=\"headerlink\" title=\"prepareContext\"></a>prepareContext</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">prepareContext</span><span class=\"params\">(ConfigurableApplicationContext context, ConfigurableEnvironment environment,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                            SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner)</span> </span>&#123;</span><br><span class=\"line\">    context.setEnvironment(environment);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    postProcessApplicationContext(context);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    applyInitializers(context);</span><br><span class=\"line\">    listeners.contextPrepared(context);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.logStartupInfo) &#123;</span><br><span class=\"line\">        logStartupInfo(context.getParent() == <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        logStartupProfileInfo(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Add boot specific singleton beans</span></span><br><span class=\"line\">    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();</span><br><span class=\"line\">    beanFactory.registerSingleton(<span class=\"string\">&quot;springApplicationArguments&quot;</span>, applicationArguments);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (printedBanner != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        beanFactory.registerSingleton(<span class=\"string\">&quot;springBootBanner&quot;</span>, printedBanner);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanFactory <span class=\"keyword\">instanceof</span> DefaultListableBeanFactory) &#123;</span><br><span class=\"line\">        ((DefaultListableBeanFactory) beanFactory)</span><br><span class=\"line\">        .setAllowBeanDefinitionOverriding(<span class=\"keyword\">this</span>.allowBeanDefinitionOverriding);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.lazyInitialization) &#123;</span><br><span class=\"line\">        context.addBeanFactoryPostProcessor(<span class=\"keyword\">new</span> LazyInitializationBeanFactoryPostProcessor());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Load the sources</span></span><br><span class=\"line\">    Set&lt;Object&gt; sources = getAllSources();</span><br><span class=\"line\">    Assert.notEmpty(sources, <span class=\"string\">&quot;Sources must not be empty&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// BeanDefinitionLoader</span></span><br><span class=\"line\">    load(context, sources.toArray(<span class=\"keyword\">new</span> Object[<span class=\"number\">0</span>]));</span><br><span class=\"line\">    listeners.contextLoaded(context);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>listeners<em>contextPrepared</em><em>contextLoaded</em>bean</p>\n<h3 id=\"contextPrepared\"><a href=\"#contextPrepared\" class=\"headerlink\" title=\"contextPrepared\"></a>contextPrepared</h3><p></p>\n<h4 id=\"postProcess\"><a href=\"#postProcess\" class=\"headerlink\" title=\"postProcess\"></a>postProcess</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">postProcessApplicationContext</span><span class=\"params\">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.beanNameGenerator != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// bean</span></span><br><span class=\"line\">        context.getBeanFactory().registerSingleton(AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR,</span><br><span class=\"line\">                                                   <span class=\"keyword\">this</span>.beanNameGenerator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.resourceLoader != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context <span class=\"keyword\">instanceof</span> GenericApplicationContext) &#123;</span><br><span class=\"line\">            ((GenericApplicationContext) context).setResourceLoader(<span class=\"keyword\">this</span>.resourceLoader);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context <span class=\"keyword\">instanceof</span> DefaultResourceLoader) &#123;</span><br><span class=\"line\">            ((DefaultResourceLoader) context).setClassLoader(<span class=\"keyword\">this</span>.resourceLoader.getClassLoader());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.addConversionService) &#123;</span><br><span class=\"line\">        context.getBeanFactory().setConversionService(ApplicationConversionService.getSharedInstance());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>beanNameGenerator</code></p>\n<h4 id=\"applyInitializers\"><a href=\"#applyInitializers\" class=\"headerlink\" title=\"applyInitializers\"></a>applyInitializers</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">applyInitializers</span><span class=\"params\">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ApplicationContextInitializer initializer : getInitializers()) &#123;</span><br><span class=\"line\">        Class&lt;?&gt; requiredType = GenericTypeResolver.resolveTypeArgument(initializer.getClass(),</span><br><span class=\"line\">                                                                        ApplicationContextInitializer.class);</span><br><span class=\"line\">        Assert.isInstanceOf(requiredType, context, <span class=\"string\">&quot;Unable to call initializer.&quot;</span>);</span><br><span class=\"line\">        initializer.initialize(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"contextLoaded\"><a href=\"#contextLoaded\" class=\"headerlink\" title=\"contextLoaded\"></a>contextLoaded</h3><p><code>BeanDefinitionLoader</code>xmljavaConfigbean</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">load</span><span class=\"params\">(ApplicationContext context, Object[] sources)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class=\"line\">        logger.debug(<span class=\"string\">&quot;Loading source &quot;</span> + StringUtils.arrayToCommaDelimitedString(sources));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    BeanDefinitionLoader loader = createBeanDefinitionLoader(getBeanDefinitionRegistry(context), sources);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.beanNameGenerator != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setBeanNameGenerator(<span class=\"keyword\">this</span>.beanNameGenerator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.resourceLoader != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setResourceLoader(<span class=\"keyword\">this</span>.resourceLoader);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.environment != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setEnvironment(<span class=\"keyword\">this</span>.environment);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    loader.load();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringBoot</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>SpringBootSpringBoot</p>","more":"<p>        SpringBootSpringStruts2SpringBootwebmainproperties/ymlSpringSpringBootIOCAOPweb</p>\n<!--toc-->\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyApplication</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SpringBootresources</p>\n<ul>\n<li>@SpringBootApplication</li>\n<li>SpringApplicationrunclassmainargs</li>\n</ul>\n<p>runrun</p>\n<ul>\n<li>SpringApplication</li>\n<li>run</li>\n</ul>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SpringApplication</span><span class=\"params\">(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// null</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.resourceLoader = resourceLoader;</span><br><span class=\"line\">    Assert.notNull(primarySources, <span class=\"string\">&quot;PrimarySources must not be null&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// class</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.primarySources = <span class=\"keyword\">new</span> LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.webApplicationType = WebApplicationType.deduceFromClasspath();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.mainApplicationClass = deduceMainApplicationClass();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SpringBootwebwebSpring</p>\n<p>webSpringBootwebwebclasswebclass</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String WEBMVC_INDICATOR_CLASS = <span class=\"string\">&quot;org.springframework.web.servlet.DispatcherServlet&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String WEBFLUX_INDICATOR_CLASS = <span class=\"string\">&quot;org.springframework.web.reactive.DispatcherHandler&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String JERSEY_INDICATOR_CLASS = <span class=\"string\">&quot;org.glassfish.jersey.servlet.ServletContainer&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> WebApplicationType <span class=\"title\">deduceFromClasspath</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, <span class=\"keyword\">null</span>) &amp;&amp; !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        &amp;&amp; !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> WebApplicationType.REACTIVE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String className : SERVLET_INDICATOR_CLASSES) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!ClassUtils.isPresent(className, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> WebApplicationType.NONE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> WebApplicationType.SERVLET;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SPI\"><a href=\"#SPI\" class=\"headerlink\" title=\"SPI\"></a>SPI</h2><p>SPI</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String FACTORIES_RESOURCE_LOCATION = <span class=\"string\">&quot;META-INF/spring.factories&quot;</span>;</span><br></pre></td></tr></table></figure>\n\n<p>SpringBootkey-value<code>ApplicaitonListener</code>class</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.context.ApplicationListener</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.springframework.boot.ClearCachesApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.builder.ParentContextCloserApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\\</span><br><span class=\"line\">org.springframework.boot.context.FileEncodingApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.config.AnsiOutputApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.config.ConfigFileApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.config.DelegatingApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.logging.ClasspathLoggingApplicationListener,\\</span><br><span class=\"line\">org.springframework.boot.context.logging.LoggingApplicationListener,\\</span><br><span class=\"line\"><span class=\"attr\">org.springframework.boot.liquibase.LiquibaseServiceLocatorApplicationListener</span></span><br></pre></td></tr></table></figure>\n\n<p><em>spring.facories</em>listenerlistenerevent<code>ClearCachesApplicationListener</code></p>\n<p>runList</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>ApplicationContextInitializer</code></p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">org.springframework.context.ApplicationContextInitializer</span>=<span class=\"string\">\\</span></span><br><span class=\"line\">org.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\\</span><br><span class=\"line\">org.springframework.boot.context.ContextIdApplicationContextInitializer,\\</span><br><span class=\"line\">org.springframework.boot.context.config.DelegatingApplicationContextInitializer,\\</span><br><span class=\"line\">org.springframework.boot.rsocket.context.RSocketPortInfoApplicationContextInitializer,\\</span><br><span class=\"line\"><span class=\"attr\">org.springframework.boot.web.context.ServerPortInfoApplicationContextInitializ</span></span><br></pre></td></tr></table></figure>\n\n<p>contextSpring warningsList</p>\n<h1 id=\"Run\"><a href=\"#Run\" class=\"headerlink\" title=\"Run\"></a>Run</h1><p>runrunrun</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ConfigurableApplicationContext <span class=\"title\">run</span><span class=\"params\">(String... args)</span> </span>&#123;</span><br><span class=\"line\">    StopWatch stopWatch = <span class=\"keyword\">new</span> StopWatch();</span><br><span class=\"line\">    stopWatch.start();</span><br><span class=\"line\">    ConfigurableApplicationContext context = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    configureHeadlessProperty();</span><br><span class=\"line\">    <span class=\"comment\">// listenerslistener</span></span><br><span class=\"line\">    SpringApplicationRunListeners listeners = getRunListeners(args);</span><br><span class=\"line\">    listeners.starting();</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        ApplicationArguments applicationArguments = <span class=\"keyword\">new</span> DefaultApplicationArguments(args);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);</span><br><span class=\"line\">        configureIgnoreBeanInfo(environment);</span><br><span class=\"line\">        Banner printedBanner = printBanner(environment);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        context = createApplicationContext();</span><br><span class=\"line\">        exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,</span><br><span class=\"line\">                                                         <span class=\"keyword\">new</span> Class[] &#123; ConfigurableApplicationContext.class &#125;, context);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        prepareContext(context, environment, listeners, applicationArguments, printedBanner);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        refreshContext(context);</span><br><span class=\"line\">        afterRefresh(context, applicationArguments);</span><br><span class=\"line\">        stopWatch.stop();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.logStartupInfo) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> StartupInfoLogger(<span class=\"keyword\">this</span>.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        listeners.started(context);</span><br><span class=\"line\">        callRunners(context, applicationArguments);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        handleRunFailure(context, ex, exceptionReporters, listeners);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        listeners.running(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">        handleRunFailure(context, ex, exceptionReporters, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(ex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> context;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"RunListeners\"><a href=\"#RunListeners\" class=\"headerlink\" title=\"RunListeners\"></a>RunListeners</h2><p><code>SpringApplicaitonRunListeners</code>listener</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> SpringApplicationRunListeners <span class=\"title\">getRunListeners</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    Class&lt;?&gt;[] types = <span class=\"keyword\">new</span> Class&lt;?&gt;[] &#123; SpringApplication.class, String[].class &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> SpringApplicationRunListeners(logger,</span><br><span class=\"line\">                                             getSpringFactoriesInstances(SpringApplicationRunListener.class, types, <span class=\"keyword\">this</span>, args));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>EventPublishingRunListener</code><code>SpringApplicationRunListeners</code><code>EventPublishingRunListener</code>runlisteners<code>EventPublishingRunListenr</code>listeners</p>\n<p><code>EventPublishingRunListener</code><code>SimpleApplicationEventMulticaster</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">starting</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.initialMulticaster.multicastEvent(<span class=\"keyword\">new</span> ApplicationStartingEvent(<span class=\"keyword\">this</span>.application, <span class=\"keyword\">this</span>.args));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>this.application</code><code>SpringApplication</code><code>SpringApplication</code>getlistenerseventlistener</p>\n<h2 id=\"createApplicationContext\"><a href=\"#createApplicationContext\" class=\"headerlink\" title=\"createApplicationContext\"></a>createApplicationContext</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.context.&quot;</span></span><br><span class=\"line\">\t\t\t+ <span class=\"string\">&quot;annotation.AnnotationConfigApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.boot.&quot;</span></span><br><span class=\"line\">\t\t\t+ <span class=\"string\">&quot;web.servlet.context.AnnotationConfigServletWebServerApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = <span class=\"string\">&quot;org.springframework.&quot;</span></span><br><span class=\"line\">\t\t\t+ <span class=\"string\">&quot;boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> ConfigurableApplicationContext <span class=\"title\">createApplicationContext</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    Class&lt;?&gt; contextClass = <span class=\"keyword\">this</span>.applicationContextClass;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (contextClass == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">switch</span> (<span class=\"keyword\">this</span>.webApplicationType) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> SERVLET:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> REACTIVE:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                    contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (ClassNotFoundException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalStateException(</span><br><span class=\"line\">                <span class=\"string\">&quot;Unable create a default ApplicationContext, please specify an ApplicationContextClass&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"prepareContext\"><a href=\"#prepareContext\" class=\"headerlink\" title=\"prepareContext\"></a>prepareContext</h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">prepareContext</span><span class=\"params\">(ConfigurableApplicationContext context, ConfigurableEnvironment environment,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                            SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner)</span> </span>&#123;</span><br><span class=\"line\">    context.setEnvironment(environment);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    postProcessApplicationContext(context);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    applyInitializers(context);</span><br><span class=\"line\">    listeners.contextPrepared(context);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.logStartupInfo) &#123;</span><br><span class=\"line\">        logStartupInfo(context.getParent() == <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        logStartupProfileInfo(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Add boot specific singleton beans</span></span><br><span class=\"line\">    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();</span><br><span class=\"line\">    beanFactory.registerSingleton(<span class=\"string\">&quot;springApplicationArguments&quot;</span>, applicationArguments);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (printedBanner != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        beanFactory.registerSingleton(<span class=\"string\">&quot;springBootBanner&quot;</span>, printedBanner);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (beanFactory <span class=\"keyword\">instanceof</span> DefaultListableBeanFactory) &#123;</span><br><span class=\"line\">        ((DefaultListableBeanFactory) beanFactory)</span><br><span class=\"line\">        .setAllowBeanDefinitionOverriding(<span class=\"keyword\">this</span>.allowBeanDefinitionOverriding);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.lazyInitialization) &#123;</span><br><span class=\"line\">        context.addBeanFactoryPostProcessor(<span class=\"keyword\">new</span> LazyInitializationBeanFactoryPostProcessor());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Load the sources</span></span><br><span class=\"line\">    Set&lt;Object&gt; sources = getAllSources();</span><br><span class=\"line\">    Assert.notEmpty(sources, <span class=\"string\">&quot;Sources must not be empty&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// BeanDefinitionLoader</span></span><br><span class=\"line\">    load(context, sources.toArray(<span class=\"keyword\">new</span> Object[<span class=\"number\">0</span>]));</span><br><span class=\"line\">    listeners.contextLoaded(context);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>listeners<em>contextPrepared</em><em>contextLoaded</em>bean</p>\n<h3 id=\"contextPrepared\"><a href=\"#contextPrepared\" class=\"headerlink\" title=\"contextPrepared\"></a>contextPrepared</h3><p></p>\n<h4 id=\"postProcess\"><a href=\"#postProcess\" class=\"headerlink\" title=\"postProcess\"></a>postProcess</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">postProcessApplicationContext</span><span class=\"params\">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.beanNameGenerator != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// bean</span></span><br><span class=\"line\">        context.getBeanFactory().registerSingleton(AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR,</span><br><span class=\"line\">                                                   <span class=\"keyword\">this</span>.beanNameGenerator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.resourceLoader != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context <span class=\"keyword\">instanceof</span> GenericApplicationContext) &#123;</span><br><span class=\"line\">            ((GenericApplicationContext) context).setResourceLoader(<span class=\"keyword\">this</span>.resourceLoader);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context <span class=\"keyword\">instanceof</span> DefaultResourceLoader) &#123;</span><br><span class=\"line\">            ((DefaultResourceLoader) context).setClassLoader(<span class=\"keyword\">this</span>.resourceLoader.getClassLoader());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.addConversionService) &#123;</span><br><span class=\"line\">        context.getBeanFactory().setConversionService(ApplicationConversionService.getSharedInstance());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>beanNameGenerator</code></p>\n<h4 id=\"applyInitializers\"><a href=\"#applyInitializers\" class=\"headerlink\" title=\"applyInitializers\"></a>applyInitializers</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">applyInitializers</span><span class=\"params\">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ApplicationContextInitializer initializer : getInitializers()) &#123;</span><br><span class=\"line\">        Class&lt;?&gt; requiredType = GenericTypeResolver.resolveTypeArgument(initializer.getClass(),</span><br><span class=\"line\">                                                                        ApplicationContextInitializer.class);</span><br><span class=\"line\">        Assert.isInstanceOf(requiredType, context, <span class=\"string\">&quot;Unable to call initializer.&quot;</span>);</span><br><span class=\"line\">        initializer.initialize(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"contextLoaded\"><a href=\"#contextLoaded\" class=\"headerlink\" title=\"contextLoaded\"></a>contextLoaded</h3><p><code>BeanDefinitionLoader</code>xmljavaConfigbean</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">load</span><span class=\"params\">(ApplicationContext context, Object[] sources)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class=\"line\">        logger.debug(<span class=\"string\">&quot;Loading source &quot;</span> + StringUtils.arrayToCommaDelimitedString(sources));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    BeanDefinitionLoader loader = createBeanDefinitionLoader(getBeanDefinitionRegistry(context), sources);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.beanNameGenerator != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setBeanNameGenerator(<span class=\"keyword\">this</span>.beanNameGenerator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.resourceLoader != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setResourceLoader(<span class=\"keyword\">this</span>.resourceLoader);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.environment != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        loader.setEnvironment(<span class=\"keyword\">this</span>.environment);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    loader.load();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SpringBoot</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>"},{"title":"mq","date":"2020-07-20T13:04:40.000Z","_content":"\nmqmq\n\n<!--more-->\n\n# MQ\n\n\n\n1. ````\n\n   ``\n\n2. `A`BC\n\n   `D``A`__AD__`A``A`\n\n## \n\n-   \n\n-   \n\n-   \n\n# \n\n|    | Topic                                                | Queue                                                |\n| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n|    | - |  |\n|    |                                                        | Queuemq                    |\n|  |                        |                                                  |\n|    |  |  |\n\n# JMS\n\nJavaJava Message ServiceJavaEEAPIiJava\n\nJMSMQ\n\n## MESSAGE\n\nJMS message +  + \n\n### \n\n\n\n- JMSDestination QueueTopic\n\n- JMSDeliveryMode JMS\n\n- JMSExpiration \n\n- JMSPriority 0-45-9\n\n- JMSMessgeID ID\n\n### \n\n5\n\n- TextMessage  \n\n- MapMessage mapkeyStringJava\n\n- BytesMessage \n\n- StreamMessage \n\n- ObjectMessage Java\n\n\n\n### \n\n\n\n```java\nTextMessage tm = session.createTextMessage(\"wa wa\");\ntm.setStringProperty(\"c01\",\"vip\"); // \n\n\nTextMessage tms = (TextMessage) messge;\nSystem.out.println(tms.getStringProperty(\"c01\")); // \n```\n\n# \n\nMQ************\n\n##  PERSISTENT\n\nredisrdbaof\n\n### QUEUE\n\n#### \n\n1.  \n\n   > messaegeProducer.setDeliveryMode(DeliveryMode.*NON_PRESISTENT*);\n\n2.  \n\n   > messageProducer.setDelieveryMode(DeliveryMode._PRESISTENT_);\n\n#### \n\nactiveMQMQ\n\n\n\n********\n\n\n\n### TOPIC\n\ntopictopic\n\n1. MQ\n\n2. \n\n3. \n\n##  TRANSACTION\n\nACID\n\n```java\n// session \nSession session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n```\n\n### \n\n- false `send`\n\n- true `send``commit`\n\ntrue\n\n```java\ntry{\n    // ok session.commit;\n}catch (Exception e){\n    // error\n    session.rollback();\n}finally{\n    if(null != session){\n        session.close();\n}\n}\n```\n\n### \n\nsession`true``commit`\n\n##  ACKNOWLEDGE\n\n\n\n#### \n\n```java\n// session \nSession session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n```\n\n- **AUTO_ACKNOWLEDGE**  \n\n-  **CLIENT_ACKNOWLEDGE** \n\n-  **DUPS_OK_ACKNOWLEDGE**\n\n\n\n```java\nTextMessage tm = (TextMessage)messageConsumer.receive(4000L);\nif(null != tm){\n    tm.acknowledge();\n}else{\n    break;\n}\n// ...\n```\n\n### \n\n```java\n// session \nSession session = connection.createSession(true, Session.AUTO_ACKNOWLEDGE);\n```\n\n`commit`\n\n## \n\n****\n\n- **Session****acknowledge**)\n\n- ****\n\n## \n\nJMS Pub/Sub**topic**publishersubscribepublishersubscribe\n\n### \n\nMQ\n\n### \n\nMQIDIDMQMQID \n\n# BROKER\n\n\n\nActiveMQ****ActiveMQMQJava\n\nlinuxMQMQ  springboottomcat.\n\n## \n\nActiveMQbroker\n\n`ActiveMQ`****1. 2. producerbroker\n\nproducerproducerclientbroker100%``\n\n# ACTIVEMQ\n\nQ: 61616tcp\n\nNIO\n\nTCP, NIO, UDP, SSL, VMjava\n\n|    |                                 |\n| ------ | ----------------------------------- |\n| TCP    |             |\n| NIO    | TCP |\n| HTP(s) | HTTP(s)                         |\n\n## NIO\n\nNIO`activemq.xml`\n\n```xml\n<broker>\n...\n    <transportConnectors>\n        <transportConnector name=\"nio\" uri=\"nio://192.168.111.136\"/>\n    </transportConnectors>\n...\n</broker>\n```\n\n\n\n```java\npublic stati final String ACTIVEMQ_URL = \"nio://192.168.111.136\";\n\n\npublic static void main(String[] args){\n    ActiveMQConnectionFactory af = new ActiveMQConnectionFactory(ACTIVEMQ_URL);\n    ......\n}\n```\n\n### \n\nQ: urinioTCPNIOIO`openwireTCP`NIO\n\n`BIO+TCP``NIO+TCP``NIO+TCP/Mqtt/stomp`\n\nA: `auto`[reference](https://activemq.apache.org/auto)\n\n```xml\n<transportConnector name=\"auto\" uri=\"auto://localhost:5761\"/>\n```\n\n**note:** activeMQ`Network`\n\n# ACTIVEMQ\n\nMQ``MQi\n\nDB`KahaDB`, `LevelDB`, `JDBC`\n\nQ: AMQ\n\n## KahaDB\n\nActiveMQ5.4Redisaof\n\n\n\n```xml\n<persistenceAdapter>\n    <kahaDB directory=\"${activemq.data}/kahadb\"/>\n</persistenceAdpter>\n```\n\n### \n\nreference [here](https:/activemq.apache.org/kahadb)\n\n********\n\nKahadb4lockdb-1.log, db.data, db.free, db.redo, lock. 41\n\n#### db\\<Number\\>.log\n\nNumber1\n\n#### db.data\n\n`BTree`B-TreeB-Tree`db-\\<Number>.log`\n\n#### db.free\n\n`db.data`**ID**. linuxbash`free`\n\n#### db.redo\n\nKahaDBBTree\n\n#### lock\n\nmysqlkahadbbroker\n\n## JDBC\n\nmysql/oraclejdbcJournalkahaDBJDBC\n\n## LevelDB\n\n## JDBC Message store with ActiveMQ Journal\n\n\n\n# Q&A\n\n1. \n\n2. Async Sends\n\n3. \n\n4. \n\n5. ActiveMQ\n\n6. \n\n7. \n\n## \n\nzookeeper + (replicated-leveldb-store)\n\n## \n\n \n\n\n\n```java\nActiveMQConnectionFacotry acf = new ActiveMQConnectionFactory(URL);\n// \nacf.setUseAsyncSend(true);\nActiveMQMessageProducer amp = (ActiveMQMessageProducer)session.createProducer(queue);\n...\nTextMessage message = session.createTextMessage();\n// message\nmessage.setJMSMessageID(UUID.randomUUID().toString());\n\n// send\namp.send(message, new AsyncCallback(){\n    @Override\n    public void onSucces(){\n\n        System.out.println(message.getJMSmessageID+\" succeed\")\n    }\n    @Override\n    public void onException(JMSException exception){\n        // \n        System.out.println(message.getJMSmessageID+\" fail\")\n    }\n})\n```\n\n## \n\n[](http://activemq.apache.org/delay-and-schedule-message-delivery.html)\n\n| Property name          | type   | description        |\n| ---------------------- | ------ | ------------------ |\n| AMQ\\_SCHEDULED\\_DELAY  | long   |      |\n| AMQ\\_SCHEDULED\\_PERIOD | long   |  |\n| AMQ\\_SCHEDULED\\_REPEAT | int    |        |\n| AMQ\\_SCHEDULED\\_CRON   | String | Cron         |\n\n`activemq.xml`*schedulerSupport**true*Java*ScheduledMessage*\n\n```java\nlong delay = 3 * 1000; //3\nlong period = 4 * 1000;\nint repeat = 5;\n\nTextMessage message = session.createTextMessage();\nmessage.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);\nmessage.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, delay);\nmessage.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, delay);\n\nmessageProducer.send(mesage);\n...\n```\n\n## ActiveMQ\n\n- \n\n- \n\n- Posion ACK\n\nreference [here](activemq.apache.org/redelivery-policy)\n\ncommit6MQDLQDead Letter Queue\n\n## \n\n**note**: MQ\n\n- \n\n- redis**id**\\<id, message\\>K-Vredisredis","source":"_posts/mq.md","raw":"---\ntitle: mq\ndate: 2020-07-20 21:04:40\ncategories: MiddleWare\ntags: activemq\n---\n\nmqmq\n\n<!--more-->\n\n# MQ\n\n\n\n1. ````\n\n   ``\n\n2. `A`BC\n\n   `D``A`__AD__`A``A`\n\n## \n\n-   \n\n-   \n\n-   \n\n# \n\n|    | Topic                                                | Queue                                                |\n| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n|    | - |  |\n|    |                                                        | Queuemq                    |\n|  |                        |                                                  |\n|    |  |  |\n\n# JMS\n\nJavaJava Message ServiceJavaEEAPIiJava\n\nJMSMQ\n\n## MESSAGE\n\nJMS message +  + \n\n### \n\n\n\n- JMSDestination QueueTopic\n\n- JMSDeliveryMode JMS\n\n- JMSExpiration \n\n- JMSPriority 0-45-9\n\n- JMSMessgeID ID\n\n### \n\n5\n\n- TextMessage  \n\n- MapMessage mapkeyStringJava\n\n- BytesMessage \n\n- StreamMessage \n\n- ObjectMessage Java\n\n\n\n### \n\n\n\n```java\nTextMessage tm = session.createTextMessage(\"wa wa\");\ntm.setStringProperty(\"c01\",\"vip\"); // \n\n\nTextMessage tms = (TextMessage) messge;\nSystem.out.println(tms.getStringProperty(\"c01\")); // \n```\n\n# \n\nMQ************\n\n##  PERSISTENT\n\nredisrdbaof\n\n### QUEUE\n\n#### \n\n1.  \n\n   > messaegeProducer.setDeliveryMode(DeliveryMode.*NON_PRESISTENT*);\n\n2.  \n\n   > messageProducer.setDelieveryMode(DeliveryMode._PRESISTENT_);\n\n#### \n\nactiveMQMQ\n\n\n\n********\n\n\n\n### TOPIC\n\ntopictopic\n\n1. MQ\n\n2. \n\n3. \n\n##  TRANSACTION\n\nACID\n\n```java\n// session \nSession session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n```\n\n### \n\n- false `send`\n\n- true `send``commit`\n\ntrue\n\n```java\ntry{\n    // ok session.commit;\n}catch (Exception e){\n    // error\n    session.rollback();\n}finally{\n    if(null != session){\n        session.close();\n}\n}\n```\n\n### \n\nsession`true``commit`\n\n##  ACKNOWLEDGE\n\n\n\n#### \n\n```java\n// session \nSession session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n```\n\n- **AUTO_ACKNOWLEDGE**  \n\n-  **CLIENT_ACKNOWLEDGE** \n\n-  **DUPS_OK_ACKNOWLEDGE**\n\n\n\n```java\nTextMessage tm = (TextMessage)messageConsumer.receive(4000L);\nif(null != tm){\n    tm.acknowledge();\n}else{\n    break;\n}\n// ...\n```\n\n### \n\n```java\n// session \nSession session = connection.createSession(true, Session.AUTO_ACKNOWLEDGE);\n```\n\n`commit`\n\n## \n\n****\n\n- **Session****acknowledge**)\n\n- ****\n\n## \n\nJMS Pub/Sub**topic**publishersubscribepublishersubscribe\n\n### \n\nMQ\n\n### \n\nMQIDIDMQMQID \n\n# BROKER\n\n\n\nActiveMQ****ActiveMQMQJava\n\nlinuxMQMQ  springboottomcat.\n\n## \n\nActiveMQbroker\n\n`ActiveMQ`****1. 2. producerbroker\n\nproducerproducerclientbroker100%``\n\n# ACTIVEMQ\n\nQ: 61616tcp\n\nNIO\n\nTCP, NIO, UDP, SSL, VMjava\n\n|    |                                 |\n| ------ | ----------------------------------- |\n| TCP    |             |\n| NIO    | TCP |\n| HTP(s) | HTTP(s)                         |\n\n## NIO\n\nNIO`activemq.xml`\n\n```xml\n<broker>\n...\n    <transportConnectors>\n        <transportConnector name=\"nio\" uri=\"nio://192.168.111.136\"/>\n    </transportConnectors>\n...\n</broker>\n```\n\n\n\n```java\npublic stati final String ACTIVEMQ_URL = \"nio://192.168.111.136\";\n\n\npublic static void main(String[] args){\n    ActiveMQConnectionFactory af = new ActiveMQConnectionFactory(ACTIVEMQ_URL);\n    ......\n}\n```\n\n### \n\nQ: urinioTCPNIOIO`openwireTCP`NIO\n\n`BIO+TCP``NIO+TCP``NIO+TCP/Mqtt/stomp`\n\nA: `auto`[reference](https://activemq.apache.org/auto)\n\n```xml\n<transportConnector name=\"auto\" uri=\"auto://localhost:5761\"/>\n```\n\n**note:** activeMQ`Network`\n\n# ACTIVEMQ\n\nMQ``MQi\n\nDB`KahaDB`, `LevelDB`, `JDBC`\n\nQ: AMQ\n\n## KahaDB\n\nActiveMQ5.4Redisaof\n\n\n\n```xml\n<persistenceAdapter>\n    <kahaDB directory=\"${activemq.data}/kahadb\"/>\n</persistenceAdpter>\n```\n\n### \n\nreference [here](https:/activemq.apache.org/kahadb)\n\n********\n\nKahadb4lockdb-1.log, db.data, db.free, db.redo, lock. 41\n\n#### db\\<Number\\>.log\n\nNumber1\n\n#### db.data\n\n`BTree`B-TreeB-Tree`db-\\<Number>.log`\n\n#### db.free\n\n`db.data`**ID**. linuxbash`free`\n\n#### db.redo\n\nKahaDBBTree\n\n#### lock\n\nmysqlkahadbbroker\n\n## JDBC\n\nmysql/oraclejdbcJournalkahaDBJDBC\n\n## LevelDB\n\n## JDBC Message store with ActiveMQ Journal\n\n\n\n# Q&A\n\n1. \n\n2. Async Sends\n\n3. \n\n4. \n\n5. ActiveMQ\n\n6. \n\n7. \n\n## \n\nzookeeper + (replicated-leveldb-store)\n\n## \n\n \n\n\n\n```java\nActiveMQConnectionFacotry acf = new ActiveMQConnectionFactory(URL);\n// \nacf.setUseAsyncSend(true);\nActiveMQMessageProducer amp = (ActiveMQMessageProducer)session.createProducer(queue);\n...\nTextMessage message = session.createTextMessage();\n// message\nmessage.setJMSMessageID(UUID.randomUUID().toString());\n\n// send\namp.send(message, new AsyncCallback(){\n    @Override\n    public void onSucces(){\n\n        System.out.println(message.getJMSmessageID+\" succeed\")\n    }\n    @Override\n    public void onException(JMSException exception){\n        // \n        System.out.println(message.getJMSmessageID+\" fail\")\n    }\n})\n```\n\n## \n\n[](http://activemq.apache.org/delay-and-schedule-message-delivery.html)\n\n| Property name          | type   | description        |\n| ---------------------- | ------ | ------------------ |\n| AMQ\\_SCHEDULED\\_DELAY  | long   |      |\n| AMQ\\_SCHEDULED\\_PERIOD | long   |  |\n| AMQ\\_SCHEDULED\\_REPEAT | int    |        |\n| AMQ\\_SCHEDULED\\_CRON   | String | Cron         |\n\n`activemq.xml`*schedulerSupport**true*Java*ScheduledMessage*\n\n```java\nlong delay = 3 * 1000; //3\nlong period = 4 * 1000;\nint repeat = 5;\n\nTextMessage message = session.createTextMessage();\nmessage.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);\nmessage.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, delay);\nmessage.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, delay);\n\nmessageProducer.send(mesage);\n...\n```\n\n## ActiveMQ\n\n- \n\n- \n\n- Posion ACK\n\nreference [here](activemq.apache.org/redelivery-policy)\n\ncommit6MQDLQDead Letter Queue\n\n## \n\n**note**: MQ\n\n- \n\n- redis**id**\\<id, message\\>K-Vredisredis","slug":"mq","published":1,"updated":"2020-11-08T07:20:16.385Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckn438q930041w5ih5mop3veu","content":"<p>mqmq</p>\n<a id=\"more\"></a>\n\n<h1 id=\"MQ\"><a href=\"#MQ\" class=\"headerlink\" title=\"MQ\"></a>MQ</h1><p></p>\n<ol>\n<li><p><code></code><code></code></p>\n<p><code></code></p>\n</li>\n<li><p><code>A</code>BC</p>\n<p><code>D</code><code>A</code>__AD__<code>A</code><code>A</code></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p>  </p>\n</li>\n<li><p>  </p>\n</li>\n<li><p>  </p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th></th>\n<th>Topic</th>\n<th>Queue</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td>-</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Queuemq</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h1 id=\"JMS\"><a href=\"#JMS\" class=\"headerlink\" title=\"JMS\"></a>JMS</h1><p>JavaJava Message ServiceJavaEEAPIiJava</p>\n<p>JMSMQ</p>\n<h2 id=\"MESSAGE\"><a href=\"#MESSAGE\" class=\"headerlink\" title=\"MESSAGE\"></a>MESSAGE</h2><p>JMS message +  + </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><p>JMSDestination QueueTopic</p>\n</li>\n<li><p>JMSDeliveryMode JMS</p>\n</li>\n<li><p>JMSExpiration </p>\n</li>\n<li><p>JMSPriority 0-45-9</p>\n</li>\n<li><p>JMSMessgeID ID</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>5</p>\n<ul>\n<li><p>TextMessage  </p>\n</li>\n<li><p>MapMessage mapkeyStringJava</p>\n</li>\n<li><p>BytesMessage </p>\n</li>\n<li><p>StreamMessage </p>\n</li>\n<li><p>ObjectMessage Java</p>\n</li>\n</ul>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TextMessage tm = session.createTextMessage(<span class=\"string\">&quot;wa wa&quot;</span>);</span><br><span class=\"line\">tm.setStringProperty(<span class=\"string\">&quot;c01&quot;</span>,<span class=\"string\">&quot;vip&quot;</span>); <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">TextMessage tms = (TextMessage) messge;</span><br><span class=\"line\">System.out.println(tms.getStringProperty(<span class=\"string\">&quot;c01&quot;</span>)); <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MQ<strong></strong><strong></strong><strong></strong></p>\n<h2 id=\"-PERSISTENT\"><a href=\"#-PERSISTENT\" class=\"headerlink\" title=\" PERSISTENT\"></a> PERSISTENT</h2><p>redisrdbaof</p>\n<h3 id=\"QUEUE\"><a href=\"#QUEUE\" class=\"headerlink\" title=\"QUEUE\"></a>QUEUE</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><p> </p>\n<blockquote>\n<p>messaegeProducer.setDeliveryMode(DeliveryMode.<em>NON_PRESISTENT</em>);</p>\n</blockquote>\n</li>\n<li><p> </p>\n<blockquote>\n<p>messageProducer.setDelieveryMode(DeliveryMode.<em>PRESISTENT</em>);</p>\n</blockquote>\n</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>activeMQMQ</p>\n<p></p>\n<p><strong></strong><strong></strong></p>\n<p></p>\n<h3 id=\"TOPIC\"><a href=\"#TOPIC\" class=\"headerlink\" title=\"TOPIC\"></a>TOPIC</h3><p>topictopic</p>\n<ol>\n<li><p>MQ</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"-TRANSACTION\"><a href=\"#-TRANSACTION\" class=\"headerlink\" title=\" TRANSACTION\"></a> TRANSACTION</h2><p>ACID</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>false <code>send</code></p>\n</li>\n<li><p>true <code>send</code><code>commit</code></p>\n</li>\n</ul>\n<p>true</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ok session.commit;</span></span><br><span class=\"line\">&#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">    <span class=\"comment\">// error</span></span><br><span class=\"line\">    session.rollback();</span><br><span class=\"line\">&#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != session)&#123;</span><br><span class=\"line\">        session.close();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>session<code>true</code><code>commit</code></p>\n<h2 id=\"-ACKNOWLEDGE\"><a href=\"#-ACKNOWLEDGE\" class=\"headerlink\" title=\" ACKNOWLEDGE\"></a> ACKNOWLEDGE</h2><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p><strong>AUTO_ACKNOWLEDGE</strong>  </p>\n</li>\n<li><p> <strong>CLIENT_ACKNOWLEDGE</strong> </p>\n</li>\n<li><p> <strong>DUPS_OK_ACKNOWLEDGE</strong></p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TextMessage tm = (TextMessage)messageConsumer.receive(<span class=\"number\">4000L</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != tm)&#123;</span><br><span class=\"line\">    tm.acknowledge();</span><br><span class=\"line\">&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">true</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<p><code>commit</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<ul>\n<li><p><strong>Session</strong><strong>acknowledge</strong>)</p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>JMS Pub/Sub<strong>topic</strong>publishersubscribepublishersubscribe</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MQ</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MQIDIDMQMQID </p>\n<h1 id=\"BROKER\"><a href=\"#BROKER\" class=\"headerlink\" title=\"BROKER\"></a>BROKER</h1><p></p>\n<p>ActiveMQ<strong></strong>ActiveMQMQJava</p>\n<p>linuxMQMQ  springboottomcat.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ActiveMQbroker</p>\n<p><code>ActiveMQ</code><strong></strong>1. 2. producerbroker</p>\n<p>producerproducerclientbroker100%<code></code></p>\n<h1 id=\"ACTIVEMQ\"><a href=\"#ACTIVEMQ\" class=\"headerlink\" title=\"ACTIVEMQ\"></a>ACTIVEMQ</h1><p>Q: 61616tcp</p>\n<p>NIO</p>\n<p>TCP, NIO, UDP, SSL, VMjava</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>TCP</td>\n<td></td>\n</tr>\n<tr>\n<td>NIO</td>\n<td>TCP</td>\n</tr>\n<tr>\n<td>HTP(s)</td>\n<td>HTTP(s)</td>\n</tr>\n</tbody></table>\n<h2 id=\"NIO\"><a href=\"#NIO\" class=\"headerlink\" title=\"NIO\"></a>NIO</h2><p>NIO<code>activemq.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">broker</span>&gt;</span></span><br><span class=\"line\">...</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">transportConnectors</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">transportConnector</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;nio&quot;</span> <span class=\"attr\">uri</span>=<span class=\"string\">&quot;nio://192.168.111.136&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">transportConnectors</span>&gt;</span></span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">broker</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> stati <span class=\"keyword\">final</span> String ACTIVEMQ_URL = <span class=\"string\">&quot;nio://192.168.111.136&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">    ActiveMQConnectionFactory af = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(ACTIVEMQ_URL);</span><br><span class=\"line\">    ......</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Q: urinioTCPNIOIO<code>openwireTCP</code>NIO</p>\n<p><code>BIO+TCP</code><code>NIO+TCP</code><code>NIO+TCP/Mqtt/stomp</code></p>\n<p>A: <code>auto</code><a href=\"https://activemq.apache.org/auto\">reference</a></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">transportConnector</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;auto&quot;</span> <span class=\"attr\">uri</span>=<span class=\"string\">&quot;auto://localhost:5761&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>note:</strong> activeMQ<code>Network</code></p>\n<h1 id=\"ACTIVEMQ\"><a href=\"#ACTIVEMQ\" class=\"headerlink\" title=\"ACTIVEMQ\"></a>ACTIVEMQ</h1><p>MQ<code></code>MQi</p>\n<p>DB<code>KahaDB</code>, <code>LevelDB</code>, <code>JDBC</code></p>\n<p>Q: AMQ</p>\n<h2 id=\"KahaDB\"><a href=\"#KahaDB\" class=\"headerlink\" title=\"KahaDB\"></a>KahaDB</h2><p>ActiveMQ5.4Redisaof</p>\n<p></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">persistenceAdapter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">kahaDB</span> <span class=\"attr\">directory</span>=<span class=\"string\">&quot;$&#123;activemq.data&#125;/kahadb&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">persistenceAdpter</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>reference <a href=\"https://activemq.apache.org/kahadb\">here</a></p>\n<p><strong></strong><strong></strong></p>\n<p>Kahadb4lockdb-1.log, db.data, db.free, db.redo, lock. 41</p>\n<h4 id=\"db-lt-Number-gt-log\"><a href=\"#db-lt-Number-gt-log\" class=\"headerlink\" title=\"db&lt;Number&gt;.log\"></a>db&lt;Number&gt;.log</h4><p>Number1</p>\n<h4 id=\"db-data\"><a href=\"#db-data\" class=\"headerlink\" title=\"db.data\"></a>db.data</h4><p><code>BTree</code>B-TreeB-Tree<code>db-\\&lt;Number&gt;.log</code></p>\n<h4 id=\"db-free\"><a href=\"#db-free\" class=\"headerlink\" title=\"db.free\"></a>db.free</h4><p><code>db.data</code><strong>ID</strong>. linuxbash<code>free</code></p>\n<h4 id=\"db-redo\"><a href=\"#db-redo\" class=\"headerlink\" title=\"db.redo\"></a>db.redo</h4><p>KahaDBBTree</p>\n<h4 id=\"lock\"><a href=\"#lock\" class=\"headerlink\" title=\"lock\"></a>lock</h4><p>mysqlkahadbbroker</p>\n<h2 id=\"JDBC\"><a href=\"#JDBC\" class=\"headerlink\" title=\"JDBC\"></a>JDBC</h2><p>mysql/oraclejdbcJournalkahaDBJDBC</p>\n<h2 id=\"LevelDB\"><a href=\"#LevelDB\" class=\"headerlink\" title=\"LevelDB\"></a>LevelDB</h2><h2 id=\"JDBC-Message-store-with-ActiveMQ-Journal\"><a href=\"#JDBC-Message-store-with-ActiveMQ-Journal\" class=\"headerlink\" title=\"JDBC Message store with ActiveMQ Journal\"></a>JDBC Message store with ActiveMQ Journal</h2><p></p>\n<h1 id=\"Q-amp-A\"><a href=\"#Q-amp-A\" class=\"headerlink\" title=\"Q&amp;A\"></a>Q&amp;A</h1><ol>\n<li><p></p>\n</li>\n<li><p>Async Sends</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>ActiveMQ</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>zookeeper + (replicated-leveldb-store)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> </p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ActiveMQConnectionFacotry acf = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(URL);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">acf.setUseAsyncSend(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">ActiveMQMessageProducer amp = (ActiveMQMessageProducer)session.createProducer(queue);</span><br><span class=\"line\">...</span><br><span class=\"line\">TextMessage message = session.createTextMessage();</span><br><span class=\"line\"><span class=\"comment\">// message</span></span><br><span class=\"line\">message.setJMSMessageID(UUID.randomUUID().toString());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// send</span></span><br><span class=\"line\">amp.send(message, <span class=\"keyword\">new</span> AsyncCallback()&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSucces</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(message.getJMSmessageID+<span class=\"string\">&quot; succeed&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onException</span><span class=\"params\">(JMSException exception)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        System.out.println(message.getJMSmessageID+<span class=\"string\">&quot; fail&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"http://activemq.apache.org/delay-and-schedule-message-delivery.html\"></a></p>\n<table>\n<thead>\n<tr>\n<th>Property name</th>\n<th>type</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AMQ_SCHEDULED_DELAY</td>\n<td>long</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_PERIOD</td>\n<td>long</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_REPEAT</td>\n<td>int</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_CRON</td>\n<td>String</td>\n<td>Cron</td>\n</tr>\n</tbody></table>\n<p><code>activemq.xml</code><em>schedulerSupport</em><em>true</em>Java<em>ScheduledMessage</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">long</span> delay = <span class=\"number\">3</span> * <span class=\"number\">1000</span>; <span class=\"comment\">//3</span></span><br><span class=\"line\"><span class=\"keyword\">long</span> period = <span class=\"number\">4</span> * <span class=\"number\">1000</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> repeat = <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">TextMessage message = session.createTextMessage();</span><br><span class=\"line\">message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);</span><br><span class=\"line\">message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, delay);</span><br><span class=\"line\">message.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, delay);</span><br><span class=\"line\"></span><br><span class=\"line\">messageProducer.send(mesage);</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ActiveMQ\"><a href=\"#ActiveMQ\" class=\"headerlink\" title=\"ActiveMQ\"></a>ActiveMQ</h2><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>Posion ACK</p>\n</li>\n</ul>\n<p>reference <a href=\"activemq.apache.org/redelivery-policy\">here</a></p>\n<p>commit6MQDLQDead Letter Queue</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>note</strong>: MQ</p>\n<ul>\n<li><p></p>\n</li>\n<li><p>redis<strong>id</strong>&lt;id, message&gt;K-Vredisredis</p>\n</li>\n</ul>\n","site":{"data":{}},"thumbnailImageUrl":null,"excerpt":"<p>mqmq</p>","more":"<h1 id=\"MQ\"><a href=\"#MQ\" class=\"headerlink\" title=\"MQ\"></a>MQ</h1><p></p>\n<ol>\n<li><p><code></code><code></code></p>\n<p><code></code></p>\n</li>\n<li><p><code>A</code>BC</p>\n<p><code>D</code><code>A</code>__AD__<code>A</code><code>A</code></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p>  </p>\n</li>\n<li><p>  </p>\n</li>\n<li><p>  </p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th></th>\n<th>Topic</th>\n<th>Queue</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td>-</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Queuemq</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h1 id=\"JMS\"><a href=\"#JMS\" class=\"headerlink\" title=\"JMS\"></a>JMS</h1><p>JavaJava Message ServiceJavaEEAPIiJava</p>\n<p>JMSMQ</p>\n<h2 id=\"MESSAGE\"><a href=\"#MESSAGE\" class=\"headerlink\" title=\"MESSAGE\"></a>MESSAGE</h2><p>JMS message +  + </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><p>JMSDestination QueueTopic</p>\n</li>\n<li><p>JMSDeliveryMode JMS</p>\n</li>\n<li><p>JMSExpiration </p>\n</li>\n<li><p>JMSPriority 0-45-9</p>\n</li>\n<li><p>JMSMessgeID ID</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>5</p>\n<ul>\n<li><p>TextMessage  </p>\n</li>\n<li><p>MapMessage mapkeyStringJava</p>\n</li>\n<li><p>BytesMessage </p>\n</li>\n<li><p>StreamMessage </p>\n</li>\n<li><p>ObjectMessage Java</p>\n</li>\n</ul>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TextMessage tm = session.createTextMessage(<span class=\"string\">&quot;wa wa&quot;</span>);</span><br><span class=\"line\">tm.setStringProperty(<span class=\"string\">&quot;c01&quot;</span>,<span class=\"string\">&quot;vip&quot;</span>); <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">TextMessage tms = (TextMessage) messge;</span><br><span class=\"line\">System.out.println(tms.getStringProperty(<span class=\"string\">&quot;c01&quot;</span>)); <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MQ<strong></strong><strong></strong><strong></strong></p>\n<h2 id=\"-PERSISTENT\"><a href=\"#-PERSISTENT\" class=\"headerlink\" title=\" PERSISTENT\"></a> PERSISTENT</h2><p>redisrdbaof</p>\n<h3 id=\"QUEUE\"><a href=\"#QUEUE\" class=\"headerlink\" title=\"QUEUE\"></a>QUEUE</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><p> </p>\n<blockquote>\n<p>messaegeProducer.setDeliveryMode(DeliveryMode.<em>NON_PRESISTENT</em>);</p>\n</blockquote>\n</li>\n<li><p> </p>\n<blockquote>\n<p>messageProducer.setDelieveryMode(DeliveryMode.<em>PRESISTENT</em>);</p>\n</blockquote>\n</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>activeMQMQ</p>\n<p></p>\n<p><strong></strong><strong></strong></p>\n<p></p>\n<h3 id=\"TOPIC\"><a href=\"#TOPIC\" class=\"headerlink\" title=\"TOPIC\"></a>TOPIC</h3><p>topictopic</p>\n<ol>\n<li><p>MQ</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"-TRANSACTION\"><a href=\"#-TRANSACTION\" class=\"headerlink\" title=\" TRANSACTION\"></a> TRANSACTION</h2><p>ACID</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>false <code>send</code></p>\n</li>\n<li><p>true <code>send</code><code>commit</code></p>\n</li>\n</ul>\n<p>true</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ok session.commit;</span></span><br><span class=\"line\">&#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">    <span class=\"comment\">// error</span></span><br><span class=\"line\">    session.rollback();</span><br><span class=\"line\">&#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != session)&#123;</span><br><span class=\"line\">        session.close();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>session<code>true</code><code>commit</code></p>\n<h2 id=\"-ACKNOWLEDGE\"><a href=\"#-ACKNOWLEDGE\" class=\"headerlink\" title=\" ACKNOWLEDGE\"></a> ACKNOWLEDGE</h2><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p><strong>AUTO_ACKNOWLEDGE</strong>  </p>\n</li>\n<li><p> <strong>CLIENT_ACKNOWLEDGE</strong> </p>\n</li>\n<li><p> <strong>DUPS_OK_ACKNOWLEDGE</strong></p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TextMessage tm = (TextMessage)messageConsumer.receive(<span class=\"number\">4000L</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != tm)&#123;</span><br><span class=\"line\">    tm.acknowledge();</span><br><span class=\"line\">&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// session </span></span><br><span class=\"line\">Session session = connection.createSession(<span class=\"keyword\">true</span>, Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>\n\n<p><code>commit</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<ul>\n<li><p><strong>Session</strong><strong>acknowledge</strong>)</p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>JMS Pub/Sub<strong>topic</strong>publishersubscribepublishersubscribe</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MQ</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>MQIDIDMQMQID </p>\n<h1 id=\"BROKER\"><a href=\"#BROKER\" class=\"headerlink\" title=\"BROKER\"></a>BROKER</h1><p></p>\n<p>ActiveMQ<strong></strong>ActiveMQMQJava</p>\n<p>linuxMQMQ  springboottomcat.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ActiveMQbroker</p>\n<p><code>ActiveMQ</code><strong></strong>1. 2. producerbroker</p>\n<p>producerproducerclientbroker100%<code></code></p>\n<h1 id=\"ACTIVEMQ\"><a href=\"#ACTIVEMQ\" class=\"headerlink\" title=\"ACTIVEMQ\"></a>ACTIVEMQ</h1><p>Q: 61616tcp</p>\n<p>NIO</p>\n<p>TCP, NIO, UDP, SSL, VMjava</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>TCP</td>\n<td></td>\n</tr>\n<tr>\n<td>NIO</td>\n<td>TCP</td>\n</tr>\n<tr>\n<td>HTP(s)</td>\n<td>HTTP(s)</td>\n</tr>\n</tbody></table>\n<h2 id=\"NIO\"><a href=\"#NIO\" class=\"headerlink\" title=\"NIO\"></a>NIO</h2><p>NIO<code>activemq.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">broker</span>&gt;</span></span><br><span class=\"line\">...</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">transportConnectors</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">transportConnector</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;nio&quot;</span> <span class=\"attr\">uri</span>=<span class=\"string\">&quot;nio://192.168.111.136&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">transportConnectors</span>&gt;</span></span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">broker</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> stati <span class=\"keyword\">final</span> String ACTIVEMQ_URL = <span class=\"string\">&quot;nio://192.168.111.136&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">    ActiveMQConnectionFactory af = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(ACTIVEMQ_URL);</span><br><span class=\"line\">    ......</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Q: urinioTCPNIOIO<code>openwireTCP</code>NIO</p>\n<p><code>BIO+TCP</code><code>NIO+TCP</code><code>NIO+TCP/Mqtt/stomp</code></p>\n<p>A: <code>auto</code><a href=\"https://activemq.apache.org/auto\">reference</a></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">transportConnector</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;auto&quot;</span> <span class=\"attr\">uri</span>=<span class=\"string\">&quot;auto://localhost:5761&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>note:</strong> activeMQ<code>Network</code></p>\n<h1 id=\"ACTIVEMQ\"><a href=\"#ACTIVEMQ\" class=\"headerlink\" title=\"ACTIVEMQ\"></a>ACTIVEMQ</h1><p>MQ<code></code>MQi</p>\n<p>DB<code>KahaDB</code>, <code>LevelDB</code>, <code>JDBC</code></p>\n<p>Q: AMQ</p>\n<h2 id=\"KahaDB\"><a href=\"#KahaDB\" class=\"headerlink\" title=\"KahaDB\"></a>KahaDB</h2><p>ActiveMQ5.4Redisaof</p>\n<p></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">persistenceAdapter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">kahaDB</span> <span class=\"attr\">directory</span>=<span class=\"string\">&quot;$&#123;activemq.data&#125;/kahadb&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">persistenceAdpter</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>reference <a href=\"https://activemq.apache.org/kahadb\">here</a></p>\n<p><strong></strong><strong></strong></p>\n<p>Kahadb4lockdb-1.log, db.data, db.free, db.redo, lock. 41</p>\n<h4 id=\"db-lt-Number-gt-log\"><a href=\"#db-lt-Number-gt-log\" class=\"headerlink\" title=\"db&lt;Number&gt;.log\"></a>db&lt;Number&gt;.log</h4><p>Number1</p>\n<h4 id=\"db-data\"><a href=\"#db-data\" class=\"headerlink\" title=\"db.data\"></a>db.data</h4><p><code>BTree</code>B-TreeB-Tree<code>db-\\&lt;Number&gt;.log</code></p>\n<h4 id=\"db-free\"><a href=\"#db-free\" class=\"headerlink\" title=\"db.free\"></a>db.free</h4><p><code>db.data</code><strong>ID</strong>. linuxbash<code>free</code></p>\n<h4 id=\"db-redo\"><a href=\"#db-redo\" class=\"headerlink\" title=\"db.redo\"></a>db.redo</h4><p>KahaDBBTree</p>\n<h4 id=\"lock\"><a href=\"#lock\" class=\"headerlink\" title=\"lock\"></a>lock</h4><p>mysqlkahadbbroker</p>\n<h2 id=\"JDBC\"><a href=\"#JDBC\" class=\"headerlink\" title=\"JDBC\"></a>JDBC</h2><p>mysql/oraclejdbcJournalkahaDBJDBC</p>\n<h2 id=\"LevelDB\"><a href=\"#LevelDB\" class=\"headerlink\" title=\"LevelDB\"></a>LevelDB</h2><h2 id=\"JDBC-Message-store-with-ActiveMQ-Journal\"><a href=\"#JDBC-Message-store-with-ActiveMQ-Journal\" class=\"headerlink\" title=\"JDBC Message store with ActiveMQ Journal\"></a>JDBC Message store with ActiveMQ Journal</h2><p></p>\n<h1 id=\"Q-amp-A\"><a href=\"#Q-amp-A\" class=\"headerlink\" title=\"Q&amp;A\"></a>Q&amp;A</h1><ol>\n<li><p></p>\n</li>\n<li><p>Async Sends</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>ActiveMQ</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>zookeeper + (replicated-leveldb-store)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> </p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ActiveMQConnectionFacotry acf = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(URL);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">acf.setUseAsyncSend(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">ActiveMQMessageProducer amp = (ActiveMQMessageProducer)session.createProducer(queue);</span><br><span class=\"line\">...</span><br><span class=\"line\">TextMessage message = session.createTextMessage();</span><br><span class=\"line\"><span class=\"comment\">// message</span></span><br><span class=\"line\">message.setJMSMessageID(UUID.randomUUID().toString());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// send</span></span><br><span class=\"line\">amp.send(message, <span class=\"keyword\">new</span> AsyncCallback()&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSucces</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(message.getJMSmessageID+<span class=\"string\">&quot; succeed&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onException</span><span class=\"params\">(JMSException exception)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        System.out.println(message.getJMSmessageID+<span class=\"string\">&quot; fail&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"http://activemq.apache.org/delay-and-schedule-message-delivery.html\"></a></p>\n<table>\n<thead>\n<tr>\n<th>Property name</th>\n<th>type</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AMQ_SCHEDULED_DELAY</td>\n<td>long</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_PERIOD</td>\n<td>long</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_REPEAT</td>\n<td>int</td>\n<td></td>\n</tr>\n<tr>\n<td>AMQ_SCHEDULED_CRON</td>\n<td>String</td>\n<td>Cron</td>\n</tr>\n</tbody></table>\n<p><code>activemq.xml</code><em>schedulerSupport</em><em>true</em>Java<em>ScheduledMessage</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">long</span> delay = <span class=\"number\">3</span> * <span class=\"number\">1000</span>; <span class=\"comment\">//3</span></span><br><span class=\"line\"><span class=\"keyword\">long</span> period = <span class=\"number\">4</span> * <span class=\"number\">1000</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> repeat = <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">TextMessage message = session.createTextMessage();</span><br><span class=\"line\">message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);</span><br><span class=\"line\">message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, delay);</span><br><span class=\"line\">message.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, delay);</span><br><span class=\"line\"></span><br><span class=\"line\">messageProducer.send(mesage);</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ActiveMQ\"><a href=\"#ActiveMQ\" class=\"headerlink\" title=\"ActiveMQ\"></a>ActiveMQ</h2><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>Posion ACK</p>\n</li>\n</ul>\n<p>reference <a href=\"activemq.apache.org/redelivery-policy\">here</a></p>\n<p>commit6MQDLQDead Letter Queue</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>note</strong>: MQ</p>\n<ul>\n<li><p></p>\n</li>\n<li><p>redis<strong>id</strong>&lt;id, message&gt;K-Vredisredis</p>\n</li>\n</ul>"}],"PostAsset":[],"PostCategory":[{"post_id":"ckn438q6q0003w5ih0fh0ht7b","category_id":"ckn438q6w0007w5ihfov39dki","_id":"ckn438q77000lw5ih8whl47y7"},{"post_id":"ckn438q74000iw5ih3umqdncr","category_id":"ckn438q72000gw5ih4fz680oe","_id":"ckn438q7a000rw5ih3h807mtd"},{"post_id":"ckn438q6v0006w5ih90kr1epz","category_id":"ckn438q72000gw5ih4fz680oe","_id":"ckn438q7d000vw5ihd4aabp2w"},{"post_id":"ckn438q6x0009w5ihdile7yi8","category_id":"ckn438q77000nw5ihe8o31505","_id":"ckn438q7f000zw5ih3yq03s28"},{"post_id":"ckn438q7a000qw5ihcptj9jqw","category_id":"ckn438q77000nw5ihe8o31505","_id":"ckn438q7h0012w5ih42kv1sc8"},{"post_id":"ckn438q7c000uw5ihbz9pcsev","category_id":"ckn438q77000nw5ihe8o31505","_id":"ckn438q7j0016w5ihagn3br01"},{"post_id":"ckn438q6z000bw5iheq0k9nyw","category_id":"ckn438q72000gw5ih4fz680oe","_id":"ckn438q7k0019w5ih629kbdya"},{"post_id":"ckn438q72000fw5ih3h1zgn5l","category_id":"ckn438q72000gw5ih4fz680oe","_id":"ckn438q7l001cw5ih6ba33if8"},{"post_id":"ckn438q78000ow5ih6vi74u1i","category_id":"ckn438q7i0015w5ih7i3w3bry","_id":"ckn438q7o001jw5ih0dtj1lo5"},{"post_id":"ckn438q7n001hw5ih9xrv26ea","category_id":"ckn438q77000nw5ihe8o31505","_id":"ckn438q7x001qw5ih5ttb60kv"},{"post_id":"ckn438q7e000xw5ih6igs72r5","category_id":"ckn438q7m001dw5ih88ir7jkg","_id":"ckn438q7z001uw5ihcuicaucf"},{"post_id":"ckn438q7p001lw5ih0n9t6rvg","category_id":"ckn438q6w0007w5ihfov39dki","_id":"ckn438q83001xw5ih8eod7fhy"},{"post_id":"ckn438q7t001nw5ihe0yj0268","category_id":"ckn438q6w0007w5ihfov39dki","_id":"ckn438q850021w5ih9yny10lr"},{"post_id":"ckn438q7g0011w5ih3swj1f2a","category_id":"ckn438q7p001mw5ih7xcsbosh","_id":"ckn438q880025w5ih2wbn1gaq"},{"post_id":"ckn438q7v001pw5ihb0ns40jx","category_id":"ckn438q6w0007w5ihfov39dki","_id":"ckn438q8a0029w5ihhffxejjs"},{"post_id":"ckn438q7z001tw5ih51vqajrg","category_id":"ckn438q7m001dw5ih88ir7jkg","_id":"ckn438q8b002bw5ih0vpj8mv8"},{"post_id":"ckn438q7h0013w5ihhdjgbwme","category_id":"ckn438q7y001sw5ih0sg45v3l","_id":"ckn438q8c002gw5ih2wn63l5m"},{"post_id":"ckn438q82001ww5ih4e46g5xd","category_id":"ckn438q7i0015w5ih7i3w3bry","_id":"ckn438q8d002iw5ih9urd5ruh"},{"post_id":"ckn438q7j0018w5ihfke5chrb","category_id":"ckn438q7y001sw5ih0sg45v3l","_id":"ckn438q8f002lw5ihccwff3xp"},{"post_id":"ckn438q870024w5ihg38x2fc4","category_id":"ckn438q7y001sw5ih0sg45v3l","_id":"ckn438q8g002ow5ih7ezy90n0"},{"post_id":"ckn438q890028w5ihdly0flea","category_id":"ckn438q72000gw5ih4fz680oe","_id":"ckn438q8h002qw5ihdyej3gzn"},{"post_id":"ckn438q7k001aw5ih69a14lt6","category_id":"ckn438q880026w5ih6eyq98uq","_id":"ckn438q8h002tw5ihbdwt4ssu"},{"post_id":"ckn438q8c002fw5ihend92pom","category_id":"ckn438q77000nw5ihe8o31505","_id":"ckn438q8i002ww5ihdrsy7jz5"},{"post_id":"ckn438q7m001fw5ih3bqj38se","category_id":"ckn438q8b002dw5ih57sx7km6","_id":"ckn438q8i002yw5ih98ntcwpp"},{"post_id":"ckn438q8e002kw5ih3cavee9c","category_id":"ckn438q880026w5ih6eyq98uq","_id":"ckn438q8j002zw5ih2we20mum"},{"post_id":"ckn438q8f002nw5ih51ws5ehk","category_id":"ckn438q880026w5ih6eyq98uq","_id":"ckn438q8k0032w5ih6w4wdp1o"},{"post_id":"ckn438q840020w5ihbhmmer5d","category_id":"ckn438q8f002mw5ihg5u9d8op","_id":"ckn438q8k0033w5ihf41gesdy"},{"post_id":"ckn438q8a002aw5ihd43v2r8d","category_id":"ckn438q8h002rw5ihb64d1w7t","_id":"ckn438q8l0036w5ihewey59bk"},{"post_id":"ckn438q920040w5ih87kh5m6w","category_id":"ckn438q7y001sw5ih0sg45v3l","_id":"ckn438q950044w5ihcy705yiz"},{"post_id":"ckn438q930041w5ih5mop3veu","category_id":"ckn438q8b002dw5ih57sx7km6","_id":"ckn438q950045w5ihgufj4arc"}],"PostTag":[{"post_id":"ckn438q6m0001w5ih4jvxamag","tag_id":"ckn438q6s0004w5ihg9x6ejhl","_id":"ckn438q71000dw5ihdha23wxo"},{"post_id":"ckn438q6q0003w5ih0fh0ht7b","tag_id":"ckn438q70000cw5iheyqw7s81","_id":"ckn438q77000mw5ih9f6c29xq"},{"post_id":"ckn438q6v0006w5ih90kr1epz","tag_id":"ckn438q75000jw5ihhq3r3ost","_id":"ckn438q7a000sw5ih7o8h7r75"},{"post_id":"ckn438q6x0009w5ihdile7yi8","tag_id":"ckn438q79000pw5ihgj47fuw0","_id":"ckn438q7f0010w5ih6488ahf7"},{"post_id":"ckn438q6z000bw5iheq0k9nyw","tag_id":"ckn438q7e000ww5ihgg94fabu","_id":"ckn438q7j0017w5ihclscdliv"},{"post_id":"ckn438q72000fw5ih3h1zgn5l","tag_id":"ckn438q7e000ww5ihgg94fabu","_id":"ckn438q7m001ew5ihdo0yelll"},{"post_id":"ckn438q7k001aw5ih69a14lt6","tag_id":"ckn438q6s0004w5ihg9x6ejhl","_id":"ckn438q7n001gw5ih94kv3fyu"},{"post_id":"ckn438q74000iw5ih3umqdncr","tag_id":"ckn438q7e000ww5ihgg94fabu","_id":"ckn438q7p001kw5iha3qz114w"},{"post_id":"ckn438q76000kw5ihc54z9u0j","tag_id":"ckn438q7o001iw5ih1uyf0os2","_id":"ckn438q7x001rw5ihhmdw9k6c"},{"post_id":"ckn438q78000ow5ih6vi74u1i","tag_id":"ckn438q7u001ow5ih8iww1rn0","_id":"ckn438q83001yw5ih6flehp6m"},{"post_id":"ckn438q82001ww5ih4e46g5xd","tag_id":"ckn438q7u001ow5ih8iww1rn0","_id":"ckn438q860022w5ihdipo6932"},{"post_id":"ckn438q7a000qw5ihcptj9jqw","tag_id":"ckn438q80001vw5ihfn3b81yb","_id":"ckn438q890027w5ihe5p1epgr"},{"post_id":"ckn438q7c000uw5ihbz9pcsev","tag_id":"ckn438q860023w5ihcy6sfn1h","_id":"ckn438q8c002ew5ih0wb8858u"},{"post_id":"ckn438q7e000xw5ih6igs72r5","tag_id":"ckn438q8b002cw5ih3emi9udw","_id":"ckn438q8h002sw5ihc7kgfw8p"},{"post_id":"ckn438q7e000xw5ih6igs72r5","tag_id":"ckn438q8e002jw5ih5w8k15wa","_id":"ckn438q8h002uw5ih3m8n7zzi"},{"post_id":"ckn438q7g0011w5ih3swj1f2a","tag_id":"ckn438q8g002pw5iheeazbcui","_id":"ckn438q8i002xw5ihgixxdis1"},{"post_id":"ckn438q7h0013w5ihhdjgbwme","tag_id":"ckn438q8i002vw5ihdqa6bnlh","_id":"ckn438q8k0031w5ihbufg0c8w"},{"post_id":"ckn438q7j0018w5ihfke5chrb","tag_id":"ckn438q8i002vw5ihdqa6bnlh","_id":"ckn438q8l0035w5ih9g7ncgsh"},{"post_id":"ckn438q7m001fw5ih3bqj38se","tag_id":"ckn438q8k0034w5ih7u83dzhl","_id":"ckn438q8m0038w5ihhilm0dae"},{"post_id":"ckn438q7n001hw5ih9xrv26ea","tag_id":"ckn438q8l0037w5ih9kmrdito","_id":"ckn438q8m003aw5ih7dmk475e"},{"post_id":"ckn438q7p001lw5ih0n9t6rvg","tag_id":"ckn438q8m0039w5ihdw416zim","_id":"ckn438q8n003cw5ih18k07l0u"},{"post_id":"ckn438q7t001nw5ihe0yj0268","tag_id":"ckn438q8m0039w5ihdw416zim","_id":"ckn438q8o003ew5ihf8kda29v"},{"post_id":"ckn438q7v001pw5ihb0ns40jx","tag_id":"ckn438q8m0039w5ihdw416zim","_id":"ckn438q8o003gw5ihhhg57e7h"},{"post_id":"ckn438q7z001tw5ih51vqajrg","tag_id":"ckn438q8o003fw5ihfejyh7iu","_id":"ckn438q8p003iw5ih36787t8p"},{"post_id":"ckn438q840020w5ihbhmmer5d","tag_id":"ckn438q8p003hw5ih1dc1aswe","_id":"ckn438q8w003lw5ihancvbtcc"},{"post_id":"ckn438q840020w5ihbhmmer5d","tag_id":"ckn438q8q003jw5ihhj53a6zo","_id":"ckn438q8x003mw5ih3w441tit"},{"post_id":"ckn438q870024w5ihg38x2fc4","tag_id":"ckn438q8i002vw5ihdqa6bnlh","_id":"ckn438q8x003ow5ihgdp8691y"},{"post_id":"ckn438q890028w5ihdly0flea","tag_id":"ckn438q8x003nw5ih8c652feo","_id":"ckn438q8y003rw5ih7kc28kfm"},{"post_id":"ckn438q890028w5ihdly0flea","tag_id":"ckn438q8x003pw5ih7h5ab1nc","_id":"ckn438q8y003sw5ih2x3jf89x"},{"post_id":"ckn438q8a002aw5ihd43v2r8d","tag_id":"ckn438q8y003qw5ihhky6h97j","_id":"ckn438q8z003uw5ihaqgjhn70"},{"post_id":"ckn438q8c002fw5ihend92pom","tag_id":"ckn438q8l0037w5ih9kmrdito","_id":"ckn438q8z003ww5ihgwg178wb"},{"post_id":"ckn438q8e002kw5ih3cavee9c","tag_id":"ckn438q8z003vw5ihgh0h6fzk","_id":"ckn438q90003yw5ih70lzcp52"},{"post_id":"ckn438q8f002nw5ih51ws5ehk","tag_id":"ckn438q8z003xw5ihawm77h56","_id":"ckn438q90003zw5ih4up17u11"},{"post_id":"ckn438q920040w5ih87kh5m6w","tag_id":"ckn438q8i002vw5ihdqa6bnlh","_id":"ckn438q940042w5ih94ldcffy"},{"post_id":"ckn438q930041w5ih5mop3veu","tag_id":"ckn438q940043w5ihdjql3uj6","_id":"ckn438q960046w5ihhk340nwe"}],"Tag":[{"name":"summary","_id":"ckn438q6s0004w5ihg9x6ejhl"},{"name":"spring security","_id":"ckn438q70000cw5iheyqw7s81"},{"name":"bst","_id":"ckn438q75000jw5ihhq3r3ost"},{"name":"bitwise","_id":"ckn438q79000pw5ihgj47fuw0"},{"name":"algorithm","_id":"ckn438q7e000ww5ihgg94fabu"},{"name":"LeetCode","_id":"ckn438q7o001iw5ih1uyf0os2"},{"name":"design_patterns","_id":"ckn438q7u001ow5ih8iww1rn0"},{"name":"hashmap, data structure","_id":"ckn438q80001vw5ihfn3b81yb"},{"name":"datastructure","_id":"ckn438q860023w5ihcy6sfn1h"},{"name":"http","_id":"ckn438q8b002cw5ih3emi9udw"},{"name":"https","_id":"ckn438q8e002jw5ih5w8k15wa"},{"name":"framework","_id":"ckn438q8g002pw5iheeazbcui"},{"name":"source","_id":"ckn438q8i002vw5ihdqa6bnlh"},{"name":"kafka","_id":"ckn438q8k0034w5ih7u83dzhl"},{"name":"lock","_id":"ckn438q8l0037w5ih9kmrdito"},{"name":"mybatis","_id":"ckn438q8m0039w5ihdw416zim"},{"name":"network","_id":"ckn438q8o003fw5ihfejyh7iu"},{"name":"redis","_id":"ckn438q8p003hw5ih1dc1aswe"},{"name":"nosql","_id":"ckn438q8q003jw5ihhj53a6zo"},{"name":"double poiters","_id":"ckn438q8x003nw5ih8c652feo"},{"name":"map+preSum","_id":"ckn438q8x003pw5ih7h5ab1nc"},{"name":"utils","_id":"ckn438q8y003qw5ihhky6h97j"},{"name":"classloader","_id":"ckn438q8z003vw5ihgh0h6fzk"},{"name":"memory","_id":"ckn438q8z003xw5ihawm77h56"},{"name":"activemq","_id":"ckn438q940043w5ihdjql3uj6"}]}}